(self.webpackChunkGboardPlus=self.webpackChunkGboardPlus||[]).push([[228],{371:(ot,zt,V)=>{"use strict";V.d(zt,{ro:()=>Iy,rK:()=>Id,I2:()=>Wa});var x=V(755),A=V(6733),ke=V(6424),d=V(8748),R=V(5047),Li=V(530),Qi=V(1570),mi=V(155),$t=V(8004),Zi=V(5333),Hi=V(1749),Bt=V(2405);class tt extends Error{}class Ve extends tt{constructor(y){super(`Invalid DateTime: ${y.toMessage()}`)}}class Nt extends tt{constructor(y){super(`Invalid Interval: ${y.toMessage()}`)}}class Vt extends tt{constructor(y){super(`Invalid Duration: ${y.toMessage()}`)}}class Pi extends tt{}class Fi extends tt{constructor(y){super(`Invalid unit ${y}`)}}class Ht extends tt{}class si extends tt{constructor(){super("Zone is an abstract class")}}const Je="numeric",pi="short",ni="long",Mn={year:Je,month:Je,day:Je},ls={year:Je,month:pi,day:Je},ir={year:Je,month:pi,day:Je,weekday:pi},jt={year:Je,month:ni,day:Je},zn={year:Je,month:ni,day:Je,weekday:ni},ut={hour:Je,minute:Je},yi={hour:Je,minute:Je,second:Je},Qt={hour:Je,minute:Je,second:Je,timeZoneName:pi},Bi={hour:Je,minute:Je,second:Je,timeZoneName:ni},ts={hour:Je,minute:Je,hourCycle:"h23"},ps={hour:Je,minute:Je,second:Je,hourCycle:"h23"},Os={hour:Je,minute:Je,second:Je,hourCycle:"h23",timeZoneName:pi},Rs={hour:Je,minute:Je,second:Je,hourCycle:"h23",timeZoneName:ni},cs={year:Je,month:Je,day:Je,hour:Je,minute:Je},pn={year:Je,month:Je,day:Je,hour:Je,minute:Je,second:Je},fn={year:Je,month:pi,day:Je,hour:Je,minute:Je},jn={year:Je,month:pi,day:Je,hour:Je,minute:Je,second:Je},Vi={year:Je,month:pi,day:Je,weekday:pi,hour:Je,minute:Je},ds={year:Je,month:ni,day:Je,hour:Je,minute:Je,timeZoneName:pi},fs={year:Je,month:ni,day:Je,hour:Je,minute:Je,second:Je,timeZoneName:pi},bn={year:Je,month:ni,day:Je,weekday:ni,hour:Je,minute:Je,timeZoneName:ni},gi={year:Je,month:ni,day:Je,weekday:ni,hour:Je,minute:Je,second:Je,timeZoneName:ni};class is{get type(){throw new si}get name(){throw new si}get ianaName(){return this.name}get isUniversal(){throw new si}offsetName(y,v){throw new si}formatOffset(y,v){throw new si}offset(y){throw new si}equals(y){throw new si}get isValid(){throw new si}}let Tn=null;class Sn extends is{static get instance(){return null===Tn&&(Tn=new Sn),Tn}get type(){return"system"}get name(){return(new Intl.DateTimeFormat).resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(y,{format:v,locale:T}){return gd(y,v,T)}formatOffset(y,v){return we(this.offset(y),v)}offset(y){return-new Date(y).getTimezoneOffset()}equals(y){return"system"===y.type}get isValid(){return!0}}let dt={};const j={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};let Mt={};class it extends is{static create(y){return Mt[y]||(Mt[y]=new it(y)),Mt[y]}static resetCache(){Mt={},dt={}}static isValidSpecifier(y){return this.isValidZone(y)}static isValidZone(y){if(!y)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:y}).format(),!0}catch{return!1}}constructor(y){super(),this.zoneName=y,this.valid=it.isValidZone(y)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(y,{format:v,locale:T}){return gd(y,v,T,this.name)}formatOffset(y,v){return we(this.offset(y),v)}offset(y){const v=new Date(y);if(isNaN(v))return NaN;const T=function Ni(w){return dt[w]||(dt[w]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:w,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),dt[w]}(this.name);let[k,H,oe,Me,Be,Ke,ci]=T.formatToParts?function De(w,y){const v=w.formatToParts(y),T=[];for(let k=0;k<v.length;k++){const{type:H,value:oe}=v[k],Me=j[H];"era"===H?T[Me]=oe:Ie(Me)||(T[Me]=parseInt(oe,10))}return T}(T,v):function he(w,y){const v=w.format(y).replace(/\u200E/g,""),T=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(v),[,k,H,oe,Me,Be,Ke,ci]=T;return[oe,k,H,Me,Be,Ke,ci]}(T,v);"BC"===Me&&(k=1-Math.abs(k));let bi=+v;const Us=bi%1e3;return bi-=Us>=0?Us:1e3+Us,(ul({year:k,month:H,day:oe,hour:24===Be?0:Be,minute:Ke,second:ci,millisecond:0})-bi)/6e4}equals(y){return"iana"===y.type&&y.name===this.name}get isValid(){return this.valid}}let Ln={},Ne={};function je(w,y={}){const v=JSON.stringify([w,y]);let T=Ne[v];return T||(T=new Intl.DateTimeFormat(w,y),Ne[v]=T),T}let Zt={},z={},mt=null,Ae={};function Tt(w,y,v,T){const k=w.listingMode();return"error"===k?null:"en"===k?v(y):T(y)}class Hn{constructor(y,v,T){this.padTo=T.padTo||0,this.floor=T.floor||!1;const{padTo:k,floor:H,...oe}=T;if(!v||Object.keys(oe).length>0){const Me={useGrouping:!1,...T};T.padTo>0&&(Me.minimumIntegerDigits=T.padTo),this.inf=function ne(w,y={}){const v=JSON.stringify([w,y]);let T=Zt[v];return T||(T=new Intl.NumberFormat(w,y),Zt[v]=T),T}(y,Me)}}format(y){if(this.inf){const v=this.floor?Math.floor(y):y;return this.inf.format(v)}return Ot(this.floor?Math.floor(y):Ur(y,3),this.padTo)}}class Wi{constructor(y,v,T){let k;if(this.opts=T,this.originalZone=void 0,this.opts.timeZone)this.dt=y;else if("fixed"===y.zone.type){const oe=y.offset/60*-1,Me=oe>=0?`Etc/GMT+${oe}`:`Etc/GMT${oe}`;0!==y.offset&&it.create(Me).valid?(k=Me,this.dt=y):(k="UTC",this.dt=0===y.offset?y:y.setZone("UTC").plus({minutes:y.offset}),this.originalZone=y.zone)}else"system"===y.zone.type?this.dt=y:"iana"===y.zone.type?(this.dt=y,k=y.zone.name):(k="UTC",this.dt=y.setZone("UTC").plus({minutes:y.offset}),this.originalZone=y.zone);const H={...this.opts};H.timeZone=H.timeZone||k,this.dtf=je(v,H)}format(){return this.originalZone?this.formatToParts().map(({value:y})=>y).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const y=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?y.map(v=>{if("timeZoneName"===v.type){const T=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...v,value:T}}return v}):y}resolvedOptions(){return this.dtf.resolvedOptions()}}class ns{constructor(y,v,T){this.opts={style:"long",...T},!v&&Zn()&&(this.rtf=function Qe(w,y={}){const{base:v,...T}=y,k=JSON.stringify([w,T]);let H=z[k];return H||(H=new Intl.RelativeTimeFormat(w,y),z[k]=H),H}(y,T))}format(y,v){return this.rtf?this.rtf.format(y,v):function cc(w,y,v="always",T=!1){const k={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},H=-1===["hours","minutes","seconds"].indexOf(w);if("auto"===v&&H){const Ri="days"===w;switch(y){case 1:return Ri?"tomorrow":`next ${k[w][0]}`;case-1:return Ri?"yesterday":`last ${k[w][0]}`;case 0:return Ri?"today":`this ${k[w][0]}`}}const oe=Object.is(y,-0)||y<0,Me=Math.abs(y),Be=1===Me,Ke=k[w],ci=T?Be?Ke[1]:Ke[2]||Ke[1]:Be?k[w][0]:w;return oe?`${Me} ${ci} ago`:`in ${Me} ${ci}`}(v,y,this.opts.numeric,"long"!==this.opts.style)}formatToParts(y,v){return this.rtf?this.rtf.formatToParts(y,v):[]}}const Ia={firstDay:1,minimalDays:4,weekend:[6,7]};class Si{static fromOpts(y){return Si.create(y.locale,y.numberingSystem,y.outputCalendar,y.weekSettings,y.defaultToEN)}static create(y,v,T,k,H=!1){const oe=y||gn.defaultLocale,Me=oe||(H?"en-US":function ht(){return mt||(mt=(new Intl.DateTimeFormat).resolvedOptions().locale,mt)}()),Be=v||gn.defaultNumberingSystem,Ke=T||gn.defaultOutputCalendar,ci=F(k)||gn.defaultWeekSettings;return new Si(Me,Be,Ke,ci,oe)}static resetCache(){mt=null,Ne={},Zt={},z={}}static fromObject({locale:y,numberingSystem:v,outputCalendar:T,weekSettings:k}={}){return Si.create(y,v,T,k)}constructor(y,v,T,k,H){const[oe,Me,Be]=function Y(w){const y=w.indexOf("-x-");-1!==y&&(w=w.substring(0,y));const v=w.indexOf("-u-");if(-1===v)return[w];{let T,k;try{T=je(w).resolvedOptions(),k=w}catch{const Be=w.substring(0,v);T=je(Be).resolvedOptions(),k=Be}const{numberingSystem:H,calendar:oe}=T;return[k,H,oe]}}(y);this.locale=oe,this.numberingSystem=v||Me||null,this.outputCalendar=T||Be||null,this.weekSettings=k,this.intl=function be(w,y,v){return(v||y)&&(w.includes("-u-")||(w+="-u"),v&&(w+=`-ca-${v}`),y&&(w+=`-nu-${y}`)),w}(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=H,this.fastNumbersCached=null}get fastNumbers(){return null==this.fastNumbersCached&&(this.fastNumbersCached=function xi(w){return(!w.numberingSystem||"latn"===w.numberingSystem)&&("latn"===w.numberingSystem||!w.locale||w.locale.startsWith("en")||"latn"===new Intl.DateTimeFormat(w.intl).resolvedOptions().numberingSystem)}(this)),this.fastNumbersCached}listingMode(){return this.isEnglish()&&!(null!==this.numberingSystem&&"latn"!==this.numberingSystem||null!==this.outputCalendar&&"gregory"!==this.outputCalendar)?"en":"intl"}clone(y){return y&&0!==Object.getOwnPropertyNames(y).length?Si.create(y.locale||this.specifiedLocale,y.numberingSystem||this.numberingSystem,y.outputCalendar||this.outputCalendar,F(y.weekSettings)||this.weekSettings,y.defaultToEN||!1):this}redefaultToEN(y={}){return this.clone({...y,defaultToEN:!0})}redefaultToSystem(y={}){return this.clone({...y,defaultToEN:!1})}months(y,v=!1){return Tt(this,y,Wt,()=>{const T=v?{month:y,day:"numeric"}:{month:y},k=v?"format":"standalone";return this.monthsCache[k][y]||(this.monthsCache[k][y]=function fe(w){const y=[];for(let v=1;v<=12;v++){const T=Kt.utc(2009,v,1);y.push(w(T))}return y}(H=>this.extract(H,T,"month"))),this.monthsCache[k][y]})}weekdays(y,v=!1){return Tt(this,y,Nn,()=>{const T=v?{weekday:y,year:"numeric",month:"long",day:"numeric"}:{weekday:y},k=v?"format":"standalone";return this.weekdaysCache[k][y]||(this.weekdaysCache[k][y]=function St(w){const y=[];for(let v=1;v<=7;v++){const T=Kt.utc(2016,11,13+v);y.push(w(T))}return y}(H=>this.extract(H,T,"weekday"))),this.weekdaysCache[k][y]})}meridiems(){return Tt(this,void 0,()=>un,()=>{if(!this.meridiemCache){const y={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[Kt.utc(2016,11,13,9),Kt.utc(2016,11,13,19)].map(v=>this.extract(v,y,"dayperiod"))}return this.meridiemCache})}eras(y){return Tt(this,y,Cs,()=>{const v={era:y};return this.eraCache[y]||(this.eraCache[y]=[Kt.utc(-40,1,1),Kt.utc(2017,1,1)].map(T=>this.extract(T,v,"era"))),this.eraCache[y]})}extract(y,v,T){const oe=this.dtFormatter(y,v).formatToParts().find(Me=>Me.type.toLowerCase()===T);return oe?oe.value:null}numberFormatter(y={}){return new Hn(this.intl,y.forceSimple||this.fastNumbers,y)}dtFormatter(y,v={}){return new Wi(y,this.intl,v)}relFormatter(y={}){return new ns(this.intl,this.isEnglish(),y)}listFormatter(y={}){return function ge(w,y={}){const v=JSON.stringify([w,y]);let T=Ln[v];return T||(T=new Intl.ListFormat(w,y),Ln[v]=T),T}(this.intl,y)}isEnglish(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:Gi()?function Lt(w){let y=Ae[w];if(!y){const v=new Intl.Locale(w);y="getWeekInfo"in v?v.getWeekInfo():v.weekInfo,Ae[w]=y}return y}(this.locale):Ia}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(y){return this.locale===y.locale&&this.numberingSystem===y.numberingSystem&&this.outputCalendar===y.outputCalendar}}let Sr=null;class Fn extends is{static get utcInstance(){return null===Sr&&(Sr=new Fn(0)),Sr}static instance(y){return 0===y?Fn.utcInstance:new Fn(y)}static parseSpecifier(y){if(y){const v=y.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(v)return new Fn(ao(v[1],v[2]))}return null}constructor(y){super(),this.fixed=y}get type(){return"fixed"}get name(){return 0===this.fixed?"UTC":`UTC${we(this.fixed,"narrow")}`}get ianaName(){return 0===this.fixed?"Etc/UTC":`Etc/GMT${we(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(y,v){return we(this.fixed,v)}get isUniversal(){return!0}offset(){return this.fixed}equals(y){return"fixed"===y.type&&y.fixed===this.fixed}get isValid(){return!0}}class kr extends is{constructor(y){super(),this.zoneName=y}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Ys(w,y){if(Ie(w)||null===w)return y;if(w instanceof is)return w;if(function ri(w){return"string"==typeof w}(w)){const T=w.toLowerCase();return"default"===T?y:"local"===T||"system"===T?Sn.instance:"utc"===T||"gmt"===T?Fn.utcInstance:Fn.parseSpecifier(T)||it.create(w)}return qt(w)?Fn.instance(w):"object"==typeof w&&"offset"in w&&"function"==typeof w.offset?w:new kr(w)}let so,Is=()=>Date.now(),Qr="system",Nr=null,La=null,Ro=null,Fa=60,ya=null;class gn{static get now(){return Is}static set now(y){Is=y}static set defaultZone(y){Qr=y}static get defaultZone(){return Ys(Qr,Sn.instance)}static get defaultLocale(){return Nr}static set defaultLocale(y){Nr=y}static get defaultNumberingSystem(){return La}static set defaultNumberingSystem(y){La=y}static get defaultOutputCalendar(){return Ro}static set defaultOutputCalendar(y){Ro=y}static get defaultWeekSettings(){return ya}static set defaultWeekSettings(y){ya=F(y)}static get twoDigitCutoffYear(){return Fa}static set twoDigitCutoffYear(y){Fa=y%100}static get throwOnInvalid(){return so}static set throwOnInvalid(y){so=y}static resetCaches(){Si.resetCache(),it.resetCache()}}class Ls{constructor(y,v){this.reason=y,this.explanation=v}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const xa=[0,31,59,90,120,151,181,212,243,273,304,334],ro=[0,31,60,91,121,152,182,213,244,274,305,335];function Fs(w,y){return new Ls("unit out of range",`you specified ${y} (of type ${typeof y}) as a ${w}, which is invalid`)}function wa(w,y,v){const T=new Date(Date.UTC(w,y-1,v));w<100&&w>=0&&T.setUTCFullYear(T.getUTCFullYear()-1900);const k=T.getUTCDay();return 0===k?7:k}function Ba(w,y,v){return v+(ia(w)?ro:xa)[y-1]}function Io(w,y){const v=ia(w)?ro:xa,T=v.findIndex(H=>H<y);return{month:T+1,day:y-v[T]}}function Ma(w,y){return(w-y+7)%7+1}function ss(w,y=4,v=1){const{year:T,month:k,day:H}=w,oe=Ba(T,k,H),Me=Ma(wa(T,k,H),v);let Ke,Be=Math.floor((oe-Me+14-y)/7);return Be<1?(Ke=T-1,Be=js(Ke,y,v)):Be>js(T,y,v)?(Ke=T+1,Be=1):Ke=T,{weekYear:Ke,weekNumber:Be,weekday:Me,...Re(w)}}function ea(w,y=4,v=1){const{weekYear:T,weekNumber:k,weekday:H}=w,oe=Ma(wa(T,1,y),v),Me=Lo(T);let Ke,Be=7*k+H-oe-7+y;Be<1?(Ke=T-1,Be+=Lo(Ke)):Be>Me?(Ke=T+1,Be-=Lo(T)):Ke=T;const{month:ci,day:Ri}=Io(Ke,Be);return{year:Ke,month:ci,day:Ri,...Re(w)}}function ta(w){const{year:y,month:v,day:T}=w;return{year:y,ordinal:Ba(y,v,T),...Re(w)}}function J(w){const{year:y,ordinal:v}=w,{month:T,day:k}=Io(y,v);return{year:y,month:T,day:k,...Re(w)}}function _t(w,y){if(Ie(w.localWeekday)&&Ie(w.localWeekNumber)&&Ie(w.localWeekYear))return{minDaysInFirstWeek:4,startOfWeek:1};if(!Ie(w.weekday)||!Ie(w.weekNumber)||!Ie(w.weekYear))throw new Pi("Cannot mix locale-based week fields with ISO-based week fields");return Ie(w.localWeekday)||(w.weekday=w.localWeekday),Ie(w.localWeekNumber)||(w.weekNumber=w.localWeekNumber),Ie(w.localWeekYear)||(w.weekYear=w.localWeekYear),delete w.localWeekday,delete w.localWeekNumber,delete w.localWeekYear,{minDaysInFirstWeek:y.getMinDaysInFirstWeek(),startOfWeek:y.getStartOfWeek()}}function _e(w){const y=Ei(w.year),v=X(w.month,1,12),T=X(w.day,1,ac(w.year,w.month));return y?v?!T&&Fs("day",w.day):Fs("month",w.month):Fs("year",w.year)}function ze(w){const{hour:y,minute:v,second:T,millisecond:k}=w,H=X(y,0,23)||24===y&&0===v&&0===T&&0===k,oe=X(v,0,59),Me=X(T,0,59),Be=X(k,0,999);return H?oe?Me?!Be&&Fs("millisecond",k):Fs("second",T):Fs("minute",v):Fs("hour",y)}function Ie(w){return typeof w>"u"}function qt(w){return"number"==typeof w}function Ei(w){return"number"==typeof w&&w%1==0}function Zn(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function Gi(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function bt(w,y,v){if(0!==w.length)return w.reduce((T,k)=>{const H=[y(k),k];return T&&v(T[0],H[0])===T[0]?T:H},null)[1]}function U(w,y){return Object.prototype.hasOwnProperty.call(w,y)}function F(w){if(null==w)return null;if("object"!=typeof w)throw new Ht("Week settings must be an object");if(!X(w.firstDay,1,7)||!X(w.minimalDays,1,7)||!Array.isArray(w.weekend)||w.weekend.some(y=>!X(y,1,7)))throw new Ht("Invalid week settings");return{firstDay:w.firstDay,minimalDays:w.minimalDays,weekend:Array.from(w.weekend)}}function X(w,y,v){return Ei(w)&&w>=y&&w<=v}function Ot(w,y=2){let T;return T=w<0?"-"+(""+-w).padStart(y,"0"):(""+w).padStart(y,"0"),T}function Pn(w){if(!Ie(w)&&null!==w&&""!==w)return parseInt(w,10)}function Bn(w){if(!Ie(w)&&null!==w&&""!==w)return parseFloat(w)}function nr(w){if(!Ie(w)&&null!==w&&""!==w){const y=1e3*parseFloat("0."+w);return Math.floor(y)}}function Ur(w,y,v=!1){const T=10**y;return(v?Math.trunc:Math.round)(w*T)/T}function ia(w){return w%4==0&&(w%100!=0||w%400==0)}function Lo(w){return ia(w)?366:365}function ac(w,y){const v=function Ee(w,y){return w-y*Math.floor(w/y)}(y-1,12)+1;return 2===v?ia(w+(y-v)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][v-1]}function ul(w){let y=Date.UTC(w.year,w.month-1,w.day,w.hour,w.minute,w.second,w.millisecond);return w.year<100&&w.year>=0&&(y=new Date(y),y.setUTCFullYear(w.year,w.month-1,w.day)),+y}function zr(w,y,v){return-Ma(wa(w,1,y),v)+y-1}function js(w,y=4,v=1){const T=zr(w,y,v),k=zr(w+1,y,v);return(Lo(w)-T+k)/7}function oc(w){return w>99?w:w>gn.twoDigitCutoffYear?1900+w:2e3+w}function gd(w,y,v,T=null){const k=new Date(w),H={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};T&&(H.timeZone=T);const oe={timeZoneName:y,...H},Me=new Intl.DateTimeFormat(v,oe).formatToParts(k).find(Be=>"timezonename"===Be.type.toLowerCase());return Me?Me.value:null}function ao(w,y){let v=parseInt(w,10);Number.isNaN(v)&&(v=0);const T=parseInt(y,10)||0;return 60*v+(v<0||Object.is(v,-0)?-T:T)}function Fo(w){const y=Number(w);if("boolean"==typeof w||""===w||Number.isNaN(y))throw new Ht(`Invalid unit value ${w}`);return y}function le(w,y){const v={};for(const T in w)if(U(w,T)){const k=w[T];if(null==k)continue;v[y(T)]=Fo(k)}return v}function we(w,y){const v=Math.trunc(Math.abs(w/60)),T=Math.trunc(Math.abs(w%60)),k=w>=0?"+":"-";switch(y){case"short":return`${k}${Ot(v,2)}:${Ot(T,2)}`;case"narrow":return`${k}${v}${T>0?`:${T}`:""}`;case"techie":return`${k}${Ot(v,2)}${Ot(T,2)}`;default:throw new RangeError(`Value format ${y} is out of range for property format`)}}function Re(w){return function D(w,y){return y.reduce((v,T)=>(v[T]=w[T],v),{})}(w,["hour","minute","second","millisecond"])}const kt=["January","February","March","April","May","June","July","August","September","October","November","December"],Ct=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],_i=["J","F","M","A","M","J","J","A","S","O","N","D"];function Wt(w){switch(w){case"narrow":return[..._i];case"short":return[...Ct];case"long":return[...kt];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const Cn=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],hn=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Vn=["M","T","W","T","F","S","S"];function Nn(w){switch(w){case"narrow":return[...Vn];case"short":return[...hn];case"long":return[...Cn];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const un=["AM","PM"],rs=["Before Christ","Anno Domini"],Bs=["BC","AD"],gs=["B","A"];function Cs(w){switch(w){case"narrow":return[...gs];case"short":return[...Bs];case"long":return[...rs];default:return null}}function dc(w,y){let v="";for(const T of w)v+=T.literal?T.val:y(T.val);return v}const c_={D:Mn,DD:ls,DDD:jt,DDDD:zn,t:ut,tt:yi,ttt:Qt,tttt:Bi,T:ts,TT:ps,TTT:Os,TTTT:Rs,f:cs,ff:fn,fff:ds,ffff:bn,F:pn,FF:jn,FFF:fs,FFFF:gi};class sr{static create(y,v={}){return new sr(y,v)}static parseFormat(y){let v=null,T="",k=!1;const H=[];for(let oe=0;oe<y.length;oe++){const Me=y.charAt(oe);"'"===Me?(T.length>0&&H.push({literal:k||/^\s+$/.test(T),val:T}),v=null,T="",k=!k):k||Me===v?T+=Me:(T.length>0&&H.push({literal:/^\s+$/.test(T),val:T}),T=Me,v=Me)}return T.length>0&&H.push({literal:k||/^\s+$/.test(T),val:T}),H}static macroTokenToFormatOpts(y){return c_[y]}constructor(y,v){this.opts=v,this.loc=y,this.systemLoc=null}formatWithSystemDefault(y,v){return null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(y,{...this.opts,...v}).format()}dtFormatter(y,v={}){return this.loc.dtFormatter(y,{...this.opts,...v})}formatDateTime(y,v){return this.dtFormatter(y,v).format()}formatDateTimeParts(y,v){return this.dtFormatter(y,v).formatToParts()}formatInterval(y,v){return this.dtFormatter(y.start,v).dtf.formatRange(y.start.toJSDate(),y.end.toJSDate())}resolvedOptions(y,v){return this.dtFormatter(y,v).resolvedOptions()}num(y,v=0){if(this.opts.forceSimple)return Ot(y,v);const T={...this.opts};return v>0&&(T.padTo=v),this.loc.numberFormatter(T).format(y)}formatDateTimeFromString(y,v){const T="en"===this.loc.listingMode(),k=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar,H=(bi,Us)=>this.loc.extract(y,bi,Us),oe=bi=>y.isOffsetFixed&&0===y.offset&&bi.allowZ?"Z":y.isValid?y.zone.formatOffset(y.ts,bi.format):"",Be=(bi,Us)=>T?function ml(w,y){return Wt(y)[w.month-1]}(y,bi):H(Us?{month:bi}:{month:bi,day:"numeric"},"month"),Ke=(bi,Us)=>T?function lc(w,y){return Nn(y)[w.weekday-1]}(y,bi):H(Us?{weekday:bi}:{weekday:bi,month:"long",day:"numeric"},"weekday"),ci=bi=>{const Us=sr.macroTokenToFormatOpts(bi);return Us?this.formatWithSystemDefault(y,Us):bi},Ri=bi=>T?function _d(w,y){return Cs(y)[w.year<0?0:1]}(y,bi):H({era:bi},"era");return dc(sr.parseFormat(v),bi=>{switch(bi){case"S":return this.num(y.millisecond);case"u":case"SSS":return this.num(y.millisecond,3);case"s":return this.num(y.second);case"ss":return this.num(y.second,2);case"uu":return this.num(Math.floor(y.millisecond/10),2);case"uuu":return this.num(Math.floor(y.millisecond/100));case"m":return this.num(y.minute);case"mm":return this.num(y.minute,2);case"h":return this.num(y.hour%12==0?12:y.hour%12);case"hh":return this.num(y.hour%12==0?12:y.hour%12,2);case"H":return this.num(y.hour);case"HH":return this.num(y.hour,2);case"Z":return oe({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return oe({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return oe({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return y.zone.offsetName(y.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return y.zone.offsetName(y.ts,{format:"long",locale:this.loc.locale});case"z":return y.zoneName;case"a":return T?function Na(w){return un[w.hour<12?0:1]}(y):H({hour:"numeric",hourCycle:"h12"},"dayperiod");case"d":return k?H({day:"numeric"},"day"):this.num(y.day);case"dd":return k?H({day:"2-digit"},"day"):this.num(y.day,2);case"c":case"E":return this.num(y.weekday);case"ccc":return Ke("short",!0);case"cccc":return Ke("long",!0);case"ccccc":return Ke("narrow",!0);case"EEE":return Ke("short",!1);case"EEEE":return Ke("long",!1);case"EEEEE":return Ke("narrow",!1);case"L":return k?H({month:"numeric",day:"numeric"},"month"):this.num(y.month);case"LL":return k?H({month:"2-digit",day:"numeric"},"month"):this.num(y.month,2);case"LLL":return Be("short",!0);case"LLLL":return Be("long",!0);case"LLLLL":return Be("narrow",!0);case"M":return k?H({month:"numeric"},"month"):this.num(y.month);case"MM":return k?H({month:"2-digit"},"month"):this.num(y.month,2);case"MMM":return Be("short",!1);case"MMMM":return Be("long",!1);case"MMMMM":return Be("narrow",!1);case"y":return k?H({year:"numeric"},"year"):this.num(y.year);case"yy":return k?H({year:"2-digit"},"year"):this.num(y.year.toString().slice(-2),2);case"yyyy":return k?H({year:"numeric"},"year"):this.num(y.year,4);case"yyyyyy":return k?H({year:"numeric"},"year"):this.num(y.year,6);case"G":return Ri("short");case"GG":return Ri("long");case"GGGGG":return Ri("narrow");case"kk":return this.num(y.weekYear.toString().slice(-2),2);case"kkkk":return this.num(y.weekYear,4);case"W":return this.num(y.weekNumber);case"WW":return this.num(y.weekNumber,2);case"n":return this.num(y.localWeekNumber);case"nn":return this.num(y.localWeekNumber,2);case"ii":return this.num(y.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(y.localWeekYear,4);case"o":return this.num(y.ordinal);case"ooo":return this.num(y.ordinal,3);case"q":return this.num(y.quarter);case"qq":return this.num(y.quarter,2);case"X":return this.num(Math.floor(y.ts/1e3));case"x":return this.num(y.ts);default:return ci(bi)}})}formatDurationFromString(y,v){const T=Be=>{switch(Be[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},H=sr.parseFormat(v),oe=H.reduce((Be,{literal:Ke,val:ci})=>Ke?Be:Be.concat(ci),[]);return dc(H,(Be=>Ke=>{const ci=T(Ke);return ci?this.num(Be.get(ci),Ke.length):Ke})(y.shiftTo(...oe.map(T).filter(Be=>Be))))}}const Wm=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function pl(...w){const y=w.reduce((v,T)=>v+T.source,"");return RegExp(`^${y}$`)}function fl(...w){return y=>w.reduce(([v,T,k],H)=>{const[oe,Me,Be]=H(y,k);return[{...v,...oe},Me||T,Be]},[{},null,1]).slice(0,2)}function gl(w,...y){if(null==w)return[null,null];for(const[v,T]of y){const k=v.exec(w);if(k)return T(k)}return[null,null]}function Gm(...w){return(y,v)=>{const T={};let k;for(k=0;k<w.length;k++)T[w[k]]=Pn(y[v+k]);return[T,null,v+k]}}const Ym=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,su=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,jm=RegExp(`${su.source}(?:${Ym.source}?(?:\\[(${Wm.source})\\])?)?`),ru=RegExp(`(?:T${jm.source})?`),Zm=Gm("weekYear","weekNumber","weekDay"),On=Gm("year","ordinal"),fi=RegExp(`${su.source} ?(?:${Ym.source}|(${Wm.source}))?`),li=RegExp(`(?: ${fi.source})?`);function Zs(w,y,v){const T=w[y];return Ie(T)?v:Pn(T)}function Ta(w,y){return[{hours:Zs(w,y,0),minutes:Zs(w,y+1,0),seconds:Zs(w,y+2,0),milliseconds:nr(w[y+3])},null,y+4]}function ur(w,y){const v=!w[y]&&!w[y+1],T=ao(w[y+1],w[y+2]);return[{},v?null:Fn.instance(T),y+3]}function hc(w,y){return[{},w[y]?it.create(w[y]):null,y+1]}const p_=RegExp(`^T?${su.source}$`),Ua=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function f_(w){const[y,v,T,k,H,oe,Me,Be,Ke]=w,ci="-"===y[0],Ri=Be&&"-"===Be[0],vn=(bi,Us=!1)=>void 0!==bi&&(Us||bi&&ci)?-bi:bi;return[{years:vn(Bn(v)),months:vn(Bn(T)),weeks:vn(Bn(k)),days:vn(Bn(H)),hours:vn(Bn(oe)),minutes:vn(Bn(Me)),seconds:vn(Bn(Be),"-0"===Be),milliseconds:vn(nr(Ke),Ri)}]}const g_={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Xs(w,y,v,T,k,H,oe){const Me={year:2===y.length?oc(Pn(y)):Pn(y),month:Ct.indexOf(v)+1,day:Pn(T),hour:Pn(k),minute:Pn(H)};return oe&&(Me.second=Pn(oe)),w&&(Me.weekday=w.length>3?Cn.indexOf(w)+1:hn.indexOf(w)+1),Me}const __=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function au(w){const[,y,v,T,k,H,oe,Me,Be,Ke,ci,Ri]=w,vn=Xs(y,k,T,v,H,oe,Me);let bi;return bi=Be?g_[Be]:Ke?0:ao(ci,Ri),[vn,new Fn(bi)]}const v_=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,y_=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,qm=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function $m(w){const[,y,v,T,k,H,oe,Me]=w;return[Xs(y,k,T,v,H,oe,Me),Fn.utcInstance]}function x_(w){const[,y,v,T,k,H,oe,Me]=w;return[Xs(y,Me,v,T,k,H,oe),Fn.utcInstance]}const w_=pl(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,ru),M_=pl(/(\d{4})-?W(\d\d)(?:-?(\d))?/,ru),T_=pl(/(\d{4})-?(\d{3})/,ru),C_=pl(jm),Km=fl(function Xm(w,y){return[{year:Zs(w,y),month:Zs(w,y+1,1),day:Zs(w,y+2,1)},null,y+3]},Ta,ur,hc),D_=fl(Zm,Ta,ur,hc),an=fl(On,Ta,ur,hc),ou=fl(Ta,ur,hc),as=fl(Ta),A_=pl(/(\d{4})-(\d\d)-(\d\d)/,li),P_=pl(fi),Jm=fl(Ta,ur,hc),_l="Invalid Duration",oo={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},ep={years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6},...oo},Xn=365.2425,Ca=30.436875,za={years:{quarters:4,months:12,weeks:Xn/7,days:Xn,hours:24*Xn,minutes:525949.2,seconds:525949.2*60,milliseconds:525949.2*60*1e3},quarters:{months:3,weeks:Xn/28,days:Xn/4,hours:24*Xn/4,minutes:131487.3,seconds:525949.2*60/4,milliseconds:7889237999.999999},months:{weeks:Ca/7,days:Ca,hours:24*Ca,minutes:43829.1,seconds:2629746,milliseconds:2629746e3},...oo},sa=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],uc=sa.slice(0).reverse();function Hr(w,y,v=!1){const T={values:v?y.values:{...w.values,...y.values||{}},loc:w.loc.clone(y.loc),conversionAccuracy:y.conversionAccuracy||w.conversionAccuracy,matrix:y.matrix||w.matrix};return new on(T)}function bl(w,y){let v=y.milliseconds??0;for(const T of uc.slice(1))y[T]&&(v+=y[T]*w[T].milliseconds);return v}function lu(w,y){const v=bl(w,y)<0?-1:1;sa.reduceRight((T,k)=>{if(Ie(y[k]))return T;if(T){const oe=w[k][T],Me=Math.floor(y[T]*v/oe);y[k]+=Me*v,y[T]-=Me*oe*v}return k},null),sa.reduce((T,k)=>{if(Ie(y[k]))return T;if(T){const H=y[T]%1;y[T]-=H,y[k]+=H*w[T][k]}return k},null)}class on{constructor(y){const v="longterm"===y.conversionAccuracy||!1;let T=v?za:ep;y.matrix&&(T=y.matrix),this.values=y.values,this.loc=y.loc||Si.create(),this.conversionAccuracy=v?"longterm":"casual",this.invalid=y.invalid||null,this.matrix=T,this.isLuxonDuration=!0}static fromMillis(y,v){return on.fromObject({milliseconds:y},v)}static fromObject(y,v={}){if(null==y||"object"!=typeof y)throw new Ht("Duration.fromObject: argument expected to be an object, got "+(null===y?"null":typeof y));return new on({values:le(y,on.normalizeUnit),loc:Si.fromObject(v),conversionAccuracy:v.conversionAccuracy,matrix:v.matrix})}static fromDurationLike(y){if(qt(y))return on.fromMillis(y);if(on.isDuration(y))return y;if("object"==typeof y)return on.fromObject(y);throw new Ht(`Unknown duration argument ${y} of type ${typeof y}`)}static fromISO(y,v){const[T]=function S_(w){return gl(w,[Ua,f_])}(y);return T?on.fromObject(T,v):on.invalid("unparsable",`the input "${y}" can't be parsed as ISO 8601`)}static fromISOTime(y,v){const[T]=function k_(w){return gl(w,[p_,as])}(y);return T?on.fromObject(T,v):on.invalid("unparsable",`the input "${y}" can't be parsed as ISO 8601`)}static invalid(y,v=null){if(!y)throw new Ht("need to specify a reason the Duration is invalid");const T=y instanceof Ls?y:new Ls(y,v);if(gn.throwOnInvalid)throw new Vt(T);return new on({invalid:T})}static normalizeUnit(y){const v={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[y&&y.toLowerCase()];if(!v)throw new Fi(y);return v}static isDuration(y){return y&&y.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(y,v={}){const T={...v,floor:!1!==v.round&&!1!==v.floor};return this.isValid?sr.create(this.loc,T).formatDurationFromString(this,y):_l}toHuman(y={}){if(!this.isValid)return _l;const v=sa.map(T=>{const k=this.values[T];return Ie(k)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...y,unit:T.slice(0,-1)}).format(k)}).filter(T=>T);return this.loc.listFormatter({type:"conjunction",style:y.listStyle||"narrow",...y}).format(v)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let y="P";return 0!==this.years&&(y+=this.years+"Y"),(0!==this.months||0!==this.quarters)&&(y+=this.months+3*this.quarters+"M"),0!==this.weeks&&(y+=this.weeks+"W"),0!==this.days&&(y+=this.days+"D"),(0!==this.hours||0!==this.minutes||0!==this.seconds||0!==this.milliseconds)&&(y+="T"),0!==this.hours&&(y+=this.hours+"H"),0!==this.minutes&&(y+=this.minutes+"M"),(0!==this.seconds||0!==this.milliseconds)&&(y+=Ur(this.seconds+this.milliseconds/1e3,3)+"S"),"P"===y&&(y+="T0S"),y}toISOTime(y={}){if(!this.isValid)return null;const v=this.toMillis();return v<0||v>=864e5?null:(y={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...y,includeOffset:!1},Kt.fromMillis(v,{zone:"UTC"}).toISOTime(y))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?bl(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(y){if(!this.isValid)return this;const v=on.fromDurationLike(y),T={};for(const k of sa)(U(v.values,k)||U(this.values,k))&&(T[k]=v.get(k)+this.get(k));return Hr(this,{values:T},!0)}minus(y){if(!this.isValid)return this;const v=on.fromDurationLike(y);return this.plus(v.negate())}mapUnits(y){if(!this.isValid)return this;const v={};for(const T of Object.keys(this.values))v[T]=Fo(y(this.values[T],T));return Hr(this,{values:v},!0)}get(y){return this[on.normalizeUnit(y)]}set(y){return this.isValid?Hr(this,{values:{...this.values,...le(y,on.normalizeUnit)}}):this}reconfigure({locale:y,numberingSystem:v,conversionAccuracy:T,matrix:k}={}){return Hr(this,{loc:this.loc.clone({locale:y,numberingSystem:v}),matrix:k,conversionAccuracy:T})}as(y){return this.isValid?this.shiftTo(y).get(y):NaN}normalize(){if(!this.isValid)return this;const y=this.toObject();return lu(this.matrix,y),Hr(this,{values:y},!0)}rescale(){return this.isValid?Hr(this,{values:function tp(w){const y={};for(const[v,T]of Object.entries(w))0!==T&&(y[v]=T);return y}(this.normalize().shiftToAll().toObject())},!0):this}shiftTo(...y){if(!this.isValid)return this;if(0===y.length)return this;y=y.map(oe=>on.normalizeUnit(oe));const v={},T={},k=this.toObject();let H;for(const oe of sa)if(y.indexOf(oe)>=0){H=oe;let Me=0;for(const Ke in T)Me+=this.matrix[Ke][oe]*T[Ke],T[Ke]=0;qt(k[oe])&&(Me+=k[oe]);const Be=Math.trunc(Me);v[oe]=Be,T[oe]=(1e3*Me-1e3*Be)/1e3}else qt(k[oe])&&(T[oe]=k[oe]);for(const oe in T)0!==T[oe]&&(v[H]+=oe===H?T[oe]:T[oe]/this.matrix[H][oe]);return lu(this.matrix,v),Hr(this,{values:v},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const y={};for(const v of Object.keys(this.values))y[v]=0===this.values[v]?0:-this.values[v];return Hr(this,{values:y},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(y){if(!this.isValid||!y.isValid||!this.loc.equals(y.loc))return!1;function v(T,k){return void 0===T||0===T?void 0===k||0===k:T===k}for(const T of sa)if(!v(this.values[T],y.values[T]))return!1;return!0}}const Bo="Invalid Interval";class Wn{constructor(y){this.s=y.start,this.e=y.end,this.invalid=y.invalid||null,this.isLuxonInterval=!0}static invalid(y,v=null){if(!y)throw new Ht("need to specify a reason the Interval is invalid");const T=y instanceof Ls?y:new Ls(y,v);if(gn.throwOnInvalid)throw new Nt(T);return new Wn({invalid:T})}static fromDateTimes(y,v){const T=fc(y),k=fc(v),H=function cu(w,y){return w&&w.isValid?y&&y.isValid?y<w?Wn.invalid("end before start",`The end of an interval must be after its start, but you had start=${w.toISO()} and end=${y.toISO()}`):null:Wn.invalid("missing or invalid end"):Wn.invalid("missing or invalid start")}(T,k);return H??new Wn({start:T,end:k})}static after(y,v){const T=on.fromDurationLike(v),k=fc(y);return Wn.fromDateTimes(k,k.plus(T))}static before(y,v){const T=on.fromDurationLike(v),k=fc(y);return Wn.fromDateTimes(k.minus(T),k)}static fromISO(y,v){const[T,k]=(y||"").split("/",2);if(T&&k){let H,oe,Me,Be;try{H=Kt.fromISO(T,v),oe=H.isValid}catch{oe=!1}try{Me=Kt.fromISO(k,v),Be=Me.isValid}catch{Be=!1}if(oe&&Be)return Wn.fromDateTimes(H,Me);if(oe){const Ke=on.fromISO(k,v);if(Ke.isValid)return Wn.after(H,Ke)}else if(Be){const Ke=on.fromISO(T,v);if(Ke.isValid)return Wn.before(Me,Ke)}}return Wn.invalid("unparsable",`the input "${y}" can't be parsed as ISO 8601`)}static isInterval(y){return y&&y.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return null===this.invalidReason}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(y="milliseconds"){return this.isValid?this.toDuration(y).get(y):NaN}count(y="milliseconds",v){if(!this.isValid)return NaN;const T=this.start.startOf(y,v);let k;return k=v?.useLocaleWeeks?this.end.reconfigure({locale:T.locale}):this.end,k=k.startOf(y,v),Math.floor(k.diff(T,y).get(y))+(k.valueOf()!==this.end.valueOf())}hasSame(y){return!!this.isValid&&(this.isEmpty()||this.e.minus(1).hasSame(this.s,y))}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(y){return!!this.isValid&&this.s>y}isBefore(y){return!!this.isValid&&this.e<=y}contains(y){return!!this.isValid&&this.s<=y&&this.e>y}set({start:y,end:v}={}){return this.isValid?Wn.fromDateTimes(y||this.s,v||this.e):this}splitAt(...y){if(!this.isValid)return[];const v=y.map(fc).filter(oe=>this.contains(oe)).sort((oe,Me)=>oe.toMillis()-Me.toMillis()),T=[];let{s:k}=this,H=0;for(;k<this.e;){const oe=v[H]||this.e,Me=+oe>+this.e?this.e:oe;T.push(Wn.fromDateTimes(k,Me)),k=Me,H+=1}return T}splitBy(y){const v=on.fromDurationLike(y);if(!this.isValid||!v.isValid||0===v.as("milliseconds"))return[];let H,{s:T}=this,k=1;const oe=[];for(;T<this.e;){const Me=this.start.plus(v.mapUnits(Be=>Be*k));H=+Me>+this.e?this.e:Me,oe.push(Wn.fromDateTimes(T,H)),T=H,k+=1}return oe}divideEqually(y){return this.isValid?this.splitBy(this.length()/y).slice(0,y):[]}overlaps(y){return this.e>y.s&&this.s<y.e}abutsStart(y){return!!this.isValid&&+this.e==+y.s}abutsEnd(y){return!!this.isValid&&+y.e==+this.s}engulfs(y){return!!this.isValid&&this.s<=y.s&&this.e>=y.e}equals(y){return!(!this.isValid||!y.isValid)&&this.s.equals(y.s)&&this.e.equals(y.e)}intersection(y){if(!this.isValid)return this;const v=this.s>y.s?this.s:y.s,T=this.e<y.e?this.e:y.e;return v>=T?null:Wn.fromDateTimes(v,T)}union(y){return this.isValid?Wn.fromDateTimes(this.s<y.s?this.s:y.s,this.e>y.e?this.e:y.e):this}static merge(y){const[v,T]=y.sort((k,H)=>k.s-H.s).reduce(([k,H],oe)=>H?H.overlaps(oe)||H.abutsStart(oe)?[k,H.union(oe)]:[k.concat([H]),oe]:[k,oe],[[],null]);return T&&v.push(T),v}static xor(y){let v=null,T=0;const k=[],H=y.map(Be=>[{time:Be.s,type:"s"},{time:Be.e,type:"e"}]),Me=Array.prototype.concat(...H).sort((Be,Ke)=>Be.time-Ke.time);for(const Be of Me)T+="s"===Be.type?1:-1,1===T?v=Be.time:(v&&+v!=+Be.time&&k.push(Wn.fromDateTimes(v,Be.time)),v=null);return Wn.merge(k)}difference(...y){return Wn.xor([this].concat(y)).map(v=>this.intersection(v)).filter(v=>v&&!v.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} \u2013 ${this.e.toISO()})`:Bo}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(y=Mn,v={}){return this.isValid?sr.create(this.s.loc.clone(v),y).formatInterval(this):Bo}toISO(y){return this.isValid?`${this.s.toISO(y)}/${this.e.toISO(y)}`:Bo}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:Bo}toISOTime(y){return this.isValid?`${this.s.toISOTime(y)}/${this.e.toISOTime(y)}`:Bo}toFormat(y,{separator:v=" \u2013 "}={}){return this.isValid?`${this.s.toFormat(y)}${v}${this.e.toFormat(y)}`:Bo}toDuration(y,v){return this.isValid?this.e.diff(this.s,y,v):on.invalid(this.invalidReason)}mapEndpoints(y){return Wn.fromDateTimes(y(this.s),y(this.e))}}class vl{static hasDST(y=gn.defaultZone){const v=Kt.now().setZone(y).set({month:12});return!y.isUniversal&&v.offset!==v.set({month:6}).offset}static isValidIANAZone(y){return it.isValidZone(y)}static normalizeZone(y){return Ys(y,gn.defaultZone)}static getStartOfWeek({locale:y=null,locObj:v=null}={}){return(v||Si.create(y)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:y=null,locObj:v=null}={}){return(v||Si.create(y)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:y=null,locObj:v=null}={}){return(v||Si.create(y)).getWeekendDays().slice()}static months(y="long",{locale:v=null,numberingSystem:T=null,locObj:k=null,outputCalendar:H="gregory"}={}){return(k||Si.create(v,T,H)).months(y)}static monthsFormat(y="long",{locale:v=null,numberingSystem:T=null,locObj:k=null,outputCalendar:H="gregory"}={}){return(k||Si.create(v,T,H)).months(y,!0)}static weekdays(y="long",{locale:v=null,numberingSystem:T=null,locObj:k=null}={}){return(k||Si.create(v,T,null)).weekdays(y)}static weekdaysFormat(y="long",{locale:v=null,numberingSystem:T=null,locObj:k=null}={}){return(k||Si.create(v,T,null)).weekdays(y,!0)}static meridiems({locale:y=null}={}){return Si.create(y).meridiems()}static eras(y="short",{locale:v=null}={}){return Si.create(v,null,"gregory").eras(y)}static features(){return{relative:Zn(),localeWeek:Gi()}}}function du(w,y){const v=k=>k.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),T=v(y)-v(w);return Math.floor(on.fromMillis(T).as("days"))}const hu={arab:"[\u0660-\u0669]",arabext:"[\u06f0-\u06f9]",bali:"[\u1b50-\u1b59]",beng:"[\u09e6-\u09ef]",deva:"[\u0966-\u096f]",fullwide:"[\uff10-\uff19]",gujr:"[\u0ae6-\u0aef]",hanidec:"[\u3007|\u4e00|\u4e8c|\u4e09|\u56db|\u4e94|\u516d|\u4e03|\u516b|\u4e5d]",khmr:"[\u17e0-\u17e9]",knda:"[\u0ce6-\u0cef]",laoo:"[\u0ed0-\u0ed9]",limb:"[\u1946-\u194f]",mlym:"[\u0d66-\u0d6f]",mong:"[\u1810-\u1819]",mymr:"[\u1040-\u1049]",orya:"[\u0b66-\u0b6f]",tamldec:"[\u0be6-\u0bef]",telu:"[\u0c66-\u0c6f]",thai:"[\u0e50-\u0e59]",tibt:"[\u0f20-\u0f29]",latn:"\\d"},sp={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},Ar=hu.hanidec.replace(/[\[|\]]/g,"").split("");function ra({numberingSystem:w},y=""){return new RegExp(`${hu[w||"latn"]}${y}`)}function _n(w,y=(v=>v)){return{regex:w,deser:([v])=>y(function O_(w){let y=parseInt(w,10);if(isNaN(y)){y="";for(let v=0;v<w.length;v++){const T=w.charCodeAt(v);if(-1!==w[v].search(hu.hanidec))y+=Ar.indexOf(w[v]);else for(const k in sp){const[H,oe]=sp[k];T>=H&&T<=oe&&(y+=T-H)}}return parseInt(y,10)}return y}(v))}}const I_=`[ ${String.fromCharCode(160)}]`,rp=new RegExp(I_,"g");function uu(w){return w.replace(/\./g,"\\.?").replace(rp,I_)}function ap(w){return w.replace(/\./g,"").replace(rp," ").toLowerCase()}function aa(w,y){return null===w?null:{regex:RegExp(w.map(uu).join("|")),deser:([v])=>w.findIndex(T=>ap(v)===ap(T))+y}}function op(w,y){return{regex:w,deser:([,v,T])=>ao(v,T),groups:y}}function mc(w){return{regex:w,deser:([y])=>y}}function yl(w){return w.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}const mu={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};let cp=null;function B_(w,y){return Array.prototype.concat(...w.map(v=>function F_(w,y){if(w.literal)return w;const T=rr(sr.macroTokenToFormatOpts(w.val),y);return null==T||T.includes(void 0)?w:T}(v,y)))}function N_(w,y,v){const T=B_(sr.parseFormat(v),w),k=T.map(oe=>function L_(w,y){const v=ra(y),T=ra(y,"{2}"),k=ra(y,"{3}"),H=ra(y,"{4}"),oe=ra(y,"{6}"),Me=ra(y,"{1,2}"),Be=ra(y,"{1,3}"),Ke=ra(y,"{1,6}"),ci=ra(y,"{1,9}"),Ri=ra(y,"{2,4}"),vn=ra(y,"{4,6}"),bi=Da=>({regex:RegExp(yl(Da.val)),deser:([Pl])=>Pl,literal:!0}),Al=(Da=>{if(w.literal)return bi(Da);switch(Da.val){case"G":return aa(y.eras("short"),0);case"GG":return aa(y.eras("long"),0);case"y":return _n(Ke);case"yy":case"kk":return _n(Ri,oc);case"yyyy":case"kkkk":return _n(H);case"yyyyy":return _n(vn);case"yyyyyy":return _n(oe);case"M":case"L":case"d":case"H":case"h":case"m":case"q":case"s":case"W":return _n(Me);case"MM":case"LL":case"dd":case"HH":case"hh":case"mm":case"qq":case"ss":case"WW":return _n(T);case"MMM":return aa(y.months("short",!0),1);case"MMMM":return aa(y.months("long",!0),1);case"LLL":return aa(y.months("short",!1),1);case"LLLL":return aa(y.months("long",!1),1);case"o":case"S":return _n(Be);case"ooo":case"SSS":return _n(k);case"u":return mc(ci);case"uu":return mc(Me);case"uuu":case"E":case"c":return _n(v);case"a":return aa(y.meridiems(),0);case"EEE":return aa(y.weekdays("short",!1),1);case"EEEE":return aa(y.weekdays("long",!1),1);case"ccc":return aa(y.weekdays("short",!0),1);case"cccc":return aa(y.weekdays("long",!0),1);case"Z":case"ZZ":return op(new RegExp(`([+-]${Me.source})(?::(${T.source}))?`),2);case"ZZZ":return op(new RegExp(`([+-]${Me.source})(${T.source})?`),2);case"z":return mc(/[a-z_+-/]{1,256}?/i);case" ":return mc(/[^\S\n\r]/);default:return bi(Da)}})(w)||{invalidReason:"missing Intl.DateTimeFormat.formatToParts support"};return Al.token=w,Al}(oe,w)),H=k.find(oe=>oe.invalidReason);if(H)return{input:y,tokens:T,invalidReason:H.invalidReason};{const[oe,Me]=function pc(w){return[`^${w.map(v=>v.regex).reduce((v,T)=>`${v}(${T.source})`,"")}$`,w]}(k),Be=RegExp(oe,"i"),[Ke,ci]=function lp(w,y,v){const T=w.match(y);if(T){const k={};let H=1;for(const oe in v)if(U(v,oe)){const Me=v[oe],Be=Me.groups?Me.groups+1:1;!Me.literal&&Me.token&&(k[Me.token.val[0]]=Me.deser(T.slice(H,H+Be))),H+=Be}return[T,k]}return[T,{}]}(y,Be,Me),[Ri,vn,bi]=ci?function by(w){let T,v=null;return Ie(w.z)||(v=it.create(w.z)),Ie(w.Z)||(v||(v=new Fn(w.Z)),T=w.Z),Ie(w.q)||(w.M=3*(w.q-1)+1),Ie(w.h)||(w.h<12&&1===w.a?w.h+=12:12===w.h&&0===w.a&&(w.h=0)),0===w.G&&w.y&&(w.y=-w.y),Ie(w.u)||(w.S=nr(w.u)),[Object.keys(w).reduce((H,oe)=>{const Me=(H=>{switch(H){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}})(oe);return Me&&(H[Me]=w[oe]),H},{}),v,T]}(ci):[null,null,void 0];if(U(ci,"a")&&U(ci,"H"))throw new Pi("Can't include meridiem when specifying 24-hour format");return{input:y,tokens:T,regex:Be,rawMatches:Ke,matches:ci,result:Ri,zone:vn,specificOffset:bi}}}function rr(w,y){if(!w)return null;const T=sr.create(y,w).dtFormatter(function vy(){return cp||(cp=Kt.fromMillis(1555555555555)),cp}()),k=T.formatToParts(),H=T.resolvedOptions();return k.map(oe=>function ye(w,y,v){const{type:T,value:k}=w;if("literal"===T){const Be=/^\s+$/.test(k);return{literal:!Be,val:Be?" ":k}}let oe=T;"hour"===T&&(oe=null!=y.hour12?y.hour12?"hour12":"hour24":null!=y.hourCycle?"h11"===y.hourCycle||"h12"===y.hourCycle?"hour12":"hour24":v.hour12?"hour12":"hour24");let Me=mu[oe];if("object"==typeof Me&&(Me=Me[y[T]]),Me)return{literal:!1,val:Me}}(oe,w,H))}const bd="Invalid DateTime",U_=864e13;function lo(w){return new Ls("unsupported zone",`the zone "${w.name}" is not supported`)}function dp(w){return null===w.weekData&&(w.weekData=ss(w.c)),w.weekData}function hp(w){return null===w.localWeekData&&(w.localWeekData=ss(w.c,w.loc.getMinDaysInFirstWeek(),w.loc.getStartOfWeek())),w.localWeekData}function xl(w,y){const v={ts:w.ts,zone:w.zone,c:w.c,o:w.o,loc:w.loc,invalid:w.invalid};return new Kt({...v,...y,old:v})}function vd(w,y,v){let T=w-60*y*1e3;const k=v.offset(T);if(y===k)return[T,y];T-=60*(k-y)*1e3;const H=v.offset(T);return k===H?[T,k]:[w-60*Math.min(k,H)*1e3,Math.max(k,H)]}function pu(w,y){const v=new Date(w+=60*y*1e3);return{year:v.getUTCFullYear(),month:v.getUTCMonth()+1,day:v.getUTCDate(),hour:v.getUTCHours(),minute:v.getUTCMinutes(),second:v.getUTCSeconds(),millisecond:v.getUTCMilliseconds()}}function No(w,y,v){return vd(ul(w),y,v)}function yd(w,y){const v=w.o,T=w.c.year+Math.trunc(y.years),k=w.c.month+Math.trunc(y.months)+3*Math.trunc(y.quarters),H={...w.c,year:T,month:k,day:Math.min(w.c.day,ac(T,k))+Math.trunc(y.days)+7*Math.trunc(y.weeks)},oe=on.fromObject({years:y.years-Math.trunc(y.years),quarters:y.quarters-Math.trunc(y.quarters),months:y.months-Math.trunc(y.months),weeks:y.weeks-Math.trunc(y.weeks),days:y.days-Math.trunc(y.days),hours:y.hours,minutes:y.minutes,seconds:y.seconds,milliseconds:y.milliseconds}).as("milliseconds"),Me=ul(H);let[Be,Ke]=vd(Me,v,w.zone);return 0!==oe&&(Be+=oe,Ke=w.zone.offset(Be)),{ts:Be,o:Ke}}function wl(w,y,v,T,k,H){const{setZone:oe,zone:Me}=v;if(w&&0!==Object.keys(w).length||y){const Be=y||Me,Ke=Kt.fromObject(w,{...v,zone:Be,specificOffset:H});return oe?Ke:Ke.setZone(Me)}return Kt.invalid(new Ls("unparsable",`the input "${k}" can't be parsed as ${T}`))}function xd(w,y,v=!0){return w.isValid?sr.create(Si.create("en-US"),{allowZ:v,forceSimple:!0}).formatDateTimeFromString(w,y):null}function wd(w,y){const v=w.c.year>9999||w.c.year<0;let T="";return v&&w.c.year>=0&&(T+="+"),T+=Ot(w.c.year,v?6:4),y?(T+="-",T+=Ot(w.c.month),T+="-",T+=Ot(w.c.day)):(T+=Ot(w.c.month),T+=Ot(w.c.day)),T}function up(w,y,v,T,k,H){let oe=Ot(w.c.hour);return y?(oe+=":",oe+=Ot(w.c.minute),(0!==w.c.millisecond||0!==w.c.second||!v)&&(oe+=":")):oe+=Ot(w.c.minute),(0!==w.c.millisecond||0!==w.c.second||!v)&&(oe+=Ot(w.c.second),(0!==w.c.millisecond||!T)&&(oe+=".",oe+=Ot(w.c.millisecond,3))),k&&(w.isOffsetFixed&&0===w.offset&&!H?oe+="Z":w.o<0?(oe+="-",oe+=Ot(Math.trunc(-w.o/60)),oe+=":",oe+=Ot(Math.trunc(-w.o%60))):(oe+="+",oe+=Ot(Math.trunc(w.o/60)),oe+=":",oe+=Ot(Math.trunc(w.o%60)))),H&&(oe+="["+w.zone.ianaName+"]"),oe}const z_={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},yy={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},fu={ordinal:1,hour:0,minute:0,second:0,millisecond:0},gu=["year","month","day","hour","minute","second","millisecond"],Md=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],_u=["year","ordinal","hour","minute","second","millisecond"];function mp(w){switch(w.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return function Ds(w){const y={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[w.toLowerCase()];if(!y)throw new Fi(w);return y}(w)}}function mr(w,y){const v=Ys(y.zone,gn.defaultZone),T=Si.fromObject(y),k=gn.now();let H,oe;if(Ie(w.year))H=k;else{for(const Ke of gu)Ie(w[Ke])&&(w[Ke]=z_[Ke]);const Me=_e(w)||ze(w);if(Me)return Kt.invalid(Me);const Be=v.offset(k);[H,oe]=No(w,Be,v)}return new Kt({ts:H,zone:v,loc:T,o:oe})}function H_(w,y,v){const T=!!Ie(v.round)||v.round,k=(oe,Me)=>(oe=Ur(oe,T||v.calendary?0:2,!0),y.loc.clone(v).relFormatter(v).format(oe,Me)),H=oe=>v.calendary?y.hasSame(w,oe)?0:y.startOf(oe).diff(w.startOf(oe),oe).get(oe):y.diff(w,oe).get(oe);if(v.unit)return k(H(v.unit),v.unit);for(const oe of v.units){const Me=H(oe);if(Math.abs(Me)>=1)return k(Me,oe)}return k(w>y?-0:0,v.units[v.units.length-1])}function bu(w){let v,y={};return w.length>0&&"object"==typeof w[w.length-1]?(y=w[w.length-1],v=Array.from(w).slice(0,w.length-1)):v=Array.from(w),[y,v]}class Kt{constructor(y){const v=y.zone||gn.defaultZone;let T=y.invalid||(Number.isNaN(y.ts)?new Ls("invalid input"):null)||(v.isValid?null:lo(v));this.ts=Ie(y.ts)?gn.now():y.ts;let k=null,H=null;if(!T)if(y.old&&y.old.ts===this.ts&&y.old.zone.equals(v))[k,H]=[y.old.c,y.old.o];else{const Me=v.offset(this.ts);k=pu(this.ts,Me),T=Number.isNaN(k.year)?new Ls("invalid input"):null,k=T?null:k,H=T?null:Me}this._zone=v,this.loc=y.loc||Si.create(),this.invalid=T,this.weekData=null,this.localWeekData=null,this.c=k,this.o=H,this.isLuxonDateTime=!0}static now(){return new Kt({})}static local(){const[y,v]=bu(arguments),[T,k,H,oe,Me,Be,Ke]=v;return mr({year:T,month:k,day:H,hour:oe,minute:Me,second:Be,millisecond:Ke},y)}static utc(){const[y,v]=bu(arguments),[T,k,H,oe,Me,Be,Ke]=v;return y.zone=Fn.utcInstance,mr({year:T,month:k,day:H,hour:oe,minute:Me,second:Be,millisecond:Ke},y)}static fromJSDate(y,v={}){const T=function Di(w){return"[object Date]"===Object.prototype.toString.call(w)}(y)?y.valueOf():NaN;if(Number.isNaN(T))return Kt.invalid("invalid input");const k=Ys(v.zone,gn.defaultZone);return k.isValid?new Kt({ts:T,zone:k,loc:Si.fromObject(v)}):Kt.invalid(lo(k))}static fromMillis(y,v={}){if(qt(y))return y<-U_||y>U_?Kt.invalid("Timestamp out of range"):new Kt({ts:y,zone:Ys(v.zone,gn.defaultZone),loc:Si.fromObject(v)});throw new Ht(`fromMillis requires a numerical input, but received a ${typeof y} with value ${y}`)}static fromSeconds(y,v={}){if(qt(y))return new Kt({ts:1e3*y,zone:Ys(v.zone,gn.defaultZone),loc:Si.fromObject(v)});throw new Ht("fromSeconds requires a numerical input")}static fromObject(y,v={}){y=y||{};const T=Ys(v.zone,gn.defaultZone);if(!T.isValid)return Kt.invalid(lo(T));const k=Si.fromObject(v),H=le(y,mp),{minDaysInFirstWeek:oe,startOfWeek:Me}=_t(H,k),Be=gn.now(),Ke=Ie(v.specificOffset)?T.offset(Be):v.specificOffset,ci=!Ie(H.ordinal),Ri=!Ie(H.year),vn=!Ie(H.month)||!Ie(H.day),bi=Ri||vn,Us=H.weekYear||H.weekNumber;if((bi||ci)&&Us)throw new Pi("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(vn&&ci)throw new Pi("Can't mix ordinal dates with month/day");const Al=Us||H.weekday&&!bi;let Da,Pl,ho=pu(Be,Ke);Al?(Da=Md,Pl=yy,ho=ss(ho,oe,Me)):ci?(Da=_u,Pl=fu,ho=ta(ho)):(Da=gu,Pl=z_);let lb=!1;for(const yc of Da)Ie(H[yc])?H[yc]=lb?Pl[yc]:ho[yc]:lb=!0;const cb=Al?function W(w,y=4,v=1){const T=Ei(w.weekYear),k=X(w.weekNumber,1,js(w.weekYear,y,v)),H=X(w.weekday,1,7);return T?k?!H&&Fs("weekday",w.weekday):Fs("week",w.weekNumber):Fs("weekYear",w.weekYear)}(H,oe,Me):ci?function ie(w){const y=Ei(w.year),v=X(w.ordinal,1,Lo(w.year));return y?!v&&Fs("ordinal",w.ordinal):Fs("year",w.year)}(H):_e(H),Tp=cb||ze(H);if(Tp)return Kt.invalid(Tp);const Cp=Al?ea(H,oe,Me):ci?J(H):H,[Dp,db]=No(Cp,Ke,T),Ep=new Kt({ts:Dp,zone:T,o:db,loc:k});return H.weekday&&bi&&y.weekday!==Ep.weekday?Kt.invalid("mismatched weekday",`you can't specify both a weekday of ${H.weekday} and a date of ${Ep.toISO()}`):Ep}static fromISO(y,v={}){const[T,k]=function Rn(w){return gl(w,[w_,Km],[M_,D_],[T_,an],[C_,ou])}(y);return wl(T,k,v,"ISO 8601",y)}static fromRFC2822(y,v={}){const[T,k]=function qs(w){return gl(function b_(w){return w.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}(w),[__,au])}(y);return wl(T,k,v,"RFC 2822",y)}static fromHTTP(y,v={}){const[T,k]=function E_(w){return gl(w,[v_,$m],[y_,$m],[qm,x_])}(y);return wl(T,k,v,"HTTP",v)}static fromFormat(y,v,T={}){if(Ie(y)||Ie(v))throw new Ht("fromFormat requires an input string and a format");const{locale:k=null,numberingSystem:H=null}=T,oe=Si.fromOpts({locale:k,numberingSystem:H,defaultToEN:!0}),[Me,Be,Ke,ci]=function Pr(w,y,v){const{result:T,zone:k,specificOffset:H,invalidReason:oe}=N_(w,y,v);return[T,k,H,oe]}(oe,y,v);return ci?Kt.invalid(ci):wl(Me,Be,T,`format ${v}`,y,Ke)}static fromString(y,v,T={}){return Kt.fromFormat(y,v,T)}static fromSQL(y,v={}){const[T,k]=function Qm(w){return gl(w,[A_,Km],[P_,Jm])}(y);return wl(T,k,v,"SQL",y)}static invalid(y,v=null){if(!y)throw new Ht("need to specify a reason the DateTime is invalid");const T=y instanceof Ls?y:new Ls(y,v);if(gn.throwOnInvalid)throw new Ve(T);return new Kt({invalid:T})}static isDateTime(y){return y&&y.isLuxonDateTime||!1}static parseFormatForOpts(y,v={}){const T=rr(y,Si.fromObject(v));return T?T.map(k=>k?k.val:null).join(""):null}static expandFormat(y,v={}){return B_(sr.parseFormat(y),Si.fromObject(v)).map(k=>k.val).join("")}get(y){return this[y]}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?dp(this).weekYear:NaN}get weekNumber(){return this.isValid?dp(this).weekNumber:NaN}get weekday(){return this.isValid?dp(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?hp(this).weekday:NaN}get localWeekNumber(){return this.isValid?hp(this).weekNumber:NaN}get localWeekYear(){return this.isValid?hp(this).weekYear:NaN}get ordinal(){return this.isValid?ta(this.c).ordinal:NaN}get monthShort(){return this.isValid?vl.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?vl.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?vl.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?vl.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return!this.isOffsetFixed&&(this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset)}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const y=864e5,v=6e4,T=ul(this.c),k=this.zone.offset(T-y),H=this.zone.offset(T+y),oe=this.zone.offset(T-k*v),Me=this.zone.offset(T-H*v);if(oe===Me)return[this];const Be=T-oe*v,Ke=T-Me*v,ci=pu(Be,oe),Ri=pu(Ke,Me);return ci.hour===Ri.hour&&ci.minute===Ri.minute&&ci.second===Ri.second&&ci.millisecond===Ri.millisecond?[xl(this,{ts:Be}),xl(this,{ts:Ke})]:[this]}get isInLeapYear(){return ia(this.year)}get daysInMonth(){return ac(this.year,this.month)}get daysInYear(){return this.isValid?Lo(this.year):NaN}get weeksInWeekYear(){return this.isValid?js(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?js(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(y={}){const{locale:v,numberingSystem:T,calendar:k}=sr.create(this.loc.clone(y),y).resolvedOptions(this);return{locale:v,numberingSystem:T,outputCalendar:k}}toUTC(y=0,v={}){return this.setZone(Fn.instance(y),v)}toLocal(){return this.setZone(gn.defaultZone)}setZone(y,{keepLocalTime:v=!1,keepCalendarTime:T=!1}={}){if((y=Ys(y,gn.defaultZone)).equals(this.zone))return this;if(y.isValid){let k=this.ts;if(v||T){const H=y.offset(this.ts),oe=this.toObject();[k]=No(oe,H,y)}return xl(this,{ts:k,zone:y})}return Kt.invalid(lo(y))}reconfigure({locale:y,numberingSystem:v,outputCalendar:T}={}){return xl(this,{loc:this.loc.clone({locale:y,numberingSystem:v,outputCalendar:T})})}setLocale(y){return this.reconfigure({locale:y})}set(y){if(!this.isValid)return this;const v=le(y,mp),{minDaysInFirstWeek:T,startOfWeek:k}=_t(v,this.loc),H=!Ie(v.weekYear)||!Ie(v.weekNumber)||!Ie(v.weekday),oe=!Ie(v.ordinal),Me=!Ie(v.year),Be=!Ie(v.month)||!Ie(v.day);if((Me||Be||oe)&&(v.weekYear||v.weekNumber))throw new Pi("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(Be&&oe)throw new Pi("Can't mix ordinal dates with month/day");let Ri;H?Ri=ea({...ss(this.c,T,k),...v},T,k):Ie(v.ordinal)?(Ri={...this.toObject(),...v},Ie(v.day)&&(Ri.day=Math.min(ac(Ri.year,Ri.month),Ri.day))):Ri=J({...ta(this.c),...v});const[vn,bi]=No(Ri,this.o,this.zone);return xl(this,{ts:vn,o:bi})}plus(y){return this.isValid?xl(this,yd(this,on.fromDurationLike(y))):this}minus(y){return this.isValid?xl(this,yd(this,on.fromDurationLike(y).negate())):this}startOf(y,{useLocaleWeeks:v=!1}={}){if(!this.isValid)return this;const T={},k=on.normalizeUnit(y);switch(k){case"years":T.month=1;case"quarters":case"months":T.day=1;case"weeks":case"days":T.hour=0;case"hours":T.minute=0;case"minutes":T.second=0;case"seconds":T.millisecond=0}if("weeks"===k)if(v){const H=this.loc.getStartOfWeek(),{weekday:oe}=this;oe<H&&(T.weekNumber=this.weekNumber-1),T.weekday=H}else T.weekday=1;if("quarters"===k){const H=Math.ceil(this.month/3);T.month=3*(H-1)+1}return this.set(T)}endOf(y,v){return this.isValid?this.plus({[y]:1}).startOf(y,v).minus(1):this}toFormat(y,v={}){return this.isValid?sr.create(this.loc.redefaultToEN(v)).formatDateTimeFromString(this,y):bd}toLocaleString(y=Mn,v={}){return this.isValid?sr.create(this.loc.clone(v),y).formatDateTime(this):bd}toLocaleParts(y={}){return this.isValid?sr.create(this.loc.clone(y),y).formatDateTimeParts(this):[]}toISO({format:y="extended",suppressSeconds:v=!1,suppressMilliseconds:T=!1,includeOffset:k=!0,extendedZone:H=!1}={}){if(!this.isValid)return null;const oe="extended"===y;let Me=wd(this,oe);return Me+="T",Me+=up(this,oe,v,T,k,H),Me}toISODate({format:y="extended"}={}){return this.isValid?wd(this,"extended"===y):null}toISOWeekDate(){return xd(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:y=!1,suppressSeconds:v=!1,includeOffset:T=!0,includePrefix:k=!1,extendedZone:H=!1,format:oe="extended"}={}){return this.isValid?(k?"T":"")+up(this,"extended"===oe,v,y,T,H):null}toRFC2822(){return xd(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return xd(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?wd(this,!0):null}toSQLTime({includeOffset:y=!0,includeZone:v=!1,includeOffsetSpace:T=!0}={}){let k="HH:mm:ss.SSS";return(v||y)&&(T&&(k+=" "),v?k+="z":y&&(k+="ZZ")),xd(this,k,!0)}toSQL(y={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(y)}`:null}toString(){return this.isValid?this.toISO():bd}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(y={}){if(!this.isValid)return{};const v={...this.c};return y.includeConfig&&(v.outputCalendar=this.outputCalendar,v.numberingSystem=this.loc.numberingSystem,v.locale=this.loc.locale),v}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(y,v="milliseconds",T={}){if(!this.isValid||!y.isValid)return on.invalid("created by diffing an invalid DateTime");const k={locale:this.locale,numberingSystem:this.numberingSystem,...T},H=function ce(w){return Array.isArray(w)?w:[w]}(v).map(on.normalizeUnit),oe=y.valueOf()>this.valueOf(),Ke=function np(w,y,v,T){let[k,H,oe,Me]=function ip(w,y,v){const T=[["years",(Be,Ke)=>Ke.year-Be.year],["quarters",(Be,Ke)=>Ke.quarter-Be.quarter+4*(Ke.year-Be.year)],["months",(Be,Ke)=>Ke.month-Be.month+12*(Ke.year-Be.year)],["weeks",(Be,Ke)=>{const ci=du(Be,Ke);return(ci-ci%7)/7}],["days",du]],k={},H=w;let oe,Me;for(const[Be,Ke]of T)v.indexOf(Be)>=0&&(oe=Be,k[Be]=Ke(w,y),Me=H.plus(k),Me>y?(k[Be]--,(w=H.plus(k))>y&&(Me=w,k[Be]--,w=H.plus(k))):w=Me);return[w,k,Me,oe]}(w,y,v);const Be=y-k,Ke=v.filter(Ri=>["hours","minutes","seconds","milliseconds"].indexOf(Ri)>=0);0===Ke.length&&(oe<y&&(oe=k.plus({[Me]:1})),oe!==k&&(H[Me]=(H[Me]||0)+Be/(oe-k)));const ci=on.fromObject(H,T);return Ke.length>0?on.fromMillis(Be,T).shiftTo(...Ke).plus(ci):ci}(oe?this:y,oe?y:this,H,k);return oe?Ke.negate():Ke}diffNow(y="milliseconds",v={}){return this.diff(Kt.now(),y,v)}until(y){return this.isValid?Wn.fromDateTimes(this,y):this}hasSame(y,v,T){if(!this.isValid)return!1;const k=y.valueOf(),H=this.setZone(y.zone,{keepLocalTime:!0});return H.startOf(v,T)<=k&&k<=H.endOf(v,T)}equals(y){return this.isValid&&y.isValid&&this.valueOf()===y.valueOf()&&this.zone.equals(y.zone)&&this.loc.equals(y.loc)}toRelative(y={}){if(!this.isValid)return null;const v=y.base||Kt.fromObject({},{zone:this.zone}),T=y.padding?this<v?-y.padding:y.padding:0;let k=["years","months","days","hours","minutes","seconds"],H=y.unit;return Array.isArray(y.unit)&&(k=y.unit,H=void 0),H_(v,this.plus(T),{...y,numeric:"always",units:k,unit:H})}toRelativeCalendar(y={}){return this.isValid?H_(y.base||Kt.fromObject({},{zone:this.zone}),this,{...y,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...y){if(!y.every(Kt.isDateTime))throw new Ht("min requires all arguments be DateTimes");return bt(y,v=>v.valueOf(),Math.min)}static max(...y){if(!y.every(Kt.isDateTime))throw new Ht("max requires all arguments be DateTimes");return bt(y,v=>v.valueOf(),Math.max)}static fromFormatExplain(y,v,T={}){const{locale:k=null,numberingSystem:H=null}=T;return N_(Si.fromOpts({locale:k,numberingSystem:H,defaultToEN:!0}),y,v)}static fromStringExplain(y,v,T={}){return Kt.fromFormatExplain(y,v,T)}static get DATE_SHORT(){return Mn}static get DATE_MED(){return ls}static get DATE_MED_WITH_WEEKDAY(){return ir}static get DATE_FULL(){return jt}static get DATE_HUGE(){return zn}static get TIME_SIMPLE(){return ut}static get TIME_WITH_SECONDS(){return yi}static get TIME_WITH_SHORT_OFFSET(){return Qt}static get TIME_WITH_LONG_OFFSET(){return Bi}static get TIME_24_SIMPLE(){return ts}static get TIME_24_WITH_SECONDS(){return ps}static get TIME_24_WITH_SHORT_OFFSET(){return Os}static get TIME_24_WITH_LONG_OFFSET(){return Rs}static get DATETIME_SHORT(){return cs}static get DATETIME_SHORT_WITH_SECONDS(){return pn}static get DATETIME_MED(){return fn}static get DATETIME_MED_WITH_SECONDS(){return jn}static get DATETIME_MED_WITH_WEEKDAY(){return Vi}static get DATETIME_FULL(){return ds}static get DATETIME_FULL_WITH_SECONDS(){return fs}static get DATETIME_HUGE(){return bn}static get DATETIME_HUGE_WITH_SECONDS(){return gi}}function fc(w){if(Kt.isDateTime(w))return w;if(w&&w.valueOf&&qt(w.valueOf()))return Kt.fromJSDate(w);if(w&&"object"==typeof w)return Kt.fromObject(w);throw new Ht(`Unknown datetime argument: ${w}, of type ${typeof w}`)}var _s=V(3226);function V_(w,y){1&w&&x.GkF(0)}function W_(w,y){if(1&w&&(x.TgZ(0,"div",3),x.YNc(1,V_,1,0,"ng-container",4),x.qZA()),2&w){const v=x.oxw(),T=x.MAs(4);x.Q6J("ngxAppendToInput",v.inputElement),x.xp6(1),x.Q6J("ngTemplateOutlet",T)}}function pp(w,y){1&w&&x.GkF(0)}function vu(w,y){if(1&w&&x.YNc(0,pp,1,0,"ng-container",4),2&w){x.oxw();const v=x.MAs(4);x.Q6J("ngTemplateOutlet",v)}}function Ml(w,y){1&w&&x.Hsn(0)}const Se=["*"],Td=["editableTimeTmpl"],yu=function(w){return{"timepicker-dial__item_active":w}};function co(w,y){if(1&w){const v=x.EpF();x.TgZ(0,"input",2),x.NdJ("ngModelChange",function(k){x.CHM(v);const H=x.oxw();return x.KtG(H.time=k)})("input",function(){x.CHM(v);const k=x.oxw();return x.KtG(k.updateTime())})("focus",function(k){x.CHM(v);const H=x.oxw();return x.KtG(H.saveTimeAndChangeTimeUnit(k,H.timeUnit))}),x.ALo(1,"timeLocalizer"),x.qZA()}if(2&w){const v=x.oxw();x.Q6J("ngClass",x.VKq(7,yu,v.isActive))("ngModel",x.xi3(1,4,v.time,v.timeUnit))("disabled",v.disabled)("timepickerAutofocus",v.isActive)}}function Tl(w,y){if(1&w){const v=x.EpF();x.TgZ(0,"input",3,4),x.NdJ("focus",function(k){x.CHM(v);const H=x.oxw();return x.KtG(H.saveTimeAndChangeTimeUnit(k,H.timeUnit))})("keydown",function(k){x.CHM(v);const H=x.oxw();return x.KtG(H.onKeydown(k))}),x.qZA()}if(2&w){const v=x.oxw();x.Q6J("formControl",v.timeControl)("ngClass",x.VKq(3,yu,v.isActive))("timepickerAutofocus",v.isActive)}}function Cl(w,y){if(1&w){const v=x.EpF();x.TgZ(0,"div",3),x.NdJ("@scaleInOut.done",function(){x.CHM(v);const k=x.oxw();return x.KtG(k.animationDone())}),x.TgZ(1,"p"),x._uU(2,"Current time would be invalid in this period."),x.qZA()()}2&w&&x.Q6J("@scaleInOut",void 0)}function xy(w,y){1&w&&x.GkF(0)}function gc(w,y){1&w&&(x.TgZ(0,"small",10),x._uU(1," * use arrows ("),x.TgZ(2,"span"),x._uU(3,"\u21c5"),x.qZA(),x._uU(4,") to change the time"),x.qZA())}const Dl=function(w){return{"timepicker-dial__hint-container--hidden":w}};function Cd(w,y){if(1&w&&(x.TgZ(0,"div",7),x.YNc(1,xy,1,0,"ng-container",8),x.YNc(2,gc,5,0,"ng-template",null,9,x.W1O),x.qZA()),2&w){const v=x.MAs(3),T=x.oxw();x.Q6J("ngClass",x.VKq(2,Dl,!T.isHintVisible)),x.xp6(1),x.Q6J("ngTemplateOutlet",T.editableHintTmpl?T.editableHintTmpl:v)}}const bs=function(w){return{"timepicker-dial__period--hidden":w}},G_=["clockFace"],Ti=["clockHand"],ln=function(w){return{transform:w}},El=function(w,y){return{active:w,disabled:y}};function vt(w,y){if(1&w&&(x.TgZ(0,"div",9)(1,"span",10),x.ALo(2,"activeHour"),x._uU(3),x.ALo(4,"timeLocalizer"),x.qZA()()),2&w){const v=y.$implicit,T=x.oxw(2);x.Q6J("ngStyle",x.VKq(11,ln,"rotateZ("+v.angle+"deg) translateX(-50%)")),x.xp6(1),x.Q6J("ngStyle",x.VKq(13,ln,"rotateZ(-"+v.angle+"deg)"))("ngClass",x.WLB(15,El,x.Dn7(2,4,v.time,T.selectedTime.time,T.isClockFaceDisabled),v.disabled)),x.xp6(2),x.hij(" ",x.xi3(4,8,v.time,T.timeUnit.HOUR)," ")}}function wi(w,y){if(1&w&&(x.TgZ(0,"div",13)(1,"span",10),x.ALo(2,"activeHour"),x._uU(3),x.ALo(4,"timeLocalizer"),x.qZA()()),2&w){const v=y.$implicit,T=x.oxw(3);x.Udp("height",T.innerClockFaceSize,"px"),x.Q6J("ngStyle",x.VKq(13,ln,"rotateZ("+v.angle+"deg) translateX(-50%)")),x.xp6(1),x.Q6J("ngStyle",x.VKq(15,ln,"rotateZ(-"+v.angle+"deg)"))("ngClass",x.WLB(17,El,x.Dn7(2,6,v.time,null==T.selectedTime?null:T.selectedTime.time,T.isClockFaceDisabled),v.disabled)),x.xp6(2),x.hij(" ",x.xi3(4,10,v.time,T.timeUnit.HOUR),"")}}function wy(w,y){if(1&w&&(x.TgZ(0,"div",11),x.YNc(1,wi,5,20,"div",12),x.ALo(2,"slice"),x.qZA()),2&w){const v=x.oxw(2);x.Udp("top","calc(50% - "+v.innerClockFaceSize+"px)"),x.xp6(1),x.Q6J("ngForOf",x.Dn7(2,4,v.faceTime,12,24))("ngForTrackBy",v.trackByTime)}}function vs(w,y){if(1&w&&(x.TgZ(0,"div",6),x.YNc(1,vt,5,18,"div",7),x.ALo(2,"slice"),x.YNc(3,wy,3,8,"div",8),x.qZA()),2&w){const v=x.oxw();x.xp6(1),x.Q6J("ngForOf",x.Dn7(2,3,v.faceTime,0,12))("ngForTrackBy",v.trackByTime),x.xp6(2),x.Q6J("ngIf",v.faceTime.length>12)}}function My(w,y){if(1&w&&(x.TgZ(0,"div",9)(1,"span",10),x.ALo(2,"activeMinute"),x._uU(3),x.ALo(4,"timeLocalizer"),x.ALo(5,"minutesFormatter"),x.qZA()()),2&w){const v=y.$implicit,T=x.oxw(2);x.Q6J("ngStyle",x.VKq(15,ln,"rotateZ("+v.angle+"deg) translateX(-50%)")),x.xp6(1),x.Q6J("ngStyle",x.VKq(17,ln,"rotateZ(-"+v.angle+"deg)"))("ngClass",x.WLB(19,El,x.gM2(2,4,v.time,null==T.selectedTime?null:T.selectedTime.time,T.minutesGap,T.isClockFaceDisabled),v.disabled)),x.xp6(2),x.hij(" ",x.xi3(4,9,x.xi3(5,12,v.time,T.minutesGap),T.timeUnit.MINUTE),"")}}function Y_(w,y){if(1&w&&(x.TgZ(0,"div",6),x.YNc(1,My,6,22,"div",7),x.qZA()),2&w){const v=x.oxw();x.xp6(1),x.Q6J("ngForOf",v.faceTime)("ngForTrackBy",v.trackByTime)}}const qn=function(w){return{"clock-face__clock-hand_minute":w}};function fp(w,y){if(1&w){const v=x.EpF();x.TgZ(0,"ngx-material-timepicker-24-hours-face",17),x.NdJ("hourChange",function(k){x.CHM(v);const H=x.oxw(2);return x.KtG(H.onHourChange(k))})("hourSelected",function(k){x.CHM(v);const H=x.oxw(2);return x.KtG(H.onHourSelected(k))}),x.ALo(1,"async"),x.qZA()}if(2&w){const v=x.oxw(2);x.Q6J("selectedHour",x.lcZ(1,4,v.selectedHour))("minTime",v.minTime)("maxTime",v.maxTime)("format",v.format)}}function Ha(w,y){if(1&w){const v=x.EpF();x.TgZ(0,"ngx-material-timepicker-12-hours-face",18),x.NdJ("hourChange",function(k){x.CHM(v);const H=x.oxw(2);return x.KtG(H.onHourChange(k))})("hourSelected",function(k){x.CHM(v);const H=x.oxw(2);return x.KtG(H.onHourSelected(k))}),x.ALo(1,"async"),x.ALo(2,"async"),x.qZA()}if(2&w){const v=x.oxw(2);x.Q6J("selectedHour",x.lcZ(1,4,v.selectedHour))("period",x.lcZ(2,6,v.selectedPeriod))("minTime",v.minTime)("maxTime",v.maxTime)}}function xu(w,y){if(1&w&&(x.TgZ(0,"div"),x.YNc(1,fp,2,6,"ngx-material-timepicker-24-hours-face",15),x.YNc(2,Ha,3,8,"ng-template",null,16,x.W1O),x.qZA()),2&w){const v=x.MAs(3),T=x.oxw();x.xp6(1),x.Q6J("ngIf",24===T.format)("ngIfElse",v)}}function j_(w,y){if(1&w){const v=x.EpF();x.TgZ(0,"ngx-material-timepicker-minutes-face",19),x.NdJ("minuteChange",function(k){x.CHM(v);const H=x.oxw();return x.KtG(H.onMinuteChange(k))}),x.ALo(1,"async"),x.ALo(2,"async"),x.ALo(3,"async"),x.qZA()}if(2&w){const v=x.oxw();let T;x.Q6J("selectedMinute",x.lcZ(1,7,v.selectedMinute))("selectedHour",null==(T=x.lcZ(2,9,v.selectedHour))?null:T.time)("minTime",v.minTime)("maxTime",v.maxTime)("format",v.format)("period",x.lcZ(3,11,v.selectedPeriod))("minutesGap",v.minutesGap)}}function Z_(w,y){1&w&&x.GkF(0)}function wu(w,y){1&w&&x.GkF(0)}function Mu(w,y){1&w&&(x.TgZ(0,"ngx-material-timepicker-button"),x._uU(1,"Cancel"),x.qZA())}function Dd(w,y){1&w&&(x.TgZ(0,"ngx-material-timepicker-button"),x._uU(1,"Ok"),x.qZA())}const X_=function(w){return{"timepicker-backdrop-overlay--transparent":w}};var pr=function(w){return w[w.HOUR=0]="HOUR",w[w.MINUTE=1]="MINUTE",w}(pr||{}),Oi=function(w){return w.AM="AM",w.PM="PM",w}(Oi||{}),Va=function(w){return w.TWELVE="hh:mm a",w.TWELVE_SHORT="h:m a",w.TWENTY_FOUR="HH:mm",w.TWENTY_FOUR_SHORT="H:m",w}(Va||{});function $n(w,y,v="minutes"){return"hours"===v?w.hour>=y.hour:"minutes"===v?w.hasSame(y,v)||w.valueOf()>y.valueOf():void 0}function Tu(w,y,v="minutes"){return"hours"===v?w.hour<=y.hour:"minutes"===v?w.hasSame(y,v)||w.valueOf()<=y.valueOf():void 0}let Ns=(()=>{class w{static parseTime(v,T){const{numberingSystem:k,locale:H}=w.getLocaleOptionsByTime(v,T),Me=2===v.split(" ").length?Va.TWELVE_SHORT:Va.TWENTY_FOUR_SHORT;return Kt.fromFormat(v,Me,{numberingSystem:k,locale:H})}static formatTime(v,T){if(!v)return"Invalid Time";const{format:k}=T,H=w.parseTime(v,T).setLocale(w.DEFAULT_LOCALE);return H.isValid?24!==k?H.toLocaleString(Object.assign(Object.assign({},Kt.TIME_SIMPLE),{hour12:24!==k,numberingSystem:w.DEFAULT_NUMBERING_SYSTEM})).replace(/\u200E/g,"").replace(/\u202F/g," "):H.toISOTime({includeOffset:!1,suppressMilliseconds:!0,suppressSeconds:!0}).replace(/\u200E/g,"").replace(/\u202F/g," "):null}static toLocaleTimeString(v,T={}){const{format:k=w.DEFAULT_FORMAT,locale:H=w.DEFAULT_LOCALE}=T,oe=24===k?"h23":"h12",Me=Object.assign(Object.assign({},Kt.TIME_SIMPLE),{hourCycle:oe}),Be=24===k?Va.TWENTY_FOUR_SHORT:Va.TWELVE_SHORT,Ke=Object.assign({locale:T.locale,numberingSystem:T.numberingSystem},Me);return Kt.fromFormat(v,Be).setLocale(H).toLocaleString(Ke).replace(/\u202F/g," ")}static isTimeAvailable(v,T,k,H,oe,Me){if(!v)return;const Be=this.parseTime(v,{format:Me}),Ke=Be.minute;if(oe&&Ke==Ke&&Ke%oe!=0)throw new Error(`Your minutes - ${Ke} doesn't match your minutesGap - ${oe}`);const ci=T&&!k&&$n(Be,T,H),Ri=k&&!T&&Tu(Be,k,H),vn=T&&k&&function K_(w,y,v,T="minutes"){return"hours"===T?Tu(w,v,T)&&$n(w,y,T):"minutes"===T?Tu(w,v)&&$n(w,y):void 0}(Be,T,k,H);return ci||Ri||vn||!T&&!k}static formatHour(v,T,k){if(24===T)return v;const H=k===Oi.AM?v:v+12;return k===Oi.AM&&12===H?0:k===Oi.PM&&24===H?12:H}static fromDateTimeToString(v,T){const k=24===T?Va.TWENTY_FOUR:Va.TWELVE;return v.reconfigure({numberingSystem:w.DEFAULT_NUMBERING_SYSTEM,locale:w.DEFAULT_LOCALE}).toFormat(k).replace(/\u202F/g," ")}static getLocaleOptionsByTime(v,T){const k={numberingSystem:T.numberingSystem,locale:T.locale},H={numberingSystem:w.DEFAULT_NUMBERING_SYSTEM,locale:w.DEFAULT_LOCALE};return isNaN(parseInt(v,10))?k:H}}return w.DEFAULT_FORMAT=12,w.DEFAULT_LOCALE="en-US",w.DEFAULT_NUMBERING_SYSTEM="latn",w})();const Ed={time:12,angle:360},kl={time:0,angle:360};let Sd=(()=>{class w{constructor(){this.hourSubject=new ke.X(Ed),this.minuteSubject=new ke.X(kl),this.periodSubject=new ke.X(Oi.AM)}set hour(v){this.hourSubject.next(v)}get selectedHour(){return this.hourSubject.asObservable()}set minute(v){this.minuteSubject.next(v)}get selectedMinute(){return this.minuteSubject.asObservable()}set period(v){(v===Oi.AM||v===Oi.PM)&&this.periodSubject.next(v)}get selectedPeriod(){return this.periodSubject.asObservable()}setDefaultTimeIfAvailable(v,T,k,H,oe){try{Ns.isTimeAvailable(v,T,k,"minutes",oe)&&this.setDefaultTime(v,H)}catch(Me){console.error(Me)}}getFullTime(v){const T=this.hourSubject.getValue().time,k=this.minuteSubject.getValue().time,Be=`${T??Ed.time}:${k??kl.time} ${12===v?this.periodSubject.getValue():""}`.trim();return Ns.formatTime(Be,{format:v})}setDefaultTime(v,T){const k=Ns.parseTime(v,{format:T}).toJSDate();if(Kt.fromJSDate(k).isValid){const H=v.substr(v.length-2).toUpperCase(),oe=k.getHours();this.hour=Object.assign(Object.assign({},Ed),{time:Py(oe,H)}),this.minute=Object.assign(Object.assign({},kl),{time:k.getMinutes()}),this.period=H}else this.resetTime()}resetTime(){this.hour=Object.assign({},Ed),this.minute=Object.assign({},kl),this.period=Oi.AM}}return w.\u0275fac=function(v){return new(v||w)},w.\u0275prov=x.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})();function Py(w,y){switch(y){case Oi.AM:return 0===w?12:w;case Oi.PM:return 12===w?12:w-12;default:return w}}const Uo=new x.OlP("TimeLocale",{providedIn:"root",factory:()=>Ns.DEFAULT_LOCALE}),J_=new x.OlP("NumberingSystem",{providedIn:"root",factory:()=>Ns.DEFAULT_NUMBERING_SYSTEM});let kd=(()=>{class w{constructor(){this.backdropClickSubject=new d.x,this.keydownEventSubject=new d.x}get backdropClick(){return this.backdropClickSubject.asObservable().pipe((0,Li.d)({bufferSize:1,refCount:!0}))}get keydownEvent(){return this.keydownEventSubject.asObservable().pipe((0,Li.d)({bufferSize:1,refCount:!0}))}dispatchEvent(v){switch(v.type){case"click":this.backdropClickSubject.next(v);break;case"keydown":this.keydownEventSubject.next(v);break;default:throw new Error("no such event type")}}}return w.\u0275fac=function(v){return new(v||w)},w.\u0275prov=x.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})(),Ad=(()=>{class w{constructor(v,T){this.renderer=T,this.element=v.nativeElement}get inputCords(){return this.inputElement.getBoundingClientRect()}get direction(){const v=this.element.offsetHeight,{bottom:T,top:k}=this._inputCords,H=(window&&window.innerHeight)-T<v;return H&&k>v?"top":H&&k<v?"center":"bottom"}ngAfterViewInit(){this._inputCords=this.inputCords,this._direction=this.direction,this.append()}changePosition(){const{bottom:v,top:T}=this.inputCords,k=this.defineElementYByDirection(T,v);this.setStyle("top",`${k}px`)}append(){const{left:v,bottom:T,top:k}=this._inputCords,H=this.defineElementYByDirection(k,T);this.setStyle("position","fixed"),this.setStyle("left",`${v}px`),this.setStyle("top",`${H}px`)}setStyle(v,T){this.renderer.setStyle(this.element,v,T)}defineElementYByDirection(v,T){return"top"===this._direction?v-this.element.offsetHeight:"center"===this._direction?v-this.element.offsetHeight/2:T}}return w.\u0275fac=function(v){return new(v||w)(x.Y36(x.SBq),x.Y36(x.Qsj))},w.\u0275dir=x.lG2({type:w,selectors:[["","ngxAppendToInput",""]],hostBindings:function(v,T){1&v&&x.NdJ("scroll",function(){return T.changePosition()},!1,x.Jf7)},inputs:{inputElement:["ngxAppendToInput","inputElement"]}}),w})(),Q_=(()=>{class w{}return w.\u0275fac=function(v){return new(v||w)},w.\u0275cmp=x.Xpm({type:w,selectors:[["ngx-material-timepicker-content"]],inputs:{appendToInput:"appendToInput",inputElement:"inputElement"},ngContentSelectors:Se,decls:5,vars:2,consts:[[3,"ngxAppendToInput",4,"ngIf","ngIfElse"],["timepickerModal",""],["timepickerOutlet",""],[3,"ngxAppendToInput"],[4,"ngTemplateOutlet"]],template:function(v,T){if(1&v&&(x.F$t(),x.YNc(0,W_,2,2,"div",0),x.YNc(1,vu,1,1,"ng-template",null,1,x.W1O),x.YNc(3,Ml,1,0,"ng-template",null,2,x.W1O)),2&v){const k=x.MAs(2);x.Q6J("ngIf",T.appendToInput)("ngIfElse",k)}},dependencies:[A.O5,Ad,A.tP],encapsulation:2}),w})();class oa{static getHours(y){return Array(y).fill(1).map((v,T)=>{const H=v+T;return{time:24===H?0:H,angle:30*H}})}static disableHours(y,v){return v.min||v.max?y.map(T=>{const k=24===v.format?T.time:Ns.formatHour(T.time,v.format,v.period),H=Kt.fromObject({hour:k}).toFormat(Va.TWELVE);return Object.assign(Object.assign({},T),{disabled:!Ns.isTimeAvailable(H,v.min,v.max,"hours")})}):y}static getMinutes(y=1){const k=[];for(let H=0;H<60;H++){const oe=6*H;H%y==0&&k.push({time:H,angle:0!==oe?oe:360})}return k}static disableMinutes(y,v,T){if(T.min||T.max){const k=Ns.formatHour(v,T.format,T.period);return y.map(H=>{const oe=Kt.fromObject({hour:k,minute:H.time}).toFormat(Va.TWELVE);return Object.assign(Object.assign({},H),{disabled:!Ns.isTimeAvailable(oe,T.min,T.max,"minutes")})})}return y}}let Pd=(()=>{class w{constructor(v){this.locale=v}transform(v,T,k=!1){if(null==v||""===v)return"";switch(T){case pr.HOUR:return this.formatTime("hour",v,0===v||k?"HH":"H");case pr.MINUTE:return this.formatTime("minute",v,"mm");default:throw new Error(`There is no Time Unit with type ${T}`)}}formatTime(v,T,k){try{return Kt.fromObject({[v]:+T}).setLocale(this.locale).toFormat(k)}catch{throw new Error(`Cannot format provided time - ${T} to locale - ${this.locale}`)}}}return w.\u0275fac=function(v){return new(v||w)(x.Y36(Uo,16))},w.\u0275pipe=x.Yjl({name:"timeLocalizer",type:w,pure:!0}),w})(),bc=(()=>{class w{constructor(v,T){this.locale=v,this.numberingSystem=T}transform(v,T=pr.HOUR){return null==v||""===v?"":isNaN(+v)?T===pr.MINUTE?this.parseTime(v,"m","minute"):this.parseTime(v,"H","hour"):v}parseTime(v,T,k){const H=Kt.fromFormat(String(v),T,{numberingSystem:this.numberingSystem,locale:this.locale})[k];if(!isNaN(H))return H;throw new Error(`Cannot parse time - ${v}`)}}return w.\u0275fac=function(v){return new(v||w)(x.Y36(Uo,16),x.Y36(J_,16))},w.\u0275pipe=x.Yjl({name:"timeParser",type:w,pure:!0}),w.\u0275prov=x.Yz7({token:w,factory:w.\u0275fac}),w})(),Od=(()=>{class w{constructor(v,T){this.element=v,this.document=T,this.activeElement=this.document.activeElement}ngOnChanges(){this.isFocusActive&&setTimeout(()=>this.element.nativeElement.focus({preventScroll:!0}))}ngOnDestroy(){setTimeout(()=>this.activeElement.focus({preventScroll:!0}))}}return w.\u0275fac=function(v){return new(v||w)(x.Y36(x.SBq),x.Y36(A.K0,8))},w.\u0275dir=x.lG2({type:w,selectors:[["","timepickerAutofocus",""]],inputs:{isFocusActive:["timepickerAutofocus","isFocusActive"]},features:[x.TTD]}),w})(),eb=(()=>{class w{constructor(v,T){this.timeParserPipe=v,this.timeLocalizerPipe=T,this.timeUnitChanged=new x.vpe,this.timeChanged=new x.vpe,this.focused=new x.vpe,this.unfocused=new x.vpe}get selectedTime(){if(this.time)return this.timeList.find(v=>v.time===+this.time)}ngOnInit(){this.isEditable&&(this.timeControl=new _s.NI({value:this.formatTimeForUI(this.time),disabled:this.disabled}),this.timeControl.valueChanges.pipe((0,Qi.b)(v=>{v.length>2&&this.updateInputValue(v.slice(-1))}),(0,mi.b)(500),(0,$t.x)(),(0,Zi.h)(v=>!function bp(w,y,v){if(/\d/.test(y))return Cu(y,v)}(0,v,this.timeList)),(0,Qi.b)(v=>this.time=this.timeParserPipe.transform(v,this.timeUnit).toString())).subscribe(()=>this.updateTime()))}saveTimeAndChangeTimeUnit(v,T){v.preventDefault(),this.previousTime=this.time,this.timeUnitChanged.next(T),this.focused.next()}updateTime(){const v=this.selectedTime;v&&(this.timeChanged.next(v),this.previousTime=v.time,this.isEditable&&this.updateInputValue(this.formatTimeForUI(v.time)))}onKeydown(v){!function Sl(w){return!!([46,8,9,27,13].some(y=>y===w.keyCode)||65==w.keyCode&&(!0===w.ctrlKey||!0===w.metaKey)||67==w.keyCode&&(!0===w.ctrlKey||!0===w.metaKey)||88==w.keyCode&&(!0===w.ctrlKey||!0===w.metaKey)||w.keyCode>=35&&w.keyCode<=40)||!((w.keyCode<48||w.keyCode>57)&&(w.keyCode<96||w.keyCode>105))}(v)?v.preventDefault():this.changeTimeByArrow(v.keyCode)}changeTimeByArrow(v){let H;38===v?H=String(+this.time+(this.minutesGap||1)):40===v&&(H=String(+this.time-(this.minutesGap||1))),Cu(H,this.timeList)||(this.time=H,this.updateTime())}formatTimeForUI(v){const T=this.timeParserPipe.transform(v,this.timeUnit).toString();return this.timeLocalizerPipe.transform(T,this.timeUnit,!0)}updateInputValue(v){this.editableTimeTmpl.nativeElement.value=v}}return w.\u0275fac=function(v){return new(v||w)(x.Y36(bc),x.Y36(Pd))},w.\u0275cmp=x.Xpm({type:w,selectors:[["ngx-material-timepicker-dial-control"]],viewQuery:function(v,T){if(1&v&&x.Gf(Td,5),2&v){let k;x.iGM(k=x.CRH())&&(T.editableTimeTmpl=k.first)}},inputs:{timeList:"timeList",timeUnit:"timeUnit",time:"time",isActive:"isActive",isEditable:"isEditable",minutesGap:"minutesGap",disabled:"disabled"},outputs:{timeUnitChanged:"timeUnitChanged",timeChanged:"timeChanged",focused:"focused",unfocused:"unfocused"},features:[x._Bn([bc,Pd])],decls:3,vars:2,consts:[["class","timepicker-dial__control timepicker-dial__item","readonly","",3,"ngClass","ngModel","disabled","timepickerAutofocus","ngModelChange","input","focus",4,"ngIf","ngIfElse"],["editableTemplate",""],["readonly","",1,"timepicker-dial__control","timepicker-dial__item",3,"ngClass","ngModel","disabled","timepickerAutofocus","ngModelChange","input","focus"],[1,"timepicker-dial__control","timepicker-dial__item","timepicker-dial__control_editable",3,"formControl","ngClass","timepickerAutofocus","focus","keydown"],["editableTimeTmpl",""]],template:function(v,T){if(1&v&&(x.YNc(0,co,2,9,"input",0),x.YNc(1,Tl,2,5,"ng-template",null,1,x.W1O)),2&v){const k=x.MAs(2);x.Q6J("ngIf",!T.isEditable)("ngIfElse",k)}},dependencies:[A.O5,_s.Fj,A.mk,_s.JJ,_s.On,Od,_s.oH,Pd],styles:['.timepicker-dial__item[_ngcontent-%COMP%]{cursor:pointer;color:#ffffff80;font-family:"Roboto",sans-serif}@supports (font-family: var(--primary-font-family)){.timepicker-dial__item[_ngcontent-%COMP%]{font-family:var(--primary-font-family);color:var(--dial-inactive-color)}}.timepicker-dial__item_active[_ngcontent-%COMP%]{color:#fff}@supports (color: var(--dial-active-color)){.timepicker-dial__item_active[_ngcontent-%COMP%]{color:var(--dial-active-color)}}.timepicker-dial__control[_ngcontent-%COMP%]{border:none;background-color:transparent;font-size:50px;width:60px;padding:0;border-radius:3px;text-align:right}.timepicker-dial__control_editable[_ngcontent-%COMP%]:focus{color:#00bfff;background-color:#fff;outline:deepskyblue}@supports (color: var(--dial-editable-active-color)){.timepicker-dial__control_editable[_ngcontent-%COMP%]:focus{color:var(--dial-editable-active-color)}}@supports (background-color: var(--dial-editable-background-color)){.timepicker-dial__control_editable[_ngcontent-%COMP%]:focus{background-color:var(--dial-editable-background-color)}}@supports (outline: var(--dial-editable-active-color)){.timepicker-dial__control_editable[_ngcontent-%COMP%]:focus{outline:var(--dial-editable-active-color)}}.timepicker-dial__control[_ngcontent-%COMP%]:disabled{cursor:default}.timepicker-dial__control[_ngcontent-%COMP%]:focus-visible{outline:none}']}),w})();function Cu(w,y){const v=y.find(T=>T.time===+w);return!v||v&&v.disabled}let vp=(()=>{class w{constructor(){this.timePeriod=Oi,this.isPeriodAvailable=!0,this.periodChanged=new x.vpe}changePeriod(v){this.isPeriodAvailable=this.isSwitchPeriodAvailable(v),this.isPeriodAvailable&&this.periodChanged.next(v)}animationDone(){this.isPeriodAvailable=!0}isSwitchPeriodAvailable(v){return!this.getDisabledTimeByPeriod(v).every(k=>k.disabled)}getDisabledTimeByPeriod(v){switch(this.activeTimeUnit){case pr.HOUR:return oa.disableHours(this.hours,{min:this.minTime,max:this.maxTime,format:this.format,period:v});case pr.MINUTE:return oa.disableMinutes(this.minutes,+this.selectedHour,{min:this.minTime,max:this.maxTime,format:this.format,period:v});default:throw new Error("no such TimeUnit")}}}return w.\u0275fac=function(v){return new(v||w)},w.\u0275cmp=x.Xpm({type:w,selectors:[["ngx-material-timepicker-period"]],inputs:{selectedPeriod:"selectedPeriod",format:"format",activeTimeUnit:"activeTimeUnit",hours:"hours",minutes:"minutes",minTime:"minTime",maxTime:"maxTime",selectedHour:"selectedHour",meridiems:"meridiems"},outputs:{periodChanged:"periodChanged"},decls:6,vars:9,consts:[[1,"timepicker-period"],["type","button",1,"timepicker-dial__item","timepicker-period__btn",3,"ngClass","click"],["class","timepicker-period__warning",4,"ngIf"],[1,"timepicker-period__warning"]],template:function(v,T){1&v&&(x.TgZ(0,"div",0)(1,"button",1),x.NdJ("click",function(){return T.changePeriod(T.timePeriod.AM)}),x._uU(2),x.qZA(),x.TgZ(3,"button",1),x.NdJ("click",function(){return T.changePeriod(T.timePeriod.PM)}),x._uU(4),x.qZA(),x.YNc(5,Cl,3,1,"div",2),x.qZA()),2&v&&(x.xp6(1),x.Q6J("ngClass",x.VKq(5,yu,T.selectedPeriod===T.timePeriod.AM)),x.xp6(1),x.Oqu(T.meridiems[0]),x.xp6(1),x.Q6J("ngClass",x.VKq(7,yu,T.selectedPeriod===T.timePeriod.PM)),x.xp6(1),x.Oqu(T.meridiems[1]),x.xp6(1),x.Q6J("ngIf",!T.isPeriodAvailable))},dependencies:[A.mk,A.O5],styles:['.timepicker-dial__item[_ngcontent-%COMP%]{cursor:pointer;color:#ffffff80;font-family:"Roboto",sans-serif}@supports (font-family: var(--primary-font-family)){.timepicker-dial__item[_ngcontent-%COMP%]{font-family:var(--primary-font-family);color:var(--dial-inactive-color)}}.timepicker-dial__item_active[_ngcontent-%COMP%]{color:#fff}@supports (color: var(--dial-active-color)){.timepicker-dial__item_active[_ngcontent-%COMP%]{color:var(--dial-active-color)}}.timepicker-period[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:relative}.timepicker-period__btn[_ngcontent-%COMP%]{padding:1px 3px;border:0;background-color:transparent;font-size:18px;font-weight:500;-webkit-user-select:none;-moz-user-select:none;user-select:none;outline:none;border-radius:3px;transition:background-color .5s;font-family:"Roboto",sans-serif}@supports (font-family: var(--primary-font-family)){.timepicker-period__btn[_ngcontent-%COMP%]{font-family:var(--primary-font-family)}}.timepicker-period__btn[_ngcontent-%COMP%]:focus{background-color:#00000012}.timepicker-period__warning[_ngcontent-%COMP%]{padding:5px 10px;border-radius:3px;background-color:#0000008c;color:#fff;position:absolute;width:200px;left:-20px;top:40px}.timepicker-period__warning[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{margin:0;font-size:12px;font-family:"Roboto",sans-serif}@supports (font-family: var(--primary-font-family)){.timepicker-period__warning[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{font-family:var(--primary-font-family)}}'],data:{animation:[(0,Bt.X$)("scaleInOut",[(0,Bt.eR)(":enter",[(0,Bt.oB)({transform:"scale(0)"}),(0,Bt.jt)(".2s",(0,Bt.oB)({transform:"scale(1)"})),(0,Bt.vP)([(0,Bt.jt)("3s",(0,Bt.oB)({opacity:1})),(0,Bt.jt)(".3s",(0,Bt.oB)({opacity:0}))])])])]}}),w})(),tb=(()=>{class w{constructor(v){this.locale=v,this.timeUnit=pr,this.meridiems=vl.meridiems({locale:this.locale}),this.periodChanged=new x.vpe,this.timeUnitChanged=new x.vpe,this.hourChanged=new x.vpe,this.minuteChanged=new x.vpe}ngOnChanges(v){if(v.period&&v.period.currentValue||v.format&&v.format.currentValue){const T=oa.getHours(this.format);this.hours=oa.disableHours(T,{min:this.minTime,max:this.maxTime,format:this.format,period:this.period})}if(v.period&&v.period.currentValue||v.hour&&v.hour.currentValue){const T=oa.getMinutes(this.minutesGap);this.minutes=oa.disableMinutes(T,+this.hour,{min:this.minTime,max:this.maxTime,format:this.format,period:this.period})}}changeTimeUnit(v){this.timeUnitChanged.next(v)}changePeriod(v){this.periodChanged.next(v)}changeHour(v){this.hourChanged.next(v),this.isEditable&&this.changeTimeUnit(pr.MINUTE)}changeMinute(v){this.minuteChanged.next(v)}showHint(){this.isHintVisible=!0}hideHint(){this.isHintVisible=!1}}return w.\u0275fac=function(v){return new(v||w)(x.Y36(Uo))},w.\u0275cmp=x.Xpm({type:w,selectors:[["ngx-material-timepicker-dial"]],inputs:{editableHintTmpl:"editableHintTmpl",hour:"hour",minute:"minute",format:"format",period:"period",activeTimeUnit:"activeTimeUnit",minTime:"minTime",maxTime:"maxTime",isEditable:"isEditable",minutesGap:"minutesGap",hoursOnly:"hoursOnly"},outputs:{periodChanged:"periodChanged",timeUnitChanged:"timeUnitChanged",hourChanged:"hourChanged",minuteChanged:"minuteChanged"},features:[x.TTD],decls:9,vars:25,consts:[[1,"timepicker-dial"],[1,"timepicker-dial__container"],[1,"timepicker-dial__time"],[3,"timeList","time","timeUnit","isActive","isEditable","timeUnitChanged","timeChanged","focused","unfocused"],[3,"timeList","time","timeUnit","isActive","isEditable","minutesGap","disabled","timeUnitChanged","timeChanged","focused","unfocused"],[1,"timepicker-dial__period",3,"ngClass","selectedPeriod","activeTimeUnit","maxTime","minTime","format","hours","minutes","selectedHour","meridiems","periodChanged"],[3,"ngClass",4,"ngIf"],[3,"ngClass"],[4,"ngTemplateOutlet"],["editableHintDefault",""],[1,"timepicker-dial__hint"]],template:function(v,T){1&v&&(x.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"ngx-material-timepicker-dial-control",3),x.NdJ("timeUnitChanged",function(H){return T.changeTimeUnit(H)})("timeChanged",function(H){return T.changeHour(H)})("focused",function(){return T.showHint()})("unfocused",function(){return T.hideHint()}),x.qZA(),x.TgZ(4,"span"),x._uU(5,":"),x.qZA(),x.TgZ(6,"ngx-material-timepicker-dial-control",4),x.NdJ("timeUnitChanged",function(H){return T.changeTimeUnit(H)})("timeChanged",function(H){return T.changeMinute(H)})("focused",function(){return T.showHint()})("unfocused",function(){return T.hideHint()}),x.qZA()(),x.TgZ(7,"ngx-material-timepicker-period",5),x.NdJ("periodChanged",function(H){return T.changePeriod(H)}),x.qZA()(),x.YNc(8,Cd,4,4,"div",6),x.qZA()),2&v&&(x.xp6(3),x.Q6J("timeList",T.hours)("time",T.hour)("timeUnit",T.timeUnit.HOUR)("isActive",T.activeTimeUnit===T.timeUnit.HOUR)("isEditable",T.isEditable),x.xp6(3),x.Q6J("timeList",T.minutes)("time",T.minute)("timeUnit",T.timeUnit.MINUTE)("isActive",T.activeTimeUnit===T.timeUnit.MINUTE)("isEditable",T.isEditable)("minutesGap",T.minutesGap)("disabled",T.hoursOnly),x.xp6(1),x.Q6J("ngClass",x.VKq(23,bs,24===T.format))("selectedPeriod",T.period)("activeTimeUnit",T.activeTimeUnit)("maxTime",T.maxTime)("minTime",T.minTime)("format",T.format)("hours",T.hours)("minutes",T.minutes)("selectedHour",T.hour)("meridiems",T.meridiems),x.xp6(1),x.Q6J("ngIf",T.isEditable||T.editableHintTmpl))},dependencies:[eb,vp,A.mk,A.O5,A.tP],styles:['.timepicker-dial[_ngcontent-%COMP%]{text-align:right}.timepicker-dial__container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;-webkit-tap-highlight-color:rgba(0,0,0,0)}.timepicker-dial__time[_ngcontent-%COMP%]{display:flex;align-items:baseline;line-height:normal;font-size:50px;color:#ffffff80;font-family:"Roboto",sans-serif}@supports (font-family: var(--primary-font-family)){.timepicker-dial__time[_ngcontent-%COMP%]{font-family:var(--primary-font-family);color:var(--dial-inactive-color)}}.timepicker-dial__period[_ngcontent-%COMP%]{display:block;margin-left:10px}.timepicker-dial__period--hidden[_ngcontent-%COMP%]{visibility:hidden}.timepicker-dial__hint-container--hidden[_ngcontent-%COMP%]{visibility:hidden}.timepicker-dial__hint[_ngcontent-%COMP%]{display:inline-block;font-size:10px;color:#fff}@supports (color: var(--dial-active-color)){.timepicker-dial__hint[_ngcontent-%COMP%]{color:var(--dial-active-color)}}.timepicker-dial__hint[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px}@media (max-device-width: 1023px) and (orientation: landscape){.timepicker-dial__container[_ngcontent-%COMP%]{flex-direction:column}.timepicker-dial__period[_ngcontent-%COMP%]{margin-left:0}}'],changeDetection:0}),w})(),vc=(()=>{class w{constructor(v){this.hourChange=new x.vpe,this.hourSelected=new x.vpe,this.hoursList=[],this.hoursList=oa.getHours(v)}onTimeSelected(v){this.hourSelected.next(v)}}return w.\u0275fac=function(v){x.$Z()},w.\u0275dir=x.lG2({type:w,inputs:{selectedHour:"selectedHour",minTime:"minTime",maxTime:"maxTime",format:"format"},outputs:{hourChange:"hourChange",hourSelected:"hourSelected"}}),w})(),ib=(()=>{class w{transform(v,T,k){return null!=v&&!k&&v===T}}return w.\u0275fac=function(v){return new(v||w)},w.\u0275pipe=x.Yjl({name:"activeHour",type:w,pure:!0}),w})(),Oy=(()=>{class w{transform(v,T,k,H){return null!=v&&!H&&T===v&&v%(k||5)==0}}return w.\u0275fac=function(v){return new(v||w)},w.\u0275pipe=x.Yjl({name:"activeMinute",type:w,pure:!0}),w})(),yp=(()=>{class w{transform(v,T=5){return v&&(v%T==0?v:"")}}return w.\u0275fac=function(v){return new(v||w)},w.\u0275pipe=x.Yjl({name:"minutesFormatter",type:w,pure:!0}),w})();const Rd_small_height="75px",Rd_small_top="calc(50% - 75px)",Rd_large_height="103px",Rd_large_top="calc(50% - 103px)";let Du=(()=>{class w{constructor(){this.timeUnit=pr,this.innerClockFaceSize=85,this.timeChange=new x.vpe,this.timeSelected=new x.vpe}ngAfterViewInit(){this.setClockHandPosition(),this.addTouchEvents()}ngOnChanges(v){const T=v.faceTime,k=v.selectedTime;T&&T.currentValue&&k&&k.currentValue&&(this.selectedTime=this.faceTime.find(H=>H.time===this.selectedTime.time)),k&&k.currentValue&&this.setClockHandPosition(),T&&T.currentValue&&setTimeout(()=>this.selectAvailableTime())}trackByTime(v,T){return T.time}onMousedown(v){v.preventDefault(),this.isStarted=!0}selectTime(v){if(!this.isStarted&&v instanceof MouseEvent&&"click"!==v.type)return;const T=this.clockFace.nativeElement.getBoundingClientRect(),k=T.left+T.width/2,H=T.top+T.height/2,oe=180*Math.atan(Math.abs(v.clientX-k)/Math.abs(v.clientY-H))/Math.PI,Me=function xp(w,y,v,T,k){return T>y&&v>=w?180-k:T>y&&v<w?180+k:T<y&&v<w?360-k:k}(k,H,v.clientX,v.clientY,oe),Be=this.format&&this.isInnerClockFace(k,H,v.clientX,v.clientY),Ri=(function ki(w,y){return Math.round(w/y)*y}(Me,this.unit===pr.MINUTE?6*(this.minutesGap||1):30)||360)+(Be?360:0),vn=this.faceTime.find(bi=>bi.angle===Ri);vn&&!vn.disabled&&(this.timeChange.next(vn),this.isStarted||this.timeSelected.next(vn.time))}onMouseup(v){v.preventDefault(),this.isStarted=!1}ngOnDestroy(){this.removeTouchEvents()}addTouchEvents(){this.touchStartHandler=this.onMousedown.bind(this),this.touchEndHandler=this.onMouseup.bind(this),this.clockFace.nativeElement.addEventListener("touchstart",this.touchStartHandler),this.clockFace.nativeElement.addEventListener("touchend",this.touchEndHandler)}removeTouchEvents(){this.clockFace.nativeElement.removeEventListener("touchstart",this.touchStartHandler),this.clockFace.nativeElement.removeEventListener("touchend",this.touchEndHandler)}setClockHandPosition(){24===this.format&&(this.selectedTime.time>12||0===this.selectedTime.time?this.decreaseClockHand():this.increaseClockHand()),this.clockHand.nativeElement.style.transform=`rotate(${this.selectedTime.angle}deg)`}selectAvailableTime(){const v=this.faceTime.find(T=>this.selectedTime.time===T.time);if(this.isClockFaceDisabled=this.faceTime.every(T=>T.disabled),v&&v.disabled&&!this.isClockFaceDisabled){const T=this.faceTime.find(k=>!k.disabled);this.timeChange.next(T)}}isInnerClockFace(v,T,k,H){return Math.sqrt(Math.pow(k-v,2)+Math.pow(H-T,2))<this.innerClockFaceSize}decreaseClockHand(){this.clockHand.nativeElement.style.height=Rd_small_height,this.clockHand.nativeElement.style.top=Rd_small_top}increaseClockHand(){this.clockHand.nativeElement.style.height=Rd_large_height,this.clockHand.nativeElement.style.top=Rd_large_top}}return w.\u0275fac=function(v){return new(v||w)},w.\u0275cmp=x.Xpm({type:w,selectors:[["ngx-material-timepicker-face"]],viewQuery:function(v,T){if(1&v&&(x.Gf(G_,7),x.Gf(Ti,7)),2&v){let k;x.iGM(k=x.CRH())&&(T.clockFace=k.first),x.iGM(k=x.CRH())&&(T.clockHand=k.first)}},hostBindings:function(v,T){1&v&&x.NdJ("mousedown",function(H){return T.onMousedown(H)})("click",function(H){return T.selectTime(H)})("touchmove",function(H){return T.selectTime(H.changedTouches[0])})("touchend",function(H){return T.selectTime(H.changedTouches[0])})("mousemove",function(H){return T.selectTime(H)})("mouseup",function(H){return T.onMouseup(H)})},inputs:{faceTime:"faceTime",selectedTime:"selectedTime",unit:"unit",format:"format",minutesGap:"minutesGap"},outputs:{timeChange:"timeChange",timeSelected:"timeSelected"},features:[x.TTD],decls:7,vars:6,consts:[[1,"clock-face"],["clockFace",""],["class","clock-face__container",4,"ngIf","ngIfElse"],[1,"clock-face__clock-hand",3,"ngClass","hidden"],["clockHand",""],["minutesFace",""],[1,"clock-face__container"],["class","clock-face__number clock-face__number--outer",3,"ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","clock-face__inner",3,"top",4,"ngIf"],[1,"clock-face__number","clock-face__number--outer",3,"ngStyle"],[3,"ngStyle","ngClass"],[1,"clock-face__inner"],["class","clock-face__number clock-face__number--inner",3,"ngStyle","height",4,"ngFor","ngForOf","ngForTrackBy"],[1,"clock-face__number","clock-face__number--inner",3,"ngStyle"]],template:function(v,T){if(1&v&&(x.TgZ(0,"div",0,1),x.YNc(2,vs,4,7,"div",2),x._UZ(3,"span",3,4),x.qZA(),x.YNc(5,Y_,2,2,"ng-template",null,5,x.W1O)),2&v){const k=x.MAs(6);x.xp6(2),x.Q6J("ngIf",T.unit!==T.timeUnit.MINUTE)("ngIfElse",k),x.xp6(1),x.Q6J("ngClass",x.VKq(4,qn,T.unit===T.timeUnit.MINUTE))("hidden",T.isClockFaceDisabled)}},dependencies:[A.O5,A.sg,A.PC,A.mk,A.OU,ib,Pd,Oy,yp],styles:['.clock-face[_ngcontent-%COMP%]{width:290px;height:290px;border-radius:50%;position:relative;display:flex;justify-content:center;padding:20px;box-sizing:border-box;background-color:#f0f0f0}@supports (background-color: var(--clock-face-background-color)){.clock-face[_ngcontent-%COMP%]{background-color:var(--clock-face-background-color)}}.clock-face__inner[_ngcontent-%COMP%]{position:absolute}.clock-face__container[_ngcontent-%COMP%]{margin-left:-2px}.clock-face__number[_ngcontent-%COMP%]{position:absolute;transform-origin:0 100%;width:50px;text-align:center;z-index:2}.clock-face__number--outer[_ngcontent-%COMP%]{height:calc(290px / 2 - 20px)}.clock-face__number--outer[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{font-size:16px;color:#6c6c6c}@supports (color: var(--clock-face-time-inactive-color)){.clock-face__number--outer[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{color:var(--clock-face-time-inactive-color)}}.clock-face__number--inner[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{font-size:14px;color:#929292}@supports (color: var(--clock-face-inner-time-inactive-color)){.clock-face__number--inner[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{color:var(--clock-face-inner-time-inactive-color)}}.clock-face__number[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;user-select:none;width:30px;height:30px;display:flex;justify-content:center;align-items:center;margin:auto;border-radius:50%;font-weight:500;font-family:"Roboto",sans-serif}@supports (font-family: var(--primary-font-family)){.clock-face__number[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{font-family:var(--primary-font-family)}}.clock-face__number[_ngcontent-%COMP%] > span.active[_ngcontent-%COMP%]{background-color:#00bfff;color:#fff}@supports (background-color: var(--clock-hand-color)){.clock-face__number[_ngcontent-%COMP%] > span.active[_ngcontent-%COMP%]{background-color:var(--clock-hand-color);color:var(--clock-face-time-active-color)}}.clock-face__number[_ngcontent-%COMP%] > span.disabled[_ngcontent-%COMP%]{color:#c5c5c5}@supports (color: var(--clock-face-time-disabled-color)){.clock-face__number[_ngcontent-%COMP%] > span.disabled[_ngcontent-%COMP%]{color:var(--clock-face-time-disabled-color)}}.clock-face__clock-hand[_ngcontent-%COMP%]{height:103px;width:2px;transform-origin:0 100%;position:absolute;top:calc(50% - 103px);z-index:1;background-color:#00bfff}@supports (background-color: var(--clock-hand-color)){.clock-face__clock-hand[_ngcontent-%COMP%]{background-color:var(--clock-hand-color)}}.clock-face__clock-hand[_ngcontent-%COMP%]:after{content:"";width:7px;height:7px;border-radius:50%;background-color:inherit;position:absolute;bottom:-3px;left:-3.5px}.clock-face__clock-hand_minute[_ngcontent-%COMP%]:before{content:"";width:7px;height:7px;background-color:#fff;border-radius:50%;position:absolute;top:-8px;left:calc(50% - 8px);box-sizing:content-box;border-width:4px;border-style:solid;border-color:#00bfff}@supports (border-color: var(--clock-hand-color)){.clock-face__clock-hand_minute[_ngcontent-%COMP%]:before{border-color:var(--clock-hand-color)}}@media (max-device-width: 1023px) and (orientation: landscape){.clock-face[_ngcontent-%COMP%]{width:225px;height:225px;padding:5px}.clock-face__number--outer[_ngcontent-%COMP%]{height:calc(225px / 2 - 5px)}.clock-face__clock-hand_minute[_ngcontent-%COMP%]:before{top:0}}'],changeDetection:0}),w})(),wp=(()=>{class w extends vc{constructor(){super(24)}ngAfterContentInit(){this.hoursList=oa.disableHours(this.hoursList,{min:this.minTime,max:this.maxTime,format:this.format})}}return w.\u0275fac=function(v){return new(v||w)},w.\u0275cmp=x.Xpm({type:w,selectors:[["ngx-material-timepicker-24-hours-face"]],features:[x.qOj],decls:1,vars:3,consts:[[3,"selectedTime","faceTime","format","timeChange","timeSelected"]],template:function(v,T){1&v&&(x.TgZ(0,"ngx-material-timepicker-face",0),x.NdJ("timeChange",function(H){return T.hourChange.next(H)})("timeSelected",function(H){return T.onTimeSelected(H)}),x.qZA()),2&v&&x.Q6J("selectedTime",T.selectedHour)("faceTime",T.hoursList)("format",T.format)},dependencies:[Du],encapsulation:2,changeDetection:0}),w})(),nb=(()=>{class w extends vc{constructor(){super(12)}ngOnChanges(v){v.period&&v.period.currentValue&&(this.hoursList=oa.disableHours(this.hoursList,{min:this.minTime,max:this.maxTime,format:this.format,period:this.period}))}}return w.\u0275fac=function(v){return new(v||w)},w.\u0275cmp=x.Xpm({type:w,selectors:[["ngx-material-timepicker-12-hours-face"]],inputs:{period:"period"},features:[x.qOj,x.TTD],decls:1,vars:2,consts:[[3,"selectedTime","faceTime","timeChange","timeSelected"]],template:function(v,T){1&v&&(x.TgZ(0,"ngx-material-timepicker-face",0),x.NdJ("timeChange",function(H){return T.hourChange.next(H)})("timeSelected",function(H){return T.onTimeSelected(H)}),x.qZA()),2&v&&x.Q6J("selectedTime",T.selectedHour)("faceTime",T.hoursList)},dependencies:[Du],encapsulation:2,changeDetection:0}),w})(),kn=(()=>{class w{constructor(){this.minutesList=[],this.timeUnit=pr,this.minuteChange=new x.vpe}ngOnChanges(v){if(v.period&&v.period.currentValue){const T=oa.getMinutes(this.minutesGap);this.minutesList=oa.disableMinutes(T,this.selectedHour,{min:this.minTime,max:this.maxTime,format:this.format,period:this.period})}}}return w.\u0275fac=function(v){return new(v||w)},w.\u0275cmp=x.Xpm({type:w,selectors:[["ngx-material-timepicker-minutes-face"]],inputs:{selectedMinute:"selectedMinute",selectedHour:"selectedHour",period:"period",minTime:"minTime",maxTime:"maxTime",format:"format",minutesGap:"minutesGap"},outputs:{minuteChange:"minuteChange"},features:[x.TTD],decls:1,vars:4,consts:[[3,"faceTime","selectedTime","minutesGap","unit","timeChange"]],template:function(v,T){1&v&&(x.TgZ(0,"ngx-material-timepicker-face",0),x.NdJ("timeChange",function(H){return T.minuteChange.next(H)}),x.qZA()),2&v&&x.Q6J("faceTime",T.minutesList)("selectedTime",T.selectedMinute)("minutesGap",T.minutesGap)("unit",T.timeUnit.MINUTE)},dependencies:[Du],encapsulation:2}),w})(),ei=(()=>{class w{}return w.\u0275fac=function(v){return new(v||w)},w.\u0275cmp=x.Xpm({type:w,selectors:[["ngx-material-timepicker-button"]],ngContentSelectors:Se,decls:3,vars:0,consts:[["type","button",1,"timepicker-button"]],template:function(v,T){1&v&&(x.F$t(),x.TgZ(0,"button",0)(1,"span"),x.Hsn(2),x.qZA()())},styles:['.timepicker-button[_ngcontent-%COMP%]{display:inline-block;height:36px;min-width:88px;line-height:36px;border:12px;border-radius:2px;background-color:transparent;text-align:center;transition:all .45s cubic-bezier(.23,1,.32,1);overflow:hidden;-webkit-user-select:none;-moz-user-select:none;user-select:none;position:relative;cursor:pointer;outline:none;color:#00bfff}@supports (color: var(--button-color)){.timepicker-button[_ngcontent-%COMP%]{color:var(--button-color)}}.timepicker-button[_ngcontent-%COMP%]:hover, .timepicker-button[_ngcontent-%COMP%]:focus{background-color:#9993}.timepicker-button[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{font-size:14px;text-transform:uppercase;font-weight:600;padding-left:16px;padding-right:16px;font-family:"Roboto",sans-serif}@supports (font-family: var(--primary-font-family)){.timepicker-button[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{font-family:var(--primary-font-family)}}']}),w})(),ys=(()=>{class w{constructor(v){this.eventService=v}onClick(v){this.preventClick||this.eventService.dispatchEvent(v),v.preventDefault()}}return w.\u0275fac=function(v){return new(v||w)(x.Y36(kd))},w.\u0275dir=x.lG2({type:w,selectors:[["","overlay",""]],hostBindings:function(v,T){1&v&&x.NdJ("click",function(H){return T.onClick(H)})},inputs:{preventClick:["overlay","preventClick"]}}),w})(),Mp=(()=>{class w{constructor(v){this.element=v.nativeElement}ngAfterViewInit(){this.theme&&this.setTheme(this.theme)}setTheme(v){for(const T in v)if(v.hasOwnProperty(T)){if("string"==typeof v[T]){for(const k in v)v.hasOwnProperty(k)&&this.element.style.setProperty(`--${zo(k)}`,v[k]);return}this.setTheme(v[T])}}}return w.\u0275fac=function(v){return new(v||w)(x.Y36(x.SBq))},w.\u0275dir=x.lG2({type:w,selectors:[["","ngxMaterialTimepickerTheme",""]],inputs:{theme:["ngxMaterialTimepickerTheme","theme"]}}),w})();function zo(w){return w.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}var en=function(w){return w.ENTER="enter",w.LEAVE="leave",w}(en||{});let sb=(()=>{class w{constructor(v,T,k){this.timepickerService=v,this.eventService=T,this.locale=k,this.timeUnit=pr,this.activeTimeUnit=pr.HOUR,this.unsubscribe=new d.x}set defaultTime(v){this._defaultTime=v,this.setDefaultTime(v)}get defaultTime(){return this._defaultTime}onKeydown(v){this.eventService.dispatchEvent(v),v.stopPropagation()}ngOnInit(){this.animationState=!this.disableAnimation&&en.ENTER,this.defineTime(),this.selectedHour=this.timepickerService.selectedHour.pipe((0,Li.d)({bufferSize:1,refCount:!0})),this.selectedMinute=this.timepickerService.selectedMinute.pipe((0,Li.d)({bufferSize:1,refCount:!0})),this.selectedPeriod=this.timepickerService.selectedPeriod.pipe((0,Li.d)({bufferSize:1,refCount:!0})),this.timepickerBaseRef.timeUpdated.pipe((0,Hi.R)(this.unsubscribe)).subscribe(this.setDefaultTime.bind(this))}onHourChange(v){this.timepickerService.hour=v,this.onTimeChange()}onHourSelected(v){this.hoursOnly||this.changeTimeUnit(pr.MINUTE),this.timepickerBaseRef.hourSelected.next(v)}onMinuteChange(v){this.timepickerService.minute=v,this.onTimeChange()}changePeriod(v){this.timepickerService.period=v,this.onTimeChange()}changeTimeUnit(v){this.activeTimeUnit=v}setTime(){this.timepickerBaseRef.timeSet.next(this.timepickerService.getFullTime(this.format)),this.close()}close(){this.disableAnimation?this.timepickerBaseRef.close():this.animationState=en.LEAVE}animationDone(v){"done"===v.phaseName&&v.toState===en.LEAVE&&this.timepickerBaseRef.close()}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}setDefaultTime(v){this.timepickerService.setDefaultTimeIfAvailable(v,this.minTime,this.maxTime,this.format,this.minutesGap)}defineTime(){const v=this.minTime;if(v&&!this.time&&!this.defaultTime){const T=Ns.fromDateTimeToString(v,this.format);this.setDefaultTime(T)}}onTimeChange(){const v=Ns.toLocaleTimeString(this.timepickerService.getFullTime(this.format),{locale:this.locale,format:this.format});this.timepickerBaseRef.timeChanged.emit(v)}}return w.\u0275fac=function(v){return new(v||w)(x.Y36(Sd),x.Y36(kd),x.Y36(Uo))},w.\u0275cmp=x.Xpm({type:w,selectors:[["ngx-material-timepicker-container"]],hostBindings:function(v,T){1&v&&x.NdJ("keydown",function(H){return T.onKeydown(H)})},inputs:{defaultTime:"defaultTime"},features:[x._Bn([Sd])],decls:22,vars:31,consts:[[1,"timepicker-backdrop-overlay",3,"overlay","ngClass"],[1,"timepicker-overlay"],[3,"appendToInput","inputElement","ngxMaterialTimepickerTheme"],[1,"timepicker",3,"ngClass"],[1,"timepicker__header"],[3,"format","hour","minute","period","activeTimeUnit","minTime","maxTime","isEditable","editableHintTmpl","minutesGap","hoursOnly","periodChanged","timeUnitChanged","hourChanged","minuteChanged"],[1,"timepicker__main-content"],[1,"timepicker__body",3,"ngSwitch"],[4,"ngSwitchCase"],[3,"selectedMinute","selectedHour","minTime","maxTime","format","period","minutesGap","minuteChange",4,"ngSwitchCase"],[1,"timepicker__actions"],[3,"click"],[4,"ngTemplateOutlet"],["cancelBtnDefault",""],["confirmBtnDefault",""],[3,"selectedHour","minTime","maxTime","format","hourChange","hourSelected",4,"ngIf","ngIfElse"],["ampmHours",""],[3,"selectedHour","minTime","maxTime","format","hourChange","hourSelected"],[3,"selectedHour","period","minTime","maxTime","hourChange","hourSelected"],[3,"selectedMinute","selectedHour","minTime","maxTime","format","period","minutesGap","minuteChange"]],template:function(v,T){if(1&v&&(x._UZ(0,"div",0),x.TgZ(1,"div",1)(2,"ngx-material-timepicker-content",2)(3,"div",3),x.NdJ("@timepicker.done",function(H){return T.animationDone(H)}),x.TgZ(4,"header",4)(5,"ngx-material-timepicker-dial",5),x.NdJ("periodChanged",function(H){return T.changePeriod(H)})("timeUnitChanged",function(H){return T.changeTimeUnit(H)})("hourChanged",function(H){return T.onHourChange(H)})("minuteChanged",function(H){return T.onMinuteChange(H)}),x.ALo(6,"async"),x.ALo(7,"async"),x.ALo(8,"async"),x.qZA()(),x.TgZ(9,"div",6)(10,"div",7),x.YNc(11,xu,4,2,"div",8),x.YNc(12,j_,4,13,"ngx-material-timepicker-minutes-face",9),x.qZA(),x.TgZ(13,"div",10)(14,"div",11),x.NdJ("click",function(){return T.close()}),x.YNc(15,Z_,1,0,"ng-container",12),x.qZA(),x.TgZ(16,"div",11),x.NdJ("click",function(){return T.setTime()}),x.YNc(17,wu,1,0,"ng-container",12),x.qZA()()()()()(),x.YNc(18,Mu,2,0,"ng-template",null,13,x.W1O),x.YNc(20,Dd,2,0,"ng-template",null,14,x.W1O)),2&v){const k=x.MAs(19),H=x.MAs(21);let oe,Me;x.Q6J("overlay",T.preventOverlayClick)("ngClass",x.VKq(29,X_,T.appendToInput)),x.xp6(2),x.Q6J("appendToInput",T.appendToInput)("inputElement",T.inputElement)("ngxMaterialTimepickerTheme",T.theme),x.xp6(1),x.Q6J("@timepicker",T.animationState)("ngClass",T.timepickerClass),x.xp6(2),x.Q6J("format",T.format)("hour",null==(oe=x.lcZ(6,23,T.selectedHour))?null:oe.time)("minute",null==(Me=x.lcZ(7,25,T.selectedMinute))?null:Me.time)("period",x.lcZ(8,27,T.selectedPeriod))("activeTimeUnit",T.activeTimeUnit)("minTime",T.minTime)("maxTime",T.maxTime)("isEditable",T.enableKeyboardInput)("editableHintTmpl",T.editableHintTmpl)("minutesGap",T.minutesGap)("hoursOnly",T.hoursOnly),x.xp6(5),x.Q6J("ngSwitch",T.activeTimeUnit),x.xp6(1),x.Q6J("ngSwitchCase",T.timeUnit.HOUR),x.xp6(1),x.Q6J("ngSwitchCase",T.timeUnit.MINUTE),x.xp6(3),x.Q6J("ngTemplateOutlet",T.cancelBtnTmpl?T.cancelBtnTmpl:k),x.xp6(2),x.Q6J("ngTemplateOutlet",T.confirmBtnTmpl?T.confirmBtnTmpl:H)}},dependencies:[Q_,tb,wp,nb,kn,ei,ys,A.mk,Mp,A.RF,A.n9,A.O5,A.tP,A.Ov],styles:['[_nghost-%COMP%]{--body-background-color: #fff;--primary-font-family: "Roboto", sans-serif;--button-color: deepskyblue;--dial-active-color: #fff;--dial-inactive-color: rgba(255, 255, 255, .5);--dial-background-color: deepskyblue;--dial-editable-active-color: deepskyblue;--dial-editable-background-color: #fff;--clock-face-time-active-color: #fff;--clock-face-time-inactive-color: #6c6c6c;--clock-face-inner-time-inactive-color: #929292;--clock-face-time-disabled-color: #c5c5c5;--clock-face-background-color: #f0f0f0;--clock-hand-color: deepskyblue}.timepicker-backdrop-overlay[_ngcontent-%COMP%]{position:fixed;top:0;bottom:0;right:0;left:0;background-color:#0000004d;z-index:999;pointer-events:auto}.timepicker-backdrop-overlay--transparent[_ngcontent-%COMP%]{background-color:transparent}.timepicker-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;z-index:999;pointer-events:none}.timepicker[_ngcontent-%COMP%]{width:300px;border-radius:2px;box-shadow:#00000040 0 14px 45px,#00000038 0 10px 18px;outline:none;position:static;z-index:999;pointer-events:auto}.timepicker__header[_ngcontent-%COMP%]{padding:15px 30px;background-color:#00bfff}@supports (background-color: var(--dial-background-color)){.timepicker__header[_ngcontent-%COMP%]{background-color:var(--dial-background-color)}}.timepicker__body[_ngcontent-%COMP%]{padding:15px 5px;display:flex;justify-content:center;align-items:center;background-color:#fff}@supports (background-color: var(--body-background-color)){.timepicker__body[_ngcontent-%COMP%]{background-color:var(--body-background-color)}}.timepicker__actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:15px;background-color:#fff}@supports (background-color: var(--body-background-color)){.timepicker__actions[_ngcontent-%COMP%]{background-color:var(--body-background-color)}}@media (max-device-width: 1023px) and (orientation: landscape){.timepicker[_ngcontent-%COMP%]{display:flex;width:515px}.timepicker__header[_ngcontent-%COMP%]{display:flex;align-items:center}.timepicker__main-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.timepicker__actions[_ngcontent-%COMP%]{padding:5px;margin-top:-1px}}'],data:{animation:[(0,Bt.X$)("timepicker",[(0,Bt.eR)(`* => ${en.ENTER}`,[(0,Bt.oB)({transform:"translateY(-30%)"}),(0,Bt.jt)("0.2s ease-out",(0,Bt.oB)({transform:"translateY(0)"}))]),(0,Bt.eR)(`${en.ENTER} => ${en.LEAVE}`,[(0,Bt.oB)({transform:"translateY(0)",opacity:1}),(0,Bt.jt)("0.2s ease-out",(0,Bt.oB)({transform:"translateY(-30%)",opacity:0}))])])]}}),w})(),Ry=(()=>{class w{constructor(v,T,k,H){this.cfr=v,this.appRef=T,this.injector=k,this.document=H}appendTimepickerToBody(v,T){this.componentRef=this.cfr.resolveComponentFactory(v).create(this.injector),Object.keys(T).forEach(H=>this.componentRef.instance[H]=T[H]),this.appRef.attachView(this.componentRef.hostView),this.document.body.appendChild(this.componentRef.hostView.rootNodes[0])}destroyTimepicker(){this.componentRef.destroy(),this.appRef.detachView(this.componentRef.hostView)}}return w.\u0275fac=function(v){return new(v||w)(x.LFG(x._Vd),x.LFG(x.z2F),x.LFG(x.zs3),x.LFG(A.K0,8))},w.\u0275prov=x.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})(),Iy=(()=>{class w{constructor(v,T){this.eventService=v,this.domService=T,this.timeUpdated=new d.x,this.isEsc=!0,this.hoursOnly=!1,this.timeSet=new x.vpe,this.opened=new x.vpe,this.closed=new x.vpe,this.hourSelected=new x.vpe,this.timeChanged=new x.vpe,this.unsubscribe=new d.x}set ngxMaterialTimepickerTheme(v){console.warn("'ngxMaterialTimepickerTheme' is deprecated. Use 'theme' instead"),this._ngxMaterialTimepickerTheme=v}set format(v){this._format=24===v?24:12}get format(){return this.timepickerInput?this.timepickerInput.format:this._format}set minutesGap(v){null!=v&&(v=Math.floor(v),this._minutesGap=v<=59?v:1)}get minutesGap(){return this._minutesGap}get minTime(){return this.timepickerInput?this.timepickerInput.min:this.min}get maxTime(){return this.timepickerInput?this.timepickerInput.max:this.max}get disabled(){return this.timepickerInput&&this.timepickerInput.disabled}get time(){return this.timepickerInput&&this.timepickerInput.value}get inputElement(){return this.timepickerInput&&this.timepickerInput.element}registerInput(v){if(this.timepickerInput)throw Error("A Timepicker can only be associated with a single input.");this.timepickerInput=v}open(){this.domService.appendTimepickerToBody(sb,{timepickerBaseRef:this,time:this.time,defaultTime:this.defaultTime,maxTime:this.maxTime,minTime:this.minTime,format:this.format,minutesGap:this.minutesGap,disableAnimation:this.disableAnimation,cancelBtnTmpl:this.cancelBtnTmpl,confirmBtnTmpl:this.confirmBtnTmpl,editableHintTmpl:this.editableHintTmpl,disabled:this.disabled,enableKeyboardInput:this.enableKeyboardInput,preventOverlayClick:this.preventOverlayClick,appendToInput:this.appendToInput,hoursOnly:this.hoursOnly,theme:this.theme||this._ngxMaterialTimepickerTheme,timepickerClass:this.timepickerClass,inputElement:this.inputElement}),this.opened.next(),this.subscribeToEvents()}close(){this.domService.destroyTimepicker(),this.closed.next(),this.unsubscribeFromEvents()}updateTime(v){this.timeUpdated.next(v)}subscribeToEvents(){(0,R.T)(this.eventService.backdropClick,this.eventService.keydownEvent.pipe((0,Zi.h)(v=>27===v.keyCode&&this.isEsc))).pipe((0,Hi.R)(this.unsubscribe)).subscribe(()=>this.close())}unsubscribeFromEvents(){this.unsubscribe.next(),this.unsubscribe.complete()}}return w.\u0275fac=function(v){return new(v||w)(x.Y36(kd),x.Y36(Ry))},w.\u0275cmp=x.Xpm({type:w,selectors:[["ngx-material-timepicker"]],inputs:{cancelBtnTmpl:"cancelBtnTmpl",editableHintTmpl:"editableHintTmpl",confirmBtnTmpl:"confirmBtnTmpl",isEsc:["ESC","isEsc"],enableKeyboardInput:"enableKeyboardInput",preventOverlayClick:"preventOverlayClick",disableAnimation:"disableAnimation",appendToInput:"appendToInput",hoursOnly:"hoursOnly",defaultTime:"defaultTime",timepickerClass:"timepickerClass",theme:"theme",min:"min",max:"max",ngxMaterialTimepickerTheme:"ngxMaterialTimepickerTheme",format:"format",minutesGap:"minutesGap"},outputs:{timeSet:"timeSet",opened:"opened",closed:"closed",hourSelected:"hourSelected",timeChanged:"timeChanged"},decls:0,vars:0,template:function(v,T){},encapsulation:2}),w})(),Wa=(()=>{class w{constructor(v,T){this.elementRef=v,this.locale=T,this._format=12,this._value="",this.timepickerSubscriptions=[],this.onTouched=()=>{},this.onChange=()=>{}}set format(v){this._format=24===v?24:12,v&&this.previousFormat&&this.previousFormat!==this._format&&(this.value=this._value,this._timepicker.updateTime(this._value)),this.previousFormat=this._format}get format(){return this._format}set min(v){console.log(v),this._min="string"!=typeof v?v:Ns.parseTime(v,{locale:this.locale,format:this.format})}get min(){return this._min}set max(v){this._max="string"!=typeof v?v:Ns.parseTime(v,{locale:this.locale,format:this.format})}get max(){return this._max}set timepicker(v){this.registerTimepicker(v)}set value(v){if(!v)return this._value="",void this.updateInputValue();this.setTimeIfAvailable(v)}get value(){return this._value?Ns.toLocaleTimeString(this._value,{format:this.format,locale:this.locale}):""}get element(){return this.elementRef&&this.elementRef.nativeElement}set defaultTime(v){this._timepicker.defaultTime=Ns.formatTime(v,{locale:this.locale,format:this.format})}updateValue(v){this.value=v,this.onChange(v)}ngOnChanges(v){var T;const k=null===(T=v?.value)||void 0===T?void 0:T.currentValue;k&&(this.setTimeIfAvailable(k),this.defaultTime=k)}onClick(v){this.disableClick||(this._timepicker.open(),v.stopPropagation())}writeValue(v){this.value=v,v&&(this.defaultTime=v)}registerOnChange(v){this.onChange=v}registerOnTouched(v){this.onTouched=v}setDisabledState(v){this.disabled=v}ngOnDestroy(){this.timepickerSubscriptions.forEach(v=>v.unsubscribe())}registerTimepicker(v){if(!v)throw new Error("NgxMaterialTimepickerComponent is not defined. Please make sure you passed the timepicker to ngxTimepicker directive");this._timepicker=v,this._timepicker.registerInput(this),this.timepickerSubscriptions.push(this._timepicker.timeSet.subscribe(T=>{this.value=T,this.onChange(this.value),this.onTouched(),this.defaultTime=this._value}))}updateInputValue(){this.elementRef.nativeElement.value=this.value}setTimeIfAvailable(v){var T;const k=Ns.formatTime(v,{locale:this.locale,format:this.format});Ns.isTimeAvailable(k,this._min,this._max,"minutes",null===(T=this._timepicker)||void 0===T?void 0:T.minutesGap,this._format)?(this._value=k,this.updateInputValue()):(this.value=null,console.warn("Selected time doesn't match min or max value"))}}return w.\u0275fac=function(v){return new(v||w)(x.Y36(x.SBq),x.Y36(Uo))},w.\u0275dir=x.lG2({type:w,selectors:[["","ngxTimepicker",""]],hostVars:1,hostBindings:function(v,T){1&v&&x.NdJ("change",function(H){return T.updateValue(H.target.value)})("blur",function(){return T.onTouched()})("click",function(H){return T.onClick(H)}),2&v&&x.Ikx("disabled",T.disabled)},inputs:{format:"format",min:"min",max:"max",timepicker:["ngxTimepicker","timepicker"],value:"value",disabled:"disabled",disableClick:"disableClick"},features:[x._Bn([{provide:_s.JU,useExisting:w,multi:!0}]),x.TTD]}),w})(),Id=(()=>{class w{static setOpts(v,T=Ns.DEFAULT_NUMBERING_SYSTEM){return{ngModule:w,providers:[{provide:Uo,useValue:v},{provide:J_,useValue:T}]}}}return w.\u0275fac=function(v){return new(v||w)},w.\u0275mod=x.oAB({type:w}),w.\u0275inj=x.cJS({imports:[[A.ez,_s.u5,_s.UX]]}),w})()},7462:function(ot,zt){!function(V){"use strict";function A(ne){return"object"==typeof ne&&"function"==typeof ne.to}function ke(ne){ne.parentElement.removeChild(ne)}function d(ne){return null!=ne}function R(ne){ne.preventDefault()}function $t(ne){return"number"==typeof ne&&!isNaN(ne)&&isFinite(ne)}function Zi(ne,z,Qe){Qe>0&&(Ve(ne,z),setTimeout(function(){Nt(ne,z)},Qe))}function Hi(ne){return Math.max(Math.min(ne,100),0)}function Bt(ne){return Array.isArray(ne)?ne:[ne]}function tt(ne){var z=(ne=String(ne)).split(".");return z.length>1?z[1].length:0}function Ve(ne,z){ne.classList&&!/\s/.test(z)?ne.classList.add(z):ne.className+=" "+z}function Nt(ne,z){ne.classList&&!/\s/.test(z)?ne.classList.remove(z):ne.className=ne.className.replace(new RegExp("(^|\\b)"+z.split(" ").join("|")+"(\\b|$)","gi")," ")}function Pi(ne){var z=void 0!==window.pageXOffset,Qe="CSS1Compat"===(ne.compatMode||"");return{x:z?window.pageXOffset:Qe?ne.documentElement.scrollLeft:ne.body.scrollLeft,y:z?window.pageYOffset:Qe?ne.documentElement.scrollTop:ne.body.scrollTop}}function Je(ne,z){return 100/(z-ne)}function pi(ne,z,Qe){return 100*z/(ne[Qe+1]-ne[Qe])}function ls(ne,z){for(var Qe=1;ne>=z[Qe];)Qe+=1;return Qe}function ir(ne,z,Qe){if(Qe>=ne.slice(-1)[0])return 100;var mt=ls(Qe,ne),Lt=z[mt-1],Y=z[mt];return Lt+function ni(ne,z){return pi(ne,ne[0]<0?z+Math.abs(ne[0]):z-ne[0],0)}([ne[mt-1],ne[mt]],Qe)/Je(Lt,Y)}function zn(ne,z,Qe,mt){if(100===mt)return mt;var ht=ls(mt,ne),Ae=ne[ht-1],Lt=ne[ht];return Qe?mt-Ae>(Lt-Ae)/2?Lt:Ae:z[ht-1]?ne[ht-1]+function Qi(ne,z){return Math.round(ne/z)*z}(mt-ne[ht-1],z[ht-1]):mt}var ne;V.PipsMode=void 0,(ne=V.PipsMode||(V.PipsMode={})).Range="range",ne.Steps="steps",ne.Positions="positions",ne.Count="count",ne.Values="values",V.PipsType=void 0,function(ne){ne[ne.None=-1]="None",ne[ne.NoValue=0]="NoValue",ne[ne.LargeValue=1]="LargeValue",ne[ne.SmallValue=2]="SmallValue"}(V.PipsType||(V.PipsType={}));var ut=function(){function ne(z,Qe,mt){this.xPct=[],this.xVal=[],this.xSteps=[],this.xNumSteps=[],this.xHighestCompleteStep=[],this.xSteps=[mt||!1],this.xNumSteps=[!1],this.snap=Qe;var ht,Ae=[];for(Object.keys(z).forEach(function(Lt){Ae.push([Bt(z[Lt]),Lt])}),Ae.sort(function(Lt,Y){return Lt[0][0]-Y[0][0]}),ht=0;ht<Ae.length;ht++)this.handleEntryPoint(Ae[ht][1],Ae[ht][0]);for(this.xNumSteps=this.xSteps.slice(0),ht=0;ht<this.xNumSteps.length;ht++)this.handleStepPoint(ht,this.xNumSteps[ht])}return ne.prototype.getDistance=function(z){for(var Qe=[],mt=0;mt<this.xNumSteps.length-1;mt++)Qe[mt]=pi(this.xVal,z,mt);return Qe},ne.prototype.getAbsoluteDistance=function(z,Qe,mt){var ht=0;if(z<this.xPct[this.xPct.length-1])for(;z>this.xPct[ht+1];)ht++;else z===this.xPct[this.xPct.length-1]&&(ht=this.xPct.length-2);!mt&&z===this.xPct[ht+1]&&ht++,null===Qe&&(Qe=[]);var Ae,Lt=1,Y=Qe[ht],be=0,fe=0,St=0,Tt=0;for(Ae=mt?(z-this.xPct[ht])/(this.xPct[ht+1]-this.xPct[ht]):(this.xPct[ht+1]-z)/(this.xPct[ht+1]-this.xPct[ht]);Y>0;)be=this.xPct[ht+1+Tt]-this.xPct[ht+Tt],Qe[ht+Tt]*Lt+100-100*Ae>100?(fe=be*Ae,Lt=(Y-100*Ae)/Qe[ht+Tt],Ae=1):(fe=Qe[ht+Tt]*be/100*Lt,Lt=0),mt?(St-=fe,this.xPct.length+Tt>=1&&Tt--):(St+=fe,this.xPct.length-Tt>=1&&Tt++),Y=Qe[ht+Tt]*Lt;return z+St},ne.prototype.toStepping=function(z){return ir(this.xVal,this.xPct,z)},ne.prototype.fromStepping=function(z){return function jt(ne,z,Qe){if(Qe>=100)return ne.slice(-1)[0];var mt=ls(Qe,z),Lt=z[mt-1];return function Mn(ne,z){return z*(ne[1]-ne[0])/100+ne[0]}([ne[mt-1],ne[mt]],(Qe-Lt)*Je(Lt,z[mt]))}(this.xVal,this.xPct,z)},ne.prototype.getStep=function(z){return zn(this.xPct,this.xSteps,this.snap,z)},ne.prototype.getDefaultStep=function(z,Qe,mt){var ht=ls(z,this.xPct);return(100===z||Qe&&z===this.xPct[ht-1])&&(ht=Math.max(ht-1,1)),(this.xVal[ht]-this.xVal[ht-1])/mt},ne.prototype.getNearbySteps=function(z){var Qe=ls(z,this.xPct);return{stepBefore:{startValue:this.xVal[Qe-2],step:this.xNumSteps[Qe-2],highestStep:this.xHighestCompleteStep[Qe-2]},thisStep:{startValue:this.xVal[Qe-1],step:this.xNumSteps[Qe-1],highestStep:this.xHighestCompleteStep[Qe-1]},stepAfter:{startValue:this.xVal[Qe],step:this.xNumSteps[Qe],highestStep:this.xHighestCompleteStep[Qe]}}},ne.prototype.countStepDecimals=function(){var z=this.xNumSteps.map(tt);return Math.max.apply(null,z)},ne.prototype.hasNoSize=function(){return this.xVal[0]===this.xVal[this.xVal.length-1]},ne.prototype.convert=function(z){return this.getStep(this.toStepping(z))},ne.prototype.handleEntryPoint=function(z,Qe){var mt;if(!$t(mt="min"===z?0:"max"===z?100:parseFloat(z))||!$t(Qe[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");this.xPct.push(mt),this.xVal.push(Qe[0]);var ht=Number(Qe[1]);mt?this.xSteps.push(!isNaN(ht)&&ht):isNaN(ht)||(this.xSteps[0]=ht),this.xHighestCompleteStep.push(0)},ne.prototype.handleStepPoint=function(z,Qe){if(Qe){if(this.xVal[z]===this.xVal[z+1])return void(this.xSteps[z]=this.xHighestCompleteStep[z]=this.xVal[z]);this.xSteps[z]=pi([this.xVal[z],this.xVal[z+1]],Qe,0)/Je(this.xPct[z],this.xPct[z+1]);var ht=Math.ceil(Number(((this.xVal[z+1]-this.xVal[z])/this.xNumSteps[z]).toFixed(3))-1);this.xHighestCompleteStep[z]=this.xVal[z]+this.xNumSteps[z]*ht}},ne}(),yi={to:function(ne){return void 0===ne?"":ne.toFixed(2)},from:Number},Qt={target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",touchArea:"touch-area",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",textDirectionLtr:"txt-dir-ltr",textDirectionRtl:"txt-dir-rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"},Bi={tooltips:".__tooltips",aria:".__aria"};function ts(ne,z){if(!$t(z))throw new Error("noUiSlider: 'step' is not numeric.");ne.singleStep=z}function ps(ne,z){if(!$t(z))throw new Error("noUiSlider: 'keyboardPageMultiplier' is not numeric.");ne.keyboardPageMultiplier=z}function Os(ne,z){if(!$t(z))throw new Error("noUiSlider: 'keyboardMultiplier' is not numeric.");ne.keyboardMultiplier=z}function Rs(ne,z){if(!$t(z))throw new Error("noUiSlider: 'keyboardDefaultStep' is not numeric.");ne.keyboardDefaultStep=z}function cs(ne,z){if("object"!=typeof z||Array.isArray(z))throw new Error("noUiSlider: 'range' is not an object.");if(void 0===z.min||void 0===z.max)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");ne.spectrum=new ut(z,ne.snap||!1,ne.singleStep)}function pn(ne,z){if(z=Bt(z),!Array.isArray(z)||!z.length)throw new Error("noUiSlider: 'start' option is incorrect.");ne.handles=z.length,ne.start=z}function fn(ne,z){if("boolean"!=typeof z)throw new Error("noUiSlider: 'snap' option must be a boolean.");ne.snap=z}function jn(ne,z){if("boolean"!=typeof z)throw new Error("noUiSlider: 'animate' option must be a boolean.");ne.animate=z}function Vi(ne,z){if("number"!=typeof z)throw new Error("noUiSlider: 'animationDuration' option must be a number.");ne.animationDuration=z}function ds(ne,z){var mt,Qe=[!1];if("lower"===z?z=[!0,!1]:"upper"===z&&(z=[!1,!0]),!0===z||!1===z){for(mt=1;mt<ne.handles;mt++)Qe.push(z);Qe.push(!1)}else{if(!Array.isArray(z)||!z.length||z.length!==ne.handles+1)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");Qe=z}ne.connect=Qe}function fs(ne,z){switch(z){case"horizontal":ne.ort=0;break;case"vertical":ne.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function bn(ne,z){if(!$t(z))throw new Error("noUiSlider: 'margin' option must be numeric.");0!==z&&(ne.margin=ne.spectrum.getDistance(z))}function gi(ne,z){if(!$t(z))throw new Error("noUiSlider: 'limit' option must be numeric.");if(ne.limit=ne.spectrum.getDistance(z),!ne.limit||ne.handles<2)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders with 2 or more handles.")}function is(ne,z){var Qe;if(!$t(z)&&!Array.isArray(z))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(z)&&2!==z.length&&!$t(z[0])&&!$t(z[1]))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(0!==z){for(Array.isArray(z)||(z=[z,z]),ne.padding=[ne.spectrum.getDistance(z[0]),ne.spectrum.getDistance(z[1])],Qe=0;Qe<ne.spectrum.xNumSteps.length-1;Qe++)if(ne.padding[0][Qe]<0||ne.padding[1][Qe]<0)throw new Error("noUiSlider: 'padding' option must be a positive number(s).");if((z[0]+z[1])/(ne.spectrum.xVal[ne.spectrum.xVal.length-1]-ne.spectrum.xVal[0])>1)throw new Error("noUiSlider: 'padding' option must not exceed 100% of the range.")}}function Tn(ne,z){switch(z){case"ltr":ne.dir=0;break;case"rtl":ne.dir=1;break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function Sn(ne,z){if("string"!=typeof z)throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var Qe=z.indexOf("tap")>=0,mt=z.indexOf("drag")>=0,ht=z.indexOf("fixed")>=0,Ae=z.indexOf("snap")>=0,Lt=z.indexOf("hover")>=0,Y=z.indexOf("unconstrained")>=0,be=z.indexOf("drag-all")>=0,fe=z.indexOf("smooth-steps")>=0;if(ht){if(2!==ne.handles)throw new Error("noUiSlider: 'fixed' behaviour must be used with 2 handles");bn(ne,ne.start[1]-ne.start[0])}if(Y&&(ne.margin||ne.limit))throw new Error("noUiSlider: 'unconstrained' behaviour cannot be used with margin or limit");ne.events={tap:Qe||Ae,drag:mt,dragAll:be,smoothSteps:fe,fixed:ht,snap:Ae,hover:Lt,unconstrained:Y}}function dt(ne,z){if(!1!==z)if(!0===z||A(z)){ne.tooltips=[];for(var Qe=0;Qe<ne.handles;Qe++)ne.tooltips.push(z)}else{if((z=Bt(z)).length!==ne.handles)throw new Error("noUiSlider: must pass a formatter for all handles.");z.forEach(function(mt){if("boolean"!=typeof mt&&!A(mt))throw new Error("noUiSlider: 'tooltips' must be passed a formatter or 'false'.")}),ne.tooltips=z}}function Ni(ne,z){if(z.length!==ne.handles)throw new Error("noUiSlider: must pass a attributes for all handles.");ne.handleAttributes=z}function j(ne,z){if(!A(z))throw new Error("noUiSlider: 'ariaFormat' requires 'to' method.");ne.ariaFormat=z}function he(ne,z){if(!function x(ne){return A(ne)&&"function"==typeof ne.from}(z))throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.");ne.format=z}function De(ne,z){if("boolean"!=typeof z)throw new Error("noUiSlider: 'keyboardSupport' option must be a boolean.");ne.keyboardSupport=z}function Mt(ne,z){ne.documentElement=z}function it(ne,z){if("string"!=typeof z&&!1!==z)throw new Error("noUiSlider: 'cssPrefix' must be a string or `false`.");ne.cssPrefix=z}function Ln(ne,z){if("object"!=typeof z)throw new Error("noUiSlider: 'cssClasses' must be an object.");"string"==typeof ne.cssPrefix?(ne.cssClasses={},Object.keys(z).forEach(function(Qe){ne.cssClasses[Qe]=ne.cssPrefix+z[Qe]})):ne.cssClasses=z}function ge(ne){var z={margin:null,limit:null,padding:null,animate:!0,animationDuration:300,ariaFormat:yi,format:yi},Qe={step:{r:!1,t:ts},keyboardPageMultiplier:{r:!1,t:ps},keyboardMultiplier:{r:!1,t:Os},keyboardDefaultStep:{r:!1,t:Rs},start:{r:!0,t:pn},connect:{r:!0,t:ds},direction:{r:!0,t:Tn},snap:{r:!1,t:fn},animate:{r:!1,t:jn},animationDuration:{r:!1,t:Vi},range:{r:!0,t:cs},orientation:{r:!1,t:fs},margin:{r:!1,t:bn},limit:{r:!1,t:gi},padding:{r:!1,t:is},behaviour:{r:!0,t:Sn},ariaFormat:{r:!1,t:j},format:{r:!1,t:he},tooltips:{r:!1,t:dt},keyboardSupport:{r:!0,t:De},documentElement:{r:!1,t:Mt},cssPrefix:{r:!0,t:it},cssClasses:{r:!0,t:Ln},handleAttributes:{r:!1,t:Ni}},mt={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:Qt,keyboardPageMultiplier:5,keyboardMultiplier:1,keyboardDefaultStep:10};ne.format&&!ne.ariaFormat&&(ne.ariaFormat=ne.format),Object.keys(Qe).forEach(function(be){if(d(ne[be])||void 0!==mt[be])Qe[be].t(z,d(ne[be])?ne[be]:mt[be]);else if(Qe[be].r)throw new Error("noUiSlider: '"+be+"' is required.")}),z.pips=ne.pips;var ht=document.createElement("div");return z.transformRule=void 0!==ht.style.transform?"transform":void 0!==ht.style.msTransform?"msTransform":"webkitTransform",z.style=[["left","top"],["right","bottom"]][z.dir][z.ort],z}function Ne(ne,z,Qe){var Y,be,fe,St,Tt,mt=function Fi(){return window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"}}(),Ae=function si(){return window.CSS&&CSS.supports&&CSS.supports("touch-action","none")}()&&function Ht(){var ne=!1;try{var z=Object.defineProperty({},"passive",{get:function(){ne=!0}});window.addEventListener("test",null,z)}catch{}return ne}(),Lt=ne,xi=z.spectrum,Hn=[],Wi=[],ns=[],Ia=0,Si={},Sr=ne.ownerDocument,Fn=z.documentElement||Sr.documentElement,kr=Sr.body,Ys="rtl"===Sr.dir||1===z.ort?0:100;function Is(le,we){var Re=Sr.createElement("div");return we&&Ve(Re,we),le.appendChild(Re),Re}function Qr(le,we){var Re=Is(le,z.cssClasses.origin),Ye=Is(Re,z.cssClasses.handle);if(Is(Ye,z.cssClasses.touchArea),Ye.setAttribute("data-handle",String(we)),z.keyboardSupport&&(Ye.setAttribute("tabindex","0"),Ye.addEventListener("keydown",function(Ct){return function Di(le,we){if(so()||ya(we))return!1;var Re=["Left","Right"],Ye=["Down","Up"],kt=["PageDown","PageUp"],Ct=["Home","End"];z.dir&&!z.ort?Re.reverse():z.ort&&!z.dir&&(Ye.reverse(),kt.reverse());var rs,_i=le.key.replace("Arrow",""),Wt=_i===kt[0],Cn=_i===kt[1],hn=_i===Ye[0]||_i===Re[0]||Wt,Vn=_i===Ye[1]||_i===Re[1]||Cn,un=_i===Ct[1];if(!(hn||Vn||_i===Ct[0]||un))return!0;if(le.preventDefault(),Vn||hn){var Bs=hn?0:1,Cs=js(we)[Bs];if(null===Cs)return!1;!1===Cs&&(Cs=xi.getDefaultStep(Wi[we],hn,z.keyboardDefaultStep)),Cs*=Cn||Wt?z.keyboardPageMultiplier:z.keyboardMultiplier,Cs=Math.max(Cs,1e-7),rs=Hn[we]+(Cs*=hn?-1:1)}else rs=un?z.spectrum.xVal[z.spectrum.xVal.length-1]:z.spectrum.xVal[0];return Bn(we,xi.toStepping(rs),!0,!0),D("slide",we),D("update",we),D("change",we),D("set",we),!1}(Ct,we)})),void 0!==z.handleAttributes){var kt=z.handleAttributes[we];Object.keys(kt).forEach(function(Ct){Ye.setAttribute(Ct,kt[Ct])})}return Ye.setAttribute("role","slider"),Ye.setAttribute("aria-orientation",z.ort?"vertical":"horizontal"),0===we?Ve(Ye,z.cssClasses.handleLower):we===z.handles-1&&Ve(Ye,z.cssClasses.handleUpper),Re.handle=Ye,Re}function Nr(le,we){return!!we&&Is(le,z.cssClasses.connect)}function Fa(le,we){return!(!z.tooltips||!z.tooltips[we])&&Is(le.firstChild,z.cssClasses.tooltip)}function so(){return Lt.hasAttribute("disabled")}function ya(le){return be[le].hasAttribute("disabled")}function xa(){Tt&&(bt("update"+Bi.tooltips),Tt.forEach(function(le){le&&ke(le)}),Tt=null)}function ro(){xa(),Tt=be.map(Fa),Gi("update"+Bi.tooltips,function(le,we,Re){if(Tt&&z.tooltips&&!1!==Tt[we]){var Ye=le[we];!0!==z.tooltips[we]&&(Ye=z.tooltips[we].to(Re[we])),Tt[we].innerHTML=Ye}})}function Ba(le,we){return le.map(function(Re){return xi.fromStepping(we?xi.getStep(Re):Re)})}function Io(le){function we(hn,Vn){return Number((hn+Vn).toFixed(7))}var Re=function wa(le){if(le.mode===V.PipsMode.Range||le.mode===V.PipsMode.Steps)return xi.xVal;if(le.mode===V.PipsMode.Count){if(le.values<2)throw new Error("noUiSlider: 'values' (>= 2) required for mode 'count'.");for(var we=le.values-1,Re=100/we,Ye=[];we--;)Ye[we]=we*Re;return Ye.push(100),Ba(Ye,le.stepped)}return le.mode===V.PipsMode.Positions?Ba(le.values,le.stepped):le.mode===V.PipsMode.Values?le.stepped?le.values.map(function(kt){return xi.fromStepping(xi.getStep(xi.toStepping(kt)))}):le.values:[]}(le),Ye={},kt=xi.xVal[0],Ct=xi.xVal[xi.xVal.length-1],_i=!1,Wt=!1,Cn=0;return(Re=function Li(ne){return ne.filter(function(z){return!this[z]&&(this[z]=!0)},{})}(Re.slice().sort(function(hn,Vn){return hn-Vn})))[0]!==kt&&(Re.unshift(kt),_i=!0),Re[Re.length-1]!==Ct&&(Re.push(Ct),Wt=!0),Re.forEach(function(hn,Vn){var Nn,un,rs,Cs,Na,lc,ml,cc,nu,Bs=hn,gs=Re[Vn+1],dc=le.mode===V.PipsMode.Steps;for(dc&&(Nn=xi.xNumSteps[Vn]),Nn||(Nn=gs-Bs),void 0===gs&&(gs=Bs),Nn=Math.max(Nn,1e-7),un=Bs;un<=gs;un=we(un,Nn)){for(nu=(Na=(Cs=xi.toStepping(un))-Cn)/(cc=Math.round(Na/(le.density||1))),rs=1;rs<=cc;rs+=1)Ye[(lc=Cn+rs*nu).toFixed(5)]=[xi.fromStepping(lc),0];ml=Re.indexOf(un)>-1?V.PipsType.LargeValue:dc?V.PipsType.SmallValue:V.PipsType.NoValue,!Vn&&_i&&un!==gs&&(ml=0),un===gs&&Wt||(Ye[Cs.toFixed(5)]=[un,ml]),Cn=Cs}}),Ye}function Ma(le,we,Re){var Ye,kt,Ct=Sr.createElement("div"),_i=((Ye={})[V.PipsType.None]="",Ye[V.PipsType.NoValue]=z.cssClasses.valueNormal,Ye[V.PipsType.LargeValue]=z.cssClasses.valueLarge,Ye[V.PipsType.SmallValue]=z.cssClasses.valueSub,Ye),Wt=((kt={})[V.PipsType.None]="",kt[V.PipsType.NoValue]=z.cssClasses.markerNormal,kt[V.PipsType.LargeValue]=z.cssClasses.markerLarge,kt[V.PipsType.SmallValue]=z.cssClasses.markerSub,kt),Cn=[z.cssClasses.valueHorizontal,z.cssClasses.valueVertical],hn=[z.cssClasses.markerHorizontal,z.cssClasses.markerVertical];function Vn(un,rs){var Bs=rs===z.cssClasses.value;return rs+" "+(Bs?Cn:hn)[z.ort]+" "+(Bs?_i:Wt)[un]}return Ve(Ct,z.cssClasses.pips),Ve(Ct,0===z.ort?z.cssClasses.pipsHorizontal:z.cssClasses.pipsVertical),Object.keys(le).forEach(function(un){!function Nn(un,rs,Bs){if((Bs=we?we(rs,Bs):Bs)!==V.PipsType.None){var gs=Is(Ct,!1);gs.className=Vn(Bs,z.cssClasses.marker),gs.style[z.style]=un+"%",Bs>V.PipsType.NoValue&&((gs=Is(Ct,!1)).className=Vn(Bs,z.cssClasses.value),gs.setAttribute("data-value",String(rs)),gs.style[z.style]=un+"%",gs.innerHTML=String(Re.to(rs)))}}(un,le[un][0],le[un][1])}),Ct}function ss(){St&&(ke(St),St=null)}function ea(le){ss();var we=Io(le);return St=Lt.appendChild(Ma(we,le.filter,le.format||{to:function(kt){return String(Math.round(kt))}}))}function ta(){var le=Y.getBoundingClientRect(),we="offset"+["Width","Height"][z.ort];return 0===z.ort?le.width||Y[we]:le.height||Y[we]}function J(le,we,Re,Ye){var kt=function(_i){var Wt=function _t(le,we,Re){var Ye=0===le.type.indexOf("touch"),kt=0===le.type.indexOf("mouse"),Ct=0===le.type.indexOf("pointer"),_i=0,Wt=0;if(0===le.type.indexOf("MSPointer")&&(Ct=!0),"mousedown"===le.type&&!le.buttons&&!le.touches)return!1;if(Ye){var Cn=function(Nn){var un=Nn.target;return un===Re||Re.contains(un)||le.composed&&le.composedPath().shift()===Re};if("touchstart"===le.type){var hn=Array.prototype.filter.call(le.touches,Cn);if(hn.length>1)return!1;_i=hn[0].pageX,Wt=hn[0].pageY}else{var Vn=Array.prototype.find.call(le.changedTouches,Cn);if(!Vn)return!1;_i=Vn.pageX,Wt=Vn.pageY}}return we=we||Pi(Sr),(kt||Ct)&&(_i=le.clientX+we.x,Wt=le.clientY+we.y),le.pageOffset=we,le.points=[_i,Wt],le.cursor=kt||Ct,le}(_i,Ye.pageOffset,Ye.target||we);if(!Wt||so()&&!Ye.doNotReject||function Vt(ne,z){return ne.classList?ne.classList.contains(z):new RegExp("\\b"+z+"\\b").test(ne.className)}(Lt,z.cssClasses.tap)&&!Ye.doNotReject||le===mt.start&&void 0!==Wt.buttons&&Wt.buttons>1||Ye.hover&&Wt.buttons)return!1;Ae||Wt.preventDefault(),Wt.calcPoint=Wt.points[z.ort],Re(Wt,Ye)},Ct=[];return le.split(" ").forEach(function(_i){we.addEventListener(_i,kt,!!Ae&&{passive:!0}),Ct.push([_i,kt])}),Ct}function W(le){var Re=100*(le-function mi(ne,z){var Qe=ne.getBoundingClientRect(),mt=ne.ownerDocument,ht=mt.documentElement,Ae=Pi(mt);return/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(Ae.x=0),z?Qe.top+Ae.y-ht.clientTop:Qe.left+Ae.x-ht.clientLeft}(Y,z.ort))/ta();return Re=Hi(Re),z.dir?100-Re:Re}function _e(le,we){"mouseout"===le.type&&"HTML"===le.target.nodeName&&null===le.relatedTarget&&Ie(le,we)}function ze(le,we){if(-1===navigator.appVersion.indexOf("MSIE 9")&&0===le.buttons&&0!==we.buttonsProperty)return Ie(le,we);var Re=(z.dir?-1:1)*(le.calcPoint-we.startCalcPoint);X(Re>0,100*Re/we.baseSize,we.locations,we.handleNumbers,we.connect)}function Ie(le,we){we.handle&&(Nt(we.handle,z.cssClasses.active),Ia-=1),we.listeners.forEach(function(Re){Fn.removeEventListener(Re[0],Re[1])}),0===Ia&&(Nt(Lt,z.cssClasses.drag),Pn(),le.cursor&&(kr.style.cursor="",kr.removeEventListener("selectstart",R))),z.events.smoothSteps&&(we.handleNumbers.forEach(function(Re){Bn(Re,Wi[Re],!0,!0,!1,!1)}),we.handleNumbers.forEach(function(Re){D("update",Re)})),we.handleNumbers.forEach(function(Re){D("change",Re),D("set",Re),D("end",Re)})}function qt(le,we){if(!we.handleNumbers.some(ya)){var Re;1===we.handleNumbers.length&&(Ia+=1,Ve(Re=be[we.handleNumbers[0]].children[0],z.cssClasses.active)),le.stopPropagation();var kt=[],Ct=J(mt.move,Fn,ze,{target:le.target,handle:Re,connect:we.connect,listeners:kt,startCalcPoint:le.calcPoint,baseSize:ta(),pageOffset:le.pageOffset,handleNumbers:we.handleNumbers,buttonsProperty:le.buttons,locations:Wi.slice()}),_i=J(mt.end,Fn,Ie,{target:le.target,handle:Re,listeners:kt,doNotReject:!0,handleNumbers:we.handleNumbers}),Wt=J("mouseout",Fn,_e,{target:le.target,handle:Re,listeners:kt,doNotReject:!0,handleNumbers:we.handleNumbers});kt.push.apply(kt,Ct.concat(_i,Wt)),le.cursor&&(kr.style.cursor=getComputedStyle(le.target).cursor,be.length>1&&Ve(Lt,z.cssClasses.drag),kr.addEventListener("selectstart",R,!1)),we.handleNumbers.forEach(function(Cn){D("start",Cn)})}}function Ei(le){le.stopPropagation();var we=W(le.calcPoint),Re=function ie(le){var we=100,Re=!1;return be.forEach(function(Ye,kt){if(!ya(kt)){var Ct=Wi[kt],_i=Math.abs(Ct-le);(_i<we||_i<=we&&le>Ct||100===_i&&100===we)&&(Re=kt,we=_i)}}),Re}(we);!1!==Re&&(z.events.snap||Zi(Lt,z.cssClasses.tap,z.animationDuration),Bn(Re,we,!0,!0),Pn(),D("slide",Re,!0),D("update",Re,!0),z.events.snap?qt(le,{handleNumbers:[Re]}):(D("change",Re,!0),D("set",Re,!0)))}function ri(le){var we=W(le.calcPoint),Re=xi.getStep(we),Ye=xi.fromStepping(Re);Object.keys(Si).forEach(function(kt){"hover"===kt.split(".")[0]&&Si[kt].forEach(function(Ct){Ct.call(Fo,Ye)})})}function Gi(le,we){Si[le]=Si[le]||[],Si[le].push(we),"update"===le.split(".")[0]&&be.forEach(function(Re,Ye){D("update",Ye)})}function bt(le){var we=le&&le.split(".")[0],Re=we?le.substring(we.length):le;Object.keys(Si).forEach(function(Ye){var kt=Ye.split(".")[0],Ct=Ye.substring(kt.length);we&&we!==kt||Re&&Re!==Ct||function ce(le){return le===Bi.aria||le===Bi.tooltips}(Ct)&&Re!==Ct||delete Si[Ye]})}function D(le,we,Re){Object.keys(Si).forEach(function(Ye){var kt=Ye.split(".")[0];le===kt&&Si[Ye].forEach(function(Ct){Ct.call(Fo,Hn.map(z.format.to),we,Hn.slice(),Re||!1,Wi.slice(),Fo)})})}function U(le,we,Re,Ye,kt,Ct,_i){var Wt;return be.length>1&&!z.events.unconstrained&&(Ye&&we>0&&(Wt=xi.getAbsoluteDistance(le[we-1],z.margin,!1),Re=Math.max(Re,Wt)),kt&&we<be.length-1&&(Wt=xi.getAbsoluteDistance(le[we+1],z.margin,!0),Re=Math.min(Re,Wt))),be.length>1&&z.limit&&(Ye&&we>0&&(Wt=xi.getAbsoluteDistance(le[we-1],z.limit,!1),Re=Math.min(Re,Wt)),kt&&we<be.length-1&&(Wt=xi.getAbsoluteDistance(le[we+1],z.limit,!0),Re=Math.max(Re,Wt))),z.padding&&(0===we&&(Wt=xi.getAbsoluteDistance(0,z.padding[0],!1),Re=Math.max(Re,Wt)),we===be.length-1&&(Wt=xi.getAbsoluteDistance(100,z.padding[1],!0),Re=Math.min(Re,Wt))),_i||(Re=xi.getStep(Re)),!((Re=Hi(Re))===le[we]&&!Ct)&&Re}function F(le,we){var Re=z.ort;return(Re?we:le)+", "+(Re?le:we)}function X(le,we,Re,Ye,kt){var Ct=Re.slice(),_i=Ye[0],Wt=z.events.smoothSteps,Cn=[!le,le],hn=[le,!le];Ye=Ye.slice(),le&&Ye.reverse(),Ye.length>1?Ye.forEach(function(Nn,un){var rs=U(Ct,Nn,Ct[Nn]+we,Cn[un],hn[un],!1,Wt);!1===rs?we=0:(we=rs-Ct[Nn],Ct[Nn]=rs)}):Cn=hn=[!0];var Vn=!1;Ye.forEach(function(Nn,un){Vn=Bn(Nn,Re[Nn]+we,Cn[un],hn[un],!1,Wt)||Vn}),Vn&&(Ye.forEach(function(Nn){D("update",Nn),D("slide",Nn)}),null!=kt&&D("drag",_i))}function Ee(le,we){return z.dir?100-le-we:le}function Pn(){ns.forEach(function(le){be[le].style.zIndex=String(3+(be.length+(Wi[le]>50?-1:1)*le))})}function Bn(le,we,Re,Ye,kt,Ct){return kt||(we=U(Wi,le,we,Re,Ye,!1,Ct)),!1!==we&&(function Ot(le,we){Wi[le]=we,Hn[le]=xi.fromStepping(we);var Ye="translate("+F(Ee(we,0)-Ys+"%","0")+")";be[le].style[z.transformRule]=Ye,nr(le),nr(le+1)}(le,we),!0)}function nr(le){if(fe[le]){var we=0,Re=100;0!==le&&(we=Wi[le-1]),le!==fe.length-1&&(Re=Wi[le]);var Ye=Re-we,kt="translate("+F(Ee(we,Ye)+"%","0")+")",Ct="scale("+F(Ye/100,"1")+")";fe[le].style[z.transformRule]=kt+" "+Ct}}function Ur(le,we){return null===le||!1===le||void 0===le||("number"==typeof le&&(le=String(le)),!1!==(le=z.format.from(le))&&(le=xi.toStepping(le)),!1===le||isNaN(le))?Wi[we]:le}function ia(le,we,Re){var Ye=Bt(le),kt=void 0===Wi[0];we=void 0===we||we,z.animate&&!kt&&Zi(Lt,z.cssClasses.tap,z.animationDuration),ns.forEach(function(Wt){Bn(Wt,Ur(Ye[Wt],Wt),!0,!1,Re)});var Ct=1===ns.length?0:1;if(kt&&xi.hasNoSize()&&(Re=!0,Wi[0]=0,ns.length>1)){var _i=100/(ns.length-1);ns.forEach(function(Wt){Wi[Wt]=Wt*_i})}for(;Ct<ns.length;++Ct)ns.forEach(function(Wt){Bn(Wt,Wi[Wt],!0,!0,Re)});Pn(),ns.forEach(function(Wt){D("update",Wt),null!==Ye[Wt]&&we&&D("set",Wt)})}function ul(le){if(void 0===le&&(le=!1),le)return 1===Hn.length?Hn[0]:Hn.slice(0);var we=Hn.map(z.format.to);return 1===we.length?we[0]:we}function js(le){var we=Wi[le],Re=xi.getNearbySteps(we),Ye=Hn[le],kt=Re.thisStep.step,Ct=null;if(z.snap)return[Ye-Re.stepBefore.startValue||null,Re.stepAfter.startValue-Ye||null];!1!==kt&&Ye+kt>Re.stepAfter.startValue&&(kt=Re.stepAfter.startValue-Ye),Ct=Ye>Re.thisStep.startValue?Re.thisStep.step:!1!==Re.stepBefore.step&&Ye-Re.stepBefore.highestStep,100===we?kt=null:0===we&&(Ct=null);var _i=xi.countStepDecimals();return null!==kt&&!1!==kt&&(kt=Number(kt.toFixed(_i))),null!==Ct&&!1!==Ct&&(Ct=Number(Ct.toFixed(_i))),[Ct,kt]}!function ao(){Y=function Ro(le){return Ve(le,z.cssClasses.target),Ve(le,0===z.dir?z.cssClasses.ltr:z.cssClasses.rtl),Ve(le,0===z.ort?z.cssClasses.horizontal:z.cssClasses.vertical),Ve(le,"rtl"===getComputedStyle(le).direction?z.cssClasses.textDirectionRtl:z.cssClasses.textDirectionLtr),Is(le,z.cssClasses.base)}(Lt),function La(le,we){var Re=Is(we,z.cssClasses.connects);be=[],(fe=[]).push(Nr(Re,le[0]));for(var Ye=0;Ye<z.handles;Ye++)be.push(Qr(we,Ye)),ns[Ye]=Ye,fe.push(Nr(Re,le[Ye+1]))}(z.connect,Y),function Zn(le){le.fixed||be.forEach(function(we,Re){J(mt.start,we.children[0],qt,{handleNumbers:[Re]})}),le.tap&&J(mt.start,Y,Ei,{}),le.hover&&J(mt.move,Y,ri,{hover:!0}),le.drag&&fe.forEach(function(we,Re){if(!1!==we&&0!==Re&&Re!==fe.length-1){var Ye=be[Re-1],kt=be[Re],Ct=[we],_i=[Ye,kt],Wt=[Re-1,Re];Ve(we,z.cssClasses.draggable),le.fixed&&(Ct.push(Ye.children[0]),Ct.push(kt.children[0])),le.dragAll&&(_i=be,Wt=ns),Ct.forEach(function(Cn){J(mt.start,Cn,qt,{handles:_i,handleNumbers:Wt,connect:we})})}})}(z.events),ia(z.start),z.pips&&ea(z.pips),z.tooltips&&ro(),function Fs(){bt("update"+Bi.aria),Gi("update"+Bi.aria,function(le,we,Re,Ye,kt){ns.forEach(function(Ct){var _i=be[Ct],Wt=U(Wi,Ct,0,!0,!0,!0),Cn=U(Wi,Ct,100,!0,!0,!0),hn=kt[Ct],Vn=String(z.ariaFormat.to(Re[Ct]));Wt=xi.fromStepping(Wt).toFixed(1),Cn=xi.fromStepping(Cn).toFixed(1),hn=xi.fromStepping(hn).toFixed(1),_i.children[0].setAttribute("aria-valuemin",Wt),_i.children[0].setAttribute("aria-valuemax",Cn),_i.children[0].setAttribute("aria-valuenow",hn),_i.children[0].setAttribute("aria-valuetext",Vn)})})}()}();var Fo={destroy:function zr(){for(bt(Bi.aria),bt(Bi.tooltips),Object.keys(z.cssClasses).forEach(function(le){Nt(Lt,z.cssClasses[le])});Lt.firstChild;)Lt.removeChild(Lt.firstChild);delete Lt.noUiSlider},steps:function oc(){return ns.map(js)},on:Gi,off:bt,get:ul,set:ia,setHandle:function ac(le,we,Re,Ye){if(!((le=Number(le))>=0&&le<ns.length))throw new Error("noUiSlider: invalid handle number, got: "+le);Bn(le,Ur(we,le),!0,!0,Ye),D("update",le),Re&&D("set",le)},reset:function Lo(le){ia(z.start,le)},disable:function gn(le){null!=le?(be[le].setAttribute("disabled",""),be[le].handle.removeAttribute("tabindex")):(Lt.setAttribute("disabled",""),be.forEach(function(we){we.handle.removeAttribute("tabindex")}))},enable:function Ls(le){null!=le?(be[le].removeAttribute("disabled"),be[le].handle.setAttribute("tabindex","0")):(Lt.removeAttribute("disabled"),be.forEach(function(we){we.removeAttribute("disabled"),we.handle.setAttribute("tabindex","0")}))},__moveHandles:function(le,we,Re){X(le,we,Wi,Re)},options:Qe,updateOptions:function gd(le,we){var Re=ul(),Ye=["margin","limit","padding","range","animate","snap","step","format","pips","tooltips"];Ye.forEach(function(Ct){void 0!==le[Ct]&&(Qe[Ct]=le[Ct])});var kt=ge(Qe);Ye.forEach(function(Ct){void 0!==le[Ct]&&(z[Ct]=kt[Ct])}),xi=kt.spectrum,z.margin=kt.margin,z.limit=kt.limit,z.padding=kt.padding,z.pips?ea(z.pips):ss(),z.tooltips?ro():xa(),Wi=[],ia(d(le.start)?le.start:Re,we)},target:Lt,removePips:ss,removeTooltips:xa,getPositions:function(){return Wi.slice()},getTooltips:function(){return Tt},getOrigins:function(){return be},pips:ea};return Fo}function je(ne,z){if(!ne||!ne.nodeName)throw new Error("noUiSlider: create requires a single element, got: "+ne);if(ne.noUiSlider)throw new Error("noUiSlider: Slider was already initialized.");var mt=Ne(ne,ge(z),z);return ne.noUiSlider=mt,mt}var Zt={__spectrum:ut,cssClasses:Qt,create:je};V.create=je,V.cssClasses=Qt,V.default=Zt,Object.defineProperty(V,"__esModule",{value:!0})}(zt)},9286:(ot,zt,V)=>{"use strict";V.d(zt,{g:()=>Zi});var x=V(8634),A=V(5623),ke=V(1813),d=V(1105),R=V(7376),Li=V(5130),Qi=V(6974);function mi(Hi,Bt){return Bt?tt=>(0,A.z)(Bt.pipe((0,ke.q)(1),(0,d.l)()),tt.pipe(mi(Hi))):(0,Li.z)((tt,Ve)=>(0,Qi.Xf)(Hi(tt,Ve)).pipe((0,ke.q)(1),(0,R.h)(tt)))}var $t=V(553);function Zi(Hi,Bt=x.z){const tt=(0,$t.H)(Hi,Bt);return mi(()=>tt)}},6228:(ot,zt,V)=>{"use strict";V.r(zt),V.d(zt,{SkeletonModule:()=>RH});var x=V(6733),A=V(3226),ke=V(5323),d=V(755),R=V(4220);let Bt=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275mod=d.oAB({type:s});static#i=this.\u0275inj=d.cJS({imports:[R.BQ,R.BQ]})}return s})();var tt=V(3753);V(2405);let cs=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275mod=d.oAB({type:s});static#i=this.\u0275inj=d.cJS({imports:[x.ez,R.BQ,tt.ZD,tt.ZD,R.BQ]})}return s})();var pn=V(393),fn=V(5863),jn=V(9984),Vi=V(2561),bn=(V(8491),V(902),V(5047)),gi=V(8748),is=V(6124);let Tn=(()=>{class s{constructor(){this._vertical=!1,this._inset=!1}get vertical(){return this._vertical}set vertical(t){this._vertical=(0,Vi.Ig)(t)}get inset(){return this._inset}set inset(t){this._inset=(0,Vi.Ig)(t)}static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(i,n){2&i&&(d.uIk("aria-orientation",n.vertical?"vertical":"horizontal"),d.ekj("mat-divider-vertical",n.vertical)("mat-divider-horizontal",!n.vertical)("mat-divider-inset",n.inset))},inputs:{vertical:"vertical",inset:"inset"},decls:0,vars:0,template:function(i,n){},styles:[".mat-divider{--mat-divider-width:1px;display:block;margin:0;border-top-style:solid;border-top-color:var(--mat-divider-color);border-top-width:var(--mat-divider-width)}.mat-divider.mat-divider-vertical{border-top:0;border-right-style:solid;border-right-color:var(--mat-divider-color);border-right-width:var(--mat-divider-width)}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}"],encapsulation:2,changeDetection:0})}return s})(),Sn=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275mod=d.oAB({type:s});static#i=this.\u0275inj=d.cJS({imports:[R.BQ,R.BQ]})}return s})();var dt=V(7583),Ni=V(5981),he=(V(5262),V(1749));let Ma=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275mod=d.oAB({type:s});static#i=this.\u0275inj=d.cJS({imports:[is.Q8,x.ez,R.BQ,R.si,R.us,Sn]})}return s})();var ss=V(6424);const ea=JSON.parse('{"language":"english","short":"en","direction":"ltr","preferred-font":"Roboto, sans-serif","home":"Home","page-one":"Page One","page-two":"Page Two","sub-one":"Sub One","sub-two":"Sub Two","sub-three":"Sub Three","sub-four":"Sub Four"}'),ta=JSON.parse('{"language":"farsi","short":"fa","direction":"rtl","preferred-font":"irsans, tahoma, sans-serif","home":"\u062e\u0627\u0646\u0647","page-one":"\u0635\u0641\u062d\u0647 \u0627\u0648\u0644","page-two":"\u0635\u0641\u062d\u0647 \u062f\u0648\u0645","sub-one":"\u0632\u06cc\u0631\u0645\u062c\u0645\u0648\u0639\u0647 \u0627\u0648\u0644","sub-two":"\u0632\u06cc\u0631\u0645\u062c\u0645\u0648\u0639\u0647 \u062f\u0648\u0645","sub-three":"\u0632\u06cc\u0631\u0645\u062c\u0645\u0648\u0639\u0647 \u0633\u0648\u0645","sub-four":"\u0632\u06cc\u0631\u0645\u062c\u0645\u0648\u0639\u0647 \u0686\u0647\u0627\u0631\u0645","Activity":"\u0641\u0639\u0627\u0644\u06cc\u062a \u0647\u0627","Settings":"\u062a\u0646\u0638\u06cc\u0645\u0627\u062a"}'),J=JSON.parse('{"name":"light","toolbars_bg":"#f6f6f6","toolbars_text":"#747373","sidebars_bg":"#f6f6f6","sidebars_text":"#747373","dashboard_bg":"#ffffff","dashboard_text":"#1526cc","cards_bg":"#f6f6f6","cards_text":"#000000","menu_hover_bg":"#f6f6f6","menu_hover_text":"#000000"}'),_t=JSON.parse('{"name":"dark","toolbars_bg":"#212123","toolbars_text":"#ffffff","sidebars_bg":"#212123","sidebars_text":"#ffffff","dashboard_bg":"#999","dashboard_text":"#999","cards_bg":"#212123","cards_text":"#ffffff","menu_hover_bg":"#ffffff","menu_hover_text":"#000000"}');var W=V(3232);let ie=(()=>{class s{constructor(t){this.titleService=t,this.menuType=new ss.X(localStorage.getItem("menuType")??"full"),this.menuShow=new ss.X(!0),this.notificationsCount=new ss.X(0),this.language=localStorage.getItem("language")??"english",this.language_data={},this.theme=localStorage.getItem("theme")??"light",this.themeColors_custom=JSON.parse(JSON.stringify(J)),this.themeActiveColors=JSON.parse(JSON.stringify(J)),this.loadLanguageData(this.language),null!=localStorage.getItem("themeColors_custom")&&(this.themeColors_custom=JSON.parse(localStorage.getItem("themeColors_custom")??"")),"dark"===this.theme?this.themeActiveColors=JSON.parse(JSON.stringify(_t)):"custom"===this.theme&&(this.themeActiveColors=JSON.parse(JSON.stringify(this.themeColors_custom))),this.setThemeColors()}getNotifications(){this.notificationsCount.next(15)}loadLanguageData(t){"english"===t&&(this.language_data=ea),"farsi"===t&&(this.language_data=ta)}translate(t,i){return"english"===i?ea[t]??t:"farsi"===i?ta[t]??t:void 0}setThemeColors(){let t="\n\t\t<style>\n\t\t\t.toolbars-bg { background-color: toolbars_bg; }\n\t\t\t.toolbars-text { color: toolbars_text; }\n\t\t\t.sidebars-bg { background-color: sidebars_bg; }\n\t\t\t.sidebars-text { color: sidebars_text; }\n\t\t\t.dashboard-bg { background-color: dashboard_bg; }\n\t\t\t.dashboard-text { color: dashboard_text; }\n\t\t\t.cards-bg { background-color: cards_bg; }\n\t\t\t.cards-text { color: cards_text; }\n\t\t\t.menu-hover:hover { background-color: menu_hover_bg; color: menu_hover_text }\n\t\t</style>\n\t\t";Object.keys(this.themeActiveColors).forEach(n=>{t=t.replace(n,this.themeActiveColors[n])}),$("head").append(t)}set_pageTitle(t){this.titleService.setTitle(t)}getRouteParams(){let t=window.location.pathname.split("/"),i=[],n="";return t.forEach((r,a)=>{r.length>0&&(n=n+"/"+r,i.push({param:r,link:n,label:this.translate(r,this.language)}))}),i}static#e=this.\u0275fac=function(i){return new(i||s)(d.LFG(W.Dx))};static#t=this.\u0275prov=d.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var _e=V(2932),ze=V(4185),Ie=V(5301),qt=V(1603),Ei=V(4787),ri=V(2425),Di=V(1813),Zn=V(1570),Gi=V(1301),ce=V(5644),D=(V(1070),V(1209));V(5667);class F{constructor(){this.expansionModel=new Ni.Ov(!0)}toggle(e){this.expansionModel.toggle(this._trackByValue(e))}expand(e){this.expansionModel.select(this._trackByValue(e))}collapse(e){this.expansionModel.deselect(this._trackByValue(e))}isExpanded(e){return this.expansionModel.isSelected(this._trackByValue(e))}toggleDescendants(e){this.expansionModel.isSelected(this._trackByValue(e))?this.collapseDescendants(e):this.expandDescendants(e)}collapseAll(){this.expansionModel.clear()}expandDescendants(e){let t=[e];t.push(...this.getDescendants(e)),this.expansionModel.select(...t.map(i=>this._trackByValue(i)))}collapseDescendants(e){let t=[e];t.push(...this.getDescendants(e)),this.expansionModel.deselect(...t.map(i=>this._trackByValue(i)))}_trackByValue(e){return this.trackBy?this.trackBy(e):e}}class X extends F{constructor(e,t,i){super(),this.getLevel=e,this.isExpandable=t,this.options=i,this.options&&(this.trackBy=this.options.trackBy)}getDescendants(e){const i=[];for(let n=this.dataNodes.indexOf(e)+1;n<this.dataNodes.length&&this.getLevel(e)<this.getLevel(this.dataNodes[n]);n++)i.push(this.dataNodes[n]);return i}expandAll(){this.expansionModel.select(...this.dataNodes.map(e=>this._trackByValue(e)))}}let Ye=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275mod=d.oAB({type:s});static#i=this.\u0275inj=d.cJS({})}return s})(),rs=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275mod=d.oAB({type:s});static#i=this.\u0275inj=d.cJS({imports:[Ye,R.BQ,R.BQ]})}return s})();class Bs{constructor(e,t,i,n){this.transformFunction=e,this.getLevel=t,this.isExpandable=i,this.getChildren=n}_flattenNode(e,t,i,n){const r=this.transformFunction(e,t);if(i.push(r),this.isExpandable(r)){const a=this.getChildren(e);a&&(Array.isArray(a)?this._flattenChildren(a,t,i,n):a.pipe((0,Di.q)(1)).subscribe(o=>{this._flattenChildren(o,t,i,n)}))}return i}_flattenChildren(e,t,i,n){e.forEach((r,a)=>{let o=n.slice();o.push(a!=e.length-1),this._flattenNode(r,t+1,i,o)})}flattenNodes(e){let t=[];return e.forEach(i=>this._flattenNode(i,0,t,[])),t}expandFlattenedNodes(e,t){let i=[],n=[];return n[0]=!0,e.forEach(r=>{let a=!0;for(let o=0;o<=this.getLevel(r);o++)a=a&&n[o];a&&i.push(r),this.isExpandable(r)&&(n[this.getLevel(r)+1]=t.isExpanded(r))}),i}}class gs extends Ni.o2{get data(){return this._data.value}set data(e){this._data.next(e),this._flattenedData.next(this._treeFlattener.flattenNodes(this.data)),this._treeControl.dataNodes=this._flattenedData.value}constructor(e,t,i){super(),this._treeControl=e,this._treeFlattener=t,this._flattenedData=new ss.X([]),this._expandedData=new ss.X([]),this._data=new ss.X([]),i&&(this.data=i)}connect(e){return(0,bn.T)(e.viewChange,this._treeControl.expansionModel.changed,this._flattenedData).pipe((0,ri.U)(()=>(this._expandedData.next(this._treeFlattener.expandFlattenedNodes(this._flattenedData.value,this._treeControl)),this._expandedData.value)))}disconnect(){}}var Na=V(8089);function lc(s,e){1&s&&d.GkF(0)}const ml=function(s){return{node:s}};function _d(s,e){if(1&s&&(d.ynx(0),d.YNc(1,lc,1,0,"ng-container",8),d.BQk()),2&s){const t=e.$implicit;d.oxw(2);const i=d.MAs(7);d.xp6(1),d.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",d.VKq(2,ml,t))}}function cc(s,e){if(1&s&&(d.TgZ(0,"div",6),d.YNc(1,_d,2,4,"ng-container",7),d.qZA()),2&s){const t=d.oxw();d.xp6(1),d.Q6J("ngForOf",t.menuItems)}}function nu(s,e){1&s&&d._UZ(0,"mat-divider",13)}function dc(s,e){if(1&s){const t=d.EpF();d.TgZ(0,"button",18),d.NdJ("click",function(){d.CHM(t);const n=d.oxw(2).node,r=d.oxw();return d.KtG(r.toggleSubMenu(n))}),d.TgZ(1,"mat-icon",19),d._uU(2),d.qZA()()}if(2&s){const t=d.oxw(2).node;d.xp6(2),d.hij(" ",t.isOpen?"expand_more":"chevron_right"," ")}}function c_(s,e){if(1&s&&(d.TgZ(0,"mat-icon",20),d._uU(1),d.qZA()),2&s){const t=d.oxw(2).node;d.xp6(1),d.hij(" ",t.icon," ")}}function sr(s,e){if(1&s){const t=d.EpF();d.TgZ(0,"div",14),d.YNc(1,dc,3,1,"button",15),d.YNc(2,c_,2,1,"mat-icon",16),d.TgZ(3,"span",17),d.NdJ("click",function(){d.CHM(t);const n=d.oxw().node,r=d.oxw();return d.KtG(r.toggleSubMenu(n))}),d._uU(4),d.qZA()()}if(2&s){const t=d.oxw().node;d.xp6(1),d.Q6J("ngIf",t.sub&&t.sub.length>0),d.xp6(1),d.Q6J("ngIf",t.icon),d.xp6(1),d.ekj("active-node",t.isActive),d.xp6(1),d.hij(" ",t.label," ")}}function Wm(s,e){1&s&&d.GkF(0)}function pl(s,e){if(1&s&&(d.ynx(0),d.YNc(1,Wm,1,0,"ng-container",8),d.BQk()),2&s){const t=e.$implicit;d.oxw(3);const i=d.MAs(7);d.xp6(1),d.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",d.VKq(2,ml,t))}}function fl(s,e){if(1&s&&(d.TgZ(0,"div",21),d.YNc(1,pl,2,4,"ng-container",7),d.qZA()),2&s){const t=d.oxw().node;d.xp6(1),d.Q6J("ngForOf",t.sub)}}function gl(s,e){if(1&s&&(d.TgZ(0,"div",9),d.YNc(1,nu,1,0,"mat-divider",10),d.YNc(2,sr,5,5,"div",11),d.YNc(3,fl,2,1,"div",12),d.qZA()),2&s){const t=e.node;d.Udp("padding-left",t.sub&&t.sub.length>0?"0":t.left?t.left+"px":"3px"),d.xp6(1),d.Q6J("ngIf","divider"===t.id),d.xp6(1),d.Q6J("ngIf","divider"!==t.id),d.xp6(1),d.Q6J("ngIf",t.sub&&t.isOpen)}}const Gm=function(s,e){return{backgroundColor:s,color:e}};let Ym=(()=>{class s{constructor(t,i,n,r){this.panelService=t,this.store=i,this.sharedStore=n,this.transmit=r,this.menuType="full",this.version=Na.N.VERSION,this.routeParams=[],this._transformer=(a,o)=>({expandable:!!a.sub&&a.sub.length>0,detail:a,level:o}),this.treeControl=new X(a=>a.level,a=>a.expandable),this.treeFlattener=new Bs(this._transformer,a=>a.level,a=>a.expandable,a=>a.sub),this.dataSource=new gs(this.treeControl,this.treeFlattener),this.menuItems=[],this.hasChild=(a,o)=>o.expandable}ngOnInit(){this.store.select(ze.r7).subscribe(t=>{this.transmit.emit("menu-item-clicked",void 0),this.menuItems=JSON.parse(JSON.stringify(t??[])),this.menuItems&&this.menuItems.length>0&&setTimeout(()=>{this.autoSelectFirstDashboard(this.menuItems[0])},300),this.menuItems.push({id:"user",left:10,label:"Users",sub:[]}),this.menuItems.push({id:"certificate",left:10,label:"Certificate",type:"certificate"}),this.menuItems.push({id:"trend",left:10,label:"Trend",type:"trend"}),this.menuItems.push({id:"settings",left:10,label:"Setting",sub:[]}),this.menuItems.push({id:"support",left:10,label:"Support",sub:[]})}),this.panelService.menuType.subscribe(t=>{this.menuType=t})}ngAfterViewInit(){"compact"===this.menuType&&this.controlCompactMenu()}controlCompactMenu(){this.closeCompactMenu(),$("#cmp-menu-side.menu-compact").mouseenter(()=>{this.openCompactMenu()}),$("#cmp-menu-side.menu-compact").mouseleave(()=>{this.closeCompactMenu()})}openCompactMenu(){$("#cmp-menu-side.menu-compact").velocity({width:"250px"},100,()=>{$("#cmp-menu-side.menu-compact").addClass("open"),$("#cmp-menu-side.menu-compact .item .label2 .title").show(0)})}closeCompactMenu(){$("#cmp-menu-side.menu-compact").velocity({width:"50px"},100,()=>{$("#cmp-menu-side.menu-compact").removeClass("open"),$("#cmp-menu-side.menu-compact .item .label2 .title").hide(0),$("#cmp-menu-side.menu-compact .item.open .sub").hide(0)})}autoSelectFirstDashboard(t){const i=t.sub&&t.sub.length>0;i||"dashboard"!==t.type&&"dataEntry"!==t.type&&"excel"!==t.type&&"report"!==t.type?i&&(t.isOpen=!0,this.autoSelectFirstDashboard(t.sub[0])):this.toggleSubMenu(t)}inactiveAllMenuItems(t){for(const i of t)i.isActive=!1,i.sub&&this.inactiveAllMenuItems(i.sub)}toggleSubMenu(t){if("mini"!==this.menuType){if(t.sub&&t.sub.length>0)return void(t.isOpen=!t.isOpen);this.inactiveAllMenuItems(this.menuItems),t.isActive=!0,this.transmit.emit("menu-item-clicked",t)}}openSubMenu(t){$("#"+t).addClass("open"),$("#"+t+" .sub").show(100)}closeSubMenu(t){$("#"+t).removeClass("open"),$("#"+t+" .sub").hide(100)}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(ie),d.Y36(Ie.yh),d.Y36(Ie.yh),d.Y36(qt.U))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-menu-side"]],inputs:{skeletonConfig:"skeletonConfig"},decls:8,vars:10,consts:[["id","cmp-menu-side",3,"ngStyle"],[1,"logo"],["src","./assets/logo.svg","alt",""],[1,"version"],["class","node-list",4,"ngIf"],["treeNode",""],[1,"node-list"],[4,"ngFor","ngForOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"node-item"],["style","margin: 5px 0",4,"ngIf"],["class","text",4,"ngIf"],["class","node-children",4,"ngIf"],[2,"margin","5px 0"],[1,"text"],["mat-icon-button","","class","expansion-icon",3,"click",4,"ngIf"],["style","overflow: unset !important;     margin-right: 5px;","class","",4,"ngIf"],[1,"pointer",3,"click"],["mat-icon-button","",1,"expansion-icon",3,"click"],[1,"mat-icon-rtl-mirror",2,"overflow","unset !important"],[1,"",2,"overflow","unset !important","margin-right","5px"],[1,"node-children"]],template:function(i,n){1&i&&(d.TgZ(0,"div",0)(1,"div",1),d._UZ(2,"img",2),d.TgZ(3,"div",3),d._uU(4),d.qZA()(),d.YNc(5,cc,2,1,"div",4),d.qZA(),d.YNc(6,gl,4,5,"ng-template",null,5,d.W1O)),2&i&&(d.MT6("",n.panelService.language_data.direction," menu-",n.menuType," sidebars-bg sidebars-text"),d.Q6J("ngStyle",d.WLB(7,Gm,n.skeletonConfig.sidebarColor,n.skeletonConfig.sidebarTextColor)),d.xp6(4),d.hij("version ",n.version,""),d.xp6(1),d.Q6J("ngIf",n.menuItems&&n.menuItems.length>0))},dependencies:[x.sg,x.O5,x.tP,x.PC,pn.RK,jn.Hw,Tn],styles:["#cmp-menu-side{height:100vh;overflow-y:hidden;display:none}#cmp-menu-side .logo{padding:30px 15px;text-align:center;display:flex;flex-direction:column;align-items:center}#cmp-menu-side .logo img{width:80%}#cmp-menu-side .logo .version{font-size:.9em;margin-top:.5em}#cmp-menu-side .accordion-item-body ul{display:grid;padding:0;margin:0;gap:0;list-style:none}#cmp-menu-side .accordion-item-body ul li{display:grid;grid-template-columns:1fr 2fr;border:1px solid #aaaaaa;padding:.5rem}#cmp-menu-side .accordion-item-body ul li:not(:first-child){border-top:none}#cmp-menu-side .accordion-item-body ul li label{display:flex;align-items:center;justify-content:flex-start}#cmp-menu-side .accordion-item-body ul li img{width:40px;height:40px}#cmp-menu-side .items{max-height:80vh;overflow-y:auto;overflow-x:hidden}#cmp-menu-side.menu-full{display:block;width:200px}#cmp-menu-side.menu-full .items .item{display:flex;flex-wrap:wrap;align-items:center;margin-bottom:10px}#cmp-menu-side.menu-full .items .item .label2{display:flex;align-items:center;flex-grow:1;height:40px}#cmp-menu-side.menu-full .items .item .label2 .icon{margin:0 10px}#cmp-menu-side.menu-full .items .item .label2 .title{flex-grow:1;white-space:nowrap}#cmp-menu-side.menu-full .items .item .label2:hover{box-shadow:0 3px 5px #bbb}#cmp-menu-side.menu-full .items .item .label2.active{color:#000;background-color:#fff;box-shadow:0 3px 5px #bbb}#cmp-menu-side.menu-full .items .item .sub{width:100%;display:none}#cmp-menu-side.menu-full .items .item .sub .sub-item{display:flex;align-items:center;margin-bottom:5px;height:40px}#cmp-menu-side.menu-full .items .item .sub .sub-item .icon{margin:0 10px;height:20px}#cmp-menu-side.menu-full .items .item .sub .sub-item .icon *{font-size:20px}#cmp-menu-side.menu-full .items .item .sub .sub-item .title{font-size:13px;white-space:nowrap}#cmp-menu-side.menu-full .items .item .sub .sub-item:hover{background-color:#fff;box-shadow:0 3px 5px #bbb}#cmp-menu-side.menu-full .items .item .sub .sub-item.active{color:#000;background-color:#fff;box-shadow:0 3px 5px #bbb}#cmp-menu-side.menu-full .items .item.open .sub,#cmp-menu-side.menu-compact{display:block}#cmp-menu-side.menu-compact:not(.open) .logo{padding:15px 5px;text-align:center}#cmp-menu-side.menu-compact:not(.open) .logo img{width:100%}#cmp-menu-side.menu-compact .items .item{display:flex;flex-wrap:wrap;align-items:center;margin-bottom:10px}#cmp-menu-side.menu-compact .items .item .label2{display:flex;align-items:center;flex-grow:1;height:40px;border-left:4px solid transparent;border-right:4px solid transparent}#cmp-menu-side.menu-compact .items .item .label2 .icon{margin:0 10px;height:24px}#cmp-menu-side.menu-compact .items .item .label2 .title{flex-grow:1;white-space:nowrap;display:none}#cmp-menu-side.menu-compact .items .item .label2:hover{box-shadow:0 3px 5px #bbb}#cmp-menu-side.menu-compact .items .item .label2.active{color:#000;background-color:#fff;box-shadow:0 3px 5px #bbb}#cmp-menu-side.menu-compact .items .item .sub{width:100%;display:none}#cmp-menu-side.menu-compact .items .item .sub .sub-item{display:flex;align-items:center;margin-bottom:5px;height:40px}#cmp-menu-side.menu-compact .items .item .sub .sub-item .icon{margin:0 10px;height:20px}#cmp-menu-side.menu-compact .items .item .sub .sub-item .icon *{font-size:20px}#cmp-menu-side.menu-compact .items .item .sub .sub-item .title{font-size:13px;white-space:nowrap}#cmp-menu-side.menu-compact .items .item .sub .sub-item:hover{background-color:#fff;box-shadow:0 3px 5px #bbb}#cmp-menu-side.menu-compact .items .item .sub .sub-item.active,#cmp-menu-side.menu-compact .items .item.open .label2{color:#000;background-color:#fff;box-shadow:0 3px 5px #bbb}#cmp-menu-side.menu-compact .items .item.open .sub{display:block}#cmp-menu-side.menu-mini{display:block;height:95vh;width:auto;overflow:hidden}#cmp-menu-side.menu-mini .logo{padding:15px 0}#cmp-menu-side.menu-mini .logo img{width:auto;height:15px}#cmp-menu-side.menu-mini .items{overflow-y:auto;min-height:90vh}#cmp-menu-side.menu-mini .items .item{margin-bottom:10px;position:relative;display:block}#cmp-menu-side.menu-mini .items .item .label2{display:grid;grid-template-columns:2fr 10fr}#cmp-menu-side.menu-mini .items .item .label2 .icon{margin-bottom:5px;height:24px;width:100%;text-align:center}#cmp-menu-side.menu-mini .items .item .label2 .title{display:block;text-align:center;width:100%;white-space:nowrap}#cmp-menu-side.menu-mini .items .item .label2:hover{box-shadow:0 3px 5px #bbb}#cmp-menu-side.menu-mini .items .item .label2.active,#cmp-menu-side.menu-mini .items .item.open .label2{color:#000;background-color:#fff;box-shadow:0 3px 5px #bbb}#cmp-menu-side.menu-mini .items .item .sub{display:none;position:absolute;top:0;background-color:#f1f1f1;box-shadow:10px 10px 20px 10px #0000004d;z-index:1;overflow:hidden;width:100%}#cmp-menu-side.menu-mini .items .item .sub .sub-item{color:#000;padding:10px;text-decoration:none;display:flex;align-items:center}#cmp-menu-side.menu-mini .items .item .sub .sub-item .icon{height:20px}#cmp-menu-side.menu-mini .items .item .sub .sub-item .icon *{font-size:20px}#cmp-menu-side.menu-mini .items .item .sub .sub-item .title{font-size:13px;white-space:nowrap}#cmp-menu-side.menu-mini .items .item .sub .sub-item:hover,#cmp-menu-side.menu-mini .items .item .sub .sub-item.active{background-color:#fff;box-shadow:0 3px 5px #bbb}#cmp-menu-side.menu-mini .items .item:hover .sub{display:block}#cmp-menu-side.ltr.menu-full .items .item .label2{border-left:4px solid transparent}#cmp-menu-side.ltr.menu-full .items .item .label2.active{border-left-color:#1526cc}#cmp-menu-side.ltr.menu-full .items .item .sub .sub-item{padding-left:15px;border-left:4px solid transparent}#cmp-menu-side.ltr.menu-full .items .item .sub .sub-item.active,#cmp-menu-side.ltr.menu-compact .items .item .label2.active{border-left-color:#1526cc}#cmp-menu-side.ltr.menu-compact .items .item .sub .sub-item{padding-left:15px;border-left:4px solid transparent}#cmp-menu-side.ltr.menu-compact .items .item .sub .sub-item.active{border-left-color:#1526cc}#cmp-menu-side.ltr.menu-mini .items .item .label2{border-left:4px solid transparent}#cmp-menu-side.ltr.menu-mini .items .item .label2.active{border-left-color:#1526cc}#cmp-menu-side.ltr.menu-mini .items .item .sub{left:0;width:100%}#cmp-menu-side.ltr.menu-mini .items .item .sub .sub-item{border-left:4px solid transparent}#cmp-menu-side.ltr.menu-mini .items .item .sub .sub-item .icon{margin-right:10px}#cmp-menu-side.ltr.menu-mini .items .item .sub .sub-item.active{border-left-color:#1526cc}#cmp-menu-side.rtl.menu-full .items .item .label2{border-right:4px solid transparent}#cmp-menu-side.rtl.menu-full .items .item .label2.active{border-right-color:#1526cc}#cmp-menu-side.rtl.menu-full .items .item .sub .sub-item{padding-right:15px;border-right:4px solid transparent}#cmp-menu-side.rtl.menu-full .items .item .sub .sub-item.active,#cmp-menu-side.rtl.menu-compact .items .item .label2.active{border-right-color:#1526cc}#cmp-menu-side.rtl.menu-compact .items .item .sub .sub-item{padding-right:15px;border-right:4px solid transparent}#cmp-menu-side.rtl.menu-compact .items .item .sub .sub-item.active{border-right-color:#1526cc}#cmp-menu-side.rtl.menu-mini .items .item .label2{border-right:4px solid transparent}#cmp-menu-side.rtl.menu-mini .items .item .label2.active{border-right-color:#1526cc}#cmp-menu-side.rtl.menu-mini .items .item .sub{right:0;width:100%}#cmp-menu-side.rtl.menu-mini .items .item .sub .sub-item{border-right:4px solid transparent}#cmp-menu-side.rtl.menu-mini .items .item .sub .sub-item .icon{margin-left:10px}#cmp-menu-side.rtl.menu-mini .items .item .sub .sub-item.active{border-right-color:#1526cc}.pointer{cursor:pointer;font-size:.75em;opacity:.85;transition:all .3s}.pointer:hover{opacity:1}.expantion-icon{width:30px!important;padding:7px!important;height:30px!important;display:flex!important;align-items:center!important;justify-content:center!important}.active-node{color:#000;font-weight:700;opacity:1;transition:all .3s}.node-list{overflow:auto;display:flex;flex-direction:column;flex:1 1 0}.node-item{display:flex;flex-direction:column;padding:3px 6px}.node-item .text{display:flex;align-items:center}.node-item .expansion-icon{width:25px;height:25px;display:flex;align-items:center;justify-content:center}.node-item .expansion-icon mat-icon{font-size:.8em;width:unset;height:unset}.node-item .node-children{padding-left:23px;display:flex;flex-direction:column}#cmp-menu-side{display:flex!important;flex-direction:column}\n"],encapsulation:2})}return s})();function d_(s,e){if(1&s&&(d.TgZ(0,"a",7)(1,"div",8)(2,"span",9),d._uU(3),d.qZA()(),d.TgZ(4,"span",10),d._uU(5),d.qZA()()),2&s){const t=d.oxw().$implicit,i=d.oxw();d.s9C("routerLink",t.target),d.xp6(3),d.Oqu(t.material_icon),d.xp6(2),d.Oqu(i.panelService.translate(t.label,i.panelService.language))}}function su(s,e){if(1&s&&(d.TgZ(0,"span",11)(1,"div",8)(2,"span",9),d._uU(3),d.qZA()(),d.TgZ(4,"span",10),d._uU(5),d.qZA()()),2&s){const t=d.oxw().$implicit,i=d.oxw();d.xp6(3),d.Oqu(t.material_icon),d.xp6(2),d.Oqu(i.panelService.translate(t.label,i.panelService.language))}}function jm(s,e){if(1&s&&(d.TgZ(0,"a",14)(1,"div",8)(2,"span",9),d._uU(3),d.qZA()(),d.TgZ(4,"span",10),d._uU(5),d.qZA()()),2&s){const t=e.$implicit,i=d.oxw(3);d.s9C("routerLink",t.target),d.xp6(3),d.Oqu(t.material_icon),d.xp6(2),d.Oqu(i.panelService.translate(t.label,i.panelService.language))}}function ru(s,e){if(1&s&&(d.TgZ(0,"div",12),d.YNc(1,jm,6,3,"a",13),d.qZA()),2&s){const t=d.oxw().$implicit;d.xp6(1),d.Q6J("ngForOf",null==t?null:t.sub)}}function h_(s,e){if(1&s&&(d.TgZ(0,"div",3),d.YNc(1,d_,6,3,"a",4),d.YNc(2,su,6,2,"span",5),d.YNc(3,ru,2,1,"div",6),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Q6J("ngIf",t.hasOwnProperty("target")),d.xp6(1),d.Q6J("ngIf",!t.hasOwnProperty("target")),d.xp6(1),d.Q6J("ngIf",t.hasOwnProperty("sub"))}}let u_=(()=>{class s{constructor(t,i){this.panelService=t,this.store=i,this.menu=(0,D.of)([])}ngOnInit(){this.menu=this.store.select(ze.r7).pipe()}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(ie),d.Y36(Ie.yh))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-menu-static"]],decls:4,vars:6,consts:[["id","cmp-menu-static"],[1,"items"],["class","item dropdown2",4,"ngFor","ngForOf"],[1,"item","dropdown2"],["class","label2",3,"routerLink",4,"ngIf"],["class","label2",4,"ngIf"],["class","sub",4,"ngIf"],[1,"label2",3,"routerLink"],[1,"icon"],[1,"material-icons"],[1,"title"],[1,"label2"],[1,"sub"],["class","sub-item",3,"routerLink",4,"ngFor","ngForOf"],[1,"sub-item",3,"routerLink"]],template:function(i,n){1&i&&(d.TgZ(0,"div",0)(1,"div",1),d.YNc(2,h_,4,3,"div",2),d.ALo(3,"async"),d.qZA()()),2&i&&(d.Gre("",n.panelService.language_data.direction," toolbars-bg toolbars-text"),d.xp6(2),d.Q6J("ngForOf",d.lcZ(3,4,n.menu)))},dependencies:[x.sg,x.O5,_e.rH,x.Ov],styles:["#cmp-menu-static .items{display:flex;flex-wrap:wrap;padding:5px;overflow:visible}#cmp-menu-static .items .item{margin:5px;padding:5px 10px;position:relative;display:inline-block;background-color:#0000001a;border-radius:5px}#cmp-menu-static .items .item:hover .sub,#cmp-menu-static .items .item.active .sub{display:block}#cmp-menu-static .items .item:hover,#cmp-menu-static .items .item.active{background-color:#0003}#cmp-menu-static .items .item .label2{display:flex;align-items:center}#cmp-menu-static .items .item .label2 .icon{height:24px}#cmp-menu-static .items .item .label2 .title{white-space:nowrap}#cmp-menu-static .items .item .sub{display:none;position:absolute;background-color:#f1f1f1;border-radius:5px;box-shadow:0 8px 16px #0003;z-index:1;overflow:hidden}#cmp-menu-static .items .item .sub .sub-item{color:#000;padding:10px;text-decoration:none;display:flex;align-items:center}#cmp-menu-static .items .item .sub .sub-item:hover{background-color:#ddd}#cmp-menu-static .items .item .sub .sub-item .icon{height:20px}#cmp-menu-static .items .item .sub .sub-item .icon *{font-size:20px}#cmp-menu-static .items .item .sub .sub-item .title{font-size:13px;white-space:nowrap}#cmp-menu-static.ltr .icon{margin-right:10px}#cmp-menu-static.rtl .icon{margin-left:10px}\n"],encapsulation:2})}return s})();var m_=V(3932),Zm=V(6297),On=V(8239),na=function(s){return s[s.FLOATING=1]="FLOATING",s[s.DOCKED=2]="DOCKED",s[s.GRID_STER=3]="GRID_STER",s}(na||{});let fi=(()=>{class s{static#e=this._counter=0;static getPixels(t){return null===t?0:parseInt(t.replace("px",""))}static disableGlobalTextSelection(t){t.classList.add("disable-selection")}static enableGlobalTextSelection(t){t.classList.remove("disable-selection")}static isPointInsideNode(t,i,n){let a=n.container.containerElement.getBoundingClientRect();return t>=a.left&&t<=a.left+a.width&&i>=a.top&&i<=a.top+a.height}static getNextId(t){return t+s._counter++}static removeNode(t){return null!==t.parentNode&&(t.parentNode.removeChild(t),!0)}static orderByIndexes(t,i){let n=[];for(let r=0;r<i.length;r++)n.push(t[i[r]]);return n}static arrayRemove(t,i){let n=t.indexOf(i);return-1!==n&&t.splice(n,1)}static arrayContains(t,i){let n=t.length;for(;n--;)if(t[n]===i)return!0;return!1}static arrayEqual(t,i){if(t===i)return!0;if(null==t||null==i||t.length!=i.length)return!1;for(let n=0;n<t.length;++n)if(t[n]!==i[n])return!1;return!0}}return s})();class li{constructor(e,t,i,n){this.target=i,this.eventName=t,this.source=e,this.source.addEventListener(t,this.target,n)}cancel(){this.source.removeEventListener(this.eventName,this.target)}}class Zs{constructor(e,t){this.x=e,this.y=t}}class Xm{constructor(e,t,i){i||(i=7),this.element=e,this._undockededCallback=t,this.thresholdPixels=i,this._enabled=!1}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._enabled?(this.mouseDownHandler&&(this.mouseDownHandler.cancel(),delete this.mouseDownHandler),this.touchDownHandler&&(this.touchDownHandler.cancel(),delete this.touchDownHandler),this.mouseDownHandler=new li(this.element,"mousedown",this.onMouseDown.bind(this)),this.touchDownHandler=new li(this.element,"touchstart",this.onMouseDown.bind(this),{passive:!1})):(this.mouseDownHandler&&(this.mouseDownHandler.cancel(),delete this.mouseDownHandler),this.touchDownHandler&&(this.touchDownHandler.cancel(),delete this.touchDownHandler),this.mouseUpHandler&&(this.mouseUpHandler.cancel(),delete this.mouseUpHandler),this.touchUpHandler&&(this.touchUpHandler.cancel(),delete this.touchUpHandler),this.mouseMoveHandler&&(this.mouseMoveHandler.cancel(),delete this.mouseMoveHandler),this.touchMoveHandler&&(this.touchMoveHandler.cancel(),delete this.touchMoveHandler))}onMouseDown(e){if(e.preventDefault(),this.enabled){if(e.touches){if(e.touches.length>1)return;e=e.touches[0]}this.mouseUpHandler&&(this.mouseUpHandler.cancel(),delete this.mouseUpHandler),this.touchUpHandler&&(this.touchUpHandler.cancel(),delete this.touchUpHandler),this.mouseMoveHandler&&(this.mouseMoveHandler.cancel(),delete this.mouseMoveHandler),this.touchMoveHandler&&(this.touchMoveHandler.cancel(),delete this.touchMoveHandler),this.mouseUpHandler=new li(window,"mouseup",this.onMouseUp.bind(this)),this.touchUpHandler=new li(window,"touchend",this.onMouseUp.bind(this)),this.mouseMoveHandler=new li(window,"mousemove",this.onMouseMove.bind(this)),this.touchMoveHandler=new li(window,"touchmove",this.onMouseMove.bind(this)),this.dragStartPosition=new Zs(e.clientX,e.clientY)}}onMouseUp(){this.mouseUpHandler&&(this.mouseUpHandler.cancel(),delete this.mouseUpHandler),this.touchUpHandler&&(this.touchUpHandler.cancel(),delete this.touchUpHandler),this.mouseMoveHandler&&(this.mouseMoveHandler.cancel(),delete this.mouseMoveHandler),this.touchMoveHandler&&(this.touchMoveHandler.cancel(),delete this.touchMoveHandler)}onMouseMove(e){if(e.touches){if(e.touches.length>1)return;e=e.touches[0]}let i=new Zs(e.clientX,e.clientY).y-this.dragStartPosition.y;(i>this.thresholdPixels||i<-this.thresholdPixels)&&(this.enabled=!1,this._requestUndock(e))}_requestUndock(e){let t=0,i=0,n=this.element;do{t+=n.offsetTop||0,i+=n.offsetLeft||0,n=n.offsetParent}while(n);let o=new Zs(this.dragStartPosition.x-i,this.dragStartPosition.y-t);this._undockededCallback(e,o)}}var Ta=function(s){return s.horizontal="horizontal",s.vertical="vertical",s.fill="fill",s.panel="panel",s}(Ta||{}),ur=function(s){return s.document="document",s.panel="panel",s}(ur||{});const hc={CloseDialog:"Close dialog",CloseAll:"Close all documents",CloseAllButThis:"Close all documents but this",DefaultPanelName:"Panel",NewBrowserWindow:"Open in new window"};class Ua{static configure(e){Ua._getTemplateString=e}static getString(e,...t){return function p_(s,...e){return s.replace(/{(\d+)}/g,(t,i)=>{const n=Number.parseInt(i);return e[n].toString()})}(Ua._getTemplateString?.(e)??hc[e],...t)}}class Xs{constructor(e,t,i,n,r){this.panelActions={},this.isPin=!1,this.isFullscreen=!1,this.undockedToNewBrowserWindow=!1,i||(i=Ua.getString("DefaultPanelName")),n||(n=ur.panel),this.panelType=n,e._dockSpawnPanelContainer=this,this.elementContent=e,e.style.position="absolute",e.style.width="100%",e.style.height="100%",e.style.top="0",e.style.bottom="0",this.elementContentContainer=document.createElement("div"),this.elementContentContainer.className="panel-element-content-container",this.elementContentContainer.style.position="absolute",this.elementContentContainer._panel=this,this.elementContentContainer.addEventListener("pointerdown",a=>{try{this.isDialog?this._floatingDialog?.bringToFront():this.tabPage&&this.tabPage.setSelected(!0,!0),this.dockManager.activePanel=this}catch{}},{passive:!0}),this.elementContentContainer.appendChild(e),t.config.dialogRootElement.appendChild(this.elementContentContainer),this.dockManager=t,this.title=i,this.containerType=Ta.panel,this.icon=null,this.minimumAllowedChildNodes=0,this._floatingDialog=void 0,this.isDialog=!1,this._canUndock=t._undockEnabled,this.eventListeners=[],this._hideCloseButton=r,this._hidePinButton=!1,this._initialize()}canUndock(e){this._canUndock=e,this.undockInitiator.enabled=e,this.eventListeners.forEach(t=>{t.onDockEnabled&&t.onDockEnabled({self:this,state:e})})}addListener(e){this.eventListeners.push(e)}removeListener(e){this.eventListeners.splice(this.eventListeners.indexOf(e),1)}get floatingDialog(){return this._floatingDialog}set floatingDialog(e){this._floatingDialog=e,this.undockInitiator.enabled=void 0===this._floatingDialog}static loadFromState(e,t){return(0,On.Z)(function*(){let i,n;if(t.getElementCallback){let a=yield t.getElementCallback(e);i=a.element,n=a.title}else i=document.getElementById(e.element);if(null===i)return null;let r=new Xs(i,t,n);return r.loadState(e),r})()}saveState(e){e.element=this.elementContent.id,e.width=this.width,e.height=this.height,e.canUndock=this._canUndock,e.hideCloseButton=this._hideCloseButton,e.hidePinButton=this._hidePinButton,e.panelType=this.panelType,e.id=this.id,e.name=this.name,e.title=this.title,e.isPin=this.isPin}loadState(e){this.resize(e.width,e.height),this.state={width:e.width,height:e.height},this.canUndock(e.canUndock??!1),"boolean"==typeof e.hideCloseButton&&this.hideCloseButton(e.hideCloseButton??!1),"boolean"==typeof e.hidePinButton&&this.hidePinButton(e.hidePinButton??!1),this.panelType=e.panelType,this.name=e.name,this.id=e.id,this.isPin=e.isPin,this.pinButtonEffect(this.isPin),this.setTitle(e.title),this.isFullscreen=e.isFullscreen}setActiveChild(){}get containerElement(){return this.elementPanel}grayOut(e){!e&&this._grayOut?(this.elementContentWrapper.removeChild(this._grayOut),this.panelActions.close.elementButton.style.display=this._hideCloseButton?"none":"block",this._grayOut=null,this._hideCloseButton||this.eventListeners.forEach(t=>{t.onHideCloseButton&&t.onHideCloseButton({self:this,state:this._hideCloseButton})})):e&&!this._grayOut&&(this._grayOut=document.createElement("div"),this._grayOut.className="panel-grayout",this.panelActions.close.elementButton.style.display="none",this.elementContentWrapper.appendChild(this._grayOut),this.eventListeners.forEach(t=>{t.onHideCloseButton&&t.onHideCloseButton({self:this,state:!0})}))}setId(e){this.id=e}_initialize(){this.name=fi.getNextId("panel_"),this.elementPanel=document.createElement("div"),this.elementPanel.tabIndex=0,this.elementTitle=document.createElement("div"),this.elementTitleText=document.createElement("div"),this.elementContentHost=document.createElement("div"),this.panelActions={close:{elementButton:document.createElement("div")},pin:{elementButton:document.createElement("div")},fullscreen:{elementButton:document.createElement("div")}},this.elementPanel.appendChild(this.elementTitle),this.elementTitle.appendChild(this.elementTitleText);for(const a of Object.keys(this.panelActions))this.elementTitle.appendChild(this.panelActions[a].elementButton);this.panelActions.close.elementButton.classList.add("panel-titlebar-button","panel-titlebar-button-close"),this.panelActions.close.elementButton.style.display=this._hideCloseButton?"none":"block",this.panelActions.pin.elementButton.classList.add("panel-titlebar-button","panel-titlebar-button-pin"),this.panelActions.pin.elementButton.style.display=this._hidePinButton?"none":"block",this.panelActions.fullscreen.elementButton.classList.add("panel-titlebar-button","panel-titlebar-button-fullscreen"),this.panelActions.fullscreen.elementButton.style.display=this._hideFullScreenButton?"none":"block",this.elementPanel.appendChild(this.elementContentHost),this.elementPanel.classList.add("panel-base"),this.elementTitle.classList.add("panel-titlebar"),this.elementTitle.classList.add("disable-selection"),this.elementTitleText.classList.add("panel-titlebar-text"),this.elementContentHost.classList.add("panel-content");let e=this.elementContentContainer.clientWidth,t=this.elementContentContainer.clientHeight,i=this.elementTitle.clientHeight;this.elementContentWrapper=document.createElement("div"),this.elementContentWrapper.classList.add("panel-content-wrapper"),this._setPanelDimensions(e,t+i),this._hideCloseButton||(this.panelActions.close.buttonClickedHandler=new li(this.panelActions.close.elementButton,"mousedown",this.onCloseButtonClicked.bind(this)),this.panelActions.close.buttonTouchedHandler=new li(this.panelActions.close.elementButton,"touchstart",this.onCloseButtonClicked.bind(this))),this._hidePinButton||(this.panelActions.pin.buttonClickedHandler=new li(this.panelActions.pin.elementButton,"mousedown",this.onPinButtonClicked.bind(this)),this.panelActions.pin.buttonTouchedHandler=new li(this.panelActions.pin.elementButton,"touchstart",this.onPinButtonClicked.bind(this))),this._hideFullScreenButton||(this.panelActions.fullscreen.buttonClickedHandler=new li(this.panelActions.fullscreen.elementButton,"mousedown",this.onFullscreenButtonClicked.bind(this)),this.panelActions.fullscreen.buttonTouchedHandler=new li(this.panelActions.fullscreen.elementButton,"touchstart",this.onFullscreenButtonClicked.bind(this))),fi.removeNode(this.elementContentWrapper),this.elementContentHost.appendChild(this.elementContentWrapper);let n=this.elementContent.dataset.panelCaption,r=this.elementContent.dataset.panelIcon;n&&(this.title=n),r&&(this.icon=r),this._updateTitle(),this.undockInitiator=new Xm(this.elementTitle,this.performUndockToDialog.bind(this)),delete this.floatingDialog,this.mouseDownHandler=new li(this.elementPanel,"mousedown",this.onMouseDown.bind(this)),this.touchDownHandler=new li(this.elementPanel,"touchstart",this.onMouseDown.bind(this),{passive:!0}),this._resolvedElementContent=this.elementContent,this.elementContent instanceof HTMLSlotElement&&(this._resolvedElementContent=this.elementContent.assignedElements()?.[0])}onMouseDown(){this.dockManager.activePanel=this}hideCloseButton(e){this._hideCloseButton=e,this.panelActions.close.elementButton.style.display=e?"none":"block",this.eventListeners.forEach(t=>{t.onHideCloseButton&&t.onHideCloseButton({self:this,state:e})})}hidePinButton(e){this._hidePinButton=e,this.panelActions.pin.elementButton.style.display=e?"none":"block",this.eventListeners.forEach(t=>{t.onHidePinButton&&t.onHidePinButton({self:this,state:e})})}hideFullscreenButton(e){this._hideFullScreenButton=e,this.panelActions.fullscreen.elementButton.style.display=e?"none":"block",this.eventListeners.forEach(t=>{t.onHideFullscreenButton&&t.onHideFullscreenButton({self:this,state:e})})}destroy(){this.mouseDownHandler&&(this.mouseDownHandler.cancel(),delete this.mouseDownHandler),this.touchDownHandler&&(this.touchDownHandler.cancel(),delete this.touchDownHandler),fi.removeNode(this.elementPanel);for(const e of Object.keys(this.panelActions))this.panelActions[e].buttonClickedHandler&&(this.panelActions[e].buttonClickedHandler?.cancel(),delete this.panelActions[e].buttonClickedHandler),this.panelActions[e].buttonTouchedHandler&&(this.panelActions[e].buttonTouchedHandler?.cancel(),delete this.panelActions[e].buttonTouchedHandler)}performUndockToDialog(e,t){return this.isDialog=!0,this.undockInitiator.enabled=!1,this.elementContentWrapper.style.display="block",this.elementPanel.style.position="",this.dockManager.requestUndockToDialog(this,e,t)}performClose(){this.isDialog=!0,this.undockInitiator.enabled=!1,this.elementContentWrapper.style.display="block",this.elementContentContainer.style.display="none",this.elementPanel.style.position="",this.dockManager.requestClose(this)}performUndock(){this.undockInitiator.enabled=!1,this.dockManager.requestUndock(this)}prepareForDocking(){this.isDialog=!1,this.undockInitiator.enabled=this._canUndock,this.elementContentContainer.parentElement!=this.dockManager.config.dialogRootElement&&this.dockManager.config.dialogRootElement.appendChild(this.elementContentContainer)}get width(){return this._cachedWidth}set width(e){e!==this._cachedWidth&&(this._cachedWidth=e,this.elementPanel.style.width=e+"px")}get height(){return this._cachedHeight}set height(e){e!==this._cachedHeight&&(this._cachedHeight=e,this.elementPanel.style.height=e+"px")}get resolvedElementContent(){return this._resolvedElementContent||(this._resolvedElementContent=this.elementContent,this.elementContent instanceof HTMLSlotElement&&(this._resolvedElementContent=this.elementContent.assignedElements()?.[0])),this._resolvedElementContent}panelDocked(){this.elementContent.hidden&&(this.elementContent.hidden=!1),this.elementContentContainer.parentElement!==this.dockManager.config.dialogRootElement&&this.dockManager.config.dialogRootElement.appendChild(this.elementContentContainer)}resize(e,t){this.panelDocked(),this.setVisible(!0),this._setPanelDimensions(e,t),this._cachedWidth=e,this._cachedHeight=t;try{null!=this.elementContent&&"function"==typeof this.elementContent.resizeHandler&&this.elementContent.resizeHandler(e,t-this.elementTitle.clientHeight)}catch(i){console.log("error calling resizeHandler:",i," elt:",this.elementContent)}}_setPanelDimensions(e,t){this.elementTitle.style.width=e+"px",this.elementContentHost.style.width=e+"px",this.elementContentContainer.style.width=e+"px",this.elementPanel.style.width=e+"px";let n=t-this.elementTitle.clientHeight;this.elementContentHost.style.height=n+"px",this.elementContentContainer.style.height=n+"px",this.elementPanel.style.height=t+"px";const r=this.elementContentWrapper.getBoundingClientRect(),a=this.dockManager.config.dialogRootElement.getBoundingClientRect();this.elementContentContainer.style.left=r.x-a.x+"px",this.elementContentContainer.style.top=r.y-a.y+"px",this.elementContentContainer.style.width=r.width+"px",this.elementContentContainer.style.height=r.height+"px"}setDialogPosition(e,t){this.elementContentContainer.style.left=e+"px",this.elementContentContainer.style.top=t+this.elementTitle.clientHeight+"px"}setVisible(e){this.elementContentContainer.style.display=e?"block":"none"}setTitle(e){this.title=e,this._updateTitle(),this.onTitleChanged&&this.onTitleChanged(this,e)}setTitleIcon(e){this.icon=e,this._updateTitle(),this.onTitleChanged&&this.onTitleChanged(this,this.title)}setHasChanges(e){this.hasChanges=e,this._updateTitle(),e?this.elementTitleText.classList.add("panel-has-changes"):this.elementTitleText.classList.remove("panel-has-changes"),this.onTitleChanged&&this.onTitleChanged(this,this.title)}setCloseIconTemplate(e){this.panelActions.close.elementButton.innerHTML=e}setPinIconTemplate(e){this.panelActions.pin.elementButton.innerHTML=e}_updateTitle(){this.elementTitleText.innerHTML=null===this.icon?this.title:'<img class="panel-titlebar-icon" src="'+this.icon+'"><span>'+this.title+"</span>"}getRawTitle(){return this.elementTitleText.innerHTML}performLayout(e,t){}onCloseButtonClicked(e){e.preventDefault(),e.stopPropagation(),this.close()}onPinButtonClicked(e){e.preventDefault(),e.stopPropagation(),this.isPin=!this.isPin,this.pinButtonEffect(this.isPin)}onFullscreenButtonClicked(e){e.preventDefault(),e.stopPropagation(),this.isFullscreen=!this.isFullscreen,this.fullscreenButtonEffect(this.isFullscreen)}pinButtonEffect(e){this.panelActions.pin.elementButton.classList.remove("panel-titlebar-button-pin-enabled","panel-titlebar-button-pin-disabled"),this.panelActions.pin.elementButton.classList.add(e?"panel-titlebar-button-pin-enabled":"panel-titlebar-button-pin-disabled"),this.eventListeners.forEach(t=>{t.onTogglePinButton&&t.onTogglePinButton({self:this,state:e})})}fullscreenButtonEffect(e){this.panelActions.fullscreen.elementButton.classList.remove("panel-titlebar-button-fullscreen-enabled","panel-titlebar-button-fullscreen-disabled"),this.panelActions.fullscreen.elementButton.classList.add(e?"panel-titlebar-button-fullscreen-enabled":"panel-titlebar-button-fullscreen-disabled"),this.eventListeners.forEach(t=>{t.onToggleFullscreenButton&&t.onToggleFullscreenButton({self:this,state:e})})}undockToBrowserDialog(){!function f_(s,e){const t=s.getBoundingClientRect(),n=window.open("about:blank",void 0,`popup=yes,left=${t.x+24},top=${t.y+60},width=${t.width},height=${t.height}`);n.onfocus=u=>e.focused(u),n.onblur=u=>e.blured(u);let r=[...document.head.querySelectorAll("link")].map(u=>u.cloneNode());for(let u of r)n.document.head.appendChild(n.document.adoptNode(u));let a=n.document.createElement("style");a.innerText="\n    html {\n        overflow: hidden;\n        position: fixed;\n        width: 100%;\n        height: 100%;\n    }\n    body {\n        height: 100%;\n        width: 100%;\n        margin: 0;\n    }\n    ",n.document.head.appendChild(a);const o=n.document.createElement("title");o.innerText=e.title,n.document.head.appendChild(o),n.onunload=()=>e.newWindowClosedCallback();const l=new Map,c=new Map;function h(u){if(u.shadowRoot){u.shadowRoot.adoptedStyleSheets.length>0&&c.set(u,[...u.shadowRoot.adoptedStyleSheets.map(m=>function g_(s,e,t){const i=t.get(e);if(i)return i;let n="";const r=e.cssRules;for(var a=0;a<r.length;a++)n+=r[a].cssText+"\n";const o=new s.CSSStyleSheet;return t.set(e,o),o.replaceSync(n),o}(n,m,l))]);for(const m of u.shadowRoot.querySelectorAll("*"))h(m)}}h(s);for(const u of s.querySelectorAll("*"))h(u);n.document.body.appendChild(n.document.adoptNode(s));for(const u of c)u[0].shadowRoot.adoptedStyleSheets=u[1];e.closeCallback()}(this.resolvedElementContent,{title:this.elementTitleText.textContent,closeCallback:()=>{this.undockedToNewBrowserWindow=!0,this.closeInternal(!1)},newWindowClosedCallback:()=>{this.undockedToNewBrowserWindow=!1,this.dockManager.notifyOnClosePanel(this)},focused:e=>{this.dockManager.activePanel=this},blured:e=>{this.dockManager.activePanel=null}})}close(){var e=this;return(0,On.Z)(function*(){e.closeInternal(!0)})()}closeInternal(e){var t=this;return(0,On.Z)(function*(){let i=!0;if(t.elementContentContainer.parentElement===t.dockManager.config.dialogRootElement&&(e?t.closePanelContainerCallback?i=yield t.closePanelContainerCallback(t):t.dockManager.closePanelContainerCallback&&(i=yield t.dockManager.closePanelContainerCallback(t)):i=!0,i))if(t.dockManager.config.dialogRootElement.removeChild(t.elementContentContainer),t.isDialog)t.floatingDialog&&t.floatingDialog.close();else{try{t.dockManager.notifyOnClosePanel(t)}catch(n){console.error(n)}t.performClose()}})()}}class __{constructor(e,t,i){this._isActivePanel=!1,this._fullscreenState={x:0,y:0,width:0,height:0},this._spawnDockManager=e,this._id=t||"panel_"+Math.round(1e3*Math.random())+"_"+Math.round(1e3*Math.random()),this._mode=i??na.GRID_STER}get id(){return this._id}get isFloating(){return this._mode===na.FLOATING}get isGridSter(){return this._mode===na.GRID_STER}get isDocked(){return this._mode===na.DOCKED}get gridSterConfig(){return this._gridSterConfig}get isActive(){return this._isActivePanel}get isLoaded(){return void 0!==this._spawnPanel}get nativeId(){return this.gridSterConfig._id}get getZIndex(){return this.isActive?41:40}get isPin(){return this._isPin}set setActive(e){this._isActivePanel=e}setGridSterConfig(e){this._mode=na.GRID_STER,this._gridSterConfig=JSON.parse(JSON.stringify(e))}setFloating(e){this._mode=na.FLOATING,e?this._spawnPanel=e:e=this._spawnPanel,e&&(this._floatingComponentRef&&(this._title=this.extractComponentTitle(this._floatingComponentRef.instance.panel._gridSterConfig),this._spawnPanel&&this._title&&this._spawnPanel.setTitle(this._title)),e.eventListeners.find(t=>t.onTogglePinButton)||e.addListener({onTogglePinButton:t=>{this._isPin=t.state}}),e.eventListeners.find(t=>t.onToggleFullscreenButton)||e.addListener({onToggleFullscreenButton:t=>{this._isFullscreen=t.state,this.toggleFullscreen()}}),e.setId(this.id),(!e.width||!e.height)&&e.resize(400,400),e.isDialog=!0,e.hidePinButton&&e.hidePinButton(!1),e.hideFullscreenButton&&e.hideFullscreenButton(!1),e.hideCloseButton&&e.hideCloseButton(!0))}setDocked(e){e?this._spawnPanel=e:e=this._spawnPanel,this._mode=na.DOCKED,e&&(e.hidePinButton&&e.hidePinButton(!0),e.hideFullscreenButton&&e.hideFullscreenButton(!0),e.hideCloseButton&&e.hideCloseButton(!0))}setFloatingByComponentRef(e){this._floatingComponentRef=e,this._title=this.extractComponentTitle(e.instance.panel._gridSterConfig);let t=new Xs(e.location.nativeElement,this._spawnDockManager,this._title??this.id,ur.document);this.setFloating(t);const i=window.innerWidth/2-200,n=window.innerHeight/2-200,r=this._spawnDockManager.floatDialog(t,i,n);this._spawnDialog=r}switchBackFromFloatingToGridSter(){this._mode=na.GRID_STER,this.destroyFloatingWindow()}destroyFloatingWindow(){this._floatingComponentRef&&(this._floatingComponentRef.destroy(),this._floatingComponentRef=void 0),this._spawnDialog&&(this._spawnDialog.close(),this._spawnDialog=void 0)}destroy(){var e=this;return(0,On.Z)(function*(){e.destroyFloatingWindow(),e._spawnPanel&&(e._spawnPanel.destroy(),e._spawnPanel=void 0)})()}toggleFullscreen(){!this._spawnDialog||!this._spawnPanel||(this._isFullscreen?(this._fullscreenState.x=this._spawnDialog.position.x,this._fullscreenState.y=this._spawnDialog.position.y,this._fullscreenState.width=this._spawnPanel.width,this._fullscreenState.height=this._spawnPanel.height,this._spawnDialog.setPosition(0,0),this._spawnPanel.resize(window.innerWidth,window.innerHeight),this._spawnDialog.resizable.disableResize=!0,this._spawnDialog.draggable.disableDragging=!0):(this._spawnDialog.resizable.disableResize=!1,this._spawnDialog.draggable.disableDragging=!1,this._spawnDialog.setPosition(this._fullscreenState.x,this._fullscreenState.y),this._spawnDialog.resize(this._fullscreenState.width,this._fullscreenState.height)),setTimeout(()=>{this._spawnDialog.resizable.resize(this._spawnPanel.width,this._spawnPanel.height),this._spawnDockManager.rebuildLayout(this._spawnDockManager.context.model.rootNode),this._spawnDockManager.invalidate()},200))}extractComponentTitle(e){switch(console.log("config:",e),e.type){case"ColumnChart":case"ClusterColumnChart":case"Gauge":case"PieChart":case"DynamicChart":return e.config.view?.labels?.title;case"Card":return e.config?.content?.Title;case"3D":return"3D";case"Hmi":return"Hmi"}}}var au=V(155),b_=V(553);function v_(s,e){if(1&s&&d._UZ(0,"div",3),2&s){const t=e.index,i=d.oxw();d.Q6J("ngStyle",i.gridRenderer.getGridColumnStyle(t))}}function y_(s,e){if(1&s&&d._UZ(0,"div",4),2&s){const t=e.index,i=d.oxw();d.Q6J("ngStyle",i.gridRenderer.getGridRowStyle(t))}}const qm=["*"];function $m(s,e){if(1&s){const t=d.EpF();d.TgZ(0,"div",8),d.NdJ("mousedown",function(n){d.CHM(t);const r=d.oxw();return d.KtG(r.resize.dragStartDelay(n))})("touchstart",function(n){d.CHM(t);const r=d.oxw();return d.KtG(r.resize.dragStartDelay(n))}),d.qZA()}}function x_(s,e){if(1&s){const t=d.EpF();d.TgZ(0,"div",9),d.NdJ("mousedown",function(n){d.CHM(t);const r=d.oxw();return d.KtG(r.resize.dragStartDelay(n))})("touchstart",function(n){d.CHM(t);const r=d.oxw();return d.KtG(r.resize.dragStartDelay(n))}),d.qZA()}}function w_(s,e){if(1&s){const t=d.EpF();d.TgZ(0,"div",10),d.NdJ("mousedown",function(n){d.CHM(t);const r=d.oxw();return d.KtG(r.resize.dragStartDelay(n))})("touchstart",function(n){d.CHM(t);const r=d.oxw();return d.KtG(r.resize.dragStartDelay(n))}),d.qZA()}}function M_(s,e){if(1&s){const t=d.EpF();d.TgZ(0,"div",11),d.NdJ("mousedown",function(n){d.CHM(t);const r=d.oxw();return d.KtG(r.resize.dragStartDelay(n))})("touchstart",function(n){d.CHM(t);const r=d.oxw();return d.KtG(r.resize.dragStartDelay(n))}),d.qZA()}}function T_(s,e){if(1&s){const t=d.EpF();d.TgZ(0,"div",12),d.NdJ("mousedown",function(n){d.CHM(t);const r=d.oxw();return d.KtG(r.resize.dragStartDelay(n))})("touchstart",function(n){d.CHM(t);const r=d.oxw();return d.KtG(r.resize.dragStartDelay(n))}),d.qZA()}}function C_(s,e){if(1&s){const t=d.EpF();d.TgZ(0,"div",13),d.NdJ("mousedown",function(n){d.CHM(t);const r=d.oxw();return d.KtG(r.resize.dragStartDelay(n))})("touchstart",function(n){d.CHM(t);const r=d.oxw();return d.KtG(r.resize.dragStartDelay(n))}),d.qZA()}}function Km(s,e){if(1&s){const t=d.EpF();d.TgZ(0,"div",14),d.NdJ("mousedown",function(n){d.CHM(t);const r=d.oxw();return d.KtG(r.resize.dragStartDelay(n))})("touchstart",function(n){d.CHM(t);const r=d.oxw();return d.KtG(r.resize.dragStartDelay(n))}),d.qZA()}}function D_(s,e){if(1&s){const t=d.EpF();d.TgZ(0,"div",15),d.NdJ("mousedown",function(n){d.CHM(t);const r=d.oxw();return d.KtG(r.resize.dragStartDelay(n))})("touchstart",function(n){d.CHM(t);const r=d.oxw();return d.KtG(r.resize.dragStartDelay(n))}),d.qZA()}}var an=function(s){return s.Fit="fit",s.ScrollVertical="scrollVertical",s.ScrollHorizontal="scrollHorizontal",s.Fixed="fixed",s.VerticalFixed="verticalFixed",s.HorizontalFixed="horizontalFixed",s}(an||{}),ou=function(s){return s.Always="always",s.OnDragAndResize="onDrag&Resize",s.None="none",s}(ou||{}),Rn=function(s){return s.None="none",s.CompactUp="compactUp",s.CompactLeft="compactLeft",s.CompactUpAndLeft="compactUp&Left",s.CompactLeftAndUp="compactLeft&Up",s.CompactRight="compactRight",s.CompactUpAndRight="compactUp&Right",s.CompactRightAndUp="compactRight&Up",s.CompactDown="compactDown",s.CompactDownAndLeft="compactDown&Left",s.CompactLeftAndDown="compactLeft&Down",s.CompactDownAndRight="compactDown&Right",s.CompactRightAndDown="compactRight&Down",s}(Rn||{}),qs=function(s){return s.LTR="ltr",s.RTL="rtl",s}(qs||{});class E_{constructor(e){this.gridster=e}destroy(){this.gridster=null}checkCompact(){this.gridster.$options.compactType!==Rn.None&&(this.gridster.$options.compactType===Rn.CompactUp?this.checkCompactMovement("y",-1):this.gridster.$options.compactType===Rn.CompactLeft?this.checkCompactMovement("x",-1):this.gridster.$options.compactType===Rn.CompactUpAndLeft?(this.checkCompactMovement("y",-1),this.checkCompactMovement("x",-1)):this.gridster.$options.compactType===Rn.CompactLeftAndUp?(this.checkCompactMovement("x",-1),this.checkCompactMovement("y",-1)):this.gridster.$options.compactType===Rn.CompactRight?this.checkCompactMovement("x",1):this.gridster.$options.compactType===Rn.CompactUpAndRight?(this.checkCompactMovement("y",-1),this.checkCompactMovement("x",1)):this.gridster.$options.compactType===Rn.CompactRightAndUp?(this.checkCompactMovement("x",1),this.checkCompactMovement("y",-1)):this.gridster.$options.compactType===Rn.CompactDown?this.checkCompactMovement("y",1):this.gridster.$options.compactType===Rn.CompactDownAndLeft?(this.checkCompactMovement("y",1),this.checkCompactMovement("x",-1)):this.gridster.$options.compactType===Rn.CompactDownAndRight?(this.checkCompactMovement("y",1),this.checkCompactMovement("x",1)):this.gridster.$options.compactType===Rn.CompactLeftAndDown?(this.checkCompactMovement("x",-1),this.checkCompactMovement("y",1)):this.gridster.$options.compactType===Rn.CompactRightAndDown&&(this.checkCompactMovement("x",1),this.checkCompactMovement("y",1)))}checkCompactItem(e){this.gridster.$options.compactType!==Rn.None&&(this.gridster.$options.compactType===Rn.CompactUp?this.moveTillCollision(e,"y",-1):this.gridster.$options.compactType===Rn.CompactLeft?this.moveTillCollision(e,"x",-1):this.gridster.$options.compactType===Rn.CompactUpAndLeft?(this.moveTillCollision(e,"y",-1),this.moveTillCollision(e,"x",-1)):this.gridster.$options.compactType===Rn.CompactLeftAndUp?(this.moveTillCollision(e,"x",-1),this.moveTillCollision(e,"y",-1)):this.gridster.$options.compactType===Rn.CompactUpAndRight?(this.moveTillCollision(e,"y",-1),this.moveTillCollision(e,"x",1)):this.gridster.$options.compactType===Rn.CompactDown?this.moveTillCollision(e,"y",1):this.gridster.$options.compactType===Rn.CompactDownAndLeft?(this.moveTillCollision(e,"y",1),this.moveTillCollision(e,"x",-1)):this.gridster.$options.compactType===Rn.CompactLeftAndDown?(this.moveTillCollision(e,"x",-1),this.moveTillCollision(e,"y",1)):this.gridster.$options.compactType===Rn.CompactDownAndRight?(this.moveTillCollision(e,"y",1),this.moveTillCollision(e,"x",1)):this.gridster.$options.compactType===Rn.CompactRightAndDown&&(this.moveTillCollision(e,"x",1),this.moveTillCollision(e,"y",1)))}checkCompactMovement(e,t){let i=!1;this.gridster.grid.forEach(n=>{!1!==n.$item.compactEnabled&&this.moveTillCollision(n.$item,e,t)&&(i=!0,n.item[e]=n.$item[e],n.itemChanged())}),i&&this.checkCompact()}moveTillCollision(e,t,i){return e[t]+=i,this.gridster.checkCollision(e)?(e[t]-=i,!1):(this.moveTillCollision(e,t,i),!0)}}const S_={gridType:an.Fit,scale:1,fixedColWidth:250,fixedRowHeight:250,keepFixedHeightInMobile:!1,keepFixedWidthInMobile:!1,setGridSize:!1,compactType:Rn.None,mobileBreakpoint:640,useBodyForBreakpoint:!1,allowMultiLayer:!1,defaultLayerIndex:0,maxLayerIndex:2,baseLayerIndex:1,minCols:1,maxCols:100,minRows:1,maxRows:100,defaultItemCols:1,defaultItemRows:1,maxItemCols:50,maxItemRows:50,minItemCols:1,minItemRows:1,minItemArea:1,maxItemArea:2500,addEmptyRowsCount:0,rowHeightRatio:1,margin:10,outerMargin:!0,outerMarginTop:null,outerMarginRight:null,outerMarginBottom:null,outerMarginLeft:null,useTransformPositioning:!0,scrollSensitivity:10,scrollSpeed:20,initCallback:void 0,destroyCallback:void 0,gridSizeChangedCallback:void 0,itemChangeCallback:void 0,itemResizeCallback:void 0,itemInitCallback:void 0,itemRemovedCallback:void 0,itemValidateCallback:void 0,enableEmptyCellClick:!1,enableEmptyCellContextMenu:!1,enableEmptyCellDrop:!1,enableEmptyCellDrag:!1,enableOccupiedCellDrop:!1,emptyCellClickCallback:void 0,emptyCellContextMenuCallback:void 0,emptyCellDropCallback:void 0,emptyCellDragCallback:void 0,emptyCellDragMaxCols:50,emptyCellDragMaxRows:50,ignoreMarginInRow:!1,draggable:{delayStart:0,enabled:!1,ignoreContentClass:"gridster-item-content",ignoreContent:!1,dragHandleClass:"drag-handler",stop:void 0,start:void 0,dropOverItems:!1,dropOverItemsCallback:void 0},resizable:{delayStart:0,enabled:!1,handles:{s:!0,e:!0,n:!0,w:!0,se:!0,ne:!0,sw:!0,nw:!0},stop:void 0,start:void 0},swap:!0,swapWhileDragging:!1,pushItems:!1,disablePushOnDrag:!1,disablePushOnResize:!1,pushDirections:{north:!0,east:!0,south:!0,west:!0},pushResizeItems:!1,displayGrid:ou.OnDragAndResize,disableWindowResize:!1,disableWarnings:!1,scrollToNewItems:!1,disableScrollHorizontal:!1,disableScrollVertical:!1,enableBoundaryControl:!1,disableAutoPositionOnConflict:!1,dirType:qs.LTR};class as{static merge(e,t,i){for(const n in t)void 0!==t[n]&&i.hasOwnProperty(n)&&("object"==typeof t[n]?(n in e||(e[n]={}),e[n]=as.merge(e[n],t[n],i[n])):e[n]=t[n]);return e}static checkTouchEvent(e){void 0===e.clientX&&e.touches&&(e.touches&&e.touches.length?(e.clientX=e.touches[0].clientX,e.clientY=e.touches[0].clientY):e.changedTouches&&e.changedTouches.length&&(e.clientX=e.changedTouches[0].clientX,e.clientY=e.changedTouches[0].clientY))}static checkContentClassForEvent(e,t){if(e.$options.draggable.ignoreContent){if(!as.checkDragHandleClass(t.target,t.currentTarget,e.$options.draggable.dragHandleClass,e.$options.draggable.ignoreContentClass))return!0}else if(as.checkContentClass(t.target,t.currentTarget,e.$options.draggable.ignoreContentClass))return!0;return!1}static checkContentClassForEmptyCellClickEvent(e,t){return as.checkContentClass(t.target,t.currentTarget,e.$options.draggable.ignoreContentClass)||as.checkContentClass(t.target,t.currentTarget,e.$options.draggable.dragHandleClass)}static checkDragHandleClass(e,t,i,n){if(!e||e===t)return!1;if(e.hasAttribute("class")){const r=e.getAttribute("class").split(" ");if(r.indexOf(i)>-1)return!0;if(r.indexOf(n)>-1)return!1}return as.checkDragHandleClass(e.parentNode,t,i,n)}static checkContentClass(e,t,i){return!(!e||e===t)&&(!!(e.hasAttribute("class")&&e.getAttribute("class").split(" ").indexOf(i)>-1)||as.checkContentClass(e.parentNode,t,i))}static compareItems(e,t){return e.y>t.y?-1:e.y<t.y?1:e.x>t.x?-1:1}}class k_{constructor(e){this.gridster=e,this.emptyCellClickCb=t=>{if(!this.gridster||this.gridster.movingItem||as.checkContentClassForEmptyCellClickEvent(this.gridster,t))return;const i=this.getValidItemFromEvent(t);i&&(this.gridster.options.emptyCellClickCallback&&this.gridster.options.emptyCellClickCallback(t,i),this.gridster.cdRef.markForCheck())},this.emptyCellContextMenuCb=t=>{if(this.gridster.movingItem||as.checkContentClassForEmptyCellClickEvent(this.gridster,t))return;t.preventDefault(),t.stopPropagation();const i=this.getValidItemFromEvent(t);i&&(this.gridster.options.emptyCellContextMenuCallback&&this.gridster.options.emptyCellContextMenuCallback(t,i),this.gridster.cdRef.markForCheck())},this.emptyCellDragDrop=t=>{const i=this.getValidItemFromEvent(t);i&&(this.gridster.options.emptyCellDropCallback&&this.gridster.options.emptyCellDropCallback(t,i),this.gridster.cdRef.markForCheck())},this.emptyCellDragOver=t=>{t.preventDefault(),t.stopPropagation();const i=this.getValidItemFromEvent(t);i?(t.dataTransfer&&(t.dataTransfer.dropEffect="move"),this.gridster.movingItem=i):(t.dataTransfer&&(t.dataTransfer.dropEffect="none"),this.gridster.movingItem=null),this.gridster.previewStyle()},this.emptyCellMouseDown=t=>{if(as.checkContentClassForEmptyCellClickEvent(this.gridster,t))return;t.preventDefault(),t.stopPropagation();const i=this.getValidItemFromEvent(t);!i||1!==t.buttons&&!(t instanceof TouchEvent)||(this.initialItem=i,this.gridster.movingItem=i,this.gridster.previewStyle(),this.gridster.zone.runOutsideAngular(()=>{this.removeWindowMousemoveListenerFn=this.gridster.renderer.listen("window","mousemove",this.emptyCellMouseMove),this.removeWindowTouchmoveListenerFn=this.gridster.renderer.listen("window","touchmove",this.emptyCellMouseMove)}),this.removeWindowMouseupListenerFn=this.gridster.renderer.listen("window","mouseup",this.emptyCellMouseUp),this.removeWindowTouchendListenerFn=this.gridster.renderer.listen("window","touchend",this.emptyCellMouseUp))},this.emptyCellMouseMove=t=>{t.preventDefault(),t.stopPropagation();const i=this.getValidItemFromEvent(t,this.initialItem);i&&(this.gridster.movingItem=i,this.gridster.previewStyle())},this.emptyCellMouseUp=t=>{this.removeWindowMousemoveListenerFn(),this.removeWindowTouchmoveListenerFn(),this.removeWindowMouseupListenerFn(),this.removeWindowTouchendListenerFn();const i=this.getValidItemFromEvent(t,this.initialItem);i&&(this.gridster.movingItem=i),this.gridster.options.emptyCellDragCallback&&this.gridster.movingItem&&this.gridster.options.emptyCellDragCallback(t,this.gridster.movingItem),setTimeout(()=>{this.initialItem=null,this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle())}),this.gridster.cdRef.markForCheck()}}destroy(){this.gridster.previewStyle&&this.gridster.previewStyle(),this.gridster.movingItem=null,this.initialItem=this.gridster=null,this.removeDocumentDragendListenerFn&&(this.removeDocumentDragendListenerFn(),this.removeDocumentDragendListenerFn=null)}updateOptions(){this.gridster.$options.enableEmptyCellClick&&!this.removeEmptyCellClickListenerFn&&this.gridster.options.emptyCellClickCallback?(this.removeEmptyCellClickListenerFn=this.gridster.renderer.listen(this.gridster.el,"click",this.emptyCellClickCb),this.removeEmptyCellTouchendListenerFn=this.gridster.renderer.listen(this.gridster.el,"touchend",this.emptyCellClickCb)):!this.gridster.$options.enableEmptyCellClick&&this.removeEmptyCellClickListenerFn&&this.removeEmptyCellTouchendListenerFn&&(this.removeEmptyCellClickListenerFn(),this.removeEmptyCellTouchendListenerFn(),this.removeEmptyCellClickListenerFn=null,this.removeEmptyCellTouchendListenerFn=null),this.gridster.$options.enableEmptyCellContextMenu&&!this.removeEmptyCellContextMenuListenerFn&&this.gridster.options.emptyCellContextMenuCallback?this.removeEmptyCellContextMenuListenerFn=this.gridster.renderer.listen(this.gridster.el,"contextmenu",this.emptyCellContextMenuCb):!this.gridster.$options.enableEmptyCellContextMenu&&this.removeEmptyCellContextMenuListenerFn&&(this.removeEmptyCellContextMenuListenerFn(),this.removeEmptyCellContextMenuListenerFn=null),this.gridster.$options.enableEmptyCellDrop&&!this.removeEmptyCellDropListenerFn&&this.gridster.options.emptyCellDropCallback?(this.removeEmptyCellDropListenerFn=this.gridster.renderer.listen(this.gridster.el,"drop",this.emptyCellDragDrop),this.gridster.zone.runOutsideAngular(()=>{this.removeEmptyCellDragoverListenerFn=this.gridster.renderer.listen(this.gridster.el,"dragover",this.emptyCellDragOver)}),this.removeDocumentDragendListenerFn=this.gridster.renderer.listen("document","dragend",()=>{this.gridster.movingItem=null,this.gridster.previewStyle()})):!this.gridster.$options.enableEmptyCellDrop&&this.removeEmptyCellDropListenerFn&&this.removeEmptyCellDragoverListenerFn&&this.removeDocumentDragendListenerFn&&(this.removeEmptyCellDropListenerFn(),this.removeEmptyCellDragoverListenerFn(),this.removeDocumentDragendListenerFn(),this.removeEmptyCellDragoverListenerFn=null,this.removeEmptyCellDropListenerFn=null,this.removeDocumentDragendListenerFn=null),this.gridster.$options.enableEmptyCellDrag&&!this.removeEmptyCellMousedownListenerFn&&this.gridster.options.emptyCellDragCallback?(this.removeEmptyCellMousedownListenerFn=this.gridster.renderer.listen(this.gridster.el,"mousedown",this.emptyCellMouseDown),this.removeEmptyCellTouchstartListenerFn=this.gridster.renderer.listen(this.gridster.el,"touchstart",this.emptyCellMouseDown)):!this.gridster.$options.enableEmptyCellDrag&&this.removeEmptyCellMousedownListenerFn&&this.removeEmptyCellTouchstartListenerFn&&(this.removeEmptyCellMousedownListenerFn(),this.removeEmptyCellTouchstartListenerFn(),this.removeEmptyCellMousedownListenerFn=null,this.removeEmptyCellTouchstartListenerFn=null)}getPixelsX(e,t){const i=this.gridster.options.scale;return i?(e.clientX-t.left)/i+this.gridster.el.scrollLeft-this.gridster.gridRenderer.getLeftMargin():e.clientX+this.gridster.el.scrollLeft-t.left-this.gridster.gridRenderer.getLeftMargin()}getPixelsY(e,t){const i=this.gridster.options.scale;return i?(e.clientY-t.top)/i+this.gridster.el.scrollTop-this.gridster.gridRenderer.getTopMargin():e.clientY+this.gridster.el.scrollTop-t.top-this.gridster.gridRenderer.getTopMargin()}getValidItemFromEvent(e,t){e.preventDefault(),e.stopPropagation(),as.checkTouchEvent(e);const i=this.gridster.el.getBoundingClientRect(),n=this.getPixelsX(e,i),r=this.getPixelsY(e,i),a={x:this.gridster.pixelsToPositionX(n,Math.floor,!0),y:this.gridster.pixelsToPositionY(r,Math.floor,!0),cols:this.gridster.$options.defaultItemCols,rows:this.gridster.$options.defaultItemRows};if(t&&(a.cols=Math.min(Math.abs(t.x-a.x)+1,this.gridster.$options.emptyCellDragMaxCols),a.rows=Math.min(Math.abs(t.y-a.y)+1,this.gridster.$options.emptyCellDragMaxRows),t.x<a.x?a.x=t.x:t.x-a.x>this.gridster.$options.emptyCellDragMaxCols-1&&(a.x=this.gridster.movingItem?this.gridster.movingItem.x:0),t.y<a.y?a.y=t.y:t.y-a.y>this.gridster.$options.emptyCellDragMaxRows-1&&(a.y=this.gridster.movingItem?this.gridster.movingItem.y:0)),this.gridster.$options.enableOccupiedCellDrop||!this.gridster.checkCollision(a))return a}}class A_{constructor(e){this.gridster=e,this.lastGridColumnStyles={},this.lastGridRowStyles={}}destroy(){this.gridster=null}updateItem(e,t,i){if(this.gridster.mobile)this.clearCellPosition(i,e),i.setStyle(e,"height",this.gridster.$options.keepFixedHeightInMobile?(t.rows-1)*this.gridster.$options.margin+t.rows*this.gridster.$options.fixedRowHeight+"px":t.rows*this.gridster.curWidth/t.cols+"px"),i.setStyle(e,"width",this.gridster.$options.keepFixedWidthInMobile?this.gridster.$options.fixedColWidth+"px":""),i.setStyle(e,"margin-bottom",this.gridster.$options.margin+"px"),i.setStyle(e,qs.LTR?"margin-right":"margin-left","");else{const n=Math.round(this.gridster.curColWidth*t.x),r=Math.round(this.gridster.curRowHeight*t.y),a=this.gridster.curColWidth*t.cols-this.gridster.$options.margin,o=this.gridster.curRowHeight*t.rows-this.gridster.$options.margin;this.setCellPosition(i,e,n,r),i.setStyle(e,"width",a+"px"),i.setStyle(e,"height",o+"px");let l=null,c=null;this.gridster.$options.outerMargin&&(this.gridster.rows===t.rows+t.y&&(l=null!==this.gridster.$options.outerMarginBottom?this.gridster.$options.outerMarginBottom+"px":this.gridster.$options.margin+"px"),this.gridster.columns===t.cols+t.x&&(c=null!==this.gridster.$options.outerMarginBottom?this.gridster.$options.outerMarginRight+"px":this.gridster.$options.margin+"px")),i.setStyle(e,"margin-bottom",l),i.setStyle(e,qs.LTR?"margin-right":"margin-left",c)}}updateGridster(){let e="",t="",i="",n="";if(this.gridster.$options.gridType===an.Fit)e=an.Fit,t=an.ScrollVertical,i=an.ScrollHorizontal,n=an.Fixed;else if(this.gridster.$options.gridType===an.ScrollVertical)this.gridster.curRowHeight=this.gridster.curColWidth*this.gridster.$options.rowHeightRatio,e=an.ScrollVertical,t=an.Fit,i=an.ScrollHorizontal,n=an.Fixed;else if(this.gridster.$options.gridType===an.ScrollHorizontal){const r=this.gridster.$options.rowHeightRatio;this.gridster.curColWidth=this.gridster.curRowHeight*(r>=1?r:r+1),e=an.ScrollHorizontal,t=an.Fit,i=an.ScrollVertical,n=an.Fixed}else this.gridster.$options.gridType===an.Fixed?(this.gridster.curColWidth=this.gridster.$options.fixedColWidth+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),this.gridster.curRowHeight=this.gridster.$options.fixedRowHeight+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),e=an.Fixed,t=an.Fit,i=an.ScrollVertical,n=an.ScrollHorizontal):this.gridster.$options.gridType===an.VerticalFixed?(this.gridster.curRowHeight=this.gridster.$options.fixedRowHeight+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),e=an.ScrollVertical,t=an.Fit,i=an.ScrollHorizontal,n=an.Fixed):this.gridster.$options.gridType===an.HorizontalFixed&&(this.gridster.curColWidth=this.gridster.$options.fixedColWidth+(this.gridster.$options.ignoreMarginInRow?0:this.gridster.$options.margin),e=an.ScrollHorizontal,t=an.Fit,i=an.ScrollVertical,n=an.Fixed);this.gridster.mobile||this.gridster.$options.setGridSize&&this.gridster.$options.gridType!==an.Fit?this.gridster.renderer.removeClass(this.gridster.el,e):this.gridster.renderer.addClass(this.gridster.el,e),this.gridster.renderer.removeClass(this.gridster.el,t),this.gridster.renderer.removeClass(this.gridster.el,i),this.gridster.renderer.removeClass(this.gridster.el,n)}getGridColumnStyle(e){const t={left:this.gridster.curColWidth*e,width:this.gridster.curColWidth-this.gridster.$options.margin,height:this.gridster.gridRows.length*this.gridster.curRowHeight-this.gridster.$options.margin,style:{}};t.style={...this.getLeftPosition(t.left),width:t.width+"px",height:t.height+"px"};const i=this.lastGridColumnStyles[e];return i&&i.left===t.left&&i.width===t.width&&i.height===t.height?i.style:(this.lastGridColumnStyles[e]=t,t.style)}getGridRowStyle(e){const t={top:this.gridster.curRowHeight*e,width:this.gridster.gridColumns.length*this.gridster.curColWidth+this.gridster.$options.margin,height:this.gridster.curRowHeight-this.gridster.$options.margin,style:{}};t.style={...this.getTopPosition(t.top),width:t.width+"px",height:t.height+"px"};const i=this.lastGridRowStyles[e];return i&&i.top===t.top&&i.width===t.width&&i.height===t.height?i.style:(this.lastGridRowStyles[e]=t,t.style)}getLeftPosition(e){const t=this.gridster.$options.dirType===qs.RTL?-e:e;return this.gridster.$options.useTransformPositioning?{transform:"translateX("+t+"px)"}:{left:this.getLeftMargin()+t+"px"}}getTopPosition(e){return this.gridster.$options.useTransformPositioning?{transform:"translateY("+e+"px)"}:{top:this.getTopMargin()+e+"px"}}clearCellPosition(e,t){this.gridster.$options.useTransformPositioning?e.setStyle(t,"transform",""):(e.setStyle(t,"top",""),e.setStyle(t,"left",""))}setCellPosition(e,t,i,n){const r=this.gridster.$options.dirType===qs.RTL?-i:i;this.gridster.$options.useTransformPositioning?e.setStyle(t,"transform","translate3d("+r+"px, "+n+"px, 0)"):(e.setStyle(t,"left",this.getLeftMargin()+r+"px"),e.setStyle(t,"top",this.getTopMargin()+n+"px"))}getLeftMargin(){return this.gridster.$options.outerMargin?null!==this.gridster.$options.outerMarginLeft?this.gridster.$options.outerMarginLeft:this.gridster.$options.margin:0}getTopMargin(){return this.gridster.$options.outerMargin?null!==this.gridster.$options.outerMarginTop?this.gridster.$options.outerMarginTop:this.gridster.$options.margin:0}}let _l,oo,P_=(()=>{class s{constructor(t,i){this.renderer=i,this.el=t.nativeElement}ngOnInit(){this.sub=this.previewStyle$.subscribe(t=>this.previewStyle(t))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}previewStyle(t){t?(this.renderer.setStyle(this.el,"display","block"),this.gridRenderer.updateItem(this.el,t,this.renderer)):this.renderer.setStyle(this.el,"display","")}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(d.SBq),d.Y36(d.Qsj))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["gridster-preview"]],inputs:{previewStyle$:"previewStyle$",gridRenderer:"gridRenderer"},standalone:!0,features:[d.jDz],decls:0,vars:0,template:function(i,n){},styles:["gridster-preview{position:absolute;display:none;background:rgba(0,0,0,.15)}\n"],encapsulation:2})}return s})(),Jm=(()=>{class s{constructor(t,i,n,r){this.renderer=i,this.cdRef=n,this.zone=r,this.columns=0,this.rows=0,this.gridColumns=[],this.gridRows=[],this.previewStyle$=new d.vpe,this.calculateLayout$=new gi.x,this.resize$=new gi.x,this.destroy$=new gi.x,this.optionsChanged=()=>{this.setOptions();let o,a=this.grid.length-1;for(;a>=0;a--)o=this.grid[a],o.updateOptions();this.calculateLayout()},this.onResize=()=>{this.el.clientWidth&&(this.options.setGridSize&&(this.renderer.setStyle(this.el,"width",""),this.renderer.setStyle(this.el,"height","")),this.setGridSize(),this.calculateLayout())},this.getNextPossiblePosition=(a,o={})=>{-1===a.cols&&(a.cols=this.$options.defaultItemCols),-1===a.rows&&(a.rows=this.$options.defaultItemRows),this.setGridDimensions();let c,l=o.y||0;for(;l<this.rows;l++)for(a.y=l,c=o.x||0;c<this.columns;c++)if(a.x=c,!this.checkCollision(a))return!0;const h=this.$options.maxRows>=this.rows+a.rows;return this.rows<=this.columns&&h||!(this.$options.maxCols>=this.columns+a.cols)?!!h&&(a.y=this.rows,a.x=0,!0):(a.x=this.columns,a.y=0,!0)},this.getFirstPossiblePosition=a=>{const o=Object.assign({},a);return this.getNextPossiblePosition(o),o},this.getLastPossiblePosition=a=>{let o={y:0,x:0};o=this.grid.reduce((c,h)=>{const u={y:h.$item.y+h.$item.rows-1,x:h.$item.x+h.$item.cols-1};return 1===as.compareItems(c,u)?u:c},o);const l=Object.assign({},a);return this.getNextPossiblePosition(l,o),l},this.el=t.nativeElement,this.$options=JSON.parse(JSON.stringify(S_)),this.mobile=!1,this.curWidth=0,this.curHeight=0,this.grid=[],this.curColWidth=0,this.curRowHeight=0,this.dragInProgress=!1,this.emptyCell=new k_(this),this.compact=new E_(this),this.gridRenderer=new A_(this)}static checkCollisionTwoItemsForSwaping(t,i){return t.x+(1===t.cols?0:1)<i.x+i.cols&&t.x+t.cols>i.x+(1===i.cols?0:1)&&t.y+(1===t.rows?0:1)<i.y+i.rows&&t.y+t.rows>i.y+(1===i.rows?0:1)}checkCollisionTwoItems(t,i){if(!(t.x<i.x+i.cols&&t.x+t.cols>i.x&&t.y<i.y+i.rows&&t.y+t.rows>i.y))return!1;if(!this.$options.allowMultiLayer)return!0;const r=this.$options.defaultLayerIndex;return(void 0===t.layerIndex?r:t.layerIndex)===(void 0===i.layerIndex?r:i.layerIndex)}ngOnInit(){this.options.initCallback&&this.options.initCallback(this),this.calculateLayout$.pipe((0,au.b)(0),(0,he.R)(this.destroy$)).subscribe(()=>this.calculateLayout()),this.resize$.pipe((0,Ei.w)(()=>(0,b_.H)(100)),(0,he.R)(this.destroy$)).subscribe(()=>this.resize())}ngOnChanges(t){t.options&&(this.setOptions(),this.options.api={optionsChanged:this.optionsChanged,resize:this.onResize,getNextPossiblePosition:this.getNextPossiblePosition,getFirstPossiblePosition:this.getFirstPossiblePosition,getLastPossiblePosition:this.getLastPossiblePosition,getItemComponent:i=>this.getItemComponent(i)},this.columns=this.$options.minCols,this.rows=this.$options.minRows+this.$options.addEmptyRowsCount,this.setGridSize(),this.calculateLayout())}resize(){let t,i;"fit"!==this.$options.gridType||this.mobile?(i=this.el.clientWidth,t=this.el.clientHeight):(i=this.el.offsetWidth,t=this.el.offsetHeight),(i!==this.curWidth||t!==this.curHeight)&&this.checkIfToResize()&&this.onResize()}setOptions(){this.$options=as.merge(this.$options,this.options,this.$options),this.$options.disableWindowResize||this.windowResize?this.$options.disableWindowResize&&this.windowResize&&(this.windowResize(),this.windowResize=null):this.windowResize=this.renderer.listen("window","resize",this.onResize),this.emptyCell.updateOptions()}ngOnDestroy(){this.destroy$.next(),this.previewStyle$.complete(),this.windowResize&&this.windowResize(),this.options&&this.options.destroyCallback&&this.options.destroyCallback(this),this.options&&this.options.api&&(this.options.api.resize=void 0,this.options.api.optionsChanged=void 0,this.options.api.getNextPossiblePosition=void 0,this.options.api=void 0),this.emptyCell.destroy(),this.emptyCell=null,this.compact.destroy(),this.compact=null}checkIfToResize(){const t=this.el.clientWidth,i=this.el.offsetWidth,n=this.el.scrollWidth,r=this.el.clientHeight,a=this.el.offsetHeight,o=this.el.scrollHeight;return!(t<i&&o>a&&o-a<i-t||r<a&&n>i&&n-i<a-r)}checkIfMobile(){return this.$options.useBodyForBreakpoint?this.$options.mobileBreakpoint>document.body.clientWidth:this.$options.mobileBreakpoint>this.curWidth}setGridSize(){const t=this.el;let i,n;this.$options.setGridSize||this.$options.gridType===an.Fit&&!this.mobile?(i=t.offsetWidth,n=t.offsetHeight):(i=t.clientWidth,n=t.clientHeight),this.curWidth=i,this.curHeight=n}setGridDimensions(){this.setGridSize(),!this.mobile&&this.checkIfMobile()?(this.mobile=!this.mobile,this.renderer.addClass(this.el,"mobile")):this.mobile&&!this.checkIfMobile()&&(this.mobile=!this.mobile,this.renderer.removeClass(this.el,"mobile"));let r,t=this.$options.minRows,i=this.$options.minCols,n=this.grid.length-1;for(;n>=0;n--)r=this.grid[n],r.notPlaced||(t=Math.max(t,r.$item.y+r.$item.rows),i=Math.max(i,r.$item.x+r.$item.cols));t+=this.$options.addEmptyRowsCount,(this.columns!==i||this.rows!==t)&&(this.columns=i,this.rows=t,this.options.gridSizeChangedCallback&&this.options.gridSizeChangedCallback(this))}calculateLayout(){if(this.compact&&this.compact.checkCompact(),this.setGridDimensions(),this.$options.outerMargin){let n=-this.$options.margin;null!==this.$options.outerMarginLeft?(n+=this.$options.outerMarginLeft,this.renderer.setStyle(this.el,"padding-left",this.$options.outerMarginLeft+"px")):(n+=this.$options.margin,this.renderer.setStyle(this.el,"padding-left",this.$options.margin+"px")),null!==this.$options.outerMarginRight?(n+=this.$options.outerMarginRight,this.renderer.setStyle(this.el,"padding-right",this.$options.outerMarginRight+"px")):(n+=this.$options.margin,this.renderer.setStyle(this.el,"padding-right",this.$options.margin+"px")),this.curColWidth=(this.curWidth-n)/this.columns;let r=-this.$options.margin;null!==this.$options.outerMarginTop?(r+=this.$options.outerMarginTop,this.renderer.setStyle(this.el,"padding-top",this.$options.outerMarginTop+"px")):(r+=this.$options.margin,this.renderer.setStyle(this.el,"padding-top",this.$options.margin+"px")),null!==this.$options.outerMarginBottom?(r+=this.$options.outerMarginBottom,this.renderer.setStyle(this.el,"padding-bottom",this.$options.outerMarginBottom+"px")):(r+=this.$options.margin,this.renderer.setStyle(this.el,"padding-bottom",this.$options.margin+"px")),this.curRowHeight=(this.curHeight-r)/this.rows*this.$options.rowHeightRatio}else this.curColWidth=(this.curWidth+this.$options.margin)/this.columns,this.curRowHeight=(this.curHeight+this.$options.margin)/this.rows*this.$options.rowHeightRatio,this.renderer.setStyle(this.el,"padding-left","0px"),this.renderer.setStyle(this.el,"padding-right","0px"),this.renderer.setStyle(this.el,"padding-top","0px"),this.renderer.setStyle(this.el,"padding-bottom","0px");this.gridRenderer.updateGridster(),this.$options.setGridSize?(this.renderer.addClass(this.el,"gridSize"),this.mobile||(this.renderer.setStyle(this.el,"width",this.columns*this.curColWidth+this.$options.margin+"px"),this.renderer.setStyle(this.el,"height",this.rows*this.curRowHeight+this.$options.margin+"px"))):(this.renderer.removeClass(this.el,"gridSize"),this.renderer.setStyle(this.el,"width",""),this.renderer.setStyle(this.el,"height","")),this.updateGrid();let i,t=this.grid.length-1;for(;t>=0;t--)i=this.grid[t],i.setSize(),i.drag.toggle(),i.resize.toggle();this.resize$.next()}updateGrid(){"always"!==this.$options.displayGrid||this.mobile?"onDrag&Resize"===this.$options.displayGrid&&this.dragInProgress?this.renderer.addClass(this.el,"display-grid"):("none"===this.$options.displayGrid||!this.dragInProgress||this.mobile)&&this.renderer.removeClass(this.el,"display-grid"):this.renderer.addClass(this.el,"display-grid"),this.setGridDimensions(),this.gridColumns.length=s.getNewArrayLength(this.columns,this.curWidth,this.curColWidth),this.gridRows.length=s.getNewArrayLength(this.rows,this.curHeight,this.curRowHeight),this.cdRef.markForCheck()}addItem(t){void 0===t.$item.cols&&(t.$item.cols=this.$options.defaultItemCols,t.item.cols=t.$item.cols,t.itemChanged()),void 0===t.$item.rows&&(t.$item.rows=this.$options.defaultItemRows,t.item.rows=t.$item.rows,t.itemChanged()),-1===t.$item.x||-1===t.$item.y?this.autoPositionItem(t):this.checkCollision(t.$item)&&(this.$options.disableWarnings||(t.notPlaced=!0,console.warn("Can't be placed in the bounds of the dashboard, trying to auto position!/n"+JSON.stringify(t.item,["cols","rows","x","y"]))),this.$options.disableAutoPositionOnConflict?t.notPlaced=!0:this.autoPositionItem(t)),this.grid.push(t),this.calculateLayout$.next()}removeItem(t){this.grid.splice(this.grid.indexOf(t),1),this.calculateLayout$.next(),this.options.itemRemovedCallback&&this.options.itemRemovedCallback(t.item,t)}checkCollision(t){let i=!1;if(this.options.itemValidateCallback&&(i=!this.options.itemValidateCallback(t)),!i&&this.checkGridCollision(t)&&(i=!0),!i){const n=this.findItemWithItem(t);n&&(i=n)}return i}checkGridCollision(t){const _=t.cols*t.rows;return!(t.y>-1&&t.x>-1&&t.cols+t.x<=this.$options.maxCols&&t.rows+t.y<=this.$options.maxRows&&t.cols<=(void 0===t.maxItemCols?this.$options.maxItemCols:t.maxItemCols)&&t.cols>=(void 0===t.minItemCols?this.$options.minItemCols:t.minItemCols)&&t.rows<=(void 0===t.maxItemRows?this.$options.maxItemRows:t.maxItemRows)&&t.rows>=(void 0===t.minItemRows?this.$options.minItemRows:t.minItemRows)&&(void 0===t.minItemArea?this.$options.minItemArea:t.minItemArea)<=_&&(void 0===t.maxItemArea?this.$options.maxItemArea:t.maxItemArea)>=_)}findItemWithItem(t){let n,i=0;for(;i<this.grid.length;i++)if(n=this.grid[i],n.$item!==t&&this.checkCollisionTwoItems(n.$item,t))return n;return!1}findItemsWithItem(t){const i=[];let r,n=0;for(;n<this.grid.length;n++)r=this.grid[n],r.$item!==t&&this.checkCollisionTwoItems(r.$item,t)&&i.push(r);return i}autoPositionItem(t){this.getNextPossiblePosition(t.$item)?(t.notPlaced=!1,t.item.x=t.$item.x,t.item.y=t.$item.y,t.itemChanged()):(t.notPlaced=!0,this.$options.disableWarnings||console.warn("Can't be placed in the bounds of the dashboard!/n"+JSON.stringify(t.item,["cols","rows","x","y"])))}pixelsToPositionX(t,i,n){const r=i(t/this.curColWidth);return n?r:Math.max(r,0)}pixelsToPositionY(t,i,n){const r=i(t/this.curRowHeight);return n?r:Math.max(r,0)}positionXToPixels(t){return t*this.curColWidth}positionYToPixels(t){return t*this.curRowHeight}getItemComponent(t){return this.grid.find(i=>i.item===t)}checkCollisionForSwaping(t){let i=!1;if(this.options.itemValidateCallback&&(i=!this.options.itemValidateCallback(t)),!i&&this.checkGridCollision(t)&&(i=!0),!i){const n=this.findItemWithItemForSwapping(t);n&&(i=n)}return i}findItemWithItemForSwapping(t){let n,i=this.grid.length-1;for(;i>-1;i--)if(n=this.grid[i],n.$item!==t&&s.checkCollisionTwoItemsForSwaping(n.$item,t))return n;return!1}previewStyle(t=!1){this.movingItem?(this.compact&&t&&this.compact.checkCompactItem(this.movingItem),this.previewStyle$.next(this.movingItem)):this.previewStyle$.next(null)}static getNewArrayLength(t,i,n){const r=Math.max(t,Math.floor(i/n));return r<0?0:Number.isFinite(r)?Math.floor(r):0}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(d.SBq),d.Y36(d.Qsj),d.Y36(d.sBO),d.Y36(d.R0b))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["gridster"]],inputs:{options:"options"},standalone:!0,features:[d.TTD,d.jDz],ngContentSelectors:qm,decls:4,vars:4,consts:[["class","gridster-column",3,"ngStyle",4,"ngFor","ngForOf"],["class","gridster-row",3,"ngStyle",4,"ngFor","ngForOf"],[1,"gridster-preview",3,"gridRenderer","previewStyle$"],[1,"gridster-column",3,"ngStyle"],[1,"gridster-row",3,"ngStyle"]],template:function(i,n){1&i&&(d.F$t(),d.YNc(0,v_,1,1,"div",0),d.YNc(1,y_,1,1,"div",1),d.Hsn(2),d._UZ(3,"gridster-preview",2)),2&i&&(d.Q6J("ngForOf",n.gridColumns),d.xp6(1),d.Q6J("ngForOf",n.gridRows),d.xp6(2),d.Q6J("gridRenderer",n.gridRenderer)("previewStyle$",n.previewStyle$))},dependencies:[x.sg,x.PC,P_],styles:["gridster{position:relative;box-sizing:border-box;background:grey;width:100%;height:100%;-webkit-user-select:none;user-select:none;display:block}gridster.fit{overflow-x:hidden;overflow-y:hidden}gridster.scrollVertical{overflow-x:hidden;overflow-y:auto}gridster.scrollHorizontal{overflow-x:auto;overflow-y:hidden}gridster.fixed{overflow:auto}gridster.mobile{overflow-x:hidden;overflow-y:auto}gridster.mobile gridster-item{position:relative}gridster.gridSize{height:initial;width:initial}gridster.gridSize.fit{height:100%;width:100%}gridster .gridster-column,gridster .gridster-row{position:absolute;display:none;transition:.3s;box-sizing:border-box}gridster.display-grid .gridster-column,gridster.display-grid .gridster-row{display:block}gridster .gridster-column{border-left:1px solid white;border-right:1px solid white}gridster .gridster-row{border-top:1px solid white;border-bottom:1px solid white}\n"],encapsulation:2})}return s})();class Qm{constructor(e){this.iteration=0,this.pushedItems=[],this.pushedItemsTemp=[],this.pushedItemsTempPath=[],this.pushedItemsPath=[],this.gridsterItem=e,this.gridster=e.gridster,this.tryPattern={fromEast:[this.tryWest,this.trySouth,this.tryNorth,this.tryEast],fromWest:[this.tryEast,this.trySouth,this.tryNorth,this.tryWest],fromNorth:[this.trySouth,this.tryEast,this.tryWest,this.tryNorth],fromSouth:[this.tryNorth,this.tryEast,this.tryWest,this.trySouth]},this.fromSouth="fromSouth",this.fromNorth="fromNorth",this.fromEast="fromEast",this.fromWest="fromWest"}destroy(){this.gridster=this.gridsterItem=null}pushItems(e,t){if(this.gridster.$options.pushItems&&!t){this.pushedItemsOrder=[],this.iteration=0;const i=this.push(this.gridsterItem,e);return i||this.restoreTempItems(),this.pushedItemsOrder=[],this.pushedItemsTemp=[],this.pushedItemsTempPath=[],i}return!1}restoreTempItems(){let e=this.pushedItemsTemp.length-1;for(;e>-1;e--)this.removeFromTempPushed(this.pushedItemsTemp[e])}restoreItems(){let e=0;const t=this.pushedItems.length;let i;for(;e<t;e++)i=this.pushedItems[e],i.$item.x=i.item.x||0,i.$item.y=i.item.y||0,i.setSize();this.pushedItems=[],this.pushedItemsPath=[]}setPushedItems(){let e=0;const t=this.pushedItems.length;let i;for(;e<t;e++)i=this.pushedItems[e],i.checkItemChanges(i.$item,i.item);this.pushedItems=[],this.pushedItemsPath=[]}checkPushBack(){let e=this.pushedItems.length-1,t=!1;for(;e>-1;e--)this.checkPushedItem(this.pushedItems[e],e)&&(t=!0);t&&this.checkPushBack()}push(e,t){if(this.iteration>100)return console.warn("max iteration reached"),!1;if(this.gridster.checkGridCollision(e.$item)||""===t)return!1;const i=this.gridster.findItemsWithItem(e.$item),n=t===this.fromNorth||t===this.fromWest;i.sort((c,h)=>n?h.$item.y-c.$item.y||h.$item.x-c.$item.x:c.$item.y-h.$item.y||c.$item.x-h.$item.x);let a,r=0,o=!0;const l=[];for(;r<i.length;r++){if(a=i[r],a===this.gridsterItem)continue;if(!a.canBeDragged()){o=!1;break}const c=this.pushedItemsTemp.indexOf(a);if(c>-1&&this.pushedItemsTempPath[c].length>10){o=!1;break}if(this.tryPattern[t][0].call(this,a,e))this.pushedItemsOrder.push(a),l.push(a);else if(this.tryPattern[t][1].call(this,a,e))this.pushedItemsOrder.push(a),l.push(a);else if(this.tryPattern[t][2].call(this,a,e))this.pushedItemsOrder.push(a),l.push(a);else{if(!this.tryPattern[t][3].call(this,a,e)){o=!1;break}this.pushedItemsOrder.push(a),l.push(a)}}if(!o&&(r=this.pushedItemsOrder.lastIndexOf(l[0]),r>-1)){let c=this.pushedItemsOrder.length-1;for(;c>=r;c--)a=this.pushedItemsOrder[c],this.pushedItemsOrder.pop(),this.removeFromTempPushed(a),this.removeFromPushedItem(a)}return this.iteration++,o}trySouth(e,t){return!!this.gridster.$options.pushDirections.south&&(this.addToTempPushed(e),e.$item.y=t.$item.y+t.$item.rows,this.push(e,this.fromNorth)?(e.setSize(),this.addToPushed(e),!0):(this.removeFromTempPushed(e),!1))}tryNorth(e,t){return!!this.gridster.$options.pushDirections.north&&(this.addToTempPushed(e),e.$item.y=t.$item.y-e.$item.rows,this.push(e,this.fromSouth)?(e.setSize(),this.addToPushed(e),!0):(this.removeFromTempPushed(e),!1))}tryEast(e,t){return!!this.gridster.$options.pushDirections.east&&(this.addToTempPushed(e),e.$item.x=t.$item.x+t.$item.cols,this.push(e,this.fromWest)?(e.setSize(),this.addToPushed(e),!0):(this.removeFromTempPushed(e),!1))}tryWest(e,t){return!!this.gridster.$options.pushDirections.west&&(this.addToTempPushed(e),e.$item.x=t.$item.x-e.$item.cols,this.push(e,this.fromEast)?(e.setSize(),this.addToPushed(e),!0):(this.removeFromTempPushed(e),!1))}addToTempPushed(e){let t=this.pushedItemsTemp.indexOf(e);-1===t&&(t=this.pushedItemsTemp.push(e)-1,this.pushedItemsTempPath[t]=[]),this.pushedItemsTempPath[t].push({x:e.$item.x,y:e.$item.y})}removeFromTempPushed(e){const t=this.pushedItemsTemp.indexOf(e),i=this.pushedItemsTempPath[t].pop();i&&(e.$item.x=i.x,e.$item.y=i.y,e.setSize(),this.pushedItemsTempPath[t].length||(this.pushedItemsTemp.splice(t,1),this.pushedItemsTempPath.splice(t,1)))}addToPushed(e){if(this.pushedItems.indexOf(e)<0)this.pushedItems.push(e),this.pushedItemsPath.push([{x:e.item.x||0,y:e.item.y||0},{x:e.$item.x,y:e.$item.y}]);else{const t=this.pushedItems.indexOf(e);this.pushedItemsPath[t].push({x:e.$item.x,y:e.$item.y})}}removeFromPushed(e){e>-1&&(this.pushedItems.splice(e,1),this.pushedItemsPath.splice(e,1))}removeFromPushedItem(e){const t=this.pushedItems.indexOf(e);t>-1&&(this.pushedItemsPath[t].pop(),this.pushedItemsPath.length||(this.pushedItems.splice(t,1),this.pushedItemsPath.splice(t,1)))}checkPushedItem(e,t){const i=this.pushedItemsPath[t];let r,a,o,n=i.length-2,l=!1;for(;n>-1;n--)r=i[n],a=e.$item.x,o=e.$item.y,e.$item.x=r.x,e.$item.y=r.y,this.gridster.findItemWithItem(e.$item)?(e.$item.x=a,e.$item.y=o):(e.setSize(),i.splice(n+1,i.length-n-1),l=!0);return i.length<2&&this.removeFromPushed(t),l}}const ep=50;let Xn,Ca,za,sa,uc,Hr,bl;function lu(s,e,t,i,n,r,a,o,l,c){_l=s.$options.scrollSensitivity,oo=s.$options.scrollSpeed,Xn=s.el,Ca=l,za=c;const h=Xn.offsetWidth,m=Xn.scrollLeft,p=Xn.scrollTop,_=t-p,g=Xn.offsetHeight+p-t-n,{clientX:f,clientY:b}=r;if(!s.$options.disableScrollVertical)if(a.clientY<b&&g<_l){if(np(),Ca&&za&&!za.south||bl)return;bl=tp(1,o,a)}else if(a.clientY>b&&p>0&&_<_l){if(ip(),Ca&&za&&!za.north||Hr)return;Hr=tp(-1,o,a)}else a.clientY!==b&&Wn();const M=e-m;if(!s.$options.disableScrollHorizontal)if(a.clientX<f&&m+h-e-i<=_l){if(du(),Ca&&za&&!za.east||sa)return;sa=on(1,o,a)}else if(a.clientX>f&&m>0&&M<_l){if(vl(),Ca&&za&&!za.west||uc)return;uc=on(-1,o,a)}else a.clientX!==f&&cu()}function tp(s,e,t){let i=t.clientY;return window.setInterval(()=>{(!Xn||-1===s&&Xn.scrollTop-oo<0)&&Wn(),Xn.scrollTop+=s*oo,i+=s*oo,e({clientX:t.clientX,clientY:i})},ep)}function on(s,e,t){let i=t.clientX;return window.setInterval(()=>{(!Xn||-1===s&&Xn.scrollLeft-oo<0)&&cu(),Xn.scrollLeft+=s*oo,i+=s*oo,e({clientX:i,clientY:t.clientY})},ep)}function Bo(){cu(),Wn(),Xn=null}function cu(){vl(),du()}function Wn(){np(),ip()}function vl(){sa&&(clearInterval(sa),sa=0)}function du(){uc&&(clearInterval(uc),uc=0)}function ip(){bl&&(clearInterval(bl),bl=0)}function np(){Hr&&(clearInterval(Hr),Hr=0)}class hu{constructor(e){this.gridsterItem=e,this.gridster=e.gridster}destroy(){this.gridster=this.gridsterItem=this.swapedItem=null}swapItems(){this.gridster.$options.swap&&(this.checkSwapBack(),this.checkSwap(this.gridsterItem))}checkSwapBack(){if(this.swapedItem){const e=this.swapedItem.$item.x,t=this.swapedItem.$item.y;this.swapedItem.$item.x=this.swapedItem.item.x||0,this.swapedItem.$item.y=this.swapedItem.item.y||0,this.gridster.checkCollision(this.swapedItem.$item)?(this.swapedItem.$item.x=e,this.swapedItem.$item.y=t):(this.swapedItem.setSize(),this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.swapedItem=void 0)}}restoreSwapItem(){this.swapedItem&&(this.swapedItem.$item.x=this.swapedItem.item.x||0,this.swapedItem.$item.y=this.swapedItem.item.y||0,this.swapedItem.setSize(),this.swapedItem=void 0)}setSwapItem(){this.swapedItem&&(this.swapedItem.checkItemChanges(this.swapedItem.$item,this.swapedItem.item),this.swapedItem=void 0)}checkSwap(e){let t;if(t=this.gridster.$options.swapWhileDragging?this.gridster.checkCollisionForSwaping(e.$item):this.gridster.checkCollision(e.$item),t&&!0!==t&&t.canBeDragged()){const i=t,n=i.$item.x,r=i.$item.y,a=e.$item.x,o=e.$item.y,l=a-n,c=o-r;i.$item.x=e.item.x-l,i.$item.y=e.item.y-c,e.$item.x=i.item.x+l,e.$item.y=i.item.y+c,this.gridster.checkCollision(i.$item)||this.gridster.checkCollision(e.$item)?(e.$item.x=a,e.$item.y=o,i.$item.x=n,i.$item.y=r):(i.setSize(),this.swapedItem=i,this.gridster.$options.swapWhileDragging&&(this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.setSwapItem()))}}}var Ar=function(s){return s.UP="UP",s.DOWN="DOWN",s.LEFT="LEFT",s.RIGHT="RIGHT",s}(Ar||{});class O_{constructor(e,t,i){this.zone=i,this.collision=!1,this.dragMove=n=>{n.stopPropagation(),n.preventDefault(),as.checkTouchEvent(n);let r=this.getDirections(n);this.gridster.options.enableBoundaryControl&&(r.includes(Ar.UP)&&this.gridsterItem.el.getBoundingClientRect().top<this.gridster.el.getBoundingClientRect().top+(this.outerMarginTop??this.margin)&&(r=r.filter(a=>a!=Ar.UP),n=new MouseEvent(n.type,{clientX:n.clientX,clientY:this.lastMouse.clientY})),r.includes(Ar.LEFT)&&this.gridsterItem.el.getBoundingClientRect().left<this.gridster.el.getBoundingClientRect().left+(this.outerMarginLeft??this.margin)&&(r=r.filter(a=>a!=Ar.LEFT),n=new MouseEvent(n.type,{clientX:this.lastMouse.clientX,clientY:n.clientY})),r.includes(Ar.RIGHT)&&this.gridsterItem.el.getBoundingClientRect().right>this.gridster.el.getBoundingClientRect().right-(this.outerMarginRight??this.margin)&&(r=r.filter(a=>a!=Ar.RIGHT),n=new MouseEvent(n.type,{clientX:this.lastMouse.clientX,clientY:n.clientY})),r.includes(Ar.DOWN)&&this.gridsterItem.el.getBoundingClientRect().bottom>this.gridster.el.getBoundingClientRect().bottom-(this.outerMarginBottom??this.margin)&&(r=r.filter(a=>a!=Ar.DOWN),n=new MouseEvent(n.type,{clientX:n.clientX,clientY:this.lastMouse.clientY}))),r.length&&(this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,lu(this.gridster,this.left,this.top,this.width,this.height,n,this.lastMouse,this.calculateItemPositionFromMousePosition),this.calculateItemPositionFromMousePosition(n))},this.calculateItemPositionFromMousePosition=n=>{this.gridster.options.scale?this.calculateItemPositionWithScale(n,this.gridster.options.scale):this.calculateItemPositionWithoutScale(n),this.calculateItemPosition(),this.lastMouse.clientX=n.clientX,this.lastMouse.clientY=n.clientY,this.zone.run(()=>{this.gridster.updateGrid()})},this.dragStop=n=>{n.stopPropagation(),n.preventDefault(),Bo(),this.cancelOnBlur(),this.mousemove(),this.mouseup(),this.mouseleave(),this.touchmove(),this.touchend(),this.touchcancel(),this.gridsterItem.renderer.removeClass(this.gridsterItem.el,"gridster-item-moving"),this.gridster.dragInProgress=!1,this.gridster.updateGrid(),this.path=[],this.gridster.options.draggable&&this.gridster.options.draggable.stop?Promise.resolve(this.gridster.options.draggable.stop(this.gridsterItem.item,this.gridsterItem,n)).then(this.makeDrag,this.cancelDrag):this.makeDrag(),setTimeout(()=>{this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle(!0))})},this.cancelDrag=()=>{this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.gridsterItem.setSize(),this.push&&this.push.restoreItems(),this.swap&&this.swap.restoreSwapItem(),this.push&&(this.push.destroy(),this.push=null),this.swap&&(this.swap.destroy(),this.swap=null)},this.makeDrag=()=>{this.gridster.$options.draggable.dropOverItems&&this.gridster.options.draggable&&this.gridster.options.draggable.dropOverItemsCallback&&this.collision&&!0!==this.collision&&this.collision.$item&&this.gridster.options.draggable.dropOverItemsCallback(this.gridsterItem.item,this.collision.item,this.gridster),this.collision=!1,this.gridsterItem.setSize(),this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.push&&this.push.setPushedItems(),this.swap&&this.swap.setSwapItem(),this.push&&(this.push.destroy(),this.push=null),this.swap&&(this.swap.destroy(),this.swap=null)},this.dragStartDelay=n=>{if(n.target.classList.contains("gridster-item-resizable-handler")||as.checkContentClassForEvent(this.gridster,n))return;if(as.checkTouchEvent(n),!this.gridster.$options.draggable.delayStart)return void this.dragStart(n);const a=setTimeout(()=>{this.dragStart(n),_()},this.gridster.$options.draggable.delayStart),o=this.gridsterItem.renderer.listen("document","mouseup",_),l=this.gridsterItem.renderer.listen("document","mouseleave",_),c=this.gridsterItem.renderer.listen("window","blur",_),h=this.gridsterItem.renderer.listen("document","touchmove",function p(g){as.checkTouchEvent(g),(Math.abs(g.clientX-n.clientX)>9||Math.abs(g.clientY-n.clientY)>9)&&_()}),u=this.gridsterItem.renderer.listen("document","touchend",_),m=this.gridsterItem.renderer.listen("document","touchcancel",_);function _(){clearTimeout(a),c(),o(),l(),h(),u(),m()}},this.gridsterItem=e,this.gridster=t,this.lastMouse={clientX:0,clientY:0},this.path=[]}destroy(){this.gridster.previewStyle&&this.gridster.previewStyle(!0),this.gridsterItem=this.gridster=this.collision=null,this.mousedown&&(this.mousedown(),this.touchstart())}dragStart(e){e.which&&1!==e.which||(this.gridster.options.draggable&&this.gridster.options.draggable.start&&this.gridster.options.draggable.start(this.gridsterItem.item,this.gridsterItem,e),e.stopPropagation(),e.preventDefault(),this.zone.runOutsideAngular(()=>{this.mousemove=this.gridsterItem.renderer.listen("document","mousemove",this.dragMove),this.touchmove=this.gridster.renderer.listen(this.gridster.el,"touchmove",this.dragMove)}),this.mouseup=this.gridsterItem.renderer.listen("document","mouseup",this.dragStop),this.mouseleave=this.gridsterItem.renderer.listen("document","mouseleave",this.dragStop),this.cancelOnBlur=this.gridsterItem.renderer.listen("window","blur",this.dragStop),this.touchend=this.gridsterItem.renderer.listen("document","touchend",this.dragStop),this.touchcancel=this.gridsterItem.renderer.listen("document","touchcancel",this.dragStop),this.gridsterItem.renderer.addClass(this.gridsterItem.el,"gridster-item-moving"),this.margin=this.gridster.$options.margin,this.outerMarginTop=this.gridster.$options.outerMarginTop,this.outerMarginRight=this.gridster.$options.outerMarginRight,this.outerMarginBottom=this.gridster.$options.outerMarginBottom,this.outerMarginLeft=this.gridster.$options.outerMarginLeft,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.left=this.gridsterItem.left-this.margin,this.top=this.gridsterItem.top-this.margin,this.originalClientX=e.clientX,this.originalClientY=e.clientY,this.width=this.gridsterItem.width,this.height=this.gridsterItem.height,this.diffLeft=this.gridster.$options.dirType===qs.RTL?e.clientX-this.gridster.el.scrollWidth+this.gridsterItem.left:e.clientX+this.offsetLeft-this.margin-this.left,this.diffTop=e.clientY+this.offsetTop-this.margin-this.top,this.gridster.movingItem=this.gridsterItem.$item,this.gridster.previewStyle(!0),this.push=new Qm(this.gridsterItem),this.swap=new hu(this.gridsterItem),this.gridster.dragInProgress=!0,this.gridster.updateGrid(),this.path.push({x:this.gridsterItem.item.x||0,y:this.gridsterItem.item.y||0}))}calculateItemPositionWithScale(e,t){this.left=this.gridster.$options.dirType===qs.RTL?this.gridster.el.scrollWidth-this.originalClientX+(e.clientX-this.originalClientX)/t+this.diffLeft:this.originalClientX+(e.clientX-this.originalClientX)/t+this.offsetLeft-this.diffLeft,this.top=this.originalClientY+(e.clientY-this.originalClientY)/t+this.offsetTop-this.diffTop}calculateItemPositionWithoutScale(e){this.left=this.gridster.$options.dirType===qs.RTL?this.gridster.el.scrollWidth-e.clientX+this.diffLeft:e.clientX+this.offsetLeft-this.diffLeft,this.top=e.clientY+this.offsetTop-this.diffTop}calculateItemPosition(){if(this.gridster.movingItem=this.gridsterItem.$item,this.positionX=this.gridster.pixelsToPositionX(this.left,Math.round),this.positionY=this.gridster.pixelsToPositionY(this.top,Math.round),this.positionXBackup=this.gridsterItem.$item.x,this.positionYBackup=this.gridsterItem.$item.y,this.gridsterItem.$item.x=this.positionX,this.gridster.checkGridCollision(this.gridsterItem.$item)&&(this.gridsterItem.$item.x=this.positionXBackup),this.gridsterItem.$item.y=this.positionY,this.gridster.checkGridCollision(this.gridsterItem.$item)&&(this.gridsterItem.$item.y=this.positionYBackup),this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,this.left,this.top),this.positionXBackup!==this.gridsterItem.$item.x||this.positionYBackup!==this.gridsterItem.$item.y){const e=this.path[this.path.length-1];let t="";e.x<this.gridsterItem.$item.x?t=this.push.fromWest:e.x>this.gridsterItem.$item.x?t=this.push.fromEast:e.y<this.gridsterItem.$item.y?t=this.push.fromNorth:e.y>this.gridsterItem.$item.y&&(t=this.push.fromSouth),this.push.pushItems(t,this.gridster.$options.disablePushOnDrag),this.swap.swapItems(),this.collision=this.gridster.checkCollision(this.gridsterItem.$item),this.collision?(this.gridsterItem.$item.x=this.positionXBackup,this.gridsterItem.$item.y=this.positionYBackup,this.gridster.$options.draggable.dropOverItems&&!0!==this.collision&&this.collision.$item&&(this.gridster.movingItem=null)):this.path.push({x:this.gridsterItem.$item.x,y:this.gridsterItem.$item.y}),this.push.checkPushBack()}else this.collision=!1;this.gridster.previewStyle(!0)}toggle(){const e=this.gridsterItem.canBeDragged();!this.enabled&&e?(this.enabled=!this.enabled,this.mousedown=this.gridsterItem.renderer.listen(this.gridsterItem.el,"mousedown",this.dragStartDelay),this.touchstart=this.gridsterItem.renderer.listen(this.gridsterItem.el,"touchstart",this.dragStartDelay)):this.enabled&&!e&&(this.enabled=!this.enabled,this.mousedown(),this.touchstart())}getDirections(e){const t=[];return 0===this.lastMouse.clientX&&0===this.lastMouse.clientY&&(this.lastMouse.clientY=e.clientY,this.lastMouse.clientX=e.clientX),this.lastMouse.clientY>e.clientY&&t.push(Ar.UP),this.lastMouse.clientY<e.clientY&&t.push(Ar.DOWN),this.lastMouse.clientX<e.clientX&&t.push(Ar.RIGHT),this.lastMouse.clientX>e.clientX&&t.push(Ar.LEFT),t}}class ra{constructor(e){this.pushedItems=[],this.pushedItemsPath=[],this.gridsterItem=e,this.gridster=e.gridster,this.tryPattern={fromEast:this.tryWest,fromWest:this.tryEast,fromNorth:this.trySouth,fromSouth:this.tryNorth},this.fromSouth="fromSouth",this.fromNorth="fromNorth",this.fromEast="fromEast",this.fromWest="fromWest"}destroy(){this.gridster=this.gridsterItem=null}pushItems(e){return!!this.gridster.$options.pushResizeItems&&this.push(this.gridsterItem,e)}restoreItems(){let e=0;const t=this.pushedItems.length;let i;for(;e<t;e++)i=this.pushedItems[e],i.$item.x=i.item.x||0,i.$item.y=i.item.y||0,i.$item.cols=i.item.cols||1,i.$item.row=i.item.row||1,i.setSize();this.pushedItems=[],this.pushedItemsPath=[]}setPushedItems(){let e=0;const t=this.pushedItems.length;let i;for(;e<t;e++)i=this.pushedItems[e],i.checkItemChanges(i.$item,i.item);this.pushedItems=[],this.pushedItemsPath=[]}checkPushBack(){let e=this.pushedItems.length-1,t=!1;for(;e>-1;e--)this.checkPushedItem(this.pushedItems[e],e)&&(t=!0);t&&this.checkPushBack()}push(e,t){const i=this.gridster.checkCollision(e.$item);if(i&&!0!==i&&i!==this.gridsterItem&&i.canBeResized()){if(this.tryPattern[t].call(this,i,e,t))return!0}else if(!1===i)return!0;return!1}trySouth(e,t,i){const n=e.$item.y,r=e.$item.rows;return e.$item.y=t.$item.y+t.$item.rows,e.$item.rows=r+n-e.$item.y,this.gridster.checkCollisionTwoItems(e.$item,t.$item)||this.gridster.checkGridCollision(e.$item)?(e.$item.y=n,e.$item.rows=r,!1):(e.setSize(),this.addToPushed(e),this.push(t,i),!0)}tryNorth(e,t,i){const n=e.$item.rows;return e.$item.rows=t.$item.y-e.$item.y,this.gridster.checkCollisionTwoItems(e.$item,t.$item)||this.gridster.checkGridCollision(e.$item)?(e.$item.rows=n,!1):(e.setSize(),this.addToPushed(e),this.push(t,i),!0)}tryEast(e,t,i){const n=e.$item.x,r=e.$item.cols;return e.$item.x=t.$item.x+t.$item.cols,e.$item.cols=r+n-e.$item.x,this.gridster.checkCollisionTwoItems(e.$item,t.$item)||this.gridster.checkGridCollision(e.$item)?(e.$item.x=n,e.$item.cols=r,!1):(e.setSize(),this.addToPushed(e),this.push(t,i),!0)}tryWest(e,t,i){const n=e.$item.cols;return e.$item.cols=t.$item.x-e.$item.x,this.gridster.checkCollisionTwoItems(e.$item,t.$item)||this.gridster.checkGridCollision(e.$item)?(e.$item.cols=n,!1):(e.setSize(),this.addToPushed(e),this.push(t,i),!0)}addToPushed(e){if(this.pushedItems.indexOf(e)<0)this.pushedItems.push(e),this.pushedItemsPath.push([{x:e.item.x||0,y:e.item.y||0,cols:e.item.cols||0,rows:e.item.rows||0},{x:e.$item.x,y:e.$item.y,cols:e.$item.cols,rows:e.$item.rows}]);else{const t=this.pushedItems.indexOf(e);this.pushedItemsPath[t].push({x:e.$item.x,y:e.$item.y,cols:e.$item.cols,rows:e.$item.rows})}}removeFromPushed(e){e>-1&&(this.pushedItems.splice(e,1),this.pushedItemsPath.splice(e,1))}checkPushedItem(e,t){const i=this.pushedItemsPath[t];let r,a,o,l,c,n=i.length-2;for(;n>-1;n--)r=i[n],a=e.$item.x,o=e.$item.y,l=e.$item.cols,c=e.$item.rows,e.$item.x=r.x,e.$item.y=r.y,e.$item.cols=r.cols,e.$item.rows=r.rows,this.gridster.findItemWithItem(e.$item)?(e.$item.x=a,e.$item.y=o,e.$item.cols=l,e.$item.rows=c):(e.setSize(),i.splice(n+1,i.length-1-n));return i.length<2&&(this.removeFromPushed(t),!0)}}class R_{constructor(e,t,i){this.zone=i,this.directionFunction=null,this.dragMove=n=>{if(null===this.directionFunction)throw new Error("The `directionFunction` has not been set before calling `dragMove`.");n.stopPropagation(),n.preventDefault(),as.checkTouchEvent(n),this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,lu(this.gridster,this.left,this.top,this.width,this.height,n,this.lastMouse,this.directionFunction,!0,this.resizeEventScrollType);const r=this.gridster.options.scale||1;this.directionFunction({clientX:this.originalClientX+(n.clientX-this.originalClientX)/r,clientY:this.originalClientY+(n.clientY-this.originalClientY)/r}),this.lastMouse.clientX=n.clientX,this.lastMouse.clientY=n.clientY,this.zone.run(()=>{this.gridster.updateGrid()})},this.dragStop=n=>{n.stopPropagation(),n.preventDefault(),Bo(),this.mousemove(),this.mouseup(),this.mouseleave(),this.cancelOnBlur(),this.touchmove(),this.touchend(),this.touchcancel(),this.gridster.dragInProgress=!1,this.gridster.updateGrid(),this.gridster.options.resizable&&this.gridster.options.resizable.stop?Promise.resolve(this.gridster.options.resizable.stop(this.gridsterItem.item,this.gridsterItem,n)).then(this.makeResize,this.cancelResize):this.makeResize(),setTimeout(()=>{this.gridsterItem.renderer.removeClass(this.gridsterItem.el,"gridster-item-resizing"),this.gridster&&(this.gridster.movingItem=null,this.gridster.previewStyle())})},this.cancelResize=()=>{this.gridsterItem.$item.cols=this.gridsterItem.item.cols||1,this.gridsterItem.$item.rows=this.gridsterItem.item.rows||1,this.gridsterItem.$item.x=this.gridsterItem.item.x||0,this.gridsterItem.$item.y=this.gridsterItem.item.y||0,this.gridsterItem.setSize(),this.push.restoreItems(),this.pushResize.restoreItems(),this.push.destroy(),this.push=null,this.pushResize.destroy(),this.pushResize=null},this.makeResize=()=>{this.gridsterItem.setSize(),this.gridsterItem.checkItemChanges(this.gridsterItem.$item,this.gridsterItem.item),this.push.setPushedItems(),this.pushResize.setPushedItems(),this.push.destroy(),this.push=null,this.pushResize.destroy(),this.pushResize=null},this.handleNorth=n=>{if(this.top=n.clientY+this.offsetTop-this.diffTop,this.height=this.bottom-this.top,this.minHeight>this.height?(this.height=this.minHeight,this.top=this.bottom-this.minHeight):this.gridster.options.enableBoundaryControl&&(this.top=Math.max(0,this.top),this.height=this.bottom-this.top),this.newPosition=this.gridster.pixelsToPositionY(this.top+(this.gridster.options.pushItems?this.margin:0),Math.floor),this.gridsterItem.$item.y!==this.newPosition){if(this.itemBackup[1]=this.gridsterItem.$item.y,this.itemBackup[3]=this.gridsterItem.$item.rows,this.gridsterItem.$item.rows+=this.gridsterItem.$item.y-this.newPosition,this.gridsterItem.$item.y=this.newPosition,this.pushResize.pushItems(this.pushResize.fromSouth),this.push.pushItems(this.push.fromSouth,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item))return this.gridsterItem.$item.y=this.itemBackup[1],this.gridsterItem.$item.rows=this.itemBackup[3],this.top=this.gridster.positionYToPixels(this.gridsterItem.$item.y),this.setItemTop(this.gridster.positionYToPixels(this.gridsterItem.$item.y)),void this.setItemHeight(this.gridster.positionYToPixels(this.gridsterItem.$item.rows)-this.margin);this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemTop(this.top),this.setItemHeight(this.height)},this.handleWest=n=>{if(this.left=(this.gridster.$options.dirType===qs.RTL?this.originalClientX+(this.originalClientX-n.clientX):n.clientX)+this.offsetLeft-this.diffLeft,this.width=this.right-this.left,this.minWidth>this.width?(this.width=this.minWidth,this.left=this.right-this.minWidth):this.gridster.options.enableBoundaryControl&&(this.left=Math.max(0,this.left),this.width=this.right-this.left),this.newPosition=this.gridster.pixelsToPositionX(this.left+(this.gridster.options.pushItems?this.margin:0),Math.floor),this.gridsterItem.$item.x!==this.newPosition){if(this.itemBackup[0]=this.gridsterItem.$item.x,this.itemBackup[2]=this.gridsterItem.$item.cols,this.gridsterItem.$item.cols+=this.gridsterItem.$item.x-this.newPosition,this.gridsterItem.$item.x=this.newPosition,this.pushResize.pushItems(this.pushResize.fromEast),this.push.pushItems(this.push.fromEast,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item))return this.gridsterItem.$item.x=this.itemBackup[0],this.gridsterItem.$item.cols=this.itemBackup[2],this.left=this.gridster.positionXToPixels(this.gridsterItem.$item.x),this.setItemLeft(this.gridster.positionXToPixels(this.gridsterItem.$item.x)),void this.setItemWidth(this.gridster.positionXToPixels(this.gridsterItem.$item.cols)-this.margin);this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemLeft(this.left),this.setItemWidth(this.width)},this.handleSouth=n=>{if(this.height=n.clientY+this.offsetTop-this.diffBottom-this.top,this.minHeight>this.height&&(this.height=this.minHeight),this.bottom=this.top+this.height,this.gridster.options.enableBoundaryControl){const a=this.outerMarginBottom??this.margin,o=this.gridster.el.getBoundingClientRect();this.bottom=Math.min(this.bottom,o.bottom-o.top-2*a),this.height=this.bottom-this.top}if(this.newPosition=this.gridster.pixelsToPositionY(this.bottom+(this.gridster.options.pushItems?0:this.margin),Math.ceil),this.gridsterItem.$item.y+this.gridsterItem.$item.rows!==this.newPosition){if(this.itemBackup[3]=this.gridsterItem.$item.rows,this.gridsterItem.$item.rows=this.newPosition-this.gridsterItem.$item.y,this.pushResize.pushItems(this.pushResize.fromNorth),this.push.pushItems(this.push.fromNorth,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item))return this.gridsterItem.$item.rows=this.itemBackup[3],void this.setItemHeight(this.gridster.positionYToPixels(this.gridsterItem.$item.rows)-this.margin);this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemHeight(this.height)},this.handleEast=n=>{if(this.width=(this.gridster.$options.dirType===qs.RTL?this.originalClientX+(this.originalClientX-n.clientX):n.clientX)+this.offsetLeft-this.diffRight-this.left,this.minWidth>this.width&&(this.width=this.minWidth),this.right=this.left+this.width,this.gridster.options.enableBoundaryControl){const o=this.outerMarginRight??this.margin,l=this.gridster.el.getBoundingClientRect();this.right=Math.min(this.right,l.right-l.left-2*o),this.width=this.right-this.left}if(this.newPosition=this.gridster.pixelsToPositionX(this.right+(this.gridster.options.pushItems?0:this.margin),Math.ceil),this.gridsterItem.$item.x+this.gridsterItem.$item.cols!==this.newPosition){if(this.itemBackup[2]=this.gridsterItem.$item.cols,this.gridsterItem.$item.cols=this.newPosition-this.gridsterItem.$item.x,this.pushResize.pushItems(this.pushResize.fromWest),this.push.pushItems(this.push.fromWest,this.gridster.$options.disablePushOnResize),this.gridster.checkCollision(this.gridsterItem.$item))return this.gridsterItem.$item.cols=this.itemBackup[2],void this.setItemWidth(this.gridster.positionXToPixels(this.gridsterItem.$item.cols)-this.margin);this.gridster.previewStyle(),this.pushResize.checkPushBack(),this.push.checkPushBack()}this.setItemWidth(this.width)},this.handleNorthWest=n=>{this.handleNorth(n),this.handleWest(n)},this.handleNorthEast=n=>{this.handleNorth(n),this.handleEast(n)},this.handleSouthWest=n=>{this.handleSouth(n),this.handleWest(n)},this.handleSouthEast=n=>{this.handleSouth(n),this.handleEast(n)},this.gridsterItem=e,this.gridster=t,this.lastMouse={clientX:0,clientY:0},this.itemBackup=[0,0,0,0],this.resizeEventScrollType={west:!1,east:!1,north:!1,south:!1}}destroy(){this.gridster?.previewStyle(),this.gridster=this.gridsterItem=null}dragStart(e){if(e.which&&1!==e.which)return;this.gridster.options.resizable&&this.gridster.options.resizable.start&&this.gridster.options.resizable.start(this.gridsterItem.item,this.gridsterItem,e),e.stopPropagation(),e.preventDefault(),this.zone.runOutsideAngular(()=>{this.mousemove=this.gridsterItem.renderer.listen("document","mousemove",this.dragMove),this.touchmove=this.gridster.renderer.listen(this.gridster.el,"touchmove",this.dragMove)}),this.mouseup=this.gridsterItem.renderer.listen("document","mouseup",this.dragStop),this.mouseleave=this.gridsterItem.renderer.listen("document","mouseleave",this.dragStop),this.cancelOnBlur=this.gridsterItem.renderer.listen("window","blur",this.dragStop),this.touchend=this.gridsterItem.renderer.listen("document","touchend",this.dragStop),this.touchcancel=this.gridsterItem.renderer.listen("document","touchcancel",this.dragStop),this.gridsterItem.renderer.addClass(this.gridsterItem.el,"gridster-item-resizing"),this.lastMouse.clientX=e.clientX,this.lastMouse.clientY=e.clientY,this.left=this.gridsterItem.left,this.top=this.gridsterItem.top,this.originalClientX=e.clientX,this.originalClientY=e.clientY,this.width=this.gridsterItem.width,this.height=this.gridsterItem.height,this.bottom=this.gridsterItem.top+this.gridsterItem.height,this.right=this.gridsterItem.left+this.gridsterItem.width,this.margin=this.gridster.$options.margin,this.outerMarginTop=this.gridster.$options.outerMarginTop,this.outerMarginRight=this.gridster.$options.outerMarginRight,this.outerMarginBottom=this.gridster.$options.outerMarginBottom,this.outerMarginLeft=this.gridster.$options.outerMarginLeft,this.offsetLeft=this.gridster.el.scrollLeft-this.gridster.el.offsetLeft,this.offsetTop=this.gridster.el.scrollTop-this.gridster.el.offsetTop,this.diffLeft=e.clientX+this.offsetLeft-this.left,this.diffRight=e.clientX+this.offsetLeft-this.right,this.diffTop=e.clientY+this.offsetTop-this.top,this.diffBottom=e.clientY+this.offsetTop-this.bottom,this.minHeight=this.gridster.positionYToPixels(this.gridsterItem.$item.minItemRows||this.gridster.$options.minItemRows)-this.margin,this.minWidth=this.gridster.positionXToPixels(this.gridsterItem.$item.minItemCols||this.gridster.$options.minItemCols)-this.margin,this.gridster.movingItem=this.gridsterItem.$item,this.gridster.previewStyle(),this.push=new Qm(this.gridsterItem),this.pushResize=new ra(this.gridsterItem),this.gridster.dragInProgress=!0,this.gridster.updateGrid();const{classList:t}=e.target;t.contains("handle-n")?(this.resizeEventScrollType.north=!0,this.directionFunction=this.handleNorth):t.contains("handle-w")?this.gridster.$options.dirType===qs.RTL?(this.resizeEventScrollType.east=!0,this.directionFunction=this.handleEast):(this.resizeEventScrollType.west=!0,this.directionFunction=this.handleWest):t.contains("handle-s")?(this.resizeEventScrollType.south=!0,this.directionFunction=this.handleSouth):t.contains("handle-e")?this.gridster.$options.dirType===qs.RTL?(this.resizeEventScrollType.west=!0,this.directionFunction=this.handleWest):(this.resizeEventScrollType.east=!0,this.directionFunction=this.handleEast):t.contains("handle-nw")?this.gridster.$options.dirType===qs.RTL?(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleNorthEast):(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleNorthWest):t.contains("handle-ne")?this.gridster.$options.dirType===qs.RTL?(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleNorthWest):(this.resizeEventScrollType.north=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleNorthEast):t.contains("handle-sw")?this.gridster.$options.dirType===qs.RTL?(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleSouthEast):(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleSouthWest):t.contains("handle-se")&&(this.gridster.$options.dirType===qs.RTL?(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.west=!0,this.directionFunction=this.handleSouthWest):(this.resizeEventScrollType.south=!0,this.resizeEventScrollType.east=!0,this.directionFunction=this.handleSouthEast))}toggle(){this.resizeEnabled=this.gridsterItem.canBeResized(),this.resizableHandles=this.gridsterItem.getResizableHandles()}dragStartDelay(e){if(as.checkTouchEvent(e),!this.gridster.$options.resizable.delayStart)return void this.dragStart(e);const t=setTimeout(()=>{this.dragStart(e),h()},this.gridster.$options.resizable.delayStart),{cancelMouse:i,cancelMouseLeave:n,cancelOnBlur:r,cancelTouchMove:a,cancelTouchEnd:o,cancelTouchCancel:l}=this.zone.runOutsideAngular(()=>({cancelMouse:this.gridsterItem.renderer.listen("document","mouseup",h),cancelMouseLeave:this.gridsterItem.renderer.listen("document","mouseleave",h),cancelOnBlur:this.gridsterItem.renderer.listen("window","blur",h),cancelTouchMove:this.gridsterItem.renderer.listen("document","touchmove",c),cancelTouchEnd:this.gridsterItem.renderer.listen("document","touchend",h),cancelTouchCancel:this.gridsterItem.renderer.listen("document","touchcancel",h)}));function c(u){as.checkTouchEvent(u),(Math.abs(u.clientX-e.clientX)>9||Math.abs(u.clientY-e.clientY)>9)&&h()}function h(){clearTimeout(t),r(),i(),n(),a(),o(),l()}}setItemTop(e){this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,this.left,e)}setItemLeft(e){this.gridster.gridRenderer.setCellPosition(this.gridsterItem.renderer,this.gridsterItem.el,e,this.top)}setItemHeight(e){this.gridsterItem.renderer.setStyle(this.gridsterItem.el,"height",e+"px")}setItemWidth(e){this.gridsterItem.renderer.setStyle(this.gridsterItem.el,"width",e+"px")}}let _n=(()=>{class s{get zIndex(){return this.getLayerIndex()+this.gridster.$options.baseLayerIndex}constructor(t,i,n,r){this.renderer=n,this.zone=r,this.itemInit=new d.vpe,this.itemChange=new d.vpe,this.itemResize=new d.vpe,this.el=t.nativeElement,this.$item={cols:-1,rows:-1,x:-1,y:-1},this.gridster=i,this.drag=new O_(this,i,this.zone),this.resize=new R_(this,i,this.zone)}ngOnInit(){this.gridster.addItem(this)}ngOnChanges(t){t.item&&(this.updateOptions(),this.init||this.gridster.calculateLayout$.next()),t.item&&t.item.previousValue&&this.setSize()}updateOptions(){this.$item=as.merge(this.$item,this.item,{cols:void 0,rows:void 0,x:void 0,y:void 0,layerIndex:void 0,dragEnabled:void 0,resizeEnabled:void 0,compactEnabled:void 0,maxItemRows:void 0,minItemRows:void 0,maxItemCols:void 0,minItemCols:void 0,maxItemArea:void 0,minItemArea:void 0,resizableHandles:{s:void 0,e:void 0,n:void 0,w:void 0,se:void 0,ne:void 0,sw:void 0,nw:void 0}})}ngOnDestroy(){this.gridster.removeItem(this),this.drag.destroy(),this.resize.destroy(),this.gridster=this.drag=this.resize=null}setSize(){this.renderer.setStyle(this.el,"display",this.notPlaced?"":"block"),this.gridster.gridRenderer.updateItem(this.el,this.$item,this.renderer),this.updateItemSize()}updateItemSize(){const i=this.$item.x*this.gridster.curColWidth,n=this.$item.cols*this.gridster.curColWidth-this.gridster.$options.margin,r=this.$item.rows*this.gridster.curRowHeight-this.gridster.$options.margin;this.top=this.$item.y*this.gridster.curRowHeight,this.left=i,!this.init&&n>0&&r>0&&(this.init=!0,this.item.initCallback&&this.item.initCallback(this.item,this),this.gridster.options.itemInitCallback&&this.gridster.options.itemInitCallback(this.item,this),this.itemInit.next({item:this.item,itemComponent:this}),this.gridster.$options.scrollToNewItems&&this.el.scrollIntoView(!1)),(n!==this.width||r!==this.height)&&(this.width=n,this.height=r,this.gridster.options.itemResizeCallback&&this.gridster.options.itemResizeCallback(this.item,this),this.itemResize.next({item:this.item,itemComponent:this}))}itemChanged(){this.gridster.options.itemChangeCallback&&this.gridster.options.itemChangeCallback(this.item,this),this.itemChange.next({item:this.item,itemComponent:this})}checkItemChanges(t,i){t.rows===i.rows&&t.cols===i.cols&&t.x===i.x&&t.y===i.y||(this.gridster.checkCollision(this.$item)?(this.$item.x=i.x||0,this.$item.y=i.y||0,this.$item.cols=i.cols||1,this.$item.rows=i.rows||1,this.setSize()):(this.item.cols=this.$item.cols,this.item.rows=this.$item.rows,this.item.x=this.$item.x,this.item.y=this.$item.y,this.gridster.calculateLayout$.next(),this.itemChanged()))}canBeDragged(){const t=this.gridster.$options.draggable.enabled;return!this.gridster.mobile&&t&&(void 0===this.$item.dragEnabled?t:this.$item.dragEnabled)}canBeResized(){const t=this.gridster.$options.resizable.enabled;return!this.gridster.mobile&&t&&(void 0===this.$item.resizeEnabled?t:this.$item.resizeEnabled)}getResizableHandles(){const t=this.gridster.$options.resizable.handles,i=this.$item.resizableHandles;return void 0===i?t:{...t,...i}}bringToFront(t){if(t&&t<=0)return;const i=this.getLayerIndex(),n=this.gridster.$options.maxLayerIndex;if(i<n){const r=t?i+t:n;this.item.layerIndex=this.$item.layerIndex=r>n?n:r}}sendToBack(t){if(t&&t<=0)return;const i=this.getLayerIndex();if(i>0){const n=t?i-t:0;this.item.layerIndex=this.$item.layerIndex=n<0?0:n}}getLayerIndex(){return void 0!==this.item.layerIndex?this.item.layerIndex:void 0!==this.gridster.$options.defaultLayerIndex?this.gridster.$options.defaultLayerIndex:0}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(d.SBq),d.Y36(Jm),d.Y36(d.Qsj),d.Y36(d.R0b))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["gridster-item"]],hostVars:2,hostBindings:function(i,n){2&i&&d.Udp("z-index",n.zIndex)},inputs:{item:"item"},outputs:{itemInit:"itemInit",itemChange:"itemChange",itemResize:"itemResize"},standalone:!0,features:[d.TTD,d.jDz],ngContentSelectors:qm,decls:9,vars:8,consts:[["class","gridster-item-resizable-handler handle-s",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-e",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-n",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-w",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-se",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-ne",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-sw",3,"mousedown","touchstart",4,"ngIf"],["class","gridster-item-resizable-handler handle-nw",3,"mousedown","touchstart",4,"ngIf"],[1,"gridster-item-resizable-handler","handle-s",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-e",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-n",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-w",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-se",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-ne",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-sw",3,"mousedown","touchstart"],[1,"gridster-item-resizable-handler","handle-nw",3,"mousedown","touchstart"]],template:function(i,n){1&i&&(d.F$t(),d.Hsn(0),d.YNc(1,$m,1,0,"div",0),d.YNc(2,x_,1,0,"div",1),d.YNc(3,w_,1,0,"div",2),d.YNc(4,M_,1,0,"div",3),d.YNc(5,T_,1,0,"div",4),d.YNc(6,C_,1,0,"div",5),d.YNc(7,Km,1,0,"div",6),d.YNc(8,D_,1,0,"div",7)),2&i&&(d.xp6(1),d.Q6J("ngIf",(null==n.resize.resizableHandles?null:n.resize.resizableHandles.s)&&n.resize.resizeEnabled),d.xp6(1),d.Q6J("ngIf",(null==n.resize.resizableHandles?null:n.resize.resizableHandles.e)&&n.resize.resizeEnabled),d.xp6(1),d.Q6J("ngIf",(null==n.resize.resizableHandles?null:n.resize.resizableHandles.n)&&n.resize.resizeEnabled),d.xp6(1),d.Q6J("ngIf",(null==n.resize.resizableHandles?null:n.resize.resizableHandles.w)&&n.resize.resizeEnabled),d.xp6(1),d.Q6J("ngIf",(null==n.resize.resizableHandles?null:n.resize.resizableHandles.se)&&n.resize.resizeEnabled),d.xp6(1),d.Q6J("ngIf",(null==n.resize.resizableHandles?null:n.resize.resizableHandles.ne)&&n.resize.resizeEnabled),d.xp6(1),d.Q6J("ngIf",(null==n.resize.resizableHandles?null:n.resize.resizableHandles.sw)&&n.resize.resizeEnabled),d.xp6(1),d.Q6J("ngIf",(null==n.resize.resizableHandles?null:n.resize.resizableHandles.nw)&&n.resize.resizeEnabled))},dependencies:[x.O5],styles:["gridster-item{box-sizing:border-box;z-index:1;position:absolute;overflow:hidden;transition:.3s;display:none;background:white;-webkit-user-select:text;user-select:text}gridster-item.gridster-item-moving{cursor:move}gridster-item.gridster-item-resizing,gridster-item.gridster-item-moving{transition:0s;z-index:2;box-shadow:0 0 5px 5px #0003,0 6px 10px #00000024,0 1px 18px #0000001f}.gridster-item-resizable-handler{position:absolute;z-index:2}.gridster-item-resizable-handler.handle-n{cursor:ns-resize;height:10px;right:0;top:0;left:0}.gridster-item-resizable-handler.handle-e{cursor:ew-resize;width:10px;bottom:0;right:0;top:0}.gridster-item-resizable-handler.handle-s{cursor:ns-resize;height:10px;right:0;bottom:0;left:0}.gridster-item-resizable-handler.handle-w{cursor:ew-resize;width:10px;left:0;top:0;bottom:0}.gridster-item-resizable-handler.handle-ne{cursor:ne-resize;width:10px;height:10px;right:0;top:0}.gridster-item-resizable-handler.handle-nw{cursor:nw-resize;width:10px;height:10px;left:0;top:0}.gridster-item-resizable-handler.handle-se{cursor:se-resize;width:0;height:0;right:0;bottom:0;border-style:solid;border-width:0 0 10px 10px;border-color:transparent}.gridster-item-resizable-handler.handle-sw{cursor:sw-resize;width:10px;height:10px;left:0;bottom:0}gridster-item:hover .gridster-item-resizable-handler.handle-se{border-color:transparent transparent #ccc}\n"],encapsulation:2})}return s})(),rp=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275mod=d.oAB({type:s});static#i=this.\u0275inj=d.cJS({})}return s})();var uu=V(2507);const ap=["gridSterContainer"],aa=["gridster"];function op(s,e){if(1&s&&(d.TgZ(0,"gridster-item",6),d._UZ(1,"panel-container",7),d.qZA()),2&s){const t=e.$implicit,i=d.oxw();d.Q6J("item",t.gridSterConfig),d.xp6(1),d.Q6J("panel",t)("colorGrid",i.options.colorGrid)}}let mc=(()=>{class s extends uu.H{get container(){return this.containerRef.nativeElement}constructor(t,i){super(),this.dashboardStore=t,this.dockManager=i,this.mainForm=new A.cw({}),this.options={useTransformPositioning:!0,mobileBreakpoint:640,useBodyForBreakpoint:!1,maxItemCols:100,minItemCols:1,maxItemRows:100,minItemRows:1,maxItemArea:2500,minItemArea:1,defaultItemCols:1,defaultItemRows:1,fixedColWidth:105,fixedRowHeight:105,keepFixedHeightInMobile:!1,keepFixedWidthInMobile:!1,scrollSensitivity:10,scrollSpeed:20,enableEmptyCellClick:!1,enableEmptyCellContextMenu:!1,enableEmptyCellDrop:!1,enableEmptyCellDrag:!1,enableOccupiedCellDrop:!1,emptyCellDragMaxCols:50,emptyCellDragMaxRows:50,ignoreMarginInRow:!1,margin:0,draggable:{enabled:!1},resizable:{enabled:!1},swap:!0,pushItems:!1,disablePushOnDrag:!1,disablePushOnResize:!1,pushDirections:{north:!0,east:!0,south:!0,west:!0},pushResizeItems:!1,disableWindowResize:!1,disableWarnings:!1,scrollToNewItems:!1,itemChangeCallback:(n,r)=>{this.dockManager.updateGridSterComponent(n)},itemResizeCallback:(n,r)=>{this.dockManager.updateGridSterComponent(n)}}}ngOnInit(){this.updateGrid(this.dockManager.getDashboardGridConfig),this.safeObservable(this.dockManager.lockActiveDashboardLayout$()).subscribe(t=>{t?(this.options.draggable.enabled=!1,this.options.resizable.enabled=!1):(this.options.draggable.enabled=!0,this.options.resizable.enabled=!0),this.options.api&&this.options.api.optionsChanged&&this.options.api.optionsChanged(),this.gridSter?.updateGrid()})}ngAfterViewInit(){new ResizeObserver(()=>{this.updateGrid(this.options)}).observe(this.container)}addFormField(t){t.forEach(i=>{"Form"===i.type&&this.mainForm.addControl(i.config.content.Name,new A.NI(0))})}updateGrid(t){this.options={...this.options,...t,displayGrid:ou.None}}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(Ie.yh),d.Y36(cy))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-gridster"]],viewQuery:function(i,n){if(1&i&&(d.Gf(ap,5),d.Gf(aa,5)),2&i){let r;d.iGM(r=d.CRH())&&(n.containerRef=r.first),d.iGM(r=d.CRH())&&(n.gridSter=r.first)}},features:[d.qOj],decls:6,vars:3,consts:[[2,"width","100%","height","100%"],["gridSterContainer",""],[3,"formGroup"],[1,"gridster-container",3,"options"],["gridster",""],[3,"item",4,"ngFor","ngForOf"],[3,"item"],[3,"panel","colorGrid"]],template:function(i,n){1&i&&(d.TgZ(0,"div",0,1),d.ynx(2,2),d.TgZ(3,"gridster",3,4),d.YNc(5,op,2,3,"gridster-item",5),d.qZA(),d.BQk(),d.qZA()),2&i&&(d.xp6(2),d.Q6J("formGroup",n.mainForm),d.xp6(1),d.Q6J("options",n.options),d.xp6(2),d.Q6J("ngForOf",n.dockManager.gridSterPanels))},styles:[".container[_ngcontent-%COMP%], main[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#7b7a7f}.grid-item-content[_ngcontent-%COMP%]{width:100%;height:100%}.grid-item-content[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;height:100%}*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}.gridster-container[_ngcontent-%COMP%]{background-color:#7b7a7f}"]})}return s})();function yl(s,e){const t=s.length;for(let i=0;i<t;++i)if(s[i]===e)return i;return-1}function mu(s,e){const t=s.length,i=new Array(t);for(let n=0;n<t;++n)i[n]=e(s[n],n);return i}function ye(s,e){const t=s.length;for(let i=0;i<t;++i)e(s[i],i)}function pc(s,e){let t=s.length;for(;t>0;)--t,e(s[t],t)}function lp(s,e){const t=s.length;for(let i=0;i<t&&e(s[i],i);++i);}function Pr(s,e){let t=!1,i=0;for(;;){if(i=s.indexOf(e,i),-1===i)return t;t=!0,s.splice(i,1)}}function rr(s,e){let t=s.indexOf(e);return-1!==t&&(s.splice(t,1),!0)}function bd(s,e,t){let i=yl(s,e);-1!==i&&yd(s,i),null==t?s.push(e):No(s,t,e)}function lo(s,e){-1===s.indexOf(e)&&s.push(e)}function vd(s){const e=s.length,t=new Array(e);for(let i=0;i<e;++i)t[i]=s[i];return t}function No(s,e,t){s.splice(e,0,t)}function yd(s,e){s.splice(e,1)}function wl(s,e){const t=s.length;for(let i=0;i<t;++i)if(e(s[i],i))return i;return-1}function wd(s,e){const t=wl(s,e);if(-1!==t)return s[t]}function fu(s,e){let t=0,i=s.length,n=!1;for(;t<i;){const r=t+i>>1,a=e(s[r]);a<0?t=r+1:0===a?(n=!0,t=r+1):i=r}return{found:n,index:n?t-1:t}}function gu(s,e){let t=0,i=s.length,n=!1;for(;t<i;){const r=t+i>>1,a=e(s[r]);a<0?t=r+1:(0===a&&(n=!0),i=r)}return{found:n,index:t}}function Md(s,e){let t=s.length;for(;t>0;)--t,e(s[t])||s.splice(t,1)}class _u{constructor(){Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._disposed=!1}isDisposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._dispose())}}class Ds{constructor(e){Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dispose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._disposed=!1,this._dispose=e}isDisposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._dispose())}}class mp extends _u{constructor(){super(...arguments),Object.defineProperty(this,"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:[]})}_dispose(){ye(this._disposers,e=>{e.dispose()})}}class mr extends _u{constructor(e){super(),Object.defineProperty(this,"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._disposers=e}_dispose(){ye(this._disposers,e=>{e.dispose()})}get disposers(){return this._disposers}}class bu extends Ds{constructor(){super(...arguments),Object.defineProperty(this,"_counter",{enumerable:!0,configurable:!0,writable:!0,value:0})}increment(){return++this._counter,new Ds(()=>{--this._counter,0===this._counter&&this.dispose()})}}function Kt(s){return Number(s)!==s}function _s(s){if(null!=s&&!Se(s)){let e=Number(s);return Kt(e)&&Ml(s)&&""!=s?_s(s.replace(/[^0-9.\-]+/g,"")):e}return s}function V_(s){if(vu(s))return new Date(s);if(Se(s))return new Date(s);{let e=Number(s);return Se(e)?new Date(e):new Date(s)}}function pp(s,e){return new Array(e+1).join(s)}function vu(s){return"[object Date]"===function fc(s){return{}.toString.call(s)}(s)}function Ml(s){return"string"==typeof s}function Se(s){return"number"==typeof s&&Number(s)==s}function Td(s){return"object"==typeof s&&null!==s}const co="__\xa7\xa7\xa7__",Tl="__\xa7\xa7\xa7\xa7__";class Cl{constructor(){Object.defineProperty(this,"_listeners",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_killed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_disabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_iterating",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_enabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._listeners=[],this._killed=[],this._disabled={},this._iterating=0,this._enabled=!0,this._disposed=!1}isDisposed(){return this._disposed}dispose(){if(!this._disposed){this._disposed=!0;const e=this._listeners;this._iterating=1,this._listeners=null,this._disabled=null;try{ye(e,t=>{t.disposer.dispose()})}finally{this._killed=null,this._iterating=null}}}hasListeners(){return 0!==this._listeners.length}hasListenersByType(e){return function L_(s,e){const t=s.length;for(let i=0;i<t;++i)if(e(s[i]))return!0;return!1}(this._listeners,t=>(null===t.type||t.type===e)&&!t.killed)}enable(){this._enabled=!0}disable(){this._enabled=!1}enableType(e){delete this._disabled[e]}disableType(e,t=1/0){this._disabled[e]=t}_removeListener(e){if(0===this._iterating){const t=this._listeners.indexOf(e);if(-1===t)throw new Error("Invalid state: could not remove listener");this._listeners.splice(t,1)}else this._killed.push(e)}_removeExistingListener(e,t,i,n){if(this._disposed)throw new Error("EventDispatcher is disposed");this._eachListener(r=>{r.once===e&&r.type===t&&(void 0===i||r.callback===i)&&r.context===n&&r.disposer.dispose()})}isEnabled(e){if(this._disposed)throw new Error("EventDispatcher is disposed");return this._enabled&&this._listeners.length>0&&this.hasListenersByType(e)&&void 0===this._disabled[e]}removeType(e){if(this._disposed)throw new Error("EventDispatcher is disposed");this._eachListener(t=>{t.type===e&&t.disposer.dispose()})}has(e,t,i){return-1!==wl(this._listeners,r=>!0!==r.once&&r.type===e&&(void 0===t||r.callback===t)&&r.context===i)}_shouldDispatch(e){if(this._disposed)throw new Error("EventDispatcher is disposed");const t=this._disabled[e];return Se(t)?(t<=1?delete this._disabled[e]:--this._disabled[e],!1):this._enabled}_eachListener(e){++this._iterating;try{ye(this._listeners,e)}finally{--this._iterating,0===this._iterating&&0!==this._killed.length&&(ye(this._killed,t=>{this._removeListener(t)}),this._killed.length=0)}}dispatch(e,t){this._shouldDispatch(e)&&this._eachListener(i=>{!i.killed&&(null===i.type||i.type===e)&&i.dispatch(e,t)})}_on(e,t,i,n,r,a){if(this._disposed)throw new Error("EventDispatcher is disposed");this._removeExistingListener(e,t,i,n);const o={type:t,callback:i,context:n,shouldClone:r,dispatch:a,killed:!1,once:e,disposer:new Ds(()=>{o.killed=!0,this._removeListener(o)})};return this._listeners.push(o),o}onAll(e,t,i=!0){return this._on(!1,null,e,t,i,(n,r)=>e.call(t,r)).disposer}on(e,t,i,n=!0){return this._on(!1,e,t,i,n,(r,a)=>t.call(i,a)).disposer}once(e,t,i,n=!0){const r=this._on(!0,e,t,i,n,(a,o)=>{r.disposer.dispose(),t.call(i,o)});return r.disposer}off(e,t,i){this._removeExistingListener(!1,e,t,i)}copyFrom(e){if(this._disposed)throw new Error("EventDispatcher is disposed");if(e===this)throw new Error("Cannot copyFrom the same TargetedEventDispatcher");const t=[];return ye(e._listeners,i=>{!i.killed&&i.shouldClone&&t.push(null===i.type?this.onAll(i.callback,i.context):i.once?this.once(i.type,i.callback,i.context):this.on(i.type,i.callback,i.context))}),new mr(t)}}function gc(s,e){if(!(s>=0&&s<e))throw new Error("Index out of bounds: "+s)}class Dl{constructor(e=[]){Object.defineProperty(this,"_values",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Cl}),this._values=e}get values(){return this._values}contains(e){return-1!==this._values.indexOf(e)}removeValue(e){let t=0,i=this._values.length;for(;t<i;)this._values[t]===e?(this.removeIndex(t),--i):++t}indexOf(e){return yl(this._values,e)}get length(){return this._values.length}hasIndex(e){return e>=0&&e<this._values.length}getIndex(e){return this._values[e]}_onPush(e){this.events.isEnabled("push")&&this.events.dispatch("push",{type:"push",target:this,newValue:e})}_onInsertIndex(e,t){this.events.isEnabled("insertIndex")&&this.events.dispatch("insertIndex",{type:"insertIndex",target:this,index:e,newValue:t})}_onSetIndex(e,t,i){this.events.isEnabled("setIndex")&&this.events.dispatch("setIndex",{type:"setIndex",target:this,index:e,oldValue:t,newValue:i})}_onRemoveIndex(e,t){this.events.isEnabled("removeIndex")&&this.events.dispatch("removeIndex",{type:"removeIndex",target:this,index:e,oldValue:t})}_onMoveIndex(e,t,i){this.events.isEnabled("moveIndex")&&this.events.dispatch("moveIndex",{type:"moveIndex",target:this,oldIndex:e,newIndex:t,value:i})}_onClear(e){this.events.isEnabled("clear")&&this.events.dispatch("clear",{type:"clear",target:this,oldValues:e})}setIndex(e,t){gc(e,this._values.length);const i=this._values[e];return i!==t&&(this._values[e]=t,this._onSetIndex(e,i,t)),i}insertIndex(e,t){return gc(e,this._values.length+1),No(this._values,e,t),this._onInsertIndex(e,t),t}swap(e,t){const i=this._values.length;if(gc(e,i),gc(t,i),e!==t){const n=this._values[e],r=this._values[t];this._values[e]=r,this._onSetIndex(e,n,r),this._values[t]=n,this._onSetIndex(t,r,n)}}removeIndex(e){gc(e,this._values.length);const t=this._values[e];return yd(this._values,e),this._onRemoveIndex(e,t),t}moveValue(e,t){let i=this.indexOf(e);if(-1!==i)if(yd(this._values,i),null==t){const n=this._values.length;this._values.push(e),this._onMoveIndex(i,n,e)}else No(this._values,t,e),this._onMoveIndex(i,t,e);else null==t?(this._values.push(e),this._onPush(e)):(No(this._values,t,e),this._onInsertIndex(t,e));return e}push(e){return this._values.push(e),this._onPush(e),e}unshift(e){return this.insertIndex(0,e),e}pushAll(e){ye(e,t=>{this.push(t)})}copyFrom(e){this.pushAll(e._values)}pop(){return this._values.length-1<0?void 0:this.removeIndex(this._values.length-1)}shift(){return this._values.length?this.removeIndex(0):void 0}setAll(e){const t=this._values;this._values=[],this._onClear(t),ye(e,i=>{this._values.push(i),this._onPush(i)})}clear(){this.setAll([])}*[Symbol.iterator](){const e=this._values.length;for(let t=0;t<e;++t)yield this._values[t]}each(e){ye(this._values,e)}eachReverse(e){pc(this._values,e)}}class Cd extends Dl{constructor(){super(...arguments),Object.defineProperty(this,"autoDispose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_onSetIndex(e,t,i){this.autoDispose&&t.dispose(),super._onSetIndex(e,t,i)}_onRemoveIndex(e,t){this.autoDispose&&t.dispose(),super._onRemoveIndex(e,t)}_onClear(e){this.autoDispose&&ye(e,t=>{t.dispose()}),super._onClear(e)}isDisposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this.autoDispose&&ye(this._values,e=>{e.dispose()}))}}class bs extends Cd{constructor(e,t){super(),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"make",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.template=e,this.make=t}}class G_ extends Dl{constructor(e){super(),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._container=e,this._events=this.events.onAll(t=>{if("clear"===t.type)ye(t.oldValues,i=>{this._onRemoved(i)});else if("push"===t.type)this._onInserted(t.newValue);else if("setIndex"===t.type)this._onRemoved(t.oldValue),this._onInserted(t.newValue,t.index);else if("insertIndex"===t.type)this._onInserted(t.newValue,t.index);else if("removeIndex"===t.type)this._onRemoved(t.oldValue);else{if("moveIndex"!==t.type)throw new Error("Unknown IListEvent type");this._onRemoved(t.value),this._onInserted(t.value,t.newIndex)}})}_onInserted(e,t){e._setParent(this._container,!0);const i=this._container._childrenDisplay;void 0===t?i.addChild(e._display):i.addChildAt(e._display,t)}_onRemoved(e){this._container._childrenDisplay.removeChild(e._display),this._container.markDirtyBounds(),this._container.markDirty()}isDisposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._events.dispose(),ye(this.values,e=>{e.dispose()}))}}class Ti{constructor(e){Object.defineProperty(this,"_value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._value=e}get value(){return this._value/100}get percent(){return this._value}toString(){return this._value+"%"}interpolate(e,t){return e+this.value*(t-e)}static normalize(e,t,i){return e instanceof Ti?e:new Ti(t===i?0:100*Math.min(Math.max(1/(i-t)*(e-t),0),1))}}function ln(s){return new Ti(s)}const El=ln(0),vt=ln(100),wi=ln(50);var vs=V(4911);function qn(s,e,t,i){return s.addEventListener(e,t,i||!1),new Ds(()=>{s.removeEventListener(e,t,i||!1)})}function fp(s){return qn(window,"resize",e=>{s()})}function Ha(s){switch(s){case"touchevents":return window.hasOwnProperty("TouchEvent");case"pointerevents":return window.hasOwnProperty("PointerEvent");case"mouseevents":return window.hasOwnProperty("MouseEvent");case"wheelevents":return window.hasOwnProperty("WheelEvent");case"keyboardevents":return window.hasOwnProperty("KeyboardEvent")}return!1}function xu(s){return s.pointerId||0}function wu(s){if(Ha("pointerevents"))return s;if(Ha("touchevents"))switch(s){case"pointerover":case"pointerdown":return"touchstart";case"pointerout":case"pointerleave":case"pointerup":return"touchend";case"pointermove":return"touchmove";case"click":return"click";case"dblclick":return"dblclick"}else if(Ha("mouseevents"))switch(s){case"pointerover":return"mouseover";case"pointerout":return"mouseout";case"pointerleave":return"mouseleave";case"pointerdown":return"mousedown";case"pointermove":return"mousemove";case"pointerup":return"mouseup";case"click":return"click";case"dblclick":return"dblclick"}return s}function Mu(s){if(typeof Touch<"u"&&s instanceof Touch)return!0;if(typeof PointerEvent<"u"&&s instanceof PointerEvent&&null!=s.pointerType)switch(s.pointerType){case"touch":case"pen":case 2:return!0;case"mouse":case 4:return!1;default:return!(s instanceof MouseEvent)}else if(null!=s.type&&s.type.match(/^mouse/))return!1;return!0}function Dd(s,e,t){s.style[e]=t}function q_(s){if(s.composedPath){const e=s.composedPath();return 0===e.length?null:e[0]}return s.target}function gp(s,e){return s.target&&function Ty(s,e){let t=e;for(;;){if(s===t)return!0;if(null===t.parentNode){if(null==t.host)return!1;t=t.host}else t=t.parentNode}}(e.root.dom,s.target)}function _c(s,e){s.style.pointerEvents=e?"auto":"none"}function Oi(s,e){return Se(s)?s:null!=s&&Se(s.value)&&Se(e)?e*s.value:0}function $n(s,e=0,t="0"){return"string"!=typeof s&&(s=s.toString()),e>s.length?Array(e-s.length+1).join(t)+s:s}function Sl(s){return function Tu(s){return s.replace(/^[\s]*/,"")}(function K_(s){return s.replace(/[\s]*$/,"")}(s))}function kl(s){return s.replace(/\/(date|number|duration)$/i,"")}function Sd(s){return s&&s.replace(/<[^>]*>/g,"")}function kd(s,e=!1){const t=new Date(s.getFullYear(),0,0),i=s.getTime()-t.getTime()+60*(t.getTimezoneOffset()-s.getTimezoneOffset())*1e3;return Math.floor(i/864e5)}function Ad(s,e=!1){const t=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate())),i=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-i);const n=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t.getTime()-n.getTime())/864e5+1)/7)}function Q_(s,e=!1){const t=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate())),i=t.getUTCDay()||7;return t.setUTCDate(t.getUTCDate()+4-i),new Date(Date.UTC(t.getUTCFullYear(),0,1)).getFullYear()}function oa(s,e=!1){const t=Ad(new Date(s.getFullYear(),s.getMonth(),1),e);let i=Ad(s,e);return 1==i&&(i=53),i-t+1}function bc(s,e){return s>12?s-=12:0===s&&(s=12),null!=e?s+(e-1):s}function Od(s,e=!1,t=!1,i=!1,n){if(i)return e?"Coordinated Universal Time":"UTC";if(n){const o=s.toLocaleString("en-US",{timeZone:n});return Sl(s.toLocaleString("en-US",{timeZone:n,timeZoneName:e?"long":"short"}).substr(o.length))}let r=s.toLocaleString("UTC"),a=s.toLocaleString("UTC",{timeZoneName:e?"long":"short"}).substr(r.length);return!1===t&&(a=a.replace(/ (standard|daylight|summer|winter) /i," ")),Sl(a)}function eb(s){const e=new Date(Date.UTC(2012,0,1,0,0,0,0)),t=new Date(e.toLocaleString("en-US",{timeZone:"UTC"}));return(new Date(e.toLocaleString("en-US",{timeZone:s})).getTime()-t.getTime())/6e4*-1}function bp(s){return s.charAt(0).toUpperCase()+s.slice(1)}function Cu(s){let e,t,i,n=s.h,r=s.s,a=s.l;if(0==r)e=t=i=a;else{let o=function(u,m,p){return p<0&&(p+=1),p>1&&(p-=1),p<.16666666666666666?u+6*(m-u)*p:p<.5?m:p<.6666666666666666?u+(m-u)*(.6666666666666666-p)*6:u},l=a<.5?a*(1+r):a+r-a*r,c=2*a-l;e=o(c,l,n+1/3),t=o(c,l,n),i=o(c,l,n-1/3)}return{r:Math.round(255*e),g:Math.round(255*t),b:Math.round(255*i)}}function vp(s){let e=s.r/255,t=s.g/255,i=s.b/255,n=Math.max(e,t,i),r=Math.min(e,t,i),a=0,o=0,l=(n+r)/2;if(n===r)a=o=0;else{let c=n-r;switch(o=l>.5?c/(2-n-r):c/(n+r),n){case e:a=(t-i)/c+(t<i?6:0);break;case t:a=(i-e)/c+2;break;case i:a=(e-t)/c+4}a/=6}return{h:a,s:o,l}}function vc(s,e){return Math.round((e>0?255-s:s)*e)}function yp(s){return(299*s.r+587*s.g+114*s.b)/1e3>=128}function ki(s,e){return s||(s=[]),[...s,...e].filter((t,i,n)=>n.indexOf(t)===i)}function xp(s,e){return!(!e||s.left!=e.left||s.right!=e.right||s.top!=e.top||s.bottom!=e.bottom)}function wp(s){return"#"===s[0]&&(s=s.substr(1)),3==s.length&&(s=s[0].repeat(2)+s[1].repeat(2)+s[2].repeat(2)),parseInt(s,16)}function kn(s){return ei.fromAny(s)}class ei{constructor(e){Object.defineProperty(this,"_hex",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hex=0|e}get hex(){return this._hex}get r(){return this._hex>>>16}get g(){return this._hex>>8&255}get b(){return 255&this._hex}toCSS(e=1){return"rgba("+this.r+", "+this.g+", "+this.b+", "+e+")"}toCSSHex(){return"#"+$n(this.r.toString(16),2)+$n(this.g.toString(16),2)+$n(this.b.toString(16),2)}toHSL(e=1){return vp({r:this.r,g:this.g,b:this.b,a:e})}static fromHSL(e,t,i){const n=Cu({h:e,s:t,l:i});return this.fromRGB(n.r,n.g,n.b)}toString(){return this.toCSSHex()}static fromHex(e){return new ei(e)}static fromRGB(e,t,i){return new ei((0|i)+(t<<8)+(e<<16))}static fromString(e){return new ei(wp(e))}static fromCSS(e){return new ei(function nb(s){let e=(s=s.replace(/[ ]/g,"")).match(/^rgb\(([0-9]*),([0-9]*),([0-9]*)\)/i);if(e)e.push("1");else if(e=s.match(/^rgba\(([0-9]*),([0-9]*),([0-9]*),([.0-9]*)\)/i),!e)return 0;let t="";for(let i=1;i<=3;i++){let n=parseInt(e[i]).toString(16);1==n.length&&(n="0"+n),t+=n}return wp(t)}(e))}static fromAny(e){if(Ml(e)){if("#"==e[0])return ei.fromString(e);if("rgb"==e.substr(0,3))return ei.fromCSS(e)}else{if(Se(e))return ei.fromHex(e);if(e instanceof ei)return ei.fromHex(e.hex)}throw new Error("Unknown color syntax: "+e)}static alternative(e,t,i){const n=function Du(s,e={r:255,g:255,b:255},t={r:255,g:255,b:255}){let i=e,n=t;return yp(t)&&(i=t,n=e),yp(s)?n:i}({r:e.r,g:e.g,b:e.b},t?{r:t.r,g:t.g,b:t.b}:void 0,i?{r:i.r,g:i.g,b:i.b}:void 0);return this.fromRGB(n.r,n.g,n.b)}static interpolate(e,t,i,n="rgb"){if("hsl"==n){const r=t.toHSL(),a=i.toHSL();return ei.fromHSL(Wa(e,r.h,a.h),Wa(e,r.s,a.s),Wa(e,r.l,a.l))}return ei.fromRGB(Wa(e,t.r,i.r),Wa(e,t.g,i.g),Wa(e,t.b,i.b))}static lighten(e,t){const i=function tb(s,e){return s&&{r:Math.max(0,Math.min(255,s.r+vc(s.r,e))),g:Math.max(0,Math.min(255,s.g+vc(s.g,e))),b:Math.max(0,Math.min(255,s.b+vc(s.b,e))),a:s.a}}({r:e.r,g:e.g,b:e.b},t);return ei.fromRGB(i.r,i.g,i.b)}static brighten(e,t){const i=function ib(s,e){if(s){let i=vc(Math.min(Math.max(s.r,s.g,s.b),230),e);return{r:Math.max(0,Math.min(255,Math.round(s.r+i))),g:Math.max(0,Math.min(255,Math.round(s.g+i))),b:Math.max(0,Math.min(255,Math.round(s.b+i))),a:s.a}}return s}({r:e.r,g:e.g,b:e.b},t);return ei.fromRGB(i.r,i.g,i.b)}static saturate(e,t){const i=function Rd(s,e){if(void 0===s||1==e)return s;let t=vp(s);return t.s=e,Cu(t)}({r:e.r,g:e.g,b:e.b},t);return ei.fromRGB(i.r,i.g,i.b)}}function ys(s){return Object.keys(s)}function zo(s){return Object.assign({},s)}function en(s,e){ys(s).forEach(t=>{e(t,s[t])})}function rb(s,e){return{}.hasOwnProperty.call(s,e)}function ab(s){return(0,vs.mG)(this,void 0,void 0,function*(){if(void 0!==s){const e=[];en(s,(t,i)=>{e.push(i.waitForStop())}),yield Promise.all(e)}})}function Wa(s,e,t){return e+s*(t-e)}function Ly(s,e,t){return s>=1?t:e}function ob(s,e,t){return new Ti(Wa(s,e.percent,t.percent))}function Fy(s,e,t){return ei.interpolate(s,e,t)}function Id(s){return s}function y(s){return s*s*s}function Me(s){return function(e){return 1-s(1-e)}}Math;Math.asin(1);class yc{constructor(e,t){Object.defineProperty(this,"_entity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_userSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._entity=e,this._settings=t,en(t,i=>{this._userSettings[i]=!0})}get(e,t){const i=this._settings[e];return void 0!==i?i:t}setRaw(e,t){this._settings[e]=t}set(e,t){this._userSettings[e]=!0,this.setRaw(e,t)}remove(e){delete this._userSettings[e],delete this._settings[e]}setAll(e){ys(e).forEach(t=>{this.set(t,e[t])})}_eachSetting(e){en(this._settings,e)}apply(){const e={stateAnimationEasing:!0,stateAnimationDuration:!0},t=this._entity.states.lookup("default");this._eachSetting((i,n)=>{e[i]||(e[i]=!0,this!==t&&(i in t._settings||(t._settings[i]=this._entity.get(i))),this._entity.set(i,n))})}applyAnimate(e){null==e&&(e=this._settings.stateAnimationDuration),null==e&&(e=this.get("stateAnimationDuration",this._entity.get("stateAnimationDuration",0)));let t=this._settings.stateAnimationEasing;null==t&&(t=this.get("stateAnimationEasing",this._entity.get("stateAnimationEasing",y)));const i=this._entity.states.lookup("default"),n={stateAnimationEasing:!0,stateAnimationDuration:!0},r={};return this._eachSetting((a,o)=>{if(!n[a]){n[a]=!0,this!=i&&(a in i._settings||(i._settings[a]=this._entity.get(a)));const l=this._entity.animate({key:a,to:o,duration:e,easing:t});l&&(r[a]=l)}}),r}}class hb{constructor(e){Object.defineProperty(this,"_states",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_entity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._entity=e}lookup(e){return this._states[e]}create(e,t){const i=this._states[e];if(i)return i.setAll(t),i;{const n=new yc(this._entity,t);return this._states[e]=n,n}}remove(e){delete this._states[e]}apply(e){const t=this._states[e];t&&t.apply(),this._entity._applyState(e)}applyAnimate(e,t){let i;const n=this._states[e];return n&&(i=n.applyAnimate(t)),this._entity._applyStateAnimated(e,t),i}}const Ea=new class zC{constructor(){Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.7.2"}),Object.defineProperty(this,"licenses",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"entitiesById",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"rootElements",{enumerable:!0,configurable:!0,writable:!0,value:[]})}};function uo(s,e){return s===e?0:s<e?-1:1}function Ny(s,e,t){const i=s.length,n=e.length,r=Math.min(i,n);for(let a=0;a<r;++a){const o=t(s[a],e[a]);if(0!==o)return o}return uo(i,n)}function Uy(s,e){return s===e?0:s<e?-1:1}class HC{constructor(e){Object.defineProperty(this,"_entity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_callbacks",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_disabled",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._entity=e}add(e,t){let i=this._callbacks[e];return void 0===i&&(i=this._callbacks[e]=[]),i.push(t),this._entity._markDirtyKey(e),new Ds(()=>{rr(i,t)&&this._entity._markDirtyKey(e)})}remove(e){const t=this._callbacks[e];void 0!==t&&(delete this._callbacks[e],0!==t.length&&this._entity._markDirtyKey(e))}enable(e){this._disabled[e]&&(delete this._disabled[e],this._entity._markDirtyKey(e))}disable(e){this._disabled[e]||(this._disabled[e]=!0,this._entity._markDirtyKey(e))}fold(e,t){if(!this._disabled[e]){const i=this._callbacks[e];if(void 0!==i)for(let n=0,r=i.length;n<r;++n)t=i[n](t,this._entity,e)}return t}}class Sp{constructor(e,t,i,n,r,a,o){Object.defineProperty(this,"_animation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_from",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_to",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_duration",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_easing",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_loops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_interpolate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_oldTime",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_time",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_stopped",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_playing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Cl}),this._animation=e,this._from=t,this._to=i,this._duration=n,this._easing=r,this._loops=a,this._interpolate=function By(s,e){return"number"==typeof s&&"number"==typeof e?Wa:s instanceof Ti&&e instanceof Ti?ob:s instanceof ei&&e instanceof ei?Fy:Ly}(t,i),this._oldTime=o}get to(){return this._to}get from(){return this._from}get playing(){return this._playing}get stopped(){return this._stopped}stop(){this._stopped||(this._stopped=!0,this._playing=!1,this.events.isEnabled("stopped")&&this.events.dispatch("stopped",{type:"stopped",target:this}))}pause(){this._playing=!1,this._oldTime=null}play(){!this._stopped&&!this._playing&&(this._playing=!0,this._animation._startAnimation())}get percentage(){return this._time/this._duration}waitForStop(){return new Promise((e,t)=>{if(this._stopped)e();else{const n=this.events.on("stopped",()=>{n.dispose(),e()})}})}_checkEnded(){return!(this._loops>1&&(--this._loops,1))}_run(e){null!==this._oldTime&&(this._time+=e-this._oldTime,this._time>this._duration&&(this._time=this._duration)),this._oldTime=e}_reset(e){this._oldTime=e,this._time=0}_value(e){return this._interpolate(this._easing(e),this._from,this._to)}}let VC=0;class zy{constructor(e){Object.defineProperty(this,"uid",{enumerable:!0,configurable:!0,writable:!0,value:++VC}),Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_privateSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_settingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_privateSettingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_prevSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_prevPrivateSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_animatingSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_animatingPrivateSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_playingAnimations",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_userProperties",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._settings=e}_checkDirty(){ys(this._settings).forEach(e=>{this._userProperties[e]=!0,this._markDirtyKey(e)})}resetUserSettings(){this._userProperties={}}_runAnimation(e){return!this.isDisposed()&&(en(this._animatingSettings,(t,i)=>{if(i._stopped)this._stopAnimation(t);else if(i._playing){i._run(e);const n=i.percentage;n>=1?i._checkEnded()?this.set(t,i._value(1)):(i._reset(e),this._set(t,i._value(1))):this._set(t,i._value(n))}}),en(this._animatingPrivateSettings,(t,i)=>{if(i._stopped)this._stopAnimationPrivate(t);else if(i._playing){i._run(e);const n=i.percentage;n>=1?i._checkEnded()?this.setPrivate(t,i._value(1)):(i._reset(e),this._setPrivate(t,i._value(1))):this._setPrivate(t,i._value(n))}}),0!==this._playingAnimations)}_markDirtyKey(e){this.markDirty()}_markDirtyPrivateKey(e){this.markDirty()}on(e,t){let i=this._settingEvents[e];return void 0===i&&(i=this._settingEvents[e]=[]),i.push(t),new Ds(()=>{rr(i,t),0===i.length&&delete this._settingEvents[e]})}onPrivate(e,t){let i=this._privateSettingEvents[e];return void 0===i&&(i=this._privateSettingEvents[e]=[]),i.push(t),new Ds(()=>{rr(i,t),0===i.length&&delete this._privateSettingEvents[e]})}getRaw(e,t){const i=this._settings[e];return void 0!==i?i:t}get(e,t){return this.getRaw(e,t)}_sendKeyEvent(e,t){const i=this._settingEvents[e];void 0!==i&&ye(i,n=>{n(t,this,e)})}_sendPrivateKeyEvent(e,t){const i=this._privateSettingEvents[e];void 0!==i&&ye(i,n=>{n(t,this,e)})}_setRaw(e,t,i){this._prevSettings[e]=t,this._sendKeyEvent(e,i)}setRaw(e,t){const i=this._settings[e];this._settings[e]=t,i!==t&&this._setRaw(e,i,t)}_set(e,t){const i=this._settings[e];this._settings[e]=t,i!==t&&(this._setRaw(e,i,t),this._markDirtyKey(e))}_stopAnimation(e){const t=this._animatingSettings[e];t&&(--this._playingAnimations,delete this._animatingSettings[e],t.stop())}set(e,t){return this._set(e,t),this._stopAnimation(e),t}remove(e){e in this._settings&&(this._prevSettings[e]=this._settings[e],delete this._settings[e],this._sendKeyEvent(e,void 0),this._markDirtyKey(e)),this._stopAnimation(e)}removeAll(){ye(ys(this._settings),e=>{this.remove(e)})}getPrivate(e,t){const i=this._privateSettings[e];return void 0!==i?i:t}_setPrivateRaw(e,t,i){this._prevPrivateSettings[e]=t,this._sendPrivateKeyEvent(e,i)}setPrivateRaw(e,t){const i=this._privateSettings[e];this._privateSettings[e]=t,i!==t&&this._setPrivateRaw(e,i,t)}_setPrivate(e,t){const i=this._privateSettings[e];this._privateSettings[e]=t,i!==t&&(this._setPrivateRaw(e,i,t),this._markDirtyPrivateKey(e))}_stopAnimationPrivate(e){const t=this._animatingPrivateSettings[e];t&&(--this._playingAnimations,t.stop(),delete this._animatingPrivateSettings[e])}setPrivate(e,t){return this._setPrivate(e,t),this._stopAnimationPrivate(e),t}removePrivate(e){e in this._privateSettings&&(this._prevPrivateSettings[e]=this._privateSettings[e],delete this._privateSettings[e],this._markDirtyPrivateKey(e)),this._stopAnimationPrivate(e)}setAll(e){en(e,(t,i)=>{this.set(t,i)})}animate(e){const t=e.key,i=e.to,n=e.duration||0,r=e.loops||1,a=void 0===e.from?this.get(t):e.from,o=void 0===e.easing?Id:e.easing;if(0===n)this.set(t,i);else{if(void 0!==a&&a!==i){this.set(t,a);const c=this._animatingSettings[t]=new Sp(this,a,i,n,o,r,this._animationTime());return++this._playingAnimations,this._startAnimation(),c}this.set(t,i)}const l=new Sp(this,a,i,n,o,r,null);return l.stop(),l}animatePrivate(e){const t=e.key,i=e.to,n=e.duration||0,r=e.loops||1,a=void 0===e.from?this.getPrivate(t):e.from,o=void 0===e.easing?Id:e.easing;if(0===n)this.setPrivate(t,i);else{if(void 0!==a&&a!==i){this.setPrivate(t,a);const c=this._animatingPrivateSettings[t]=new Sp(this,a,i,n,o,r,this._animationTime());return++this._playingAnimations,this._startAnimation(),c}this.setPrivate(t,i)}const l=new Sp(this,a,i,n,o,r,null);return l.stop(),l}_dispose(){}isDisposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._dispose())}}class zs extends zy{constructor(e,t,i,n=[]){if(super(t),Object.defineProperty(this,"_root",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_user_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"states",{enumerable:!0,configurable:!0,writable:!0,value:new hb(this)}),Object.defineProperty(this,"adapters",{enumerable:!0,configurable:!0,writable:!0,value:new HC(this)}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:this._createEvents()}),Object.defineProperty(this,"_userPrivateProperties",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirty",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirtyPrivate",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_templates",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_internalTemplates",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_defaultThemes",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_templateDisposers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_runSetup",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_disposerProperties",{enumerable:!0,configurable:!0,writable:!0,value:{}}),!i)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");this._root=e,this._internalTemplates=n,t.id&&this._registerId(t.id)}static new(e,t,i){const n=new this(e,t,!0);return n._template=i,n._afterNew(),n}static _new(e,t,i=[]){const n=new this(e,t,!0,i);return n._afterNew(),n}_afterNew(){this._checkDirty();let e=!1;const t=this._template;t&&(e=!0,t._setObjectTemplate(this)),ye(this._internalTemplates,i=>{e=!0,i._setObjectTemplate(this)}),e&&this._applyTemplates(!1),this.states.create("default",{}),this._setDefaults()}_afterNewApplyThemes(){this._checkDirty();const e=this._template;e&&e._setObjectTemplate(this),ye(this._internalTemplates,t=>{t._setObjectTemplate(this)}),this.states.create("default",{}),this._setDefaults(),this._applyThemes()}_createEvents(){return new Cl}get classNames(){return this.constructor.classNames}get className(){return this.constructor.className}_setDefaults(){}_setDefault(e,t){e in this._settings||super.set(e,t)}_setRawDefault(e,t){e in this._settings||super.setRaw(e,t)}_clearDirty(){ys(this._dirty).forEach(e=>{this._dirty[e]=!1}),ys(this._dirtyPrivate).forEach(e=>{this._dirtyPrivate[e]=!1})}isDirty(e){return!!this._dirty[e]}isPrivateDirty(e){return!!this._dirtyPrivate[e]}_markDirtyKey(e){this._dirty[e]=!0,super._markDirtyKey(e)}_markDirtyPrivateKey(e){this._dirtyPrivate[e]=!0,super._markDirtyKey(e)}isType(e){return-1!==this.classNames.indexOf(e)}_pushPropertyDisposer(e,t){let i=this._disposerProperties[e];return void 0===i&&(i=this._disposerProperties[e]=[]),i.push(t),t}_disposeProperty(e){const t=this._disposerProperties[e];void 0!==t&&(ye(t,i=>{i.dispose()}),delete this._disposerProperties[e])}set template(e){const t=this._template;t!==e&&(this._template=e,t&&t._removeObjectTemplate(this),e&&e._setObjectTemplate(this),this._applyTemplates())}get template(){return this._template}markDirty(){this._root._addDirtyEntity(this)}_startAnimation(){this._root._addAnimation(this)}_animationTime(){return this._root.animationTime}_applyState(e){}_applyStateAnimated(e,t){}get(e,t){const i=this.adapters.fold(e,this._settings[e]);return void 0!==i?i:t}isUserSetting(e){return this._userProperties[e]||!1}set(e,t){return this._userProperties[e]=!0,super.set(e,t)}setRaw(e,t){this._userProperties[e]=!0,super.setRaw(e,t)}_setSoft(e,t){return this._userProperties[e]?t:super.set(e,t)}remove(e){delete this._userProperties[e],this._removeTemplateProperty(e)}setPrivate(e,t){return this._userPrivateProperties[e]=!0,super.setPrivate(e,t)}setPrivateRaw(e,t){this._userPrivateProperties[e]=!0,super.setPrivateRaw(e,t)}removePrivate(e){delete this._userPrivateProperties[e],this._removeTemplatePrivateProperty(e)}_setTemplateProperty(e,t,i){this._userProperties[t]||e===this._findTemplateByKey(t)&&super.set(t,i)}_setTemplatePrivateProperty(e,t,i){this._userPrivateProperties[t]||e===this._findTemplateByPrivateKey(t)&&super.setPrivate(t,i)}_removeTemplateProperty(e){if(!this._userProperties[e]){const t=this._findTemplateByKey(e);t?super.set(e,t._settings[e]):super.remove(e)}}_removeTemplatePrivateProperty(e){if(!this._userPrivateProperties[e]){const t=this._findTemplateByPrivateKey(e);t?super.setPrivate(e,t._privateSettings[e]):super.removePrivate(e)}}_walkParents(e){e(this._root._rootContainer),e(this)}_applyStateByKey(e){const t=this.states.create(e,{}),i={};this._eachTemplate(n=>{const r=n.states.lookup(e);r&&r._apply(t,i)}),en(t._settings,n=>{!i[n]&&!t._userSettings[n]&&t.remove(n)})}_applyTemplate(e,t){this._templateDisposers.push(e._apply(this,t)),en(e._settings,(i,n)=>{!t.settings[i]&&!this._userProperties[i]&&(t.settings[i]=!0,super.set(i,n))}),en(e._privateSettings,(i,n)=>{!t.privateSettings[i]&&!this._userPrivateProperties[i]&&(t.privateSettings[i]=!0,super.setPrivate(i,n))}),this._runSetup&&e.setup&&(this._runSetup=!1,e.setup(this))}_findStaticTemplate(e){if(this._template&&e(this._template))return this._template}_eachTemplate(e){this._findStaticTemplate(t=>(e(t),!1)),pc(this._internalTemplates,e),ye(this._templates,e)}_applyTemplates(e=!0){e&&this._disposeTemplates();const t={settings:{},privateSettings:{},states:{}};this._eachTemplate(i=>{this._applyTemplate(i,t)}),e&&(en(this._settings,i=>{!this._userProperties[i]&&!t.settings[i]&&super.remove(i)}),en(this._privateSettings,i=>{!this._userPrivateProperties[i]&&!t.privateSettings[i]&&super.removePrivate(i)}))}_findTemplate(e){const t=this._findStaticTemplate(e);if(void 0===t){const i=function up(s,e){const t=function xd(s,e){let t=s.length;for(;t>0;)if(--t,e(s[t],t))return t;return-1}(s,e);if(-1!==t)return s[t]}(this._internalTemplates,e);return void 0===i?wd(this._templates,e):i}return t}_findTemplateByKey(e){return this._findTemplate(t=>e in t._settings)}_findTemplateByPrivateKey(e){return this._findTemplate(t=>e in t._privateSettings)}_disposeTemplates(){ye(this._templateDisposers,e=>{e.dispose()}),this._templateDisposers.length=0}_removeTemplates(){ye(this._templates,e=>{e._removeObjectTemplate(this)}),this._templates.length=0}_applyThemes(e=!1){let t=!1;const i=[];let n=[];const r=new Set,a=this.get("themeTagsSelf");return a&&ye(a,o=>{r.add(o)}),this._walkParents(o=>{o===this._root._rootContainer&&(t=!0),o._defaultThemes.length>0&&i.push(o._defaultThemes);const l=o.get("themes");l&&n.push(l);const c=o.get("themeTags");c&&ye(c,h=>{r.add(h)})}),n=i.concat(n),this._removeTemplates(),(t||e)&&pc(this.classNames,o=>{const l=[];ye(n,c=>{ye(c,h=>{const u=h._lookupRules(o);u&&pc(u,m=>{if(m.tags.every(_=>r.has(_))){const _=gu(l,g=>{const f=uo(m.tags.length,g.tags.length);return 0===f?Ny(m.tags,g.tags,uo):f});l.splice(_.index,0,m)}})})}),ye(l,c=>{this._templates.push(c.template),c.template._setObjectTemplate(this)})}),this._applyTemplates(),(t||e)&&(this._runSetup=!1),t||e}_changed(){}_beforeChanged(){if(this.isDirty("id")){const e=this.get("id");e&&this._registerId(e);const t=this._prevSettings.id;t&&delete Ea.entitiesById[t]}}_registerId(e){if(Ea.entitiesById[e]&&Ea.entitiesById[e]!==this)throw new Error('An entity with id "'+e+'" already exists.');Ea.entitiesById[e]=this}_afterChanged(){}addDisposer(e){return this._disposers.push(e),e}_dispose(){super._dispose();const e=this._template;e&&e._removeObjectTemplate(this),ye(this._internalTemplates,i=>{i._removeObjectTemplate(this)}),this._removeTemplates(),this._disposeTemplates(),this.events.dispose(),this._disposers.forEach(i=>{i.dispose()}),en(this._disposerProperties,(i,n)=>{ye(n,r=>{r.dispose()})});const t=this.get("id");t&&delete Ea.entitiesById[t]}setTimeout(e,t){const i=setTimeout(()=>{this.removeDispose(n),e()},t),n=new Ds(()=>{clearTimeout(i)});return this._disposers.push(n),n}removeDispose(e){if(!this.isDisposed()){let t=yl(this._disposers,e);t>-1&&this._disposers.splice(t,1)}e.dispose()}hasTag(e){return-1!==yl(this.get("themeTags",[]),e)}addTag(e){if(!this.hasTag(e)){const t=this.get("themeTags",[]);t.push(e),this.set("themeTags",t)}}removeTag(e){if(this.hasTag(e)){const t=this.get("themeTags",[]);Pr(t,e),this.set("themeTags",t)}}_t(e,t,...i){return this._root.language.translate(e,t,...i)}get root(){return this._root}}Object.defineProperty(zs,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Entity"}),Object.defineProperty(zs,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:["Entity"]});class WC{constructor(e,t,i){Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._name=e,this._template=t,this._settings=i}get(e,t){const i=this._settings[e];return void 0!==i?i:t}set(e,t){this._settings[e]=t,this._template._stateChanged(this._name)}remove(e){delete this._settings[e],this._template._stateChanged(this._name)}setAll(e){ys(e).forEach(t=>{this._settings[t]=e[t]}),this._template._stateChanged(this._name)}_apply(e,t){en(this._settings,(i,n)=>{!t[i]&&!e._userSettings[i]&&(t[i]=!0,e.setRaw(i,n))})}}class GC{constructor(e){Object.defineProperty(this,"_template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_states",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._template=e}lookup(e){return this._states[e]}create(e,t){const i=this._states[e];if(i)return i.setAll(t),i;{const n=new WC(e,this._template,t);return this._states[e]=n,this._template._stateChanged(e),n}}remove(e){delete this._states[e],this._template._stateChanged(e)}_apply(e,t){en(this._states,(i,n)=>{let r=t.states[i];null==r&&(r=t.states[i]={});const a=e.states.create(i,{});n._apply(a,r)})}}class YC{constructor(){Object.defineProperty(this,"_callbacks",{enumerable:!0,configurable:!0,writable:!0,value:{}})}add(e,t){let i=this._callbacks[e];return void 0===i&&(i=this._callbacks[e]=[]),i.push(t),new Ds(()=>{rr(i,t),0===i.length&&delete this._callbacks[e]})}remove(e){void 0!==this._callbacks[e]&&delete this._callbacks[e]}_apply(e){const t=[];return en(this._callbacks,(i,n)=>{ye(n,r=>{t.push(e.adapters.add(i,r))})}),new mr(t)}}class An{constructor(e,t){if(Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_privateSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_settingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_privateSettingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_entities",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"states",{enumerable:!0,configurable:!0,writable:!0,value:new GC(this)}),Object.defineProperty(this,"adapters",{enumerable:!0,configurable:!0,writable:!0,value:new YC}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Cl}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!t)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");this._settings=e}static new(e){return new An(e,!0)}get entities(){return this._entities}get(e,t){const i=this._settings[e];return void 0!==i?i:t}setRaw(e,t){this._settings[e]=t}set(e,t){this._settings[e]!==t&&(this.setRaw(e,t),this._entities.forEach(i=>{i._setTemplateProperty(this,e,t)}))}remove(e){e in this._settings&&(delete this._settings[e],this._entities.forEach(t=>{t._removeTemplateProperty(e)}))}removeAll(){en(this._settings,(e,t)=>{this.remove(e)})}getPrivate(e,t){const i=this._privateSettings[e];return void 0!==i?i:t}setPrivateRaw(e,t){return this._privateSettings[e]=t,t}setPrivate(e,t){return this._privateSettings[e]!==t&&(this.setPrivateRaw(e,t),this._entities.forEach(i=>{i._setTemplatePrivateProperty(this,e,t)})),t}removePrivate(e){e in this._privateSettings&&(delete this._privateSettings[e],this._entities.forEach(t=>{t._removeTemplatePrivateProperty(e)}))}setAll(e){en(e,(t,i)=>{this.set(t,i)})}on(e,t){let i=this._settingEvents[e];return void 0===i&&(i=this._settingEvents[e]=[]),i.push(t),new Ds(()=>{rr(i,t),0===i.length&&delete this._settingEvents[e]})}onPrivate(e,t){let i=this._privateSettingEvents[e];return void 0===i&&(i=this._privateSettingEvents[e]=[]),i.push(t),new Ds(()=>{rr(i,t),0===i.length&&delete this._privateSettingEvents[e]})}_apply(e,t){const i=[];return en(this._settingEvents,(n,r)=>{ye(r,a=>{i.push(e.on(n,a))})}),en(this._privateSettingEvents,(n,r)=>{ye(r,a=>{i.push(e.onPrivate(n,a))})}),this.states._apply(e,t),i.push(this.adapters._apply(e)),i.push(e.events.copyFrom(this.events)),new mr(i)}_setObjectTemplate(e){this._entities.push(e)}_removeObjectTemplate(e){Pr(this._entities,e)}_stateChanged(e){this._entities.forEach(t=>{t._applyStateByKey(e)})}}const ub=Math.PI,la=ub/180,Ho=180/ub;function fr(s,e,t){if(!Se(e)||e<=0){let i=Math.round(s);return t&&i-s==.5&&i--,i}{let i=Math.pow(10,e);return Math.round(s*i)/i}}function Hs(s,e,t){return Math.min(Math.max(s,e),t)}function $s(s){return Math.sin(la*s)}function gr(s){return Math.cos(la*s)}function Vo(s){return(s%=360)<0&&(s+=360),s}function Eu(s,e,t,i,n){let r=Number.MAX_VALUE,a=Number.MAX_VALUE,o=-Number.MAX_VALUE,l=-Number.MAX_VALUE,c=[];c.push(mb(n,t)),c.push(mb(n,i));let h=Math.min(90*Math.floor(t/90),90*Math.floor(i/90)),u=Math.max(90*Math.ceil(t/90),90*Math.ceil(i/90));for(let m=h;m<=u;m+=90)m>=t&&m<=i&&c.push(mb(n,m));for(let m=0;m<c.length;m++){let p=c[m];p.x<r&&(r=p.x),p.y<a&&(a=p.y),p.x>o&&(o=p.x),p.y>l&&(l=p.y)}return{left:s+r,top:e+a,right:s+o,bottom:e+l}}function mb(s,e){return{x:s*gr(e),y:s*$s(e)}}function Hy(s){const e=s.length;if(e>0){let t=s[0],i=t.left,n=t.top,r=t.right,a=t.bottom;if(e>1)for(let o=1;o<e;o++)t=s[o],i=Math.min(t.left,i),r=Math.max(t.right,r),n=Math.min(t.top,n),a=Math.max(t.bottom,a);return{left:i,right:r,top:n,bottom:a}}return{left:0,right:0,top:0,bottom:0}}class kp extends Cl{constructor(e){super(),Object.defineProperty(this,"_sprite",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rendererDisposers",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dispatchParents",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this._sprite=e}_makePointerEvent(e,t){return{type:e,originalEvent:t.event,point:t.point,simulated:t.simulated,native:t.native,target:this._sprite}}_onRenderer(e,t){this._sprite.set("interactive",!0),this._sprite._display.interactive=!0;let i=this._rendererDisposers[e];if(void 0===i){const n=this._sprite._display.on(e,r=>{t.call(this,r)});i=this._rendererDisposers[e]=new bu(()=>{delete this._rendererDisposers[e],n.dispose()})}return i.increment()}_on(e,t,i,n,r,a){const o=super._on(e,t,i,n,r,a),l=kp.RENDERER_EVENTS[t];return void 0!==l&&(o.disposer=new mr([o.disposer,this._onRenderer(t,l)])),o}stopParentDispatch(){this._dispatchParents=!1}dispatchParents(e,t){const i=this._dispatchParents;this._dispatchParents=!0;try{this.dispatch(e,t),this._dispatchParents&&this._sprite.parent&&this._sprite.parent.events.dispatchParents(e,t)}finally{this._dispatchParents=i}}}Object.defineProperty(kp,"RENDERER_EVENTS",{enumerable:!0,configurable:!0,writable:!0,value:{click:function(s){this.isEnabled("click")&&!this._sprite.isDragging()&&this._sprite._hasDown()&&!this._sprite._hasMoved(this._makePointerEvent("click",s))&&this.dispatch("click",this._makePointerEvent("click",s))},rightclick:function(s){this.isEnabled("rightclick")&&this.dispatch("rightclick",this._makePointerEvent("rightclick",s))},middleclick:function(s){this.isEnabled("middleclick")&&this.dispatch("middleclick",this._makePointerEvent("middleclick",s))},dblclick:function(s){this.dispatchParents("dblclick",this._makePointerEvent("dblclick",s))},pointerover:function(s){const e=this._sprite;let t=!0;if(e.getPrivate("trustBounds")){e._getBounds();const i=e.globalBounds();(function ZC(s,e){return s.x>=e.left&&s.y>=e.top&&s.x<=e.right&&s.y<=e.bottom})(s.point,i)||(t=!1,e._root._renderer.removeHovering(e._display))}t&&this.isEnabled("pointerover")&&this.dispatch("pointerover",this._makePointerEvent("pointerover",s))},pointerout:function(s){this.isEnabled("pointerout")&&this.dispatch("pointerout",this._makePointerEvent("pointerout",s))},pointerdown:function(s){this.dispatchParents("pointerdown",this._makePointerEvent("pointerdown",s))},pointerup:function(s){this.isEnabled("pointerup")&&this.dispatch("pointerup",this._makePointerEvent("pointerup",s))},globalpointerup:function(s){this.isEnabled("globalpointerup")&&this.dispatch("globalpointerup",this._makePointerEvent("globalpointerup",s))},globalpointermove:function(s){this.isEnabled("globalpointermove")&&this.dispatch("globalpointermove",this._makePointerEvent("globalpointermove",s))},wheel:function(s){this.dispatchParents("wheel",{type:"wheel",target:this._sprite,originalEvent:s.event,point:s.point})}}});class Ga extends zs{constructor(){super(...arguments),Object.defineProperty(this,"_adjustedLocalBounds",{enumerable:!0,configurable:!0,writable:!0,value:{left:0,right:0,top:0,bottom:0}}),Object.defineProperty(this,"_localBounds",{enumerable:!0,configurable:!0,writable:!0,value:{left:0,right:0,top:0,bottom:0}}),Object.defineProperty(this,"_parent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dataItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_templateField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_sizeDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isDragging",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dragEvent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dragPoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isHidden",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isShowing",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isHiding",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isDown",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_downPoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downPoints",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_toggleDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dragDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_hoverDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_focusDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipMoveDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipPointerDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_statesHandled",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_afterNew(){this.setPrivateRaw("visible",!0),super._afterNew()}_markDirtyKey(e){super._markDirtyKey(e),("x"==e||"y"==e||"dx"==e||"dy"==e)&&(this.markDirtyBounds(),this._addPercentagePositionChildren(),this.markDirtyPosition())}_markDirtyPrivateKey(e){super._markDirtyPrivateKey(e),("x"==e||"y"==e)&&this.markDirtyPosition()}_removeTemplateField(){this._templateField&&this._templateField._removeObjectTemplate(this)}_createEvents(){return new kp(this)}_processTemplateField(){let e;const t=this.get("templateField");if(t){const i=this.dataItem;if(i){const n=i.dataContext;n&&(e=n[t],!(e instanceof An)&&e&&(e=An.new(e)))}}this._templateField!==e&&(this._removeTemplateField(),this._templateField=e,e&&e._setObjectTemplate(this),this._applyTemplates())}_setDataItem(e){const t=this._dataItem;this._dataItem=e,this._processTemplateField();const i="dataitemchanged";e!=t&&this.events.isEnabled(i)&&this.events.dispatch(i,{type:i,target:this,oldDataItem:t,newDataItem:e})}set dataItem(e){this._setDataItem(e)}get dataItem(){if(this._dataItem)return this._dataItem;{let e=this._parent;for(;e;){if(e._dataItem)return e._dataItem;e=e._parent}}}_addPercentageSizeChildren(){let e=this.parent;e&&(this.get("width")instanceof Ti||this.get("height")instanceof Ti?lo(e._percentageSizeChildren,this):rr(e._percentageSizeChildren,this))}_addPercentagePositionChildren(){let e=this.parent;e&&(this.get("x")instanceof Ti||this.get("y")instanceof Ti?lo(e._percentagePositionChildren,this):rr(e._percentagePositionChildren,this))}markDirtyPosition(){this._root._addDirtyPosition(this)}updatePivotPoint(){const e=this._localBounds;if(e){const t=this.get("centerX");null!=t&&(this._display.pivot.x=e.left+Oi(t,e.right-e.left));const i=this.get("centerY");null!=i&&(this._display.pivot.y=e.top+Oi(i,e.bottom-e.top))}}_beforeChanged(){if(super._beforeChanged(),this._handleStates(),this.isDirty("tooltip")){const e=this._prevSettings.tooltip;e&&e.dispose()}if((this.isDirty("layer")||this.isDirty("layerMargin"))&&(this._display.setLayer(this.get("layer"),this.get("layerMargin")),this.markDirtyLayer()),this.isDirty("tooltipPosition")){const e=this._tooltipMoveDp;e&&(e.dispose(),this._tooltipMoveDp=void 0);const t=this._tooltipPointerDp;t&&(t.dispose(),this._tooltipPointerDp=void 0),"pointer"==this.get("tooltipPosition")&&(this.isHover()&&(this._tooltipMoveDp=this.events.on("globalpointermove",i=>{this.showTooltip(i.point)})),this._tooltipPointerDp=new mr([this.events.on("pointerover",()=>{this._tooltipMoveDp=this.events.on("globalpointermove",i=>{this.showTooltip(i.point)})}),this.events.on("pointerout",()=>{const i=this._tooltipMoveDp;i&&(i.dispose(),this._tooltipMoveDp=void 0)})]))}}_handleStates(){this._statesHandled||(this.isDirty("active")&&(this.get("active")?(this.states.applyAnimate("active"),this.set("ariaChecked",!0)):(this.isHidden()||this.states.applyAnimate("default"),this.set("ariaChecked",!1)),this.markDirtyAccessibility()),this.isDirty("disabled")&&(this.get("disabled")?(this.states.applyAnimate("disabled"),this.set("ariaChecked",!1)):(this.isHidden()||this.states.applyAnimate("default"),this.set("ariaChecked",!0)),this.markDirtyAccessibility()),this._statesHandled=!0)}_changed(){super._changed();const e=this._display,t=this.events;if(this.isDirty("draggable")){const n=this.get("draggable");n?(this.set("interactive",!0),this._dragDp=new mr([t.on("pointerdown",r=>{this.dragStart(r)}),t.on("globalpointermove",r=>{this.dragMove(r)}),t.on("globalpointerup",r=>{this.dragStop(r)})])):this._dragDp&&(this._dragDp.dispose(),this._dragDp=void 0),e.cancelTouch=!!n}if(this.isDirty("tooltipText")||this.isDirty("tooltipHTML")||this.isDirty("showTooltipOn")){const n=this.get("tooltipText"),r=this.get("tooltipHTML"),a=this.get("showTooltipOn","hover");this._tooltipDp&&(this._tooltipDp.dispose(),this._tooltipDp=void 0),(n||r)&&("click"==a?(this._tooltipDp=new mr([t.on("click",()=>{this.setTimeout(()=>this.showTooltip(),10)}),qn(document,"click",o=>{this.hideTooltip()})]),this._disposers.push(this._tooltipDp)):"always"==a||(this._tooltipDp=new mr([t.on("pointerover",()=>{this.showTooltip()}),t.on("pointerout",()=>{this.hideTooltip()})]),this._disposers.push(this._tooltipDp)))}if(this.isDirty("toggleKey")){let n=this.get("toggleKey");n&&"none"!=n?this._toggleDp=t.on("click",()=>{this._isDragging||this.set(n,!this.get(n))}):this._toggleDp&&(this._toggleDp.dispose(),this._toggleDp=void 0)}if(this.isDirty("opacity")&&(e.alpha=Math.max(0,this.get("opacity",1)),this.get("focusable")&&this.markDirtyAccessibility()),this.isDirty("rotation")&&(this.markDirtyBounds(),e.angle=this.get("rotation",0)),this.isDirty("scale")&&(this.markDirtyBounds(),e.scale=this.get("scale",0)),(this.isDirty("centerX")||this.isDirty("centerY"))&&(this.markDirtyBounds(),this.updatePivotPoint()),(this.isDirty("visible")||this.isPrivateDirty("visible")||this.isDirty("forceHidden"))&&(this.get("visible")&&this.getPrivate("visible")&&!this.get("forceHidden")?e.visible=!0:(e.visible=!1,this.hideTooltip()),this.markDirtyBounds(),this.get("focusable")&&this.markDirtyAccessibility()),this.isDirty("width")||this.isDirty("height")){this.markDirtyBounds(),this._addPercentageSizeChildren();const n=this.parent;n&&(this.isDirty("width")&&this.get("width")instanceof Ti||this.isDirty("height")&&this.get("height")instanceof Ti)&&(n.markDirty(),n._prevWidth=0),this._sizeDirty=!0}if((this.isDirty("maxWidth")||this.isDirty("maxHeight")||this.isPrivateDirty("width")||this.isPrivateDirty("height")||this.isDirty("minWidth")||this.isDirty("minHeight")||this.isPrivateDirty("maxWidth")||this.isPrivateDirty("maxHeight")||this.isPrivateDirty("minWidth")||this.isPrivateDirty("minHeight"))&&(this.markDirtyBounds(),this._sizeDirty=!0),this._sizeDirty&&this._updateSize(),this.isDirty("wheelable")){const n=this.get("wheelable");n&&this.set("interactive",!0),e.wheelable=!!n}(this.isDirty("tabindexOrder")||this.isDirty("focusableGroup"))&&(this.get("focusable")?this._root._registerTabindexOrder(this):this._root._unregisterTabindexOrder(this)),this.isDirty("filter")&&(e.filter=this.get("filter"));let i=this.get("filter","");if(this.isDirty("blur")){const n=this.get("blur",0);0!=n&&(i+=" blur("+n+"px)")}if(this.isDirty("saturate")){const n=this.get("saturate",1);1!=n&&(i+=" saturate("+n+")")}if(this.isDirty("brightness")){const n=this.get("brightness",1);1!=n&&(i+=" brightness("+n+")")}if(this.isDirty("contrast")){const n=this.get("contrast",1);1!=n&&(i+=" contrast("+n+")")}if(this.isDirty("sepia")){const n=this.get("sepia",0);0!=n&&(i+=" sepia("+n+")")}if(this.isDirty("hue")){const n=this.get("hue",0);0!=n&&(i+=" hue-rotate("+n+"deg)")}if(this.isDirty("invert")){const n=this.get("invert",0);0!=n&&(i+=" invert("+n+")")}if(i&&(e.filter=i),this.isDirty("cursorOverStyle")&&(e.cursorOverStyle=this.get("cursorOverStyle")),this.isDirty("hoverOnFocus")&&(this.get("hoverOnFocus")?this._focusDp=new mr([t.on("focus",()=>{this.showTooltip()}),t.on("blur",()=>{this.hideTooltip()})]):this._focusDp&&(this._focusDp.dispose(),this._focusDp=void 0)),this.isDirty("focusable")&&(this.get("focusable")?this._root._registerTabindexOrder(this):this._root._unregisterTabindexOrder(this),this.markDirtyAccessibility()),this.isPrivateDirty("focusable")&&this.markDirtyAccessibility(),(this.isDirty("role")||this.isDirty("ariaLive")||this.isDirty("ariaChecked")||this.isDirty("ariaHidden")||this.isDirty("ariaOrientation")||this.isDirty("ariaValueNow")||this.isDirty("ariaValueMin")||this.isDirty("ariaValueMax")||this.isDirty("ariaValueText")||this.isDirty("ariaLabel")||this.isDirty("ariaControls"))&&this.markDirtyAccessibility(),this.isDirty("exportable")&&(e.exportable=this.get("exportable")),this.isDirty("interactive")){const n=this.events;this.get("interactive")?this._hoverDp=new mr([n.on("click",r=>{Mu(r.originalEvent)&&(this.getPrivate("touchHovering")||this.setTimeout(()=>{this._handleOver(),(this.get("tooltipText")||this.get("tooltipHTML"))&&this.showTooltip(),this.setPrivateRaw("touchHovering",!0),this.events.dispatch("pointerover",{type:"pointerover",target:r.target,originalEvent:r.originalEvent,point:r.point,simulated:r.simulated})},10))}),n.on("globalpointerup",r=>{Mu(r.originalEvent)&&this.getPrivate("touchHovering")&&(this._handleOut(),(this.get("tooltipText")||this.get("tooltipHTML"))&&this.hideTooltip(),this.setPrivateRaw("touchHovering",!1),this.events.dispatch("pointerout",{type:"pointerout",target:r.target,originalEvent:r.originalEvent,point:r.point,simulated:r.simulated})),this._isDown&&this._handleUp(r)}),n.on("pointerover",()=>{this._handleOver()}),n.on("pointerout",()=>{this._handleOut()}),n.on("pointerdown",r=>{this._handleDown(r)})]):(this._display.interactive=!1,this._hoverDp&&(this._hoverDp.dispose(),this._hoverDp=void 0))}this.isDirty("forceInactive")&&(this._display.inactive=this.get("forceInactive",null)),"always"==this.get("showTooltipOn")&&this._display.visible&&this.showTooltip()}dragStart(e){this._dragEvent=e,this.events.stopParentDispatch()}dragStop(e){if(this._dragEvent=void 0,this._dragPoint=void 0,this.events.stopParentDispatch(),this._isDragging){this._isDragging=!1;const t="dragstop";this.events.isEnabled(t)&&this.events.dispatch(t,{type:t,target:this,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})}}_handleOver(){this.isHidden()||(this.get("active")&&this.states.lookup("hoverActive")?this.states.applyAnimate("hoverActive"):this.get("disabled")&&this.states.lookup("hoverDisabled")?this.states.applyAnimate("hoverDisabled"):this.states.applyAnimate("hover"),this.get("draggable")&&this._isDown&&this.states.lookup("down")&&this.states.applyAnimate("down"))}_handleOut(){this.isHidden()||(this.get("active")&&this.states.lookup("active")?this.states.applyAnimate("active"):this.get("disabled")&&this.states.lookup("disabled")?this.states.applyAnimate("disabled"):(this.states.lookup("hover")||this.states.lookup("hoverActive"))&&this.states.applyAnimate("default"),this.get("draggable")&&this._isDown&&this.states.lookup("down")&&this.states.applyAnimate("down"))}_handleUp(e){if(!this.isHidden()){this.get("active")&&this.states.lookup("active")?this.states.applyAnimate("active"):this.get("disabled")&&this.states.lookup("disabled")?this.states.applyAnimate("disabled"):this.states.lookup("down")&&(this.isHover()?this.states.applyAnimate("hover"):this.states.applyAnimate("default")),this._downPoint=void 0;const t=xu(e.originalEvent);delete this._downPoints[t],0==ys(this._downPoints).length&&(this._isDown=!1)}}_hasMoved(e){const t=xu(e.originalEvent),i=this._downPoints[t];if(i){const n=Math.abs(i.x-e.point.x),r=Math.abs(i.y-e.point.y);return n>5||r>5}return!1}_hasDown(){return ys(this._downPoints).length>0}_handleDown(e){const t=this.parent;if(t&&!this.get("draggable")&&t._handleDown(e),this.get("interactive")&&!this.isHidden()){this.states.lookup("down")&&this.states.applyAnimate("down"),this._downPoint={x:e.point.x,y:e.point.y},this._isDown=!0;const i=xu(e.originalEvent);this._downPoints[i]={x:e.point.x,y:e.point.y}}}dragMove(e){let t=this._dragEvent;if(t){if(t.simulated&&!e.simulated)return!0;let i=0,n=this.parent;for(;null!=n;)i+=n.get("rotation",0),n=n.parent;let r=e.point.x-t.point.x,a=e.point.y-t.point.y;const o=this.events;if(t.simulated&&!this._isDragging){this._isDragging=!0,this._dragEvent=e,this._dragPoint={x:this.x(),y:this.y()};const l="dragstart";o.isEnabled(l)&&o.dispatch(l,{type:l,target:this,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})}if(this._isDragging){let l=this._dragPoint;this.set("x",l.x+r*gr(i)+a*$s(i)),this.set("y",l.y+a*gr(i)-r*$s(i));const c="dragged";o.isEnabled(c)&&o.dispatch(c,{type:c,target:this,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})}else if(Math.hypot(r,a)>5){this._isDragging=!0,this._dragEvent=e,this._dragPoint={x:this.x(),y:this.y()};const l="dragstart";o.isEnabled(l)&&o.dispatch(l,{type:l,target:this,originalEvent:e.originalEvent,point:e.point,simulated:e.simulated})}}}_updateSize(){}_getBounds(){this._localBounds=this._display.getLocalBounds()}depth(){let e=this.parent,t=0;for(;;){if(!e)return t;++t,e=e.parent}}markDirtySize(){this._sizeDirty=!0,this.markDirty()}markDirtyBounds(){const e=this._display;if(this.get("isMeasured")){this._root._addDirtyBounds(this),e.isMeasured=!0,e.invalidateBounds();const t=this.parent;t&&"absolute"!=this.get("position")&&(null==t.get("width")||null==t.get("height")||t.get("layout"))&&t.markDirtyBounds(),this.get("focusable")&&this.isFocus()&&this.markDirtyAccessibility()}}markDirtyAccessibility(){this._root._invalidateAccessibility(this)}markDirtyLayer(){this._display.markDirtyLayer(!0)}markDirty(){super.markDirty(),this.markDirtyLayer()}_updateBounds(){const e=this._adjustedLocalBounds;let t;if(this.get("visible")&&this.getPrivate("visible")&&!this.get("forceHidden")?(this._getBounds(),this._fixMinBounds(this._localBounds),this.updatePivotPoint(),this._adjustedLocalBounds=this._display.getAdjustedBounds(this._localBounds),t=this._adjustedLocalBounds):(t={left:0,right:0,top:0,bottom:0},this._localBounds=t,this._adjustedLocalBounds=t),!e||e.left!==t.left||e.top!==t.top||e.right!==t.right||e.bottom!==t.bottom){const i="boundschanged";this.events.isEnabled(i)&&this.events.dispatch(i,{type:i,target:this}),this.parent&&(this.parent.markDirty(),this.parent.markDirtyBounds())}}_fixMinBounds(e){let t=this.get("minWidth",this.getPrivate("minWidth")),i=this.get("minHeight",this.getPrivate("minHeight"));Se(t)&&e.right-e.left<t&&(e.right=e.left+t),Se(i)&&e.bottom-e.top<i&&(e.bottom=e.top+i);let n=this.getPrivate("width"),r=this.getPrivate("height");Se(n)&&(n>0?e.right=e.left+n:e.left=e.right+n),Se(r)&&(r>0?e.bottom=e.top+r:e.top=e.bottom+r)}_removeParent(e){e&&(e.children.removeValue(this),rr(e._percentageSizeChildren,this),rr(e._percentagePositionChildren,this))}_clearDirty(){super._clearDirty(),this._sizeDirty=!1,this._statesHandled=!1}hover(){this.showTooltip(),this._handleOver()}unhover(){this.hideTooltip(),this._handleOut()}showTooltip(e){const t=this.getTooltip(),i=this.get("tooltipText"),n=this.get("tooltipHTML");if((i||n)&&t){const r=this.get("tooltipPosition"),a=this.getPrivate("tooltipTarget",this);("fixed"==r||!e)&&(this._display._setMatrix(),e=this.toGlobal(a._getTooltipPoint())),t.set("pointTo",e),t.set("tooltipTarget",a),t.get("x")||t.set("x",e.x),t.get("y")||t.set("y",e.y),i&&t.label.set("text",i),n&&t.label.set("html",n);const o=this.dataItem;if(o&&t.label._setDataItem(o),"always"==this.get("showTooltipOn")&&(e.x<0||e.x>this._root.width()||e.y<0||e.y>this._root.height()))return void this.hideTooltip();t.label.text.markDirtyText();const l=t.show();return this.setPrivateRaw("showingTooltip",!0),l}}hideTooltip(){const e=this.getTooltip();if(e&&(e.get("tooltipTarget")==this.getPrivate("tooltipTarget",this)||this.get("tooltip")==e)){let t=e.get("keepTargetHover")&&0==e.get("stateAnimationDuration",0)?400:void 0;const i=e.hide(t);return this.setPrivateRaw("showingTooltip",!1),i}}_getTooltipPoint(){const e=this._localBounds;if(e){let t=0,i=0;return this.get("isMeasured")?(t=e.left+Oi(this.get("tooltipX",0),e.right-e.left),i=e.top+Oi(this.get("tooltipY",0),e.bottom-e.top)):(t=Oi(this.get("tooltipX",0),this.width()),i=Oi(this.get("tooltipY",0),this.height())),{x:t,y:i}}return{x:0,y:0}}getTooltip(){let e=this.get("tooltip");if(e)return e;{let t=this.parent;if(t)return t.getTooltip()}}_updatePosition(){const e=this.parent;let t=this.get("dx",0),i=this.get("dy",0),n=this.get("x"),r=this.getPrivate("x"),a=0,o=0;const l=this.get("position");n instanceof Ti&&(n=e?e.innerWidth()*n.value+e.get("paddingLeft",0):0),Se(n)?a=n+t:null!=r?a=r:e&&"relative"==l&&(a=e.get("paddingLeft",0)+t);let c=this.get("y"),h=this.getPrivate("y");c instanceof Ti&&(c=e?e.innerHeight()*c.value+e.get("paddingTop",0):0),Se(c)?o=c+i:null!=h?o=h:e&&"relative"==l&&(o=e.get("paddingTop",0)+i);const u=this._display;if(u.x!=a||u.y!=o){u.invalidateBounds(),u.x=a,u.y=o;const m="positionchanged";this.events.isEnabled(m)&&this.events.dispatch(m,{type:m,target:this})}this.getPrivate("showingTooltip")&&this.showTooltip()}x(){let e=this.get("x"),t=this.getPrivate("x");const i=this.parent;return i?e instanceof Ti?Oi(e,i.innerWidth())+i.get("paddingLeft",0):Se(e)?e:t??i.get("paddingLeft",this._display.x):this._display.x}y(){let e=this.getPrivate("y");if(null!=e)return e;let t=this.get("y");const i=this.parent;return i?t instanceof Ti?Oi(t,i.innerHeight())+i.get("paddingTop",0):Se(t)?t:e??i.get("paddingTop",this._display.y):this._display.y}_dispose(){super._dispose(),this._display.dispose(),this._removeTemplateField(),this._removeParent(this.parent),this._root._removeFocusElement(this);const e=this.get("tooltip");e&&e.dispose(),this.markDirty()}adjustedLocalBounds(){return this._fixMinBounds(this._adjustedLocalBounds),this._adjustedLocalBounds}localBounds(){return this._localBounds}bounds(){const e=this._adjustedLocalBounds,t=this.x(),i=this.y();return{left:e.left+t,right:e.right+t,top:e.top+i,bottom:e.bottom+i}}globalBounds(){const e=this.localBounds(),t=this.toGlobal({x:e.left,y:e.top}),i=this.toGlobal({x:e.right,y:e.top}),n=this.toGlobal({x:e.right,y:e.bottom}),r=this.toGlobal({x:e.left,y:e.bottom});return{left:Math.min(t.x,i.x,n.x,r.x),top:Math.min(t.y,i.y,n.y,r.y),right:Math.max(t.x,i.x,n.x,r.x),bottom:Math.max(t.y,i.y,n.y,r.y)}}_onShow(e){}_onHide(e){}appear(e,t){return(0,vs.mG)(this,void 0,void 0,function*(){return yield this.hide(0),t?new Promise((i,n)=>{this.setTimeout(()=>{i(this.show(e))},t)}):this.show(e)})}show(e){return(0,vs.mG)(this,void 0,void 0,function*(){if(!this._isShowing){this._isHidden=!1,this._isShowing=!0,this._isHiding=!1,this.states.lookup("default").get("visible")&&this.set("visible",!0),this._onShow(e);const t=this.states.applyAnimate("default",e);yield ab(t),this._isShowing=!1}})}hide(e){return(0,vs.mG)(this,void 0,void 0,function*(){if(!this._isHiding&&!this._isHidden){this._isHiding=!0,this._isShowing=!1;let t=this.states.lookup("hidden");t||(t=this.states.create("hidden",{opacity:0,visible:!1})),this._isHidden=!0,this._onHide(e);const i=this.states.applyAnimate("hidden",e);yield ab(i),this._isHiding=!1}})}isHidden(){return this._isHidden}isShowing(){return this._isShowing}isHiding(){return this._isHiding}isHover(){return this._display.hovering()}isFocus(){return this._root.focused(this)}isDragging(){return this._isDragging}isVisible(){return!(!this.get("visible")||!this.getPrivate("visible")||this.get("forceHidden"))}isVisibleDeep(){return this._parent?this._parent.isVisibleDeep()&&this.isVisible():this.isVisible()}compositeOpacity(){const e=this.get("opacity",1);return this._parent?this._parent.compositeOpacity()*e:e}width(){let e=this.get("width"),t=this.get("maxWidth",this.getPrivate("maxWidth")),i=this.get("minWidth",this.getPrivate("minWidth")),n=this.getPrivate("width"),r=0;if(Se(n))r=n;else if(null==e)this._adjustedLocalBounds&&(r=this._adjustedLocalBounds.right-this._adjustedLocalBounds.left);else if(e instanceof Ti){const a=this.parent;r=a?a.innerWidth()*e.value:this._root.width()*e.value}else Se(e)&&(r=e);return Se(i)&&(r=Math.max(i,r)),Se(t)&&(r=Math.min(t,r)),r}maxWidth(){let e=this.get("maxWidth",this.getPrivate("maxWidth"));if(Se(e))return e;{let i=this.get("width");if(Se(i))return i}const t=this.parent;return t?t.innerWidth():this._root.width()}maxHeight(){let e=this.get("maxHeight",this.getPrivate("maxHeight"));if(Se(e))return e;{let i=this.get("height");if(Se(i))return i}const t=this.parent;return t?t.innerHeight():this._root.height()}height(){let e=this.get("height"),t=this.get("maxHeight",this.getPrivate("maxHeight")),i=this.get("minHeight",this.getPrivate("minHeight")),n=this.getPrivate("height"),r=0;if(Se(n))r=n;else if(null==e)this._adjustedLocalBounds&&(r=this._adjustedLocalBounds.bottom-this._adjustedLocalBounds.top);else if(e instanceof Ti){const a=this.parent;r=a?a.innerHeight()*e.value:this._root.height()*e.value}else Se(e)&&(r=e);return Se(i)&&(r=Math.max(i,r)),Se(t)&&(r=Math.min(t,r)),r}_findStaticTemplate(e){return this._templateField&&e(this._templateField)?this._templateField:super._findStaticTemplate(e)}_walkParents(e){this._parent&&this._walkParent(e)}_walkParent(e){this._parent&&this._parent._walkParent(e),e(this)}get parent(){return this._parent}_setParent(e,t=!1){const i=this._parent;e!==i&&(this.markDirtyBounds(),e.markDirty(),this._parent=e,t&&(this._removeParent(i),e&&(this._addPercentageSizeChildren(),this._addPercentagePositionChildren())),this.markDirtyPosition(),this._applyThemes())}getNumberFormatter(){return this.get("numberFormatter",this._root.numberFormatter)}getDateFormatter(){return this.get("dateFormatter",this._root.dateFormatter)}getDurationFormatter(){return this.get("durationFormatter",this._root.durationFormatter)}toGlobal(e){return this._display.toGlobal(e)}toLocal(e){return this._display.toLocal(e)}_getDownPoint(){const e=this._getDownPointId();if(e)return this._downPoints[e]}_getDownPointId(){if(this._downPoints)return function Mp(s,e){return ys(s).sort(e)}(this._downPoints,(e,t)=>e>t?1:e<t?-1:0)[0]}toFront(){const e=this.parent;e&&e.children.moveValue(this,e.children.length-1)}toBack(){const e=this.parent;e&&e.children.moveValue(this,0)}}Object.defineProperty(Ga,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Sprite"}),Object.defineProperty(Ga,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:zs.classNames.concat([Ga.className])});class Su extends zs{constructor(){super(...arguments),Object.defineProperty(this,"_display",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeGraphics()}),Object.defineProperty(this,"_backgroundDisplay",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeGraphics()}),Object.defineProperty(this,"_clear",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_pattern",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){super._afterNewApplyThemes()}get pattern(){return this._pattern}_draw(){}_beforeChanged(){super._beforeChanged(),(this.isDirty("repetition")||this.isDirty("width")||this.isDirty("height")||this.isDirty("rotation")||this.isDirty("strokeWidth")||this.isDirty("strokeDasharray")||this.isDirty("strokeDashoffset")||this.isDirty("colorOpacity")||this.isDirty("fillOpacity"))&&(this._clear=!0),this._checkDirtyFill()}_checkDirtyFill(){(this.isDirty("color")||this.isDirty("fill"))&&(this._clear=!0)}_changed(){if(super._changed(),this._clear){const e=this.get("repetition",""),t=this.get("width",100),i=this.get("height",100),n=this.get("fill"),r=this.get("fillOpacity",1),a=this._backgroundDisplay,o=this._display;o.clear(),a.clear(),n&&r>0&&(a.beginFill(n,r),a.drawRect(0,0,t,i),a.endFill()),o.angle=this.get("rotation",0),this._draw(),this._pattern=this._root._renderer.createPattern(o,a,e,t,i)}this._clear=!1}}Object.defineProperty(Su,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Pattern"}),Object.defineProperty(Su,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:zs.classNames.concat([Su.className])});class ku extends Su{constructor(){super(...arguments),Object.defineProperty(this,"_image",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_beforeChanged(){super._beforeChanged(),this._clear=!0,this.isDirty("src")&&this._load();const e=this.get("canvas");e&&(this.set("width",e.width),this.set("height",e.height))}_draw(){super._draw();const e=this._image;if(e){const i=this.get("width",100),n=this.get("height",100),r=this.get("fit","image");let a=0,o=0;"pattern"==r?(a=i,o=n):(a=e.width,o=e.height,"image"==r&&(this.set("width",a),this.set("height",o)));let c=0,h=0;this.get("centered",!0)&&(c=i/2-a/2,h=n/2-o/2),this._display.image(e,a,o,c,h)}const t=this.get("canvas");t&&this._display.image(t,t.width,t.height,0,0)}_load(){const e=this.get("src");if(e){const t=new Image;t.src=e,t.decode().then(()=>{this._image=t,this._draw(),this.events.isEnabled("loaded")&&this.events.dispatch("loaded",{type:"loaded",target:this})}).catch(i=>{})}}}Object.defineProperty(ku,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PicturePattern"}),Object.defineProperty(ku,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Su.classNames.concat([ku.className])});var pb=function(s){return s.ADD="lighter",s.COLOR="color",s.COLOR_BURN="color-burn",s.COLOR_DODGE="color-dodge",s.DARKEN="darken",s.DIFFERENCE="difference",s.DST_OVER="destination-over",s.EXCLUSION="exclusion",s.HARD_LIGHT="hard-light",s.HUE="hue",s.LIGHTEN="lighten",s.LUMINOSITY="luminosity",s.MULTIPLY="multiply",s.NORMAL="source-over",s.OVERLAY="overlay",s.SATURATION="saturation",s.SCREEN="screen",s.SOFT_LIGHT="soft-light",s.SRC_ATOP="source-atop",s.XOR="xor",s}(pb||{});const fb=["fill","fillOpacity","stroke","strokeWidth","strokeOpacity","fillPattern","strokePattern","fillGradient","strokeGradient","strokeDasharray","strokeDashoffset","shadowBlur","shadowColor","shadowOpacity","shadowOffsetX","shadowOffsetY","blur","sepia","invert","brightness","hue","contrast","saturate"];class rn extends Ga{constructor(){super(...arguments),Object.defineProperty(this,"_display",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeGraphics()}),Object.defineProperty(this,"_clear",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_beforeChanged(){if(super._beforeChanged(),(this.isDirty("draw")||this.isDirty("svgPath"))&&this.markDirtyBounds(),(this.isDirty("fill")||this.isDirty("stroke")||this.isDirty("visible")||this.isDirty("forceHidden")||this.isDirty("scale")||this.isDirty("fillGradient")||this.isDirty("strokeGradient")||this.isDirty("fillPattern")||this.isDirty("strokePattern")||this.isDirty("fillOpacity")||this.isDirty("strokeOpacity")||this.isDirty("strokeWidth")||this.isDirty("draw")||this.isDirty("blendMode")||this.isDirty("strokeDasharray")||this.isDirty("strokeDashoffset")||this.isDirty("svgPath")||this.isDirty("lineJoin")||this.isDirty("shadowColor")||this.isDirty("shadowBlur")||this.isDirty("shadowOffsetX")||this.isDirty("shadowOffsetY"))&&(this._clear=!0),this._display.crisp=this.get("crisp",!1),this.isDirty("fillGradient")){const e=this.get("fillGradient");if(e){this._display.isMeasured=!0;const t=e.get("target");t&&(this._disposers.push(t.events.on("boundschanged",()=>{this._markDirtyKey("fill")})),this._disposers.push(t.events.on("positionchanged",()=>{this._markDirtyKey("fill")})))}}if(this.isDirty("strokeGradient")){const e=this.get("strokeGradient");if(e){this._display.isMeasured=!0;const t=e.get("target");t&&(this._disposers.push(t.events.on("boundschanged",()=>{this._markDirtyKey("stroke")})),this._disposers.push(t.events.on("positionchanged",()=>{this._markDirtyKey("stroke")})))}}}_changed(){if(super._changed(),this._clear){this.markDirtyBounds(),this.markDirtyLayer(),this._display.clear();let e=this.get("strokeDasharray");Se(e)&&(e=e<.5?[0]:[e]),this._display.setLineDash(e);const t=this.get("strokeDashoffset");t&&this._display.setLineDashOffset(t);const i=this.get("blendMode",pb.NORMAL);this._display.blendMode=i;const n=this.get("draw");n&&n(this._display,this);const r=this.get("svgPath");null!=r&&this._display.svgPath(r)}}_afterChanged(){if(super._afterChanged(),this._clear){const e=this.get("fill"),t=this.get("fillGradient"),i=this.get("fillPattern"),n=this.get("fillOpacity"),r=this.get("stroke"),a=this.get("strokeGradient"),o=this.get("strokePattern"),l=this.get("shadowColor"),c=this.get("shadowBlur"),h=this.get("shadowOffsetX"),u=this.get("shadowOffsetY"),m=this.get("shadowOpacity");if(l&&(c||h||u)&&this._display.shadow(l,c,h,u,m),e&&!t&&(this._display.beginFill(e,n),this._display.endFill()),t){if(e){const _=t.get("stops",[]);_.length&&ye(_,g=>{(!g.color||g.colorInherited)&&e&&(g.color=e,g.colorInherited=!0),(null==g.opacity||g.opacityInherited)&&(g.opacity=n,g.opacityInherited=!0)})}const p=t.getFill(this);p&&(this._display.beginFill(p,n),this._display.endFill())}if(i){const p=i.pattern;p&&(this._display.beginFill(p,n),this._display.endFill(),i instanceof ku&&i.events.once("loaded",()=>{this._clear=!0,this.markDirty()}))}if(r||a||o){const p=this.get("strokeOpacity");let _=this.get("strokeWidth",1);this.get("nonScalingStroke")&&(_/=this.get("scale",1)),this.get("crisp")&&(_/=this._root._renderer.resolution);const g=this.get("lineJoin");if(r&&!a&&(this._display.lineStyle(_,r,p,g),this._display.endStroke()),a){const f=a.get("stops",[]);f.length&&ye(f,C=>{(!C.color||C.colorInherited)&&r&&(C.color=r,C.colorInherited=!0),(null==C.opacity||C.opacityInherited)&&(C.opacity=p,C.opacityInherited=!0)});const b=a.getFill(this);b&&(this._display.lineStyle(_,b,p,g),this._display.endStroke())}if(o){let f=o.pattern;f&&(this._display.lineStyle(_,f,p,g),this._display.endStroke(),o instanceof ku&&o.events.once("loaded",()=>{this._clear=!0,this.markDirty()}))}}this.getPrivate("showingTooltip")&&this.showTooltip()}this._clear=!1}}Object.defineProperty(rn,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Graphics"}),Object.defineProperty(rn,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Ga.classNames.concat([rn.className])});class ca extends rn{_afterNew(){super._afterNew(),this._display.isMeasured=!0,this.setPrivateRaw("trustBounds",!0)}_beforeChanged(){super._beforeChanged(),(this.isDirty("width")||this.isDirty("height")||this.isPrivateDirty("width")||this.isPrivateDirty("height"))&&(this._clear=!0)}_changed(){super._changed(),this._clear&&!this.get("draw")&&this._draw()}_draw(){this._display.drawRect(0,0,this.width(),this.height())}_updateSize(){this.markDirty(),this._clear=!0}}function Wo(s,e){s.get("reverseChildren",!1)?s.children.eachReverse(e):s.children.each(e)}Object.defineProperty(ca,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Rectangle"}),Object.defineProperty(ca,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:rn.classNames.concat([ca.className])});class Go extends zs{}Object.defineProperty(Go,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Layout"}),Object.defineProperty(Go,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:zs.classNames.concat([Go.className])});class Ld extends Go{updateContainer(e){let t=e.get("paddingLeft",0),i=e.innerWidth(),n=0;Wo(e,a=>{if(a.isVisible()&&"relative"==a.get("position")){let o=a.get("width");if(o instanceof Ti){n+=o.value;let l=i*o.value,c=a.get("minWidth",a.getPrivate("minWidth",-1/0));c>l&&(i-=c,n-=o.value);let h=a.get("maxWidth",a.getPrivate("maxWidth",1/0));l>h&&(i-=h,n-=o.value)}else Se(o)||(o=a.width()),i-=o+a.get("marginLeft",0)+a.get("marginRight",0)}}),(i<=0||i==1/0)&&(i=.1),Wo(e,a=>{if(a.isVisible()&&"relative"==a.get("position")){let o=a.get("width");if(o instanceof Ti){let l=i*o.value/n-a.get("marginLeft",0)-a.get("marginRight",0),c=a.get("minWidth",a.getPrivate("minWidth",-1/0)),h=a.get("maxWidth",a.getPrivate("maxWidth",1/0));l=Math.min(Math.max(c,l),h),a.setPrivate("width",l)}else a._prevSettings.width instanceof Ti&&a.setPrivate("width",void 0)}});let r=t;Wo(e,a=>{if("relative"==a.get("position"))if(a.isVisible()){let o=a.adjustedLocalBounds(),l=a.get("marginLeft",0),c=a.get("marginRight",0),h=a.get("maxWidth"),u=o.left,m=o.right;h&&m-u>h&&(m=u+h);let p=r+l-u;a.setPrivate("x",p),r=p+m+c}else a.setPrivate("x",void 0)})}}Object.defineProperty(Ld,"className",{enumerable:!0,configurable:!0,writable:!0,value:"HorizontalLayout"}),Object.defineProperty(Ld,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Go.classNames.concat([Ld.className])});class Fd extends Go{updateContainer(e){let t=e.get("paddingTop",0),i=e.innerHeight(),n=0;Wo(e,a=>{if(a.isVisible()&&"relative"==a.get("position")){let o=a.get("height");if(o instanceof Ti){n+=o.value;let l=i*o.value,c=a.get("minHeight",a.getPrivate("minHeight",-1/0));c>l&&(i-=c,n-=o.value);let h=a.get("maxHeight",a.getPrivate("maxHeight",1/0));l>h&&(i-=h,n-=o.value)}else Se(o)||(o=a.height()),i-=o+a.get("marginTop",0)+a.get("marginBottom",0)}}),(i<=0||i==1/0)&&(i=.1),Wo(e,a=>{if(a.isVisible()&&"relative"==a.get("position")){let o=a.get("height");if(o instanceof Ti){let l=i*o.value/n-a.get("marginTop",0)-a.get("marginBottom",0),c=a.get("minHeight",a.getPrivate("minHeight",-1/0)),h=a.get("maxHeight",a.getPrivate("maxHeight",1/0));l=Math.min(Math.max(c,l),h),a.setPrivate("height",l)}else a._prevSettings.height instanceof Ti&&a.setPrivate("height",void 0)}});let r=t;Wo(e,a=>{if("relative"==a.get("position"))if(a.isVisible()){let o=a.adjustedLocalBounds(),l=a.get("marginTop",0),c=o.top,h=o.bottom,u=a.get("maxHeight");u&&h-c>u&&(h=c+u);let m=a.get("marginBottom",0),p=r+l-c;a.setPrivate("y",p),r=p+h+m}else a.setPrivate("y",void 0)})}}Object.defineProperty(Fd,"className",{enumerable:!0,configurable:!0,writable:!0,value:"VerticalLayout"}),Object.defineProperty(Fd,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Go.classNames.concat([Fd.className])});class xc extends Go{_afterNew(){this._setRawDefault("maxColumns",Number.MAX_VALUE),super._afterNew()}updateContainer(e){let t=e.get("paddingLeft",0),i=e.get("paddingRight",0),n=e.get("paddingTop",0),r=e.maxWidth()-t-i,a=r,o=1;Wo(e,_=>{if(_.get("visible")&&_.getPrivate("visible")&&!_.get("forceHidden")&&"absolute"!=_.get("position")){let g=_.width();g<a&&(a=g),g>o&&(o=g)}}),a=Hs(a,1,r),o=Hs(o,1,r);let l=1;l=this.get("fixedWidthGrid")?r/o:r/a,l=Math.max(1,Math.floor(l)),l=Math.min(this.get("maxColumns",Number.MAX_VALUE),l);let c=this.getColumnWidths(e,l,o,r),h=n,u=0,m=0;l=c.length;let p=t;Wo(e,_=>{if("relative"==_.get("position")&&_.isVisible()){const g=_.get("marginTop",0),f=_.get("marginBottom",0);let b=_.adjustedLocalBounds(),C=_.get("marginLeft",0),M=_.get("marginRight",0),S=h+g-b.top;_.setPrivate("x",p+C-b.left),_.setPrivate("y",S),p+=c[u]+M,m=Math.max(m,_.height()+g+f),u++,u>=l&&(u=0,p=t,h+=m)}})}getColumnWidths(e,t,i,n){let r=0,a=[],o=0;return Wo(e,l=>{let c=l.adjustedLocalBounds();"absolute"!=l.get("position")&&l.isVisible()&&(a[o]=this.get("fixedWidthGrid")?i:Math.max(0|a[o],c.right-c.left+l.get("marginLeft",0)+l.get("marginRight",0)),o<e.children.length-1&&(o++,o==t&&(o=0)))}),ye(a,l=>{r+=l}),r>n?t>2?this.getColumnWidths(e,t-=1,i,n):[n]:a}}Object.defineProperty(xc,"className",{enumerable:!0,configurable:!0,writable:!0,value:"GridLayout"}),Object.defineProperty(xc,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Go.classNames.concat([xc.className])});class Ya{static escape(e){return e.replace(/\[\[/g,this.prefix+"1").replace(/([^\/\]]{1})\]\]/g,"$1"+this.prefix+"2").replace(/\]\]/g,this.prefix+"2").replace(/\{\{/g,this.prefix+"3").replace(/\}\}/g,this.prefix+"4").replace(/\'\'/g,this.prefix+"5")}static unescape(e){return e.replace(new RegExp(this.prefix+"1","g"),"[[").replace(new RegExp(this.prefix+"2","g"),"]]").replace(new RegExp(this.prefix+"3","g"),"{{").replace(new RegExp(this.prefix+"4","g"),"}}").replace(new RegExp(this.prefix+"5","g"),"''")}static cleanUp(e){return e.replace(/\[\[/g,"[").replace(/\]\]/g,"]").replace(/\{\{/g,"{").replace(/\}\}/g,"}").replace(/\'\'/g,"'")}static chunk(e,t=!1,i=!1){let n=[];e=this.escape(e);let r=t?e.split("'"):[e];for(let a=0;a<r.length;a++){let o=r[a];if(""!==o)if(a%2==0){o=o.replace(/\]\[/g,"]"+co+"["),o=o.replace(/\[\]/g,"[ ]");let l=o.split(/[\[\]]+/);for(let c=0;c<l.length;c++){let h=this.cleanUp(this.unescape(l[c]));h!==co&&""!==h&&n.push(c%2==0?{type:"value",text:h}:{type:i?"value":"format",text:"["+h+"]"})}}else{let l=o.split(/[\[\]]+/);for(let c=0;c<l.length;c++){let h=this.cleanUp(this.unescape(l[c]));""!==h&&(c%2==0?n.push({type:"text",text:h}):this.isImage(h)?n.push({type:"image",text:"["+h+"]"}):n.push({type:"format",text:"["+h+"]"}))}}}return n}static isImage(e){return!!e.match(/img[ ]?:/)}static getTextStyle(e){let t={};if(""==e||"[ ]"==e)return{};const i=e.match(/('[^']*')|("[^"]*")/gi);if(i)for(let r=0;r<i.length;r++)e=e.replace(i[r],i[r].replace(/['"]*/g,"").replace(/[ ]+/g,"+"));let n=e.match(/([\w\-]*:[\s]?[^;\s\]]*)|(\#[\w]{1,6})|([\w\-]+)|(\/)/gi);if(!n)return{};for(let r=0;r<n.length;r++)if(n[r].match(/^(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)$/i))t.fontWeight=n[r];else if(n[r].match(/^(underline|line-through)$/i))t.textDecoration=n[r];else if("/"!=n[r])if(n[r].match(/:/)){const a=n[r].replace("+"," ").split(/:[ ]*/);t[a[0]]=a[1]}else t.fill=ei.fromString(n[r]);return t}}function Au(s,e){if(null!=e){let i,t=(e=Ya.escape(e=""+e)).match(/\{([^}]+)\}/g);if(t)for(i=0;i<t.length;i++){let r=gb(s,t[i].replace(/\{([^}]+)\}/,"$1"),"");null==r&&(r=""),e=e.split(t[i]).join(r)}e=Ya.unescape(e)}else e="";return e}function gb(s,e,t){let i;const n=s.dataItem;let o,r=[],a=/(format[a-zA-Z]*)\((.*)\)|([^.]+)/g;for(;o=a.exec(e),null!==o;)if(o[3]){r.push({prop:o[3]});const l=s.getDateFormatter().get("dateFields",[]),c=s.getNumberFormatter().get("numericFields",[]),h=s.getDurationFormatter().get("durationFields",[]);-1!==l.indexOf(o[3])?r.push({method:"formatDate",params:[]}):-1!==c.indexOf(o[3])?r.push({method:"formatNumber",params:[]}):-1!==h.indexOf(o[3])&&r.push({method:"formatDuration",params:[]})}else{let l=[];if(""!=Sl(o[2])){let h,c=/'([^']*)'|"([^"]*)"|([0-9\-]+)/g;for(;h=c.exec(o[2]),null!==h;)l.push(h[1]||h[2]||h[3])}r.push({method:o[1],params:l})}if(n){i=wc(s,r,n._settings),(null==i||Td(i))&&(i=wc(s,r,n));let l=n.dataContext;null==i&&l&&(i=wc(s,r,l),null==i&&(i=wc(s,[{prop:e}],l)),null==i&&l.dataContext&&(i=wc(s,r,l.dataContext))),null==i&&n.component&&n.component.dataItem!==n&&(i=gb(n.component,e,t))}return null==i&&(i=wc(s,r,s)),null==i&&s.parent&&(i=gb(s.parent,e,t)),i}function XC(s,e){const t=s.getPrivate("customData");if(Td(t))return t[e]}function wc(s,e,t,i){let n=t,r=!1;for(let a=0,o=e.length;a<o;a++){let l=e[a];if(l.prop){if(n instanceof Ga){let c=n.get(l.prop);null==c&&(c=n.getPrivate(l.prop)),null==c&&(c=XC(n,l.prop)),null==c&&(c=n[l.prop]),n=c}else if(n.get){let c=n.get(l.prop);null==c&&(c=n[l.prop]),n=c}else n=n[l.prop];if(null==n)return}else switch(l.method){case"formatNumber":let c=_s(n);null!=c&&(n=s.getNumberFormatter().format(c,i||l.params[0]||void 0),r=!0);break;case"formatDate":let h=V_(n);if(!vu(h)||Kt(h.getTime()))return;null!=h&&(n=s.getDateFormatter().format(h,i||l.params[0]||void 0),r=!0);break;case"formatDuration":let u=_s(n);null!=u&&(n=s.getDurationFormatter().format(u,i||l.params[0]||void 0,l.params[1]||void 0),r=!0);break;case"urlEncode":case"encodeURIComponent":n=encodeURIComponent(n);break;default:n[l.method]&&n[l.method].apply(t,l.params)}}if(!r){let a=[{method:"",params:i}];if(null==i)Se(n)?(a[0].method="formatNumber",a[0].params=""):vu(n)&&(a[0].method="formatDate",a[0].params="");else{let o=function Ed(s){if(typeof s>"u")return"string";let e=(s=(s=(s=s.toLowerCase().replace(/^\[[^\]]*\]/,"")).replace(/\[[^\]]+\]/,"")).trim()).match(/\/(date|number|duration)$/);return e?e[1]:"number"===s?"number":"date"===s?"date":"duration"===s?"duration":s.match(/[#0]/)?"number":s.match(/[ymwdhnsqaxkzgtei]/)?"date":"string"}(i);"number"===o?a[0].method="formatNumber":"date"===o?a[0].method="formatDate":"duration"===o&&(a[0].method="formatDuration")}a[0].method&&(n=wc(s,a,n))}return n}Object.defineProperty(Ya,"prefix",{enumerable:!0,configurable:!0,writable:!0,value:"__amcharts__"});class ai extends Ga{constructor(){super(...arguments),Object.defineProperty(this,"_display",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeContainer()}),Object.defineProperty(this,"_childrenDisplay",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeContainer()}),Object.defineProperty(this,"children",{enumerable:!0,configurable:!0,writable:!0,value:new G_(this)}),Object.defineProperty(this,"_percentageSizeChildren",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_percentagePositionChildren",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_prevWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_prevHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_contentWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_contentHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_contentMask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_vsbd0",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_vsbd1",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){super._afterNew(),this._display.addChild(this._childrenDisplay)}_dispose(){pc(this.allChildren(),e=>{e.dispose()}),this.getPrivate("htmlElement")&&this._root._removeHTMLContent(this),super._dispose()}_changed(){if(super._changed(),this.isDirty("interactiveChildren")&&(this._display.interactiveChildren=this.get("interactiveChildren",!1)),this.isDirty("layout")&&(this._prevWidth=0,this._prevHeight=0,this.markDirtyBounds(),this._prevSettings.layout&&this.children.each(e=>{e.removePrivate("x"),e.removePrivate("y")})),(this.isDirty("paddingTop")||this.isDirty("paddingBottom")||this.isDirty("paddingLeft")||this.isDirty("paddingRight"))&&this.children.each(e=>{e.markDirtyPosition()}),this.isDirty("maskContent")){const e=this._childrenDisplay;let t=this._contentMask;this.get("maskContent")?t||(t=ca.new(this._root,{x:-.5,y:-.5,width:this.width()+1,height:this.height()+1}),this._contentMask=t,e.addChildAt(t._display,0),e.mask=t._display):t&&(e.removeChild(t._display),e.mask=null,t.dispose(),this._contentMask=void 0)}}_updateSize(){super._updateSize(),ye(this._percentageSizeChildren,e=>{e._updateSize()}),ye(this._percentagePositionChildren,e=>{e.markDirtyPosition(),e._updateSize()}),this.updateBackground()}updateBackground(){const e=this.get("background");let t=this._localBounds;if(t&&!this.isHidden()){let i=t.left,n=t.top,r=t.right-i,a=t.bottom-n,o=this.get("maxWidth"),l=this.get("maxHeight");l&&a>l&&(a=l),o&&r>o&&(r=o);let c=this.width(),h=this.height();e&&(e.setAll({width:r,height:a,x:i,y:n}),this._display.interactive&&(e._display.interactive=!0));const u=this._contentMask;u&&u.setAll({width:c+1,height:h+1});const m=this.get("verticalScrollbar");if(m){m.set("height",h),m.set("x",c-m.width()-m.get("marginRight",0)),m.set("end",m.get("start",0)+h/this._contentHeight);const p=m.get("background");p&&p.setAll({width:m.width(),height:h});let _=!0;this._contentHeight<=h&&(_=!1),m.setPrivate("visible",_)}}}_applyThemes(e=!1){return!!super._applyThemes(e)&&(this.eachChildren(t=>{t._applyThemes(e)}),!0)}_applyState(e){super._applyState(e),this.get("setStateOnChildren")&&this.eachChildren(t=>{t.states.apply(e)})}_applyStateAnimated(e,t){super._applyStateAnimated(e,t),this.get("setStateOnChildren")&&this.eachChildren(i=>{i.states.applyAnimate(e,t)})}innerWidth(){return this.width()-this.get("paddingRight",0)-this.get("paddingLeft",0)}innerHeight(){return this.height()-this.get("paddingTop",0)-this.get("paddingBottom",0)}_getBounds(){let e=this.get("width"),t=this.get("height"),i=this.getPrivate("width"),n=this.getPrivate("height"),r={left:0,top:0,right:this.width(),bottom:this.height()},a=this.get("layout"),o=!1,l=!1;if((a instanceof Ld||a instanceof xc)&&(o=!0),a instanceof Fd&&(l=!0),null==e&&null==i||null==t&&null==n||this.get("verticalScrollbar")){let c=Number.MAX_VALUE,h=c,u=-c,m=c,p=-c;const _=this.get("paddingLeft",0),g=this.get("paddingTop",0),f=this.get("paddingRight",0),b=this.get("paddingBottom",0);this.children.each(E=>{if("absolute"!=E.get("position")&&E.get("isMeasured")){let S=E.adjustedLocalBounds(),P=E.x(),I=E.y(),L=P+S.left,O=P+S.right,B=I+S.top,Q=I+S.bottom;o&&(L-=E.get("marginLeft",0),O+=E.get("marginRight",0)),l&&(B-=E.get("marginTop",0),Q+=E.get("marginBottom",0)),L<h&&(h=L),O>u&&(u=O),B<m&&(m=B),Q>p&&(p=Q)}}),h==c&&(h=0),u==-c&&(u=0),m==c&&(m=0),p==-c&&(p=0),r.left=h-_,r.top=m-g,r.right=u+f,r.bottom=p+b;const C=this.get("minWidth");Se(C)&&C>0&&r.right-r.left<C&&(r.left=r.right-C);const M=this.get("minHeight");Se(M)&&M>0&&r.bottom-r.top<M&&(r.top=r.bottom-M)}this._contentWidth=r.right-r.left,this._contentHeight=r.bottom-r.top,Se(e)&&(r.left=0,r.right=e),Se(i)&&(r.left=0,r.right=i),Se(t)&&(r.top=0,r.bottom=t),Se(n)&&(r.top=0,r.bottom=n),this._localBounds=r}_updateBounds(){const e=this.get("layout");e&&e.updateContainer(this),super._updateBounds(),this.updateBackground()}markDirty(){super.markDirty(),this._root._addDirtyParent(this)}_prepareChildren(){const e=this.innerWidth(),t=this.innerHeight();if(e!=this._prevWidth||t!=this._prevHeight){let i=this.get("layout"),n=!1,r=!1;i&&((i instanceof Ld||i instanceof xc)&&(n=!0),i instanceof Fd&&(r=!0)),ye(this._percentageSizeChildren,a=>{if(!n){let o=a.get("width");o instanceof Ti&&a.setPrivate("width",o.value*e)}if(!r){let o=a.get("height");o instanceof Ti&&a.setPrivate("height",o.value*t)}}),ye(this._percentagePositionChildren,a=>{a.markDirtyPosition(),a.markDirtyBounds()}),this._prevWidth=e,this._prevHeight=t,this._sizeDirty=!0,this.updateBackground()}this._handleStates()}_updateChildren(){if(this.isDirty("html")){const e=this.get("html");e&&""!==e?this._root._setHTMLContent(this,Au(this,this.get("html",""))):this._root._removeHTMLContent(this),this._root._positionHTMLElement(this)}if(this.isDirty("verticalScrollbar")){const e=this.get("verticalScrollbar");if(e){e._setParent(this),e.startGrip.setPrivate("visible",!1),e.endGrip.setPrivate("visible",!1),this.set("maskContent",!0),this.set("paddingRight",e.width()+e.get("marginRight",0)+e.get("marginLeft",0));let t=this.get("background");t||(t=this.set("background",ca.new(this._root,{themeTags:["background"],fillOpacity:0,fill:this._root.interfaceColors.get("alternativeBackground")}))),this._vsbd0=this.events.on("wheel",i=>{const n=i.originalEvent;if(!gp(n,this))return;n.preventDefault();let r=n.deltaY/5e3;const a=e.get("start",0),o=e.get("end",1);a+r<=0&&(r=-a),o+r>=1&&(r=1-o),a+r>=0&&o+r<=1&&(e.set("start",a+r),e.set("end",o+r))}),this._disposers.push(this._vsbd0),this._vsbd1=e.events.on("rangechanged",()=>{let i=this._contentHeight;const n=this._childrenDisplay,r=this._contentMask;n.y=-e.get("start",0)*i,n.markDirtyLayer(),r&&(r._display.y=-n.y,n.mask=r._display)}),this._disposers.push(this._vsbd1),this._display.addChild(e._display)}else{const t=this._prevSettings.verticalScrollbar;t&&(this._display.removeChild(t._display),this._vsbd0&&this._vsbd0.dispose(),this._vsbd1&&this._vsbd1.dispose(),this._childrenDisplay.y=0,this.setPrivate("height",void 0),this.set("maskContent",!1),this.set("paddingRight",void 0))}}if(this.isDirty("background")){const e=this._prevSettings.background;e&&this._display.removeChild(e._display);const t=this.get("background");t instanceof Ga&&(t.set("isMeasured",!1),t._setParent(this),this._display.addChildAt(t._display,0))}if(this.isDirty("mask")){const e=this.get("mask"),t=this._prevSettings.mask;if(t&&(this._display.removeChild(t._display),t!=e&&t.dispose()),e){const i=e.parent;i&&i.children.removeValue(e),e._setParent(this),this._display.addChildAt(e._display,0),this._childrenDisplay.mask=e._display}}}_processTemplateField(){super._processTemplateField(),this.children.each(e=>{e._processTemplateField()})}walkChildren(e){this.children.each(t=>{t instanceof ai&&t.walkChildren(e),e(t)})}eachChildren(e){const t=this.get("background");t&&e(t);const i=this.get("verticalScrollbar");i&&e(i);const n=this.get("mask");n&&e(n),this.children.values.forEach(r=>{e(r)})}allChildren(){const e=[];return this.eachChildren(t=>{e.push(t)}),e}_setDataItem(e){const t=e!==this._dataItem;super._setDataItem(e);const i=this.get("html","");i&&""!==i&&t&&this._root._setHTMLContent(this,Au(this,i))}}Object.defineProperty(ai,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Container"}),Object.defineProperty(ai,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Ga.classNames.concat([ai.className])});class Mc extends Ga{constructor(){super(...arguments),Object.defineProperty(this,"textStyle",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeTextStyle()}),Object.defineProperty(this,"_display",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeText("",this.textStyle)}),Object.defineProperty(this,"_textStyles",{enumerable:!0,configurable:!0,writable:!0,value:["textAlign","fontFamily","fontSize","fontStyle","fontWeight","fontStyle","fontVariant","textDecoration","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","shadowOpacity","lineHeight","baselineRatio","direction","textBaseline","oversizedBehavior","breakWords","ellipsis","minScale","maxChars"]}),Object.defineProperty(this,"_originalScale",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_updateBounds(){this.get("text")?super._updateBounds():this._adjustedLocalBounds={left:0,right:0,top:0,bottom:0}}_changed(){super._changed(),this._display.clear();let e=this.textStyle;if(this.isDirty("opacity")){let t=this.get("opacity",1);this._display.alpha=t}if((this.isDirty("text")||this.isDirty("populateText"))&&(this._display.text=this._getText(),this.markDirtyBounds(),"tooltip"==this.get("role")&&this._root.updateTooltip(this)),this.isPrivateDirty("tooltipElement")&&this.getPrivate("tooltipElement")&&this._disposers.push(new Ds(()=>{this._root._removeTooltipElement(this)})),this.isDirty("width")&&(e.wordWrapWidth=this.width(),this.markDirtyBounds()),this.isDirty("oversizedBehavior")&&(e.oversizedBehavior=this.get("oversizedBehavior","none"),this.markDirtyBounds()),this.isDirty("breakWords")&&(e.breakWords=this.get("breakWords",!1),this.markDirtyBounds()),this.isDirty("ellipsis")&&(e.ellipsis=this.get("ellipsis"),this.markDirtyBounds()),this.isDirty("ignoreFormatting")&&(e.ignoreFormatting=this.get("ignoreFormatting",!1),this.markDirtyBounds()),this.isDirty("minScale")&&(e.minScale=this.get("minScale",0),this.markDirtyBounds()),this.isDirty("fill")){let t=this.get("fill");t&&(e.fill=t)}if(this.isDirty("fillOpacity")){let t=this.get("fillOpacity",1);t&&(e.fillOpacity=t)}(this.isDirty("maxWidth")||this.isPrivateDirty("maxWidth"))&&(e.maxWidth=this.get("maxWidth",this.getPrivate("maxWidth")),this.markDirtyBounds()),(this.isDirty("maxHeight")||this.isPrivateDirty("maxHeight"))&&(e.maxHeight=this.get("maxHeight",this.getPrivate("maxHeight")),this.markDirtyBounds()),ye(this._textStyles,t=>{this._dirty[t]&&(e[t]=this.get(t),this.markDirtyBounds())}),e.fontSize=this.get("fontSize"),e.fontFamily=this.get("fontFamily"),this._display.style=e,this.isDirty("role")&&"tooltip"==this.get("role")&&this._root.updateTooltip(this)}_getText(){let e=this.get("text","");return this.get("maxChars")&&(e=function Ns(s,e,t=!1,i="..."){if(s.length>e){let n=e-1;for(;n>=0&&s.charAt(n).match(/\w/);)n--;return n>=0&&0==t?s.substring(0,n+1)+"...":s.substring(0,e)+i}return s}(e,this.get("maxChars",1e8),this.get("breakWords"),this.get("ellipsis"))),this.get("populateText")?Au(this,e):e}markDirtyText(){this._display.text=this._getText(),"tooltip"==this.get("role")&&this._root.updateTooltip(this),this.markDirtyBounds(),this.markDirty()}_setDataItem(e){super._setDataItem(e),this.get("populateText")&&this.markDirtyText()}getNumberFormatter(){return this.parent?this.parent.getNumberFormatter():super.getNumberFormatter()}getDateFormatter(){return this.parent?this.parent.getDateFormatter():super.getDateFormatter()}getDurationFormatter(){return this.parent?this.parent.getDurationFormatter():super.getDurationFormatter()}}Object.defineProperty(Mc,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Text"}),Object.defineProperty(Mc,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Ga.classNames.concat([Mc.className])});class qC{constructor(){Object.defineProperty(this,"_observer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_targets",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this._observer=new ResizeObserver(e=>{ye(e,t=>{ye(this._targets,i=>{i.target===t.target&&i.callback()})})})}addTarget(e,t){this._observer.observe(e,{box:"border-box"}),this._targets.push({target:e,callback:t})}removeTarget(e){this._observer.unobserve(e),Md(this._targets,t=>t.target!==e)}}class Ap{constructor(){Object.defineProperty(this,"_timer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_targets",{enumerable:!0,configurable:!0,writable:!0,value:[]})}addTarget(e,t){if(null===this._timer){let n=null;const r=()=>{const a=Date.now();(null===n||a>n+Ap.delay)&&(n=a,ye(this._targets,o=>{let l=o.target.getBoundingClientRect();(l.width!==o.size.width||l.height!==o.size.height)&&(o.size=l,o.callback())})),this._timer=0===this._targets.length?null:requestAnimationFrame(r)};this._timer=requestAnimationFrame(r)}this._targets.push({target:e,callback:t,size:{width:0,height:0,left:0,right:0,top:0,bottom:0,x:0,y:0}})}removeTarget(e){Md(this._targets,t=>t.target!==e),0===this._targets.length&&null!==this._timer&&(cancelAnimationFrame(this._timer),this._timer=null)}}Object.defineProperty(Ap,"delay",{enumerable:!0,configurable:!0,writable:!0,value:200});let Pp=null;class KC{constructor(e,t){Object.defineProperty(this,"_sensor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_element",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_listener",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this._sensor=function $C(){return null===Pp&&(Pp=typeof ResizeObserver<"u"?new qC:new Ap),Pp}(),this._element=e,this._listener=fp(t),this._sensor.addTarget(e,t)}isDisposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._sensor.removeTarget(this._element),this._listener.dispose())}get sensor(){return this._sensor}}class Op extends zs{}Object.defineProperty(Op,"className",{enumerable:!0,configurable:!0,writable:!0,value:"InterfaceColors"}),Object.defineProperty(Op,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:zs.classNames.concat([Op.className])});class _r extends ai{constructor(){super(...arguments),Object.defineProperty(this,"_text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_textKeys",{enumerable:!0,configurable:!0,writable:!0,value:["text","fill","fillOpacity","textAlign","fontFamily","fontSize","fontStyle","fontWeight","fontStyle","fontVariant","textDecoration","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","shadowOpacity","lineHeight","baselineRatio","direction","textBaseline","oversizedBehavior","breakWords","ellipsis","minScale","populateText","role","ignoreFormatting","maxChars"]})}get text(){return this._text}_afterNew(){super._afterNew(),this._makeText(),ye(this._textKeys,e=>{const t=this.get(e);null!=t&&this._text.set(e,t)}),""!==this.get("html","")&&this._text.set("text",""),this.onPrivate("maxWidth",()=>{this._setMaxDimentions()}),this.onPrivate("maxHeight",()=>{this._setMaxDimentions()})}_makeText(){this._text=this.children.push(Mc.new(this._root,{}))}_updateChildren(){if(super._updateChildren(),ye(this._textKeys,e=>{this._text.set(e,this.get(e))}),this.isDirty("maxWidth")&&this._setMaxDimentions(),this.isDirty("maxHeight")&&this._setMaxDimentions(),this.isDirty("rotation")&&this._setMaxDimentions(),""!==this.get("html","")?this._text.set("text",""):this._text.set("text",this.get("text")),this.isDirty("textAlign")||this.isDirty("width")){const e=this.get("textAlign");let t;null!=this.get("width")?t="right"==e?vt:"center"==e?wi:0:"left"==e||"start"==e?t=this.get("paddingLeft"):("right"==e||"end"==e)&&(t=-this.get("paddingRight")),this.text.set("x",t)}}_setMaxDimentions(){const e=this.get("rotation"),t=90==e||270==e||-90==e,i=this.get("maxWidth",this.getPrivate("maxWidth",1/0));Se(i)?this.text.set(t?"maxHeight":"maxWidth",i-this.get("paddingLeft",0)-this.get("paddingRight",0)):this.text.set(t?"maxHeight":"maxWidth",void 0);const n=this.get("maxHeight",this.getPrivate("maxHeight",1/0));Se(n)?this.text.set(t?"maxWidth":"maxHeight",n-this.get("paddingTop",0)-this.get("paddingBottom",0)):this.text.set(t?"maxWidth":"maxHeight",void 0)}_setDataItem(e){super._setDataItem(e),this._markDirtyKey("text"),this.text.get("populateText")&&this.text.markDirtyText()}getText(){return this._text._getText()}}Object.defineProperty(_r,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Label"}),Object.defineProperty(_r,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ai.classNames.concat([_r.className])});class Bd extends rn{_beforeChanged(){super._beforeChanged(),(this.isDirty("pointerBaseWidth")||this.isDirty("cornerRadius")||this.isDirty("pointerLength")||this.isDirty("pointerX")||this.isDirty("pointerY")||this.isDirty("width")||this.isDirty("height"))&&(this._clear=!0)}_changed(){if(super._changed(),this._clear){this.markDirtyBounds();let e=this.width(),t=this.height();if(e>0&&t>0){let i=this.get("cornerRadius",8);i=Hs(i,0,Math.min(e/2,t/2));let n=this.get("pointerX",0),r=this.get("pointerY",0),a=this.get("pointerBaseWidth",15)/2,o=0,l=0,p=0,g=(n-o)*(t-l)-(r-l)*(e-o),f=(n-p)*(0-t)-(r-t)*(e-p);const b=this._display;if(b.moveTo(i,0),g>0&&f>0){let C=Math.round(Hs(n,i+a,e-a-i));r=Hs(r,-1/0,0),b.lineTo(C-a,0),b.lineTo(n,r),b.lineTo(C+a,0)}if(b.lineTo(e-i,0),b.arcTo(e,0,e,i,i),g>0&&f<0){let C=Math.round(Hs(r,i+a,t-a-i));n=Hs(n,e,1/0),b.lineTo(e,i),b.lineTo(e,Math.max(C-a,i)),b.lineTo(n,r),b.lineTo(e,C+a)}if(b.lineTo(e,t-i),b.arcTo(e,t,e-i,t,i),g<0&&f<0){let C=Math.round(Hs(n,i+a,e-a-i));r=Hs(r,t,1/0),b.lineTo(e-i,t),b.lineTo(C+a,t),b.lineTo(n,r),b.lineTo(C-a,t)}if(b.lineTo(i,t),b.arcTo(0,t,0,t-i,i),g<0&&f>0){let C=Math.round(Hs(r,i+a,t-i-a));n=Hs(n,-1/0,0),b.lineTo(0,t-i),b.lineTo(0,C+a),b.lineTo(n,r),b.lineTo(0,Math.max(C-a,i))}b.lineTo(0,i),b.arcTo(0,0,i,0,i),b.closePath()}}}}Object.defineProperty(Bd,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PointedRectangle"}),Object.defineProperty(Bd,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:rn.classNames.concat([Bd.className])});class Vr extends ai{constructor(e,t,i,n=[]){super(e,t,i,n),Object.defineProperty(this,"_fx",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_fy",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_label",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fillDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_strokeDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_labelDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_w",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_h",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_keepHoverDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_htmlContentHovered",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_afterNew(){this._settings.themeTags=ki(this._settings.themeTags,["tooltip"]),super._afterNew(),this.set("background",Bd.new(this._root,{themeTags:["tooltip","background"]})),this._label=this.children.push(_r.new(this._root,{})),this._disposers.push(this._label.events.on("boundschanged",()=>{this._updateBackground()})),this._disposers.push(this.on("bounds",()=>{this._updateBackground()})),this._updateTextColor(),this._root.tooltipContainer.children.push(this),this.hide(0),this._disposers.push(this.label.onPrivate("htmlElement",e=>{e&&(qn(e,"pointerover",t=>{this._htmlContentHovered=!0}),qn(e,"pointerout",t=>{this._htmlContentHovered=!1}))})),this._root._tooltips.push(this)}get label(){return this._label}dispose(){super.dispose(),Pr(this._root._tooltips,this)}_updateChildren(){super._updateChildren(),(this.isDirty("pointerOrientation")||this.isPrivateDirty("minWidth")||this.isPrivateDirty("minHeight"))&&this.get("background")._markDirtyKey("width"),null!=this.get("labelText")&&this.label.set("text",this.get("labelText")),null!=this.get("labelHTML")&&this.label.set("html",this.get("labelHTML"))}_changed(){if(super._changed(),(this.isDirty("pointTo")||this.isDirty("pointerOrientation"))&&this._updateBackground(),this.isDirty("tooltipTarget")&&this.updateBackgroundColor(),this.isDirty("keepTargetHover"))if(this.get("keepTargetHover")){const t=this.get("background");this._keepHoverDp=new mr([t.events.on("pointerover",i=>{let n=this.get("tooltipTarget");n&&(n.parent&&n.parent.getPrivate("tooltipTarget")==n&&(n=n.parent),n.hover())}),t.events.on("pointerout",i=>{let n=this.get("tooltipTarget");n&&(n.parent&&n.parent.getPrivate("tooltipTarget")==n&&(n=n.parent),this._htmlContentHovered||n.unhover())})]),this.label.onPrivate("htmlElement",i=>{this._keepHoverDp&&i&&this._keepHoverDp.disposers.push(qn(i,"pointerleave",n=>{const r=this.root._renderer.getEvent(n);t.events.dispatch("pointerout",{type:"pointerout",originalEvent:r.event,point:r.point,simulated:!1,target:t})}))})}else this._keepHoverDp&&(this._keepHoverDp.dispose(),this._keepHoverDp=void 0)}_onShow(){super._onShow(),this.updateBackgroundColor()}updateBackgroundColor(){let e=this.get("tooltipTarget");const t=this.get("background");let i,n;e&&t&&(i=e.get("fill"),n=e.get("stroke"),null==i&&(i=n),this.get("getFillFromSprite")&&(this._fillDp&&this._fillDp.dispose(),null!=i&&t.set("fill",i),this._fillDp=e.on("fill",r=>{null!=r&&(t.set("fill",r),this._updateTextColor(r))}),this._disposers.push(this._fillDp)),this.get("getStrokeFromSprite")&&(this._strokeDp&&this._strokeDp.dispose(),null!=i&&t.set("stroke",i),this._strokeDp=e.on("fill",r=>{null!=r&&t.set("stroke",r)}),this._disposers.push(this._strokeDp)),this.get("getLabelFillFromSprite")&&(this._labelDp&&this._labelDp.dispose(),null!=i&&this.label.set("fill",i),this._labelDp=e.on("fill",r=>{null!=r&&this.label.set("fill",r)}),this._disposers.push(this._labelDp))),this._updateTextColor(i)}_updateTextColor(e){this.get("autoTextColor")&&(null==e&&(e=this.get("background").get("fill")),null==e&&(e=this._root.interfaceColors.get("background")),e instanceof ei&&this.label.set("fill",ei.alternative(e,this._root.interfaceColors.get("alternativeText"),this._root.interfaceColors.get("text"))))}_setDataItem(e){super._setDataItem(e),this.label._setDataItem(e)}_updateBackground(){super.updateBackground();const e=this._root.container;if(e){let t=.5,i=.5,n=this.get("centerX");n instanceof Ti&&(t=n.value);let r=this.get("centerY");r instanceof Ti&&(i=r.value);let a=e.width(),o=e.height(),l=this.parent,c=0,h=0;if(l){c=l.x(),h=l.y();const Q=l.get("layerMargin");Q&&(c+=Q.left||0,h+=Q.top||0,a+=(Q.left||0)+(Q.right||0),o+=(Q.top||0)+(Q.bottom||0))}const u=this.get("bounds",{left:-c,top:-h,right:a-c,bottom:o-h});this._updateBounds();let m=this.width(),p=this.height();0===m&&(m=this._w),0===p&&(p=this._h);let _=this.get("pointTo",{x:a/2,y:o/2}),g=_.x,f=_.y,b=this.get("pointerOrientation"),C=this.get("background"),M=0,E=0,S=0;C instanceof Bd&&(M=C.get("pointerLength",0),E=C.get("strokeWidth",0)/2,S=E,C.set("width",m),C.set("height",p));let P=0,I=0,L=u.right-u.left,O=u.bottom-u.top;"horizontal"==b||"left"==b||"right"==b?(E=0,"horizontal"==b?g>u.left+L/2?(g-=m*(1-t)+M,S*=-1):g+=m*t+M:"left"==b?g+=m*(1-t)+M:(g-=m*t+M,S*=-1)):(S=0,"vertical"==b?f>u.top+p/2+M?f-=p*(1-i)+M:(f+=p*i+M,E*=-1):"down"==b?f-=p*(1-i)+M:(f+=p*i+M,E*=-1)),g=Hs(g,u.left+m*t,u.left+L-m*(1-t))+S,f=Hs(f,u.top+p*i,u.top+O-p*(1-i))-E,P=_.x-g+m*t+S,I=_.y-f+p*i-E,this._fx=g,this._fy=f;const B=this.get("animationDuration",0);if(B>0&&this.get("visible")&&this.get("opacity")>.1){const Q=this.get("animationEasing");this.animate({key:"x",to:g,duration:B,easing:Q}),this.animate({key:"y",to:f,duration:B,easing:Q})}else this.set("x",g),this.set("y",f);C instanceof Bd&&(C.set("pointerX",P),C.set("pointerY",I)),m>0&&(this._w=m),p>0&&(this._h=p)}}}Object.defineProperty(Vr,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Tooltip"}),Object.defineProperty(Vr,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ai.classNames.concat([Vr.className])});class JC extends zs{_setDefaults(){this._setDefault("negativeBase",0),this._setDefault("numberFormat","#,###.#####"),this._setDefault("smallNumberThreshold",1);const e="_big_number_suffix_",t="_small_number_suffix_",i="_byte_suffix_";this._setDefault("bigNumberPrefixes",[{number:1e3,suffix:this._t(e+"3")},{number:1e6,suffix:this._t(e+"6")},{number:1e9,suffix:this._t(e+"9")},{number:1e12,suffix:this._t(e+"12")},{number:1e15,suffix:this._t(e+"15")},{number:1e18,suffix:this._t(e+"18")},{number:1e21,suffix:this._t(e+"21")},{number:1e24,suffix:this._t(e+"24")}]),this._setDefault("smallNumberPrefixes",[{number:1e-24,suffix:this._t(t+"24")},{number:1e-21,suffix:this._t(t+"21")},{number:1e-18,suffix:this._t(t+"18")},{number:1e-15,suffix:this._t(t+"15")},{number:1e-12,suffix:this._t(t+"12")},{number:1e-9,suffix:this._t(t+"9")},{number:1e-6,suffix:this._t(t+"6")},{number:.001,suffix:this._t(t+"3")}]),this._setDefault("bytePrefixes",[{number:1,suffix:this._t(i+"B")},{number:1024,suffix:this._t(i+"KB")},{number:1048576,suffix:this._t(i+"MB")},{number:1073741824,suffix:this._t(i+"GB")},{number:1099511627776,suffix:this._t(i+"TB")},{number:0x4000000000000,suffix:this._t(i+"PB")}]),super._setDefaults()}_beforeChanged(){super._beforeChanged()}format(e,t,i){(null==t||Ml(t)&&"number"===t.toLowerCase())&&(t=this.get("numberFormat",""));let n,r=Number(e);if(Td(t))try{return this.get("intlLocales")?new Intl.NumberFormat(this.get("intlLocales"),t).format(r):new Intl.NumberFormat(void 0,t).format(r)}catch{return"Invalid"}else{t=kl(t);let o,a=this.parseFormat(t,this._root.language);o=r>this.get("negativeBase")?a.positive:r<this.get("negativeBase")?a.negative:a.zero,null!=i&&!o.mod&&(o=zo(o),o.decimals.active=0==r?0:i),n=o.template.split(co).join(this.applyFormat(r,o))}return!0===this.get("forceLTR")&&(n="\u200e"+n),n}parseFormat(e,t){const i=t.translateEmpty("_thousandSeparator"),n=t.translateEmpty("_decimalSeparator");let r={positive:{thousands:{active:-1,passive:-1,interval:-1,separator:i},decimals:{active:-1,passive:-1,separator:n},template:"",source:"",parsed:!1},negative:{thousands:{active:-1,passive:-1,interval:-1,separator:i},decimals:{active:-1,passive:-1,separator:n},template:"",source:"",parsed:!1},zero:{thousands:{active:-1,passive:-1,interval:-1,separator:i},decimals:{active:-1,passive:-1,separator:n},template:"",source:"",parsed:!1}},a=(e=e.replace("||",Tl)).split("|");return r.positive.source=a[0],typeof a[2]>"u"?r.zero=r.positive:r.zero.source=a[2],typeof a[1]>"u"?r.negative=r.positive:r.negative.source=a[1],en(r,(o,l)=>{if(l.parsed)return;let c=l.source;"number"===c.toLowerCase()&&(c=this.get("numberFormat","#,###.#####"));let h=Ya.chunk(c,!0);for(let u=0;u<h.length;u++){let m=h[u];if(m.text=m.text.replace(Tl,"|"),"value"===m.type){let p=m.text.match(/[#0.,]+[ ]?[abespABESP%!]?[abespABESP\u2030!]?/);if(p)if(null===p||""===p[0])l.template+=m.text;else{let _=p[0].match(/[abespABESP%\u2030!]{2}|[abespABESP%\u2030]{1}$/);_&&(l.mod=_[0].toLowerCase(),l.modSpacing=!!p[0].match(/[ ]{1}[abespABESP%\u2030!]{1}$/));let g=p[0].split(".");if(""!==g[0]){l.thousands.active=(g[0].match(/0/g)||[]).length,l.thousands.passive=(g[0].match(/\#/g)||[]).length+l.thousands.active;let f=g[0].split(",");1===f.length||(l.thousands.interval=(f.pop()||"").length,0===l.thousands.interval&&(l.thousands.interval=-1))}typeof g[1]>"u"||(l.decimals.active=(g[1].match(/0/g)||[]).length,l.decimals.passive=(g[1].match(/\#/g)||[]).length+l.decimals.active),l.template+=m.text.split(p[0]).join(co)}}else l.template+=m.text}l.parsed=!0}),r}applyFormat(e,t){let i=e<0;e=Math.abs(e);let n="",r="",a=t.mod?t.mod.split(""):[];if(-1!==a.indexOf("b")){let u=this.applyPrefix(e,this.get("bytePrefixes"),-1!==a.indexOf("!"));e=u[0],n=u[1],r=u[2],t.modSpacing&&(r=" "+r)}else if(-1!==a.indexOf("a")){let u=this.applyPrefix(e,e<this.get("smallNumberThreshold")?this.get("smallNumberPrefixes"):this.get("bigNumberPrefixes"),-1!==a.indexOf("!"));e=u[0],n=u[1],r=u[2],t.modSpacing&&(r=" "+r)}else if(-1!==a.indexOf("p")){let u=Math.min(e.toString().length+2,21);e=parseFloat(e.toPrecision(u)),n=this._root.language.translate("_percentPrefix"),r=this._root.language.translate("_percentSuffix"),""==n&&""==r&&(r="%")}else if(-1!==a.indexOf("%")){let u=Math.min(e.toString().length+2,21);e*=100,e=parseFloat(e.toPrecision(u)),r="%"}else if(-1!==a.indexOf("\u2030")){let u=Math.min(e.toString().length+3,21);e*=1e3,e=parseFloat(e.toPrecision(u)),r="\u2030"}if(-1!==a.indexOf("e")){let u;u=t.decimals.passive>=0?e.toExponential(t.decimals.passive).split("e"):e.toExponential().split("e"),e=Number(u[0]),r="e"+u[1],t.modSpacing&&(r=" "+r)}else if(0===t.decimals.passive)e=Math.round(e);else if(t.decimals.passive>0){let u=Math.pow(10,t.decimals.passive);e=Math.round(e*u)/u}let o="",l=function W_(s){if(Kt(s))return"NaN";if(s===1/0)return"Infinity";if(s===-1/0)return"-Infinity";if(0===s&&1/s==-1/0)return"-0";let e=s<0;s=Math.abs(s);let r,t=/^([0-9]+)(?:\.([0-9]+))?(?:e[\+\-]([0-9]+))?$/.exec(""+s),i=t[1],n=t[2]||"";if(void 0===t[3])r=""===n?i:i+"."+n;else{let a=+t[3];if(s<1)r="0."+pp("0",a-1)+i+n;else{let o=a-n.length;r=0===o?i+n:o<0?i+n.slice(0,o)+"."+n.slice(o):i+n+pp("0",o)}}return e?"-"+r:r}(e).split("."),c=l[0];if(c.length<t.thousands.active&&(c=Array(t.thousands.active-c.length+1).join("0")+c),t.thousands.interval>0){let u=[],m=c.split("").reverse().join("");for(let p=0,_=c.length;p<=_;p+=t.thousands.interval){let g=m.substr(p,t.thousands.interval).split("").reverse().join("");""!==g&&u.unshift(g)}c=u.join(t.thousands.separator)}o+=c,1===l.length&&l.push("");let h=l[1];return h.length<t.decimals.active&&(h+=Array(t.decimals.active-h.length+1).join("0")),""!==h&&(o+=t.decimals.separator+h),""===o&&(o="0"),0!==e&&i&&-1===a.indexOf("s")&&(o="-"+o),n&&(o=n+o),r&&(o+=r),o}applyPrefix(e,t,i=!1){let n=e,r="",a="",o=!1,l=1;for(let c=0,h=t.length;c<h;c++)t[c].number<=e&&(0===t[c].number?n=0:(n=e/t[c].number,l=t[c].number),r=t[c].prefix,a=t[c].suffix,o=!0);return!o&&i&&t.length&&0!=e&&(n=e/t[0].number,r=t[0].prefix,a=t[0].suffix,o=!0),o&&(n=parseFloat(n.toPrecision(Math.min(l.toString().length+Math.floor(n).toString().replace(/[^0-9]*/g,"").length,21)))),[n,r,a]}escape(e){return e.replace("||",Tl)}unescape(e){return e.replace(Tl,"|")}}function Vy(s,e){let t=0,i=0,n=1,r=0,a=0,o=0,l=0,c=0;return s.formatToParts(e).forEach(h=>{switch(h.type){case"year":t=+h.value;break;case"month":i=+h.value-1;break;case"day":n=+h.value;break;case"hour":r=+h.value;break;case"minute":a=+h.value;break;case"second":o=+h.value;break;case"fractionalSecond":l=+h.value;break;case"weekday":switch(h.value){case"Sun":c=0;break;case"Mon":c=1;break;case"Tue":c=2;break;case"Wed":c=3;break;case"Thu":c=4;break;case"Fri":c=5;break;case"Sat":c=6}}}),24===r&&(r=0),{year:t,month:i,day:n,hour:r,minute:a,second:o,millisecond:l,weekday:c}}function Wy(s,e){const{year:t,month:i,day:n,hour:r,minute:a,second:o,millisecond:l}=Vy(s,e);return Date.UTC(t,i,n,r,a,o,l)}class QC{constructor(e,t){if(Object.defineProperty(this,"_utc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dtf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!t)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");this.name=e,this._utc=new Intl.DateTimeFormat("UTC",{hour12:!1,timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",weekday:"short",fractionalSecondDigits:3}),this._dtf=new Intl.DateTimeFormat("UTC",{hour12:!1,timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",weekday:"short",fractionalSecondDigits:3})}static new(e){return new this(e,!0)}convertLocal(e){const t=this.offsetUTC(e),i=e.getTimezoneOffset(),n=new Date(e);n.setUTCMinutes(n.getUTCMinutes()-(t-i));const r=n.getTimezoneOffset();return i!=r&&n.setUTCMinutes(n.getUTCMinutes()+r-i),n}offsetUTC(e){return(Wy(this._utc,e)-Wy(this._dtf,e))/6e4}parseDate(e){return Vy(this._dtf,e)}}class eD extends zs{_setDefaults(){this._setDefault("capitalize",!0),this._setDefault("dateFormat","yyyy-MM-dd"),super._setDefaults()}_beforeChanged(){super._beforeChanged()}format(e,t){(typeof t>"u"||""===t)&&(t=this.get("dateFormat","yyyy-MM-dd"));let i,n=e;if(Td(t))try{const o=this.get("intlLocales");return o?new Intl.DateTimeFormat(o,t).format(n):new Intl.DateTimeFormat(void 0,t).format(n)}catch{return"Invalid"}let r=this.parseFormat(t);const a=this._root.timezone;return a&&!this._root.utc&&(n=a.convertLocal(n)),Se(n.getTime())?(i=this.applyFormat(n,r),this.get("capitalize")&&(i=i.replace(/^.{1}/,i.substr(0,1).toUpperCase())),i):"Invalid date"}applyFormat(e,t){let n,r,a,o,l,c,h,u,i=t.template,m=e.getTime();this._root.utc?(n=e.getUTCFullYear(),r=e.getUTCMonth(),a=e.getUTCDay(),o=e.getUTCDate(),l=e.getUTCHours(),c=e.getUTCMinutes(),h=e.getUTCSeconds(),u=e.getUTCMilliseconds()):(n=e.getFullYear(),r=e.getMonth(),a=e.getDay(),o=e.getDate(),l=e.getHours(),c=e.getMinutes(),h=e.getSeconds(),u=e.getMilliseconds());for(let p=0,_=t.parts.length;p<_;p++){let g="";switch(t.parts[p]){case"G":g=this._t(n<0?"_era_bc":"_era_ad");break;case"yyyy":g=Math.abs(n).toString(),n<0&&(g+=this._t("_era_bc"));break;case"yyy":case"yy":case"y":g=Math.abs(n).toString().substr(-t.parts[p].length),n<0&&(g+=this._t("_era_bc"));break;case"YYYY":case"YYY":case"YY":case"Y":let f=Q_(e,this._root.utc);g="YYYY"==t.parts[p]?Math.abs(f).toString():Math.abs(f).toString().substr(-t.parts[p].length),f<0&&(g+=this._t("_era_bc"));break;case"u":case"F":case"g":break;case"q":g=""+Math.ceil((e.getMonth()+1)/3);break;case"MMMMM":g=this._t(this._getMonth(r)).substr(0,1);break;case"MMMM":g=this._t(this._getMonth(r));break;case"MMM":g=this._t(this._getShortMonth(r));break;case"MM":g=$n(r+1,2,"0");break;case"M":g=(r+1).toString();break;case"ww":g=$n(Ad(e,this._root.utc),2,"0");break;case"w":g=Ad(e,this._root.utc).toString();break;case"W":g=oa(e,this._root.utc).toString();break;case"dd":g=$n(o,2,"0");break;case"d":g=o.toString();break;case"DD":case"DDD":g=$n(kd(e,this._root.utc).toString(),t.parts[p].length,"0");break;case"D":g=kd(e,this._root.utc).toString();break;case"t":g=this._root.language.translateFunc("_dateOrd").call(this,o);break;case"E":g=(a||7).toString();break;case"EE":g=$n((a||7).toString(),2,"0");break;case"EEE":case"eee":g=this._t(this._getShortWeekday(a));break;case"EEEE":case"eeee":g=this._t(this._getWeekday(a));break;case"EEEEE":case"eeeee":g=this._t(this._getShortWeekday(a)).substr(0,1);break;case"e":case"ee":g=(a-(this._root.locale.firstDayOfWeek||1)+1).toString(),"ee"==t.parts[p]&&(g=$n(g,2,"0"));break;case"a":g=this._t(l>=12?"PM":"AM");break;case"aa":g=this._t(l>=12?"P.M.":"A.M.");break;case"aaa":g=this._t(l>=12?"P":"A");break;case"h":g=bc(l).toString();break;case"hh":g=$n(bc(l),2,"0");break;case"H":g=l.toString();break;case"HH":g=$n(l,2,"0");break;case"K":g=bc(l,0).toString();break;case"KK":g=$n(bc(l,0),2,"0");break;case"k":g=(l+1).toString();break;case"kk":g=$n(l+1,2,"0");break;case"m":g=c.toString();break;case"mm":g=$n(c,2,"0");break;case"s":g=h.toString();break;case"ss":g=$n(h,2,"0");break;case"S":case"SS":case"SSS":g=Math.round(u/1e3*Math.pow(10,t.parts[p].length)).toString();break;case"x":g=m.toString();break;case"n":case"nn":case"nnn":g=$n(u,t.parts[p].length,"0");break;case"z":g=Od(e,!1,!1,this._root.utc,this._root.timezone?this._root.timezone.name:void 0).replace(/[+-]+[0-9]+$/,"");break;case"zz":g=Od(e,!0,!1,this._root.utc,this._root.timezone?this._root.timezone.name:void 0);break;case"zzz":g=Od(e,!1,!0,this._root.utc,this._root.timezone?this._root.timezone.name:void 0).replace(/[+-]+[0-9]+$/,"");break;case"zzzz":g=Od(e,!0,!0,this._root.utc,this._root.timezone?this._root.timezone.name:void 0);break;case"Z":case"ZZ":let b=this._root.utc?"UTC":this._root.timezone;b instanceof QC&&(b=b.name);const C=b?eb(b):e.getTimezoneOffset();let M=Math.abs(C)/60,E=Math.floor(M),S=60*M-60*E;this._root.utc&&(E=0,S=0),"Z"==t.parts[p]?(g="GMT",g+=C>0?"-":"+",g+=$n(E,2)+":"+$n(S,2)):(g=C>0?"-":"+",g+=$n(E,2)+$n(S,2));break;case"i":g=e.toISOString();break;case"I":g=e.toUTCString()}i=i.replace(co,g)}return i}parseFormat(e){let t={template:"",parts:[]},i=Ya.chunk(e,!0);for(let n=0;n<i.length;n++){let r=i[n];if("value"===r.type){if(r.text.match(/^date$/i)){let o=this.get("dateFormat","yyyy-MM-dd");Ml(o)||(o="yyyy-MM-dd"),r.text=o}let a=r.text.match(/G|yyyy|yyy|yy|y|YYYY|YYY|YY|Y|u|q|MMMMM|MMMM|MMM|MM|M|ww|w|W|dd|d|DDD|DD|D|F|g|EEEEE|EEEE|EEE|EE|E|eeeee|eeee|eee|ee|e|aaa|aa|a|hh|h|HH|H|KK|K|kk|k|mm|m|ss|s|SSS|SS|S|A|zzzz|zzz|zz|z|ZZ|Z|t|x|nnn|nn|n|i|I/g);if(a)for(let o=0;o<a.length;o++)t.parts.push(a[o]),r.text=r.text.replace(a[o],co)}t.template+=r.text}return t}_months(){return["January","February","March","April","May","June","July","August","September","October","November","December"]}_getMonth(e){return this._months()[e]}_shortMonths(){return["Jan","Feb","Mar","Apr","May(short)","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}_getShortMonth(e){return this._shortMonths()[e]}_weekdays(){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}_getWeekday(e){return this._weekdays()[e]}_shortWeekdays(){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]}_getShortWeekday(e){return this._shortWeekdays()[e]}parse(e,t){if(e instanceof Date)return e;if(Se(e))return new Date(e);if("x"==t)return new Date(parseInt(e));Ml(e)||(e=e.toString());let i,n="";t=(t=kl(t)).substr(0,e.length);let r=this.parseFormat(t),a={year:-1,year3:-1,year2:-1,year1:-1,month:-1,monthShort:-1,monthLong:-1,weekdayShort:-1,weekdayLong:-1,day:-1,yearDay:-1,week:-1,hourBase0:-1,hour12Base0:-1,hourBase1:-1,hour12Base1:-1,minute:-1,second:-1,millisecond:-1,millisecondDigits:-1,am:-1,zone:-1,timestamp:-1,iso:-1},o={year:1970,month:0,day:1,hour:0,minute:0,second:0,millisecond:0,timestamp:null,offset:0,utc:this._root.utc},l=0,c=0;for(let m=0;m<r.parts.length;m++){switch(c=m+l+1,r.parts[m]){case"yyyy":case"YYYY":n+="([0-9]{4})",a.year=c;break;case"yyy":case"YYY":n+="([0-9]{3})",a.year3=c;break;case"yy":case"YY":n+="([0-9]{2})",a.year2=c;break;case"y":case"Y":n+="([0-9]{1})",a.year1=c;break;case"MMMM":n+="("+this.getStringList(this._months()).join("|")+")",a.monthLong=c;break;case"MMM":n+="("+this.getStringList(this._shortMonths()).join("|")+")",a.monthShort=c;break;case"MM":case"M":n+="([0-9]{2}|[0-9]{1})",a.month=c;break;case"ww":case"w":n+="([0-9]{2}|[0-9]{1})",a.week=c;break;case"dd":case"d":n+="([0-9]{2}|[0-9]{1})",a.day=c;break;case"DDD":case"DD":case"D":n+="([0-9]{3}|[0-9]{2}|[0-9]{1})",a.yearDay=c;break;case"dddd":n+="("+this.getStringList(this._weekdays()).join("|")+")",a.weekdayLong=c;break;case"ddd":n+="("+this.getStringList(this._shortWeekdays()).join("|")+")",a.weekdayShort=c;break;case"aaa":case"aa":case"a":n+="("+this.getStringList(["AM","PM","A.M.","P.M.","A","P"]).join("|")+")",a.am=c;break;case"hh":case"h":n+="([0-9]{2}|[0-9]{1})",a.hour12Base1=c;break;case"HH":case"H":n+="([0-9]{2}|[0-9]{1})",a.hourBase0=c;break;case"KK":case"K":n+="([0-9]{2}|[0-9]{1})",a.hour12Base0=c;break;case"kk":case"k":n+="([0-9]{2}|[0-9]{1})",a.hourBase1=c;break;case"mm":case"m":n+="([0-9]{2}|[0-9]{1})",a.minute=c;break;case"ss":case"s":n+="([0-9]{2}|[0-9]{1})",a.second=c;break;case"SSS":case"SS":case"S":n+="([0-9]{3}|[0-9]{2}|[0-9]{1})",a.millisecond=c,a.millisecondDigits=r.parts[m].length;break;case"nnn":case"nn":case"n":n+="([0-9]{3}|[0-9]{2}|[0-9]{1})",a.millisecond=c;break;case"x":n+="([0-9]{1,})",a.timestamp=c;break;case"Z":n+="GMT([-+]+[0-9]{2}:[0-9]{2})",a.zone=c;break;case"ZZ":n+="([\\-+]+[0-9]{2}[0-9]{2})",a.zone=c;break;case"i":n+="([0-9]{4})-?([0-9]{2})-?([0-9]{2})T?([0-9]{2}):?([0-9]{2}):?([0-9]{2})\\.?([0-9]{0,3})([zZ]|[+\\-][0-9]{2}:?[0-9]{2}|$)",a.iso=c,l+=7;break;case"G":case"YYYY":case"YYY":case"YY":case"Y":case"MMMMM":case"W":case"EEEEE":case"EEEE":case"EEE":case"EE":case"E":case"eeeee":case"eeee":case"eee":case"ee":case"e":case"zzzz":case"zzz":case"zz":case"z":case"t":l--}n+="[^0-9]*"}let h=new RegExp(n),u=e.match(h);if(u){if(a.year>-1&&(o.year=parseInt(u[a.year])),a.year3>-1){let m=parseInt(u[a.year3]);m+=1e3,o.year=m}if(a.year2>-1){let m=parseInt(u[a.year2]);m+=m>50?1e3:2e3,o.year=m}if(a.year1>-1){let m=parseInt(u[a.year1]);m=10*Math.floor((new Date).getFullYear()/10)+m,o.year=m}if(a.monthLong>-1&&(o.month=this.resolveMonth(u[a.monthLong])),a.monthShort>-1&&(o.month=this.resolveShortMonth(u[a.monthShort])),a.month>-1&&(o.month=parseInt(u[a.month])-1),a.week>-1&&-1===a.day&&(o.month=0,o.day=function Pd(s,e,t=1,i=!1){let n=new Date(e,0,4,0,0,0,0);return i&&n.setUTCFullYear(e),7*s+t-((n.getDay()||7)+3)}(parseInt(u[a.week]),o.year,1,this._root.utc)),a.day>-1&&(o.day=parseInt(u[a.day])),a.yearDay>-1&&(o.month=0,o.day=parseInt(u[a.yearDay])),a.hourBase0>-1&&(o.hour=parseInt(u[a.hourBase0])),a.hourBase1>-1&&(o.hour=parseInt(u[a.hourBase1])-1),a.hour12Base0>-1){let m=parseInt(u[a.hour12Base0]);11==m&&(m=0),a.am>-1&&!this.isAm(u[a.am])&&(m+=12),o.hour=m}if(a.hour12Base1>-1){let m=parseInt(u[a.hour12Base1]);12==m&&(m=0),a.am>-1&&!this.isAm(u[a.am])&&(m+=12),o.hour=m}if(a.minute>-1&&(o.minute=parseInt(u[a.minute])),a.second>-1&&(o.second=parseInt(u[a.second])),a.millisecond>-1){let m=parseInt(u[a.millisecond]);2==a.millisecondDigits?m*=10:1==a.millisecondDigits&&(m*=100),o.millisecond=m}if(a.timestamp>-1){o.timestamp=parseInt(u[a.timestamp]);const m=new Date(o.timestamp);o.year=m.getUTCFullYear(),o.month=m.getUTCMonth(),o.day=m.getUTCDate(),o.hour=m.getUTCHours(),o.minute=m.getUTCMinutes(),o.second=m.getUTCSeconds(),o.millisecond=m.getUTCMilliseconds()}a.zone>-1&&(o.offset=this.resolveTimezoneOffset(new Date(o.year,o.month,o.day),u[a.zone])),a.iso>-1&&(o.year=_s(u[a.iso+0]),o.month=_s(u[a.iso+1])-1,o.day=_s(u[a.iso+2]),o.hour=_s(u[a.iso+3]),o.minute=_s(u[a.iso+4]),o.second=_s(u[a.iso+5]),o.millisecond=_s(u[a.iso+6]),"Z"==u[a.iso+7]||"z"==u[a.iso+7]?o.utc=!0:""!=u[a.iso+7]&&(o.offset=this.resolveTimezoneOffset(new Date(o.year,o.month,o.day),u[a.iso+7]))),i=o.utc?new Date(Date.UTC(o.year,o.month,o.day,o.hour,o.minute,o.second,o.millisecond)):new Date(o.year,o.month,o.day,o.hour,o.minute+o.offset,o.second,o.millisecond)}else i=new Date(e);return i}resolveTimezoneOffset(e,t){if(t.match(/([+\-]?)([0-9]{2}):?([0-9]{2})/)){let n=t.match(/([+\-]?)([0-9]{2}):?([0-9]{2})/),r=n[1],o=n[3],l=60*parseInt(n[2])+parseInt(o);return"+"==r&&(l*=-1),l-(e||new Date).getTimezoneOffset()}return 0}resolveMonth(e){let t=this._months().indexOf(e);return t>-1||!this._root.language.isDefault()&&(t=this._root.language.translateAll(this._months()).indexOf(e),t>-1)?t:0}resolveShortMonth(e){let t=this._shortMonths().indexOf(e);return t>-1||(t=this._months().indexOf(e),t>-1)||this._root.language&&!this._root.language.isDefault()&&(t=this._root.language.translateAll(this._shortMonths()).indexOf(e),t>-1)?t:0}isAm(e){return this.getStringList(["AM","A.M.","A"]).indexOf(e.toUpperCase())>-1}getStringList(e){let t=[];for(let i=0;i<e.length;i++)t.push((this._root.language?this._t(e[i]):e[i]).replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"));return t}}class tD extends zs{constructor(){super(...arguments),Object.defineProperty(this,"_unitAliases",{enumerable:!0,configurable:!0,writable:!0,value:{Y:"y",D:"d",H:"h",K:"h",k:"h",n:"S"}})}_setDefaults(){const e="_duration_millisecond",t="_duration_second",i="_duration_minute",n="_duration_hour",r="_duration_day",a="_duration_week",o="_duration_month",h="_minute",u="_hour",m="_day",p="_week",_="_week",g="_year";this._setDefault("negativeBase",0),this._setDefault("baseUnit","second"),this._setDefault("durationFormats",{millisecond:{millisecond:this._t(e),second:this._t(e+"_second"),minute:this._t(e+h),hour:this._t(e+u),day:this._t(e+m),week:this._t(e+p),month:this._t(e+_),year:this._t(e+g)},second:{second:this._t(t),minute:this._t(t+h),hour:this._t(t+u),day:this._t(t+m),week:this._t(t+p),month:this._t(t+_),year:this._t(t+g)},minute:{minute:this._t(i),hour:this._t(i+u),day:this._t(i+m),week:this._t(i+p),month:this._t(i+_),year:this._t(i+g)},hour:{hour:this._t(n),day:this._t(n+m),week:this._t(n+p),month:this._t(n+_),year:this._t(n+g)},day:{day:this._t(r),week:this._t(r+p),month:this._t(r+_),year:this._t(r+g)},week:{week:this._t(a),month:this._t(a+_),year:this._t(a+g)},month:{month:this._t(o),year:this._t(o+g)},year:{year:this._t("_duration_year")}}),super._setDefaults()}_beforeChanged(){super._beforeChanged()}format(e,t,i){let n=i||this.get("baseUnit");(typeof t>"u"||""===t)&&(t=null!=this.get("durationFormat")?this.get("durationFormat"):this.getFormat(_s(e),void 0,n)),t=kl(t);let o,r=this.parseFormat(t,n),a=Number(e);o=a>this.get("negativeBase")?r.positive:a<this.get("negativeBase")?r.negative:r.zero;let l=this.applyFormat(a,o);return""!==o.color&&(l="["+o.color+"]"+l+"[/]"),l}parseFormat(e,t){let i=t||this.get("baseUnit"),n={positive:{color:"",template:"",parts:[],source:"",baseUnit:i,parsed:!1,absolute:!1},negative:{color:"",template:"",parts:[],source:"",baseUnit:i,parsed:!1,absolute:!1},zero:{color:"",template:"",parts:[],source:"",baseUnit:i,parsed:!1,absolute:!1}},r=(e=e.replace("||",Tl)).split("|");return n.positive.source=r[0],typeof r[2]>"u"?n.zero=n.positive:n.zero.source=r[2],typeof r[1]>"u"?n.negative=n.positive:n.negative.source=r[1],en(n,(a,o)=>{if(o.parsed)return;let l=o.source,c=[];c=o.source.match(/^\[([^\]]*)\]/),c&&c.length&&""!==c[0]&&(l=o.source.substr(c[0].length),o.color=c[1]);let h=Ya.chunk(l,!0);for(let u=0;u<h.length;u++){let m=h[u];if(m.text=m.text.replace(Tl,"|"),"value"===m.type){m.text.match(/[yYMdDwhHKkmsSn]+a/)&&(o.absolute=!0,m.text=m.text.replace(/([yYMdDwhHKkmsSn]+)a/,"$1"));let p=m.text.match(/y+|Y+|M+|d+|D+|w+|h+|H+|K+|k+|m+|s+|S+|n+/g);if(p)for(let _=0;_<p.length;_++)null==p[_]&&(p[_]=this._unitAliases[p[_]]),o.parts.push(p[_]),m.text=m.text.replace(p[_],co)}o.template+=m.text}o.parsed=!0}),n}applyFormat(e,t){let i=!t.absolute&&e<this.get("negativeBase");e=Math.abs(e);let n=this.toTimeStamp(e,t.baseUnit),r=t.template;for(let a=0,o=t.parts.length;a<o;a++){let l=t.parts[a],c=this._toTimeUnit(l.substr(0,1)),h=l.length,u=Math.floor(n/this._getUnitValue(c));r=r.replace(co,$n(u,h,"0")),n-=u*this._getUnitValue(c)}return i&&(r="-"+r),r}toTimeStamp(e,t){return e*this._getUnitValue(t)}_toTimeUnit(e){switch(e){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year"}}getFormat(e,t,i){if(null!=this.get("durationFormat"))return this.get("durationFormat");if(i||(i=this.get("baseUnit")),null!=t&&e!=t){e=Math.abs(e),t=Math.abs(t);let n=this.getValueUnit(Math.max(e,t),i);return this.get("durationFormats")[i][n]}{let n=this.getValueUnit(e,i);return this.get("durationFormats")[i][n]}}getValueUnit(e,t){t||(t=this.get("baseUnit"));let i,n=this.getMilliseconds(e,t);return function sb(s,e){for(let t in s)if(rb(s,t)&&!e(t,s[t]))break}(this._getUnitValues(),(r,a)=>{if(r==t||i){if(n/a<=1)return i||(i=r),!1;i=r}return!0}),i}getMilliseconds(e,t){return t||(t=this.get("baseUnit")),e*this._getUnitValue(t)}_getUnitValue(e){return this._getUnitValues()[e]}_getUnitValues(){return{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:2592e6,year:31536e6}}}const Gy={firstDayOfWeek:1,_decimalSeparator:".",_thousandSeparator:",",_percentPrefix:null,_percentSuffix:"%",_big_number_suffix_3:"k",_big_number_suffix_6:"M",_big_number_suffix_9:"G",_big_number_suffix_12:"T",_big_number_suffix_15:"P",_big_number_suffix_18:"E",_big_number_suffix_21:"Z",_big_number_suffix_24:"Y",_small_number_suffix_3:"m",_small_number_suffix_6:"\u03bc",_small_number_suffix_9:"n",_small_number_suffix_12:"p",_small_number_suffix_15:"f",_small_number_suffix_18:"a",_small_number_suffix_21:"z",_small_number_suffix_24:"y",_byte_suffix_B:"B",_byte_suffix_KB:"KB",_byte_suffix_MB:"MB",_byte_suffix_GB:"GB",_byte_suffix_TB:"TB",_byte_suffix_PB:"PB",_date:"yyyy-MM-dd",_date_millisecond:"mm:ss SSS",_date_millisecond_full:"HH:mm:ss SSS",_date_second:"HH:mm:ss",_date_second_full:"HH:mm:ss",_date_minute:"HH:mm",_date_minute_full:"HH:mm - MMM dd, yyyy",_date_hour:"HH:mm",_date_hour_full:"HH:mm - MMM dd, yyyy",_date_day:"MMM dd",_date_day_full:"MMM dd, yyyy",_date_week:"ww",_date_week_full:"MMM dd, yyyy",_date_month:"MMM",_date_month_full:"MMM, yyyy",_date_year:"yyyy",_duration_millisecond:"SSS",_duration_millisecond_second:"ss.SSS",_duration_millisecond_minute:"mm:ss SSS",_duration_millisecond_hour:"hh:mm:ss SSS",_duration_millisecond_day:"d'd' mm:ss SSS",_duration_millisecond_week:"d'd' mm:ss SSS",_duration_millisecond_month:"M'm' dd'd' mm:ss SSS",_duration_millisecond_year:"y'y' MM'm' dd'd' mm:ss SSS",_duration_second:"ss",_duration_second_minute:"mm:ss",_duration_second_hour:"hh:mm:ss",_duration_second_day:"d'd' hh:mm:ss",_duration_second_week:"d'd' hh:mm:ss",_duration_second_month:"M'm' dd'd' hh:mm:ss",_duration_second_year:"y'y' MM'm' dd'd' hh:mm:ss",_duration_minute:"mm",_duration_minute_hour:"hh:mm",_duration_minute_day:"d'd' hh:mm",_duration_minute_week:"d'd' hh:mm",_duration_minute_month:"M'm' dd'd' hh:mm",_duration_minute_year:"y'y' MM'm' dd'd' hh:mm",_duration_hour:"hh'h'",_duration_hour_day:"d'd' hh'h'",_duration_hour_week:"d'd' hh'h'",_duration_hour_month:"M'm' dd'd' hh'h'",_duration_hour_year:"y'y' MM'm' dd'd' hh'h'",_duration_day:"d'd'",_duration_day_week:"d'd'",_duration_day_month:"M'm' dd'd'",_duration_day_year:"y'y' MM'm' dd'd'",_duration_week:"w'w'",_duration_week_month:"w'w'",_duration_week_year:"w'w'",_duration_month:"M'm'",_duration_month_year:"y'y' MM'm'",_duration_year:"y'y'",_era_ad:"AD",_era_bc:"BC",A:"",P:"",AM:"",PM:"","A.M.":"","P.M.":"",January:"",February:"",March:"",April:"",May:"",June:"",July:"",August:"",September:"",October:"",November:"",December:"",Jan:"",Feb:"",Mar:"",Apr:"","May(short)":"May",Jun:"",Jul:"",Aug:"",Sep:"",Oct:"",Nov:"",Dec:"",Sunday:"",Monday:"",Tuesday:"",Wednesday:"",Thursday:"",Friday:"",Saturday:"",Sun:"",Mon:"",Tue:"",Wed:"",Thu:"",Fri:"",Sat:"",_dateOrd:function(s){let e="th";if(s<11||s>13)switch(s%10){case 1:e="st";break;case 2:e="nd";break;case 3:e="rd"}return e},"Zoom Out":"",Play:"",Stop:"",Legend:"","Press ENTER to toggle":"",Loading:"",Home:"",Chart:"","Serial chart":"","X/Y chart":"","Pie chart":"","Gauge chart":"","Radar chart":"","Sankey diagram":"","Flow diagram":"","Chord diagram":"","TreeMap chart":"","Force directed tree":"","Sliced chart":"",Series:"","Candlestick Series":"","OHLC Series":"","Column Series":"","Line Series":"","Pie Slice Series":"","Funnel Series":"","Pyramid Series":"","X/Y Series":"",Map:"","Press ENTER to zoom in":"","Press ENTER to zoom out":"","Use arrow keys to zoom in and out":"","Use plus and minus keys on your keyboard to zoom in and out":"",Export:"",Image:"",Data:"",Print:"","Press ENTER or use arrow keys to navigate":"","Press ENTER to open":"","Press ENTER to print.":"","Press ENTER to export as %1.":"","(Press ESC to close this message)":"","Image Export Complete":"","Export operation took longer than expected. Something might have gone wrong.":"","Saved from":"",PNG:"",JPG:"",GIF:"",SVG:"",PDF:"",JSON:"",CSV:"",XLSX:"",HTML:"","Use TAB to select grip buttons or left and right arrows to change selection":"","Use left and right arrows to move selection":"","Use left and right arrows to move left selection":"","Use left and right arrows to move right selection":"","Use TAB select grip buttons or up and down arrows to change selection":"","Use up and down arrows to move selection":"","Use up and down arrows to move lower selection":"","Use up and down arrows to move upper selection":"","From %1 to %2":"","From %1":"","To %1":"","No parser available for file: %1":"","Error parsing file: %1":"","Unable to load file: %1":"","Invalid date":"",Close:"",Minimize:""};class iD extends zs{_setDefaults(){this.setPrivate("defaultLocale",Gy),super._setDefaults()}translate(e,t,...i){t||(t=this._root.locale||this.getPrivate("defaultLocale"));let n=e,r=t[e];if(null===r)n="";else if(null!=r)r&&(n=r);else if(t!==this.getPrivate("defaultLocale"))return this.translate(e,this.getPrivate("defaultLocale"),...i);if(i.length)for(let a=i.length,o=0;o<a;++o)n=n.split("%"+(o+1)).join(i[o]);return n}translateAny(e,t,...i){return this.translate(e,t,...i)}setTranslationAny(e,t,i){(i||this._root.locale)[e]=t}setTranslationsAny(e,t){en(e,(i,n)=>{this.setTranslationAny(i,n,t)})}translateEmpty(e,t,...i){let n=this.translate(e,t,...i);return n==e?"":n}translateFunc(e,t){return this._root.locale[e]?this._root.locale[e]:t!==this.getPrivate("defaultLocale")?this.translateFunc(e,this.getPrivate("defaultLocale")):()=>""}translateAll(e,t){return this.isDefault()?e:mu(e,i=>this.translate(i,t))}isDefault(){return this.getPrivate("defaultLocale")===this._root.locale}}class Pu{constructor(e,t){if(Object.defineProperty(this,"_root",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rules",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._root=e,!t)throw new Error("You cannot use `new Class()`, instead use `Class.new()`")}static new(e){const t=new this(e,!0);return t.setupDefaultRules(),t}setupDefaultRules(){}_lookupRules(e){return this._rules[e]}ruleRaw(e,t=[]){let i=this._rules[e];i||(i=this._rules[e]=[]),t.sort(uo);const{index:n,found:r}=fu(i,a=>{const o=uo(a.tags.length,t.length);return 0===o?Ny(a.tags,t,uo):o});if(r)return i[n].template;{const a=An.new({});return i.splice(n,0,{tags:t,template:a}),a}}rule(e,t=[]){return this.ruleRaw(e,t)}}function ti(s,e,t,i){s.set(e,t.get(i)),t.on(i,n=>{s.set(e,n)})}class nD extends Pu{setupDefaultRules(){super.setupDefaultRules();const e=this._root.language,t=this._root.interfaceColors,i=this._root.horizontalLayout,n=this._root.verticalLayout,r=this.rule.bind(this);r("InterfaceColors").setAll({stroke:ei.fromHex(15066597),fill:ei.fromHex(15987699),primaryButton:ei.fromHex(6788316),primaryButtonHover:ei.fromHex(6779356),primaryButtonDown:ei.fromHex(6872182),primaryButtonActive:ei.fromHex(6872182),primaryButtonText:ei.fromHex(16777215),primaryButtonStroke:ei.fromHex(16777215),secondaryButton:ei.fromHex(14277081),secondaryButtonHover:ei.fromHex(10724259),secondaryButtonDown:ei.fromHex(9276813),secondaryButtonActive:ei.fromHex(15132390),secondaryButtonText:ei.fromHex(0),secondaryButtonStroke:ei.fromHex(16777215),grid:ei.fromHex(0),background:ei.fromHex(16777215),alternativeBackground:ei.fromHex(0),text:ei.fromHex(0),alternativeText:ei.fromHex(16777215),disabled:ei.fromHex(11382189),positive:ei.fromHex(5288704),negative:ei.fromHex(11730944)});{const a=r("ColorSet");a.setAll({passOptions:{hue:.05,saturation:0,lightness:0},colors:[ei.fromHex(6797276)],step:1,reuse:!1,startIndex:0}),a.setPrivate("currentStep",0),a.setPrivate("currentPass",0)}r("Entity").setAll({stateAnimationDuration:0,stateAnimationEasing:Me(y)}),r("Component").setAll({interpolationDuration:0,interpolationEasing:Me(y)}),r("Sprite").setAll({visible:!0,scale:1,opacity:1,rotation:0,position:"relative",tooltipX:wi,tooltipY:wi,tooltipPosition:"fixed",isMeasured:!0}),r("Sprite").states.create("default",{visible:!0,opacity:1}),r("Container").setAll({interactiveChildren:!0,setStateOnChildren:!1}),r("Graphics").setAll({strokeWidth:1}),r("Chart").setAll({width:vt,height:vt,interactiveChildren:!1}),r("Sprite",["horizontal","center"]).setAll({centerX:wi,x:wi}),r("Sprite",["vertical","center"]).setAll({centerY:wi,y:wi}),r("Container",["horizontal","layout"]).setAll({layout:i}),r("Container",["vertical","layout"]).setAll({layout:n}),r("Pattern").setAll({repetition:"repeat",width:50,height:50,rotation:0,fillOpacity:1}),r("LinePattern").setAll({gap:6,colorOpacity:1,width:49,height:49}),r("RectanglePattern").setAll({gap:6,checkered:!1,centered:!0,maxWidth:5,maxHeight:5,width:48,height:48,strokeWidth:0}),r("CirclePattern").setAll({gap:5,checkered:!1,centered:!1,radius:3,strokeWidth:0,width:45,height:45}),r("GrainPattern").setAll({width:200,height:200,colors:[ei.fromHex(0)],size:1,horizontalGap:0,verticalGap:0,density:1,minOpacity:0,maxOpacity:.2}),r("LinearGradient").setAll({rotation:90}),r("Legend").setAll({fillField:"fill",strokeField:"stroke",nameField:"name",layout:xc.new(this._root,{}),layer:30,clickTarget:"itemContainer"}),r("Container",["legend","item","itemcontainer"]).setAll({paddingLeft:5,paddingRight:5,paddingBottom:5,paddingTop:5,layout:i,setStateOnChildren:!0,interactiveChildren:!1,ariaChecked:!0,focusable:!0,ariaLabel:e.translate("Press ENTER to toggle"),role:"checkbox"});{const a=r("Rectangle",["legend","item","background"]);a.setAll({fillOpacity:0}),ti(a,"fill",t,"background")}r("Container",["legend","marker"]).setAll({setStateOnChildren:!0,centerY:wi,paddingLeft:0,paddingRight:0,paddingBottom:0,paddingTop:0,width:18,height:18}),r("RoundedRectangle",["legend","marker","rectangle"]).setAll({width:vt,height:vt,cornerRadiusBL:3,cornerRadiusTL:3,cornerRadiusBR:3,cornerRadiusTR:3});{const a=r("RoundedRectangle",["legend","marker","rectangle"]).states.create("disabled",{});ti(a,"fill",t,"disabled"),ti(a,"stroke",t,"disabled")}r("Label",["legend","label"]).setAll({centerY:wi,marginLeft:5,paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:0,populateText:!0}),ti(r("Label",["legend","label"]).states.create("disabled",{}),"fill",t,"disabled"),r("Label",["legend","value","label"]).setAll({centerY:wi,marginLeft:5,paddingRight:0,paddingLeft:0,paddingTop:0,paddingBottom:0,width:50,centerX:vt,populateText:!0}),ti(r("Label",["legend","value","label"]).states.create("disabled",{}),"fill",t,"disabled"),r("HeatLegend").setAll({stepCount:1}),r("RoundedRectangle",["heatlegend","marker"]).setAll({cornerRadiusTR:0,cornerRadiusBR:0,cornerRadiusTL:0,cornerRadiusBL:0}),r("RoundedRectangle",["vertical","heatlegend","marker"]).setAll({height:vt,width:15}),r("RoundedRectangle",["horizontal","heatlegend","marker"]).setAll({width:vt,height:15}),r("HeatLegend",["vertical"]).setAll({height:vt}),r("HeatLegend",["horizontal"]).setAll({width:vt}),r("Label",["heatlegend","start"]).setAll({paddingLeft:5,paddingRight:5,paddingTop:5,paddingBottom:5}),r("Label",["heatlegend","end"]).setAll({paddingLeft:5,paddingRight:5,paddingTop:5,paddingBottom:5});{const a=r("Label");a.setAll({paddingTop:8,paddingBottom:8,paddingLeft:10,paddingRight:10,fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',fontSize:"1em",populateText:!1}),ti(a,"fill",t,"text")}r("RadialLabel").setAll({textType:"regular",centerY:wi,centerX:wi,inside:!1,radius:0,baseRadius:vt,orientation:"auto",textAlign:"center"}),r("RoundedRectangle").setAll({cornerRadiusTL:8,cornerRadiusBL:8,cornerRadiusTR:8,cornerRadiusBR:8}),r("PointedRectangle").setAll({pointerBaseWidth:15,pointerLength:10,cornerRadius:8}),r("Slice").setAll({shiftRadius:0,dRadius:0,dInnerRadius:0});{const a=r("Tick");a.setAll({strokeOpacity:.15,isMeasured:!1,length:4.5,position:"absolute",crisp:!0}),ti(a,"stroke",t,"grid")}r("Bullet").setAll({locationX:.5,locationY:.5}),r("Tooltip").setAll({position:"absolute",getFillFromSprite:!0,getStrokeFromSprite:!1,autoTextColor:!0,paddingTop:9,paddingBottom:8,paddingLeft:10,paddingRight:10,marginBottom:5,pointerOrientation:"vertical",centerX:wi,centerY:wi,animationEasing:Me(y),exportable:!1}),r("Polygon").setAll({animationEasing:Me(y)}),r("PointedRectangle",["tooltip","background"]).setAll({strokeOpacity:.9,cornerRadius:4,pointerLength:4,pointerBaseWidth:8,fillOpacity:.9,stroke:ei.fromHex(16777215)});{const a=r("Label",["tooltip"]);a.setAll({role:"tooltip",populateText:!0,paddingRight:0,paddingTop:0,paddingLeft:0,paddingBottom:0}),ti(a,"fill",t,"alternativeText")}r("Button").setAll({paddingTop:8,paddingBottom:8,paddingLeft:10,paddingRight:10,interactive:!0,layout:i,interactiveChildren:!1,setStateOnChildren:!0,focusable:!0}),r("Button").states.create("hover",{}),r("Button").states.create("down",{stateAnimationDuration:0}),r("Button").states.create("active",{});{const a=r("RoundedRectangle",["button","background"]);ti(a,"fill",t,"primaryButton"),ti(a,"stroke",t,"primaryButtonStroke")}ti(r("RoundedRectangle",["button","background"]).states.create("hover",{}),"fill",t,"primaryButtonHover"),ti(r("RoundedRectangle",["button","background"]).states.create("down",{stateAnimationDuration:0}),"fill",t,"primaryButtonDown"),ti(r("RoundedRectangle",["button","background"]).states.create("active",{}),"fill",t,"primaryButtonActive"),ti(r("Graphics",["button","icon"]),"stroke",t,"primaryButtonText"),ti(r("Label",["button"]),"fill",t,"primaryButtonText"),r("Button",["zoom"]).setAll({paddingTop:18,paddingBottom:18,paddingLeft:12,paddingRight:12,centerX:46,centerY:-10,y:0,x:vt,role:"button",ariaLabel:e.translate("Zoom Out"),layer:30});{const a=r("RoundedRectangle",["background","button","zoom"]);a.setAll({cornerRadiusBL:40,cornerRadiusBR:40,cornerRadiusTL:40,cornerRadiusTR:40}),ti(a,"fill",t,"primaryButton")}ti(r("RoundedRectangle",["background","button","zoom"]).states.create("hover",{}),"fill",t,"primaryButtonHover"),ti(r("RoundedRectangle",["background","button","zoom"]).states.create("down",{stateAnimationDuration:0}),"fill",t,"primaryButtonDown");{const a=r("Graphics",["icon","button","zoom"]);a.setAll({crisp:!0,strokeOpacity:.7,draw:o=>{o.moveTo(0,0),o.lineTo(12,0)}}),ti(a,"stroke",t,"primaryButtonText")}r("Button",["resize"]).setAll({paddingTop:9,paddingBottom:9,paddingLeft:13,paddingRight:13,draggable:!0,centerX:wi,centerY:wi,position:"absolute",role:"slider",ariaValueMin:"0",ariaValueMax:"100",ariaLabel:e.translate("Use up and down arrows to move selection")});{const a=r("RoundedRectangle",["background","resize","button"]);a.setAll({cornerRadiusBL:40,cornerRadiusBR:40,cornerRadiusTL:40,cornerRadiusTR:40}),ti(a,"fill",t,"secondaryButton"),ti(a,"stroke",t,"secondaryButtonStroke")}ti(r("RoundedRectangle",["background","resize","button"]).states.create("hover",{}),"fill",t,"secondaryButtonHover"),ti(r("RoundedRectangle",["background","resize","button"]).states.create("down",{stateAnimationDuration:0}),"fill",t,"secondaryButtonDown");{const a=r("Graphics",["resize","button","icon"]);a.setAll({interactive:!1,crisp:!0,strokeOpacity:.5,draw:o=>{o.moveTo(0,.5),o.lineTo(0,12.5),o.moveTo(4,.5),o.lineTo(4,12.5)}}),ti(a,"stroke",t,"secondaryButtonText")}r("Button",["resize","vertical"]).setAll({rotation:90,cursorOverStyle:"ns-resize"}),r("Button",["resize","horizontal"]).setAll({cursorOverStyle:"ew-resize"}),r("Button",["play"]).setAll({paddingTop:13,paddingBottom:13,paddingLeft:14,paddingRight:14,ariaLabel:e.translate("Play"),toggleKey:"active"});{const a=r("RoundedRectangle",["play","background"]);a.setAll({strokeOpacity:.5,cornerRadiusBL:100,cornerRadiusBR:100,cornerRadiusTL:100,cornerRadiusTR:100}),ti(a,"fill",t,"primaryButton")}{const a=r("Graphics",["play","icon"]);a.setAll({stateAnimationDuration:0,dx:1,draw:o=>{o.moveTo(0,-5),o.lineTo(8,0),o.lineTo(0,5),o.lineTo(0,-5)}}),ti(a,"fill",t,"primaryButtonText")}r("Graphics",["play","icon"]).states.create("default",{stateAnimationDuration:0}),r("Graphics",["play","icon"]).states.create("active",{stateAnimationDuration:0,draw:a=>{a.moveTo(-4,-5),a.lineTo(-1,-5),a.lineTo(-1,5),a.lineTo(-4,5),a.lineTo(-4,-5),a.moveTo(4,-5),a.lineTo(1,-5),a.lineTo(1,5),a.lineTo(4,5),a.lineTo(4,-5)}}),r("Button",["switch"]).setAll({paddingTop:4,paddingBottom:4,paddingLeft:4,paddingRight:4,ariaLabel:e.translate("Press ENTER to toggle"),toggleKey:"active",width:40,height:24,layout:null});{const a=r("RoundedRectangle",["switch","background"]);a.setAll({strokeOpacity:.5,cornerRadiusBL:100,cornerRadiusBR:100,cornerRadiusTL:100,cornerRadiusTR:100}),ti(a,"fill",t,"primaryButton")}{const a=r("Circle",["switch","icon"]);a.setAll({radius:8,centerY:0,centerX:0,dx:0}),ti(a,"fill",t,"primaryButtonText")}r("Graphics",["switch","icon"]).states.create("active",{dx:16}),r("Scrollbar").setAll({start:0,end:1,layer:30,animationEasing:Me(y)}),r("Scrollbar",["vertical"]).setAll({marginRight:13,marginLeft:13,minWidth:12,height:vt}),r("Scrollbar",["horizontal"]).setAll({marginTop:13,marginBottom:13,minHeight:12,width:vt}),this.rule("Button",["scrollbar"]).setAll({exportable:!1});{const a=r("RoundedRectangle",["scrollbar","main","background"]);a.setAll({cornerRadiusTL:8,cornerRadiusBL:8,cornerRadiusTR:8,cornerRadiusBR:8,fillOpacity:.8}),ti(a,"fill",t,"fill")}{const a=r("RoundedRectangle",["scrollbar","thumb"]);a.setAll({role:"slider",ariaLive:"polite",position:"absolute",draggable:!0}),ti(a,"fill",t,"secondaryButton")}ti(r("RoundedRectangle",["scrollbar","thumb"]).states.create("hover",{}),"fill",t,"secondaryButtonHover"),ti(r("RoundedRectangle",["scrollbar","thumb"]).states.create("down",{stateAnimationDuration:0}),"fill",t,"secondaryButtonDown"),r("RoundedRectangle",["scrollbar","thumb","vertical"]).setAll({x:wi,width:vt,centerX:wi,ariaLabel:e.translate("Use up and down arrows to move selection")}),r("RoundedRectangle",["scrollbar","thumb","horizontal"]).setAll({y:wi,centerY:wi,height:vt,ariaLabel:e.translate("Use left and right arrows to move selection")});{const a=r("PointedRectangle",["axis","tooltip","background"]);a.setAll({cornerRadius:0}),ti(a,"fill",t,"alternativeBackground")}r("Label",["axis","tooltip"]).setAll({role:void 0}),r("Label",["axis","tooltip","y"]).setAll({textAlign:"right"}),r("Label",["axis","tooltip","y","opposite"]).setAll({textAlign:"left"}),r("Label",["axis","tooltip","x"]).setAll({textAlign:"center"}),r("Tooltip",["categoryaxis"]).setAll({labelText:"{category}"}),r("Star").setAll({spikes:5,innerRadius:5,radius:10}),r("Tooltip",["stock"]).setAll({paddingTop:6,paddingBottom:5,paddingLeft:7,paddingRight:7}),r("PointedRectangle",["tooltip","stock","axis"]).setAll({pointerLength:0,pointerBaseWidth:0,cornerRadius:3}),r("Label",["tooltip","stock"]).setAll({fontSize:"0.8em"}),r("SpriteResizer").setAll({rotationStep:10}),r("Container",["resizer","grip"]).states.create("hover",{});{const a=r("RoundedRectangle",["resizer","grip"]);a.setAll({strokeOpacity:.7,strokeWidth:1,fillOpacity:1,width:12,height:12}),ti(a,"fill",t,"background"),ti(a,"stroke",t,"alternativeBackground")}{const a=r("RoundedRectangle",["resizer","grip","outline"]);a.setAll({strokeOpacity:0,fillOpacity:0,width:20,height:20}),a.states.create("hover",{fillOpacity:.3}),ti(a,"fill",t,"alternativeBackground")}r("RoundedRectangle",["resizer","grip","left"]).setAll({cornerRadiusBL:0,cornerRadiusBR:0,cornerRadiusTL:0,cornerRadiusTR:0}),r("RoundedRectangle",["resizer","grip","right"]).setAll({cornerRadiusBL:0,cornerRadiusBR:0,cornerRadiusTL:0,cornerRadiusTR:0});{const a=r("Rectangle",["resizer","rectangle"]);a.setAll({strokeDasharray:[2,2],strokeOpacity:.5,strokeWidth:1}),ti(a,"stroke",t,"alternativeBackground")}}}class _b{constructor(e=1,t=0,i=0,n=1,r=0,a=0){Object.defineProperty(this,"a",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"b",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"c",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"d",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.a=e,this.b=t,this.c=i,this.d=n,this.tx=r,this.ty=a}setTransform(e,t,i,n,r,a=1){this.a=Math.cos(r)*a,this.b=Math.sin(r)*a,this.c=-Math.sin(r)*a,this.d=Math.cos(r)*a,this.tx=e-(i*this.a+n*this.c),this.ty=t-(i*this.b+n*this.d)}apply(e){return{x:this.a*e.x+this.c*e.y+this.tx,y:this.b*e.x+this.d*e.y+this.ty}}applyInverse(e){const t=1/(this.a*this.d+this.c*-this.b);return{x:this.d*t*e.x+-this.c*t*e.y+(this.ty*this.c-this.tx*this.d)*t,y:this.a*t*e.y+-this.b*t*e.x+(-this.ty*this.a+this.tx*this.b)*t}}append(e){const t=this.a,i=this.b,n=this.c,r=this.d;this.a=e.a*t+e.b*n,this.b=e.a*i+e.b*r,this.c=e.c*t+e.d*n,this.d=e.c*i+e.d*r,this.tx=e.tx*t+e.ty*n+this.tx,this.ty=e.tx*i+e.ty*r+this.ty}prepend(e){const t=this.tx;if(1!==e.a||0!==e.b||0!==e.c||1!==e.d){const i=this.a,n=this.c;this.a=i*e.a+this.b*e.c,this.b=i*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d}this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty}copyFrom(e){this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty}}var Ou=2*Math.PI,bb=function(e,t,i,n,r,a,o){var l=e.x,c=e.y;return{x:n*(l*=t)-r*(c*=i)+a,y:r*l+n*c+o}},rD=function(e,t){var i=1.5707963267948966===t?.551915024494:-1.5707963267948966===t?-.551915024494:1.3333333333333333*Math.tan(t/4),n=Math.cos(e),r=Math.sin(e),a=Math.cos(e+t),o=Math.sin(e+t);return[{x:n-r*i,y:r+n*i},{x:a+o*i,y:o-a*i},{x:a,y:o}]},Yy=function(e,t,i,n){var a=e*i+t*n;return a>1&&(a=1),a<-1&&(a=-1),(e*n-t*i<0?-1:1)*Math.acos(a)};const lD=function(e){var t=e.px,i=e.py,n=e.cx,r=e.cy,a=e.rx,o=e.ry,l=e.xAxisRotation,c=void 0===l?0:l,h=e.largeArcFlag,u=void 0===h?0:h,m=e.sweepFlag,p=void 0===m?0:m,_=[];if(0===a||0===o)return[];var g=Math.sin(c*Ou/360),f=Math.cos(c*Ou/360),b=f*(t-n)/2+g*(i-r)/2,C=-g*(t-n)/2+f*(i-r)/2;if(0===b&&0===C)return[];a=Math.abs(a),o=Math.abs(o);var M=Math.pow(b,2)/Math.pow(a,2)+Math.pow(C,2)/Math.pow(o,2);M>1&&(a*=Math.sqrt(M),o*=Math.sqrt(M));var E=function(e,t,i,n,r,a,o,l,c,h,u,m){var p=Math.pow(r,2),_=Math.pow(a,2),g=Math.pow(u,2),f=Math.pow(m,2),b=p*_-p*f-_*g;b<0&&(b=0),b/=p*f+_*g;var C=(b=Math.sqrt(b)*(o===l?-1:1))*r/a*m,M=b*-a/r*u,E=h*C-c*M+(e+i)/2,S=c*C+h*M+(t+n)/2,P=(u-C)/r,I=(m-M)/a,L=(-u-C)/r,O=(-m-M)/a,B=Yy(1,0,P,I),Q=Yy(P,I,L,O);return 0===l&&Q>0&&(Q-=Ou),1===l&&Q<0&&(Q+=Ou),[E,S,B,Q]}(t,i,n,r,a,o,u,p,g,f,b,C),S=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function s(e,t){var i=[],n=!0,r=!1,a=void 0;try{for(var l,o=e[Symbol.iterator]();!(n=(l=o.next()).done)&&(i.push(l.value),!t||i.length!==t);n=!0);}catch(c){r=!0,a=c}finally{try{!n&&o.return&&o.return()}finally{if(r)throw a}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(E,4),P=S[0],I=S[1],L=S[2],O=S[3],B=Math.abs(O)/(Ou/4);Math.abs(1-B)<1e-7&&(B=1);var Q=Math.max(Math.ceil(B),1);O/=Q;for(var pe=0;pe<Q;pe++)_.push(rD(L,O)),L+=O;return _.map(function(ae){var N=bb(ae[0],a,o,f,g,P,I),ee=N.x,K=N.y,se=bb(ae[1],a,o,f,g,P,I),ue=se.x,re=se.y,xe=bb(ae[2],a,o,f,g,P,I);return{x1:ee,y1:K,x2:ue,y2:re,x:xe.x,y:xe.y}})};function cD(s,e,t){if(e!==t)throw new Error("Required "+t+" arguments for "+s+" but got "+e)}function Ru(s,e,t){if(e<t)throw new Error("Required at least "+t+" arguments for "+s+" but got "+e)}function da(s,e,t){if(Ru(s,e,t),e%t!=0)throw new Error("Arguments for "+s+" must be in pairs of "+t)}function dD(s){for(let e=0;e<s.length;e+=7){let t=e+3,i=s[t];if(i.length>1){const n=/^([01])([01])(.*)$/.exec(i);null!==n&&(s.splice(t,0,n[1]),++t,s.splice(t,0,n[2]),++t,n[3].length>0?s[t]=n[3]:s.splice(t,1))}if(++t,i=s[t],i.length>1){const n=/^([01])(.+)$/.exec(i);null!==n&&(s.splice(t,0,n[1]),++t,s[t]=n[2])}}}function jy(s){if(0===s||1===s)return s;throw new Error("Flag must be 0 or 1")}function Rp(s,e){for(;(!s.interactive||e(s))&&s._parent;)s=s._parent}function uD(s,e,t){return qn(s,wu(e),i=>{const n=q_(i);let r=i.touches;r?(0==r.length&&(r=i.changedTouches),t(vd(r),n)):t([i],n)})}function Zy(s){const e=document.createElement("canvas");e.width=1,e.height=1;const t=e.getContext("2d",{willReadFrequently:!0});t.drawImage(s,0,0,1,1);try{return t.getImageData(0,0,1,1),!1}catch{return console.warn('Image "'+s.src+'" is loaded from different host and is not covered by CORS policy. For more information about the implications read here: https://www.amcharts.com/docs/v5/concepts/cors'),!0}}function Iu(s){s.width=0,s.height=0,s.style.width="0px",s.style.height="0px"}function Xy(s){return Math.floor(s)+.5}class mD{constructor(){Object.defineProperty(this,"_x",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y",{enumerable:!0,configurable:!0,writable:!0,value:0})}get x(){return this._x}get y(){return this._y}set x(e){this._x=e}set y(e){this._y=e}}class Ip extends _u{constructor(e){super(),Object.defineProperty(this,"_layer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mask",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"visible",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"exportable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"interactive",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"inactive",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"wheelable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"cancelTouch",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isMeasured",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"buttonMode",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"alpha",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"compoundAlpha",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"angle",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"scale",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"crisp",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"pivot",{enumerable:!0,configurable:!0,writable:!0,value:new mD}),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cursorOverStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_replacedCursorStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_localMatrix",{enumerable:!0,configurable:!0,writable:!0,value:new _b}),Object.defineProperty(this,"_matrix",{enumerable:!0,configurable:!0,writable:!0,value:new _b}),Object.defineProperty(this,"_uMatrix",{enumerable:!0,configurable:!0,writable:!0,value:new _b}),Object.defineProperty(this,"_renderer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_parent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_localBounds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_bounds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_colorId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._renderer=e}subStatus(e){return{inactive:null==this.inactive?e.inactive:this.inactive,layer:this._layer||e.layer}}_dispose(){this._renderer._removeObject(this),this.getLayer().dirty=!0}getCanvas(){return this.getLayer().view}getLayer(){let e=this;for(;;){if(e._layer)return e._layer;if(!e._parent)return this._renderer.defaultLayer;e=e._parent}}setLayer(e,t){null==e?this._layer=void 0:(this._layer=this._renderer.getLayer(e,!0),this._layer.visible=!0,this._layer.margin=t,t&&_c(this._layer.view,!1),this._renderer._ghostLayer.setMargin(this._renderer.layers),this._parent&&this._parent.registerChildLayer(this._layer),this._layer.dirty=!0,this._renderer.resizeLayer(this._layer),this._renderer.resizeGhost())}markDirtyLayer(){this.getLayer().dirty=!0}clear(){this.invalidateBounds()}invalidateBounds(){this._localBounds=void 0}_addBounds(e){}_getColorId(){return void 0===this._colorId&&(this._colorId=this._renderer.paintId(this)),this._colorId}_isInteractive(e){return!e.inactive&&(this.interactive||this._renderer._forceInteractive>0)}_isInteractiveMask(e){return this._isInteractive(e)}contains(e){for(;;){if(e===this)return!0;if(!e._parent)return!1;e=e._parent}}toGlobal(e){return this._matrix.apply(e)}toLocal(e){return this._matrix.applyInverse(e)}getLocalMatrix(){return this._uMatrix.setTransform(0,0,this.pivot.x,this.pivot.y,this.angle*Math.PI/180,this.scale),this._uMatrix}getLocalBounds(){return this._localBounds||(this._localBounds={left:1e7,top:1e7,right:-1e7,bottom:-1e7},this._addBounds(this._localBounds)),this._localBounds}getAdjustedBounds(e){this._setMatrix();const t=this.getLocalMatrix(),i=t.apply({x:e.left,y:e.top}),n=t.apply({x:e.right,y:e.top}),r=t.apply({x:e.right,y:e.bottom}),a=t.apply({x:e.left,y:e.bottom});return{left:Math.min(i.x,n.x,r.x,a.x),top:Math.min(i.y,n.y,r.y,a.y),right:Math.max(i.x,n.x,r.x,a.x),bottom:Math.max(i.y,n.y,r.y,a.y)}}on(e,t,i){return this.interactive?this._renderer._addEvent(this,e,t,i):new Ds(()=>{})}_setMatrix(){this._localMatrix.setTransform(this.x,this.y,this.pivot.x,this.pivot.y,this.angle*Math.PI/180,this.scale),this._matrix.copyFrom(this._localMatrix),this._parent&&this._matrix.prepend(this._parent._matrix)}_transform(e,t){const i=this._matrix;let n=i.tx*t,r=i.ty*t;this.crisp&&(n=Xy(n),r=Xy(r)),e.setTransform(i.a*t,i.b*t,i.c*t,i.d*t,n,r)}_transformMargin(e,t,i){const n=this._matrix;e.setTransform(n.a*t,n.b*t,n.c*t,n.d*t,(n.tx+i.left)*t,(n.ty+i.top)*t)}_transformLayer(e,t,i){i.margin?this._transformMargin(e,i.scale||t,i.margin):this._transform(e,i.scale||t)}render(e){if(this.visible&&(!1!==this.exportable||!this._renderer._omitTainted)){this._setMatrix();const t=this.subStatus(e),i=this._renderer.resolution,n=this._renderer.layers,r=this._renderer._ghostLayer,a=r.context,o=this.mask;o&&o._setMatrix(),ye(n,l=>{if(l){const c=l.context;c.save(),o&&(o._transformLayer(c,i,l),o._runPath(c),c.clip()),c.globalAlpha=this.compoundAlpha*this.alpha,this._transformLayer(c,i,l),this.filter&&(c.filter=this.filter)}}),a.save(),o&&this._isInteractiveMask(t)&&(o._transformMargin(a,i,r.margin),o._runPath(a),a.clip()),this._transformMargin(a,i,r.margin),this._render(t),a.restore(),ye(n,l=>{l&&l.context.restore()})}}_render(e){!1===this.exportable&&(e.layer.tainted=!0)}hovering(){return this._renderer._hovering.has(this)}dragging(){return this._renderer._dragging.some(e=>e.value===this)}shouldCancelTouch(){const e=this._renderer;return!(e.tapToActivate&&!e._touchActive)&&(!!this.cancelTouch||!!this._parent&&this._parent.shouldCancelTouch())}}class pD extends Ip{constructor(){super(...arguments),Object.defineProperty(this,"interactiveChildren",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_childLayers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_children",{enumerable:!0,configurable:!0,writable:!0,value:[]})}_isInteractiveMask(e){return this.interactiveChildren||super._isInteractiveMask(e)}addChild(e){e._parent=this,this._children.push(e),e._layer&&this.registerChildLayer(e._layer)}addChildAt(e,t){e._parent=this,this._children.splice(t,0,e),e._layer&&this.registerChildLayer(e._layer)}removeChild(e){e._parent=void 0,rr(this._children,e)}_render(e){super._render(e);const t=this._renderer;this.interactive&&this.interactiveChildren&&++t._forceInteractive,ye(this._children,i=>{i.compoundAlpha=this.compoundAlpha*this.alpha,i.render(e)}),this.interactive&&this.interactiveChildren&&--t._forceInteractive}registerChildLayer(e){this._childLayers||(this._childLayers=[]),lo(this._childLayers,e),this._parent&&this._parent.registerChildLayer(e)}markDirtyLayer(e=!1){super.markDirtyLayer(),e&&this._childLayers&&ye(this._childLayers,t=>t.dirty=!0)}_dispose(){super._dispose(),this._childLayers&&ye(this._childLayers,e=>{e.dirty=!0})}}function Es(s,e){s.left=Math.min(s.left,e.x),s.top=Math.min(s.top,e.y),s.right=Math.max(s.right,e.x),s.bottom=Math.max(s.bottom,e.y)}class Ks{colorize(e,t){}path(e){}addBounds(e){}}class fD extends Ks{colorize(e,t){e.beginPath()}}class vb extends Ks{constructor(e){super(),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:e})}colorize(e,t){e.fillStyle=void 0!==t?t:this.color}}class gD extends Ks{constructor(e){super(),Object.defineProperty(this,"clearShadow",{enumerable:!0,configurable:!0,writable:!0,value:e})}colorize(e,t){e.fill(),this.clearShadow&&(e.shadowColor="",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0)}}class _D extends Ks{colorize(e,t){e.stroke()}}class yb extends Ks{constructor(e,t,i){super(),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"lineJoin",{enumerable:!0,configurable:!0,writable:!0,value:i})}colorize(e,t){e.strokeStyle=void 0!==t?t:this.color,e.lineWidth=this.width,this.lineJoin&&(e.lineJoin=this.lineJoin)}}class bD extends Ks{constructor(e){super(),Object.defineProperty(this,"dash",{enumerable:!0,configurable:!0,writable:!0,value:e})}colorize(e,t){e.setLineDash(this.dash)}}class vD extends Ks{constructor(e){super(),Object.defineProperty(this,"dashOffset",{enumerable:!0,configurable:!0,writable:!0,value:e})}colorize(e,t){e.lineDashOffset=this.dashOffset}}class yD extends Ks{constructor(e,t,i,n){super(),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:n})}path(e){e.rect(this.x,this.y,this.width,this.height)}addBounds(e){const t=this.x,i=this.y,n=t+this.width,r=i+this.height;Es(e,{x:t,y:i}),Es(e,{x:n,y:i}),Es(e,{x:t,y:r}),Es(e,{x:n,y:r})}}class xD extends Ks{constructor(e,t,i){super(),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"radius",{enumerable:!0,configurable:!0,writable:!0,value:i})}path(e){e.moveTo(this.x+this.radius,this.y),e.arc(this.x,this.y,this.radius,0,2*Math.PI)}addBounds(e){Es(e,{x:this.x-this.radius,y:this.y-this.radius}),Es(e,{x:this.x+this.radius,y:this.y+this.radius})}}class wD extends Ks{constructor(e,t,i,n){super(),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"radiusX",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"radiusY",{enumerable:!0,configurable:!0,writable:!0,value:n})}path(e){e.ellipse(0,0,this.radiusX,this.radiusY,0,0,2*Math.PI)}addBounds(e){Es(e,{x:this.x-this.radiusX,y:this.y-this.radiusY}),Es(e,{x:this.x+this.radiusX,y:this.y+this.radiusY})}}class MD extends Ks{constructor(e,t,i,n,r,a){super(),Object.defineProperty(this,"cx",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"cy",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"radius",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"startAngle",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"endAngle",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"anticlockwise",{enumerable:!0,configurable:!0,writable:!0,value:a})}path(e){this.radius>0&&e.arc(this.cx,this.cy,this.radius,this.startAngle,this.endAngle,this.anticlockwise)}addBounds(e){let t=Eu(this.cx,this.cy,this.startAngle*Ho,this.endAngle*Ho,this.radius);Es(e,{x:t.left,y:t.top}),Es(e,{x:t.right,y:t.bottom})}}class TD extends Ks{constructor(e,t,i,n,r){super(),Object.defineProperty(this,"x1",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y1",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"x2",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"y2",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"radius",{enumerable:!0,configurable:!0,writable:!0,value:r})}path(e){this.radius>0&&e.arcTo(this.x1,this.y1,this.x2,this.y2,this.radius)}addBounds(e){}}class CD extends Ks{constructor(e,t){super(),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t})}path(e){e.lineTo(this.x,this.y)}addBounds(e){Es(e,{x:this.x,y:this.y})}}class DD extends Ks{constructor(e,t){super(),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t})}path(e){e.moveTo(this.x,this.y)}addBounds(e){Es(e,{x:this.x,y:this.y})}}class ED extends Ks{path(e){e.closePath()}}class SD extends Ks{constructor(e,t,i,n,r,a){super(),Object.defineProperty(this,"cpX",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"cpY",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"cpX2",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"cpY2",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"toX",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"toY",{enumerable:!0,configurable:!0,writable:!0,value:a})}path(e){e.bezierCurveTo(this.cpX,this.cpY,this.cpX2,this.cpY2,this.toX,this.toY)}addBounds(e){Es(e,{x:this.cpX,y:this.cpY}),Es(e,{x:this.cpX2,y:this.cpY2}),Es(e,{x:this.toX,y:this.toY})}}class kD extends Ks{constructor(e,t,i,n){super(),Object.defineProperty(this,"cpX",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"cpY",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"toX",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"toY",{enumerable:!0,configurable:!0,writable:!0,value:n})}path(e){e.quadraticCurveTo(this.cpX,this.cpY,this.toX,this.toY)}addBounds(e){Es(e,{x:this.cpX,y:this.cpY}),Es(e,{x:this.toX,y:this.toY})}}class AD extends Ks{constructor(e,t,i,n,r){super(),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"blur",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"offsetX",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"offsetY",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"opacity",{enumerable:!0,configurable:!0,writable:!0,value:r})}colorize(e,t){this.opacity&&(e.fillStyle=this.color),e.shadowColor=this.color,e.shadowBlur=this.blur,e.shadowOffsetX=this.offsetX,e.shadowOffsetY=this.offsetY}}class PD extends Ks{constructor(e,t,i,n,r){super(),Object.defineProperty(this,"image",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:r})}path(e){e.drawImage(this.image,this.x,this.y,this.width,this.height)}addBounds(e){Es(e,{x:this.x,y:this.y}),Es(e,{x:this.width,y:this.height})}}class OD extends Ip{constructor(){super(...arguments),Object.defineProperty(this,"_operations",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"blendMode",{enumerable:!0,configurable:!0,writable:!0,value:pb.NORMAL}),Object.defineProperty(this,"_hasShadows",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_fillAlpha",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_strokeAlpha",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}clear(){super.clear(),this._operations.length=0}_pushOp(e){this._operations.push(e)}beginFill(e,t=1){this._fillAlpha=t,e?e instanceof ei?this._pushOp(new vb(e.toCSS(t))):(this.isMeasured=!0,this._pushOp(new vb(e))):this._pushOp(new vb("rgba(0, 0, 0, "+t+")"))}endFill(){this._pushOp(new gD(this._hasShadows))}endStroke(){this._pushOp(new _D)}beginPath(){this._pushOp(new fD)}lineStyle(e=0,t,i=1,n){this._strokeAlpha=i,this._pushOp(new yb(e,t?t instanceof ei?t.toCSS(i):t:"rgba(0, 0, 0, "+i+")",n))}setLineDash(e){this._pushOp(new bD(e||[]))}setLineDashOffset(e=0){this._pushOp(new vD(e))}drawRect(e,t,i,n){this._pushOp(new yD(e,t,i,n))}drawCircle(e,t,i){this._pushOp(new xD(e,t,i))}drawEllipse(e,t,i,n){this._pushOp(new wD(e,t,i,n))}arc(e,t,i,n,r,a=!1){this._pushOp(new MD(e,t,i,n,r,a))}arcTo(e,t,i,n,r){this._pushOp(new TD(e,t,i,n,r))}lineTo(e,t){this._pushOp(new CD(e,t))}moveTo(e,t){this._pushOp(new DD(e,t))}bezierCurveTo(e,t,i,n,r,a){this._pushOp(new SD(e,t,i,n,r,a))}quadraticCurveTo(e,t,i,n){this._pushOp(new kD(e,t,i,n))}closePath(){this._pushOp(new ED)}shadow(e,t=0,i=0,n=0,r){this._hasShadows=!0,this._pushOp(new AD(e.toCSS(r||this._fillAlpha||this._strokeAlpha),t,i,n))}image(e,t,i,n,r){this._pushOp(new PD(e,t,i,n,r))}svgPath(e){let t=0,i=0,n=null,r=null,a=null,o=null;const l=/([MmZzLlHhVvCcSsQqTtAa])([^MmZzLlHhVvCcSsQqTtAa]*)/g,c=/[\u0009\u0020\u000A\u000C\u000D]*([\+\-]?[0-9]*\.?[0-9]+(?:[eE][\+\-]?[0-9]+)?)[\u0009\u0020\u000A\u000C\u000D]*,?/g;let h;for(;null!==(h=l.exec(e));){const u=h[1],m=h[2],p=[];for(;null!==(h=c.exec(m));)p.push(h[1]);switch("S"!==u&&"s"!==u&&"C"!==u&&"c"!==u&&(n=null,r=null),"Q"!==u&&"q"!==u&&"T"!==u&&"t"!==u&&(a=null,o=null),u){case"M":da(u,p.length,2),t=+p[0],i=+p[1],this.moveTo(t,i);for(let g=2;g<p.length;g+=2)t=+p[g],i=+p[g+1],this.lineTo(t,i);break;case"m":da(u,p.length,2),t+=+p[0],i+=+p[1],this.moveTo(t,i);for(let g=2;g<p.length;g+=2)t+=+p[g],i+=+p[g+1],this.lineTo(t,i);break;case"L":da(u,p.length,2);for(let g=0;g<p.length;g+=2)t=+p[g],i=+p[g+1],this.lineTo(t,i);break;case"l":da(u,p.length,2);for(let g=0;g<p.length;g+=2)t+=+p[g],i+=+p[g+1],this.lineTo(t,i);break;case"H":Ru(u,p.length,1);for(let g=0;g<p.length;++g)t=+p[g],this.lineTo(t,i);break;case"h":Ru(u,p.length,1);for(let g=0;g<p.length;++g)t+=+p[g],this.lineTo(t,i);break;case"V":Ru(u,p.length,1);for(let g=0;g<p.length;++g)i=+p[g],this.lineTo(t,i);break;case"v":Ru(u,p.length,1);for(let g=0;g<p.length;++g)i+=+p[g],this.lineTo(t,i);break;case"C":da(u,p.length,6);for(let g=0;g<p.length;g+=6)n=+p[g+2],r=+p[g+3],t=+p[g+4],i=+p[g+5],this.bezierCurveTo(+p[g],+p[g+1],n,r,t,i);break;case"c":da(u,p.length,6);for(let g=0;g<p.length;g+=6){const f=+p[g]+t,b=+p[g+1]+i;n=+p[g+2]+t,r=+p[g+3]+i,t+=+p[g+4],i+=+p[g+5],this.bezierCurveTo(f,b,n,r,t,i)}break;case"S":da(u,p.length,4),(null===n||null===r)&&(n=t,r=i);for(let g=0;g<p.length;g+=4){const f=2*t-n,b=2*i-r;n=+p[g],r=+p[g+1],t=+p[g+2],i=+p[g+3],this.bezierCurveTo(f,b,n,r,t,i)}break;case"s":da(u,p.length,4),(null===n||null===r)&&(n=t,r=i);for(let g=0;g<p.length;g+=4){const f=2*t-n,b=2*i-r;n=+p[g]+t,r=+p[g+1]+i,t+=+p[g+2],i+=+p[g+3],this.bezierCurveTo(f,b,n,r,t,i)}break;case"Q":da(u,p.length,4);for(let g=0;g<p.length;g+=4)a=+p[g],o=+p[g+1],t=+p[g+2],i=+p[g+3],this.quadraticCurveTo(a,o,t,i);break;case"q":da(u,p.length,4);for(let g=0;g<p.length;g+=4)a=+p[g]+t,o=+p[g+1]+i,t+=+p[g+2],i+=+p[g+3],this.quadraticCurveTo(a,o,t,i);break;case"T":da(u,p.length,2),(null===a||null===o)&&(a=t,o=i);for(let g=0;g<p.length;g+=2)a=2*t-a,o=2*i-o,t=+p[g],i=+p[g+1],this.quadraticCurveTo(a,o,t,i);break;case"t":da(u,p.length,2),(null===a||null===o)&&(a=t,o=i);for(let g=0;g<p.length;g+=2)a=2*t-a,o=2*i-o,t+=+p[g],i+=+p[g+1],this.quadraticCurveTo(a,o,t,i);break;case"A":case"a":const _="a"===u;dD(p),da(u,p.length,7);for(let g=0;g<p.length;g+=7){let f=+p[g+5],b=+p[g+6];_&&(f+=t,b+=i),ye(lD({px:t,py:i,rx:+p[g],ry:+p[g+1],xAxisRotation:+p[g+2],largeArcFlag:jy(+p[g+3]),sweepFlag:jy(+p[g+4]),cx:f,cy:b}),M=>{this.bezierCurveTo(M.x1,M.y1,M.x2,M.y2,M.x,M.y),t=M.x,i=M.y})}break;case"Z":case"z":cD(u,p.length,0),this.closePath()}}}_runPath(e){e.beginPath(),ye(this._operations,t=>{t.path(e)})}_render(e){super._render(e);const t=e.layer.dirty,i=this._isInteractive(e);if(t||i){const n=e.layer.context,r=this._renderer._ghostLayer.context;let a;t&&(n.globalCompositeOperation=this.blendMode,n.beginPath()),i&&(r.beginPath(),a=this._getColorId()),ye(this._operations,o=>{t&&(o.path(n),o.colorize(n,void 0)),i&&(o.path(r),o.colorize(r,a))})}}renderDetached(e){if(this.visible){this._setMatrix(),e.save();const t=this.mask;t&&(t._setMatrix(),t._transform(e,1),t._runPath(e),e.clip()),e.globalAlpha=this.compoundAlpha*this.alpha,this._transform(e,1),this.filter&&(e.filter=this.filter),e.globalCompositeOperation=this.blendMode,e.beginPath(),ye(this._operations,i=>{i.path(e),i.colorize(e,void 0)}),e.restore()}}_addBounds(e){this.visible&&this.isMeasured&&ye(this._operations,t=>{t.addBounds(e)})}}class qy extends Ip{constructor(e,t,i){super(e),Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"style",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"resolution",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"textVisible",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_textInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_originalScale",{enumerable:!0,configurable:!0,writable:!0,value:1}),this.text=t,this.style=i}invalidateBounds(){super.invalidateBounds(),this._textInfo=void 0}_shared(e){this.style.textAlign&&(e.textAlign=this.style.textAlign),this.style.direction&&(e.direction=this.style.direction),this.style.textBaseline&&(e.textBaseline=this.style.textBaseline)}_prerender(e,t=!1,i=!1){super._render(e);const n=e.layer.context,r=this._renderer._ghostLayer.context,a=this.style;let o=this._getFontStyle(void 0,i);n.font=o,this._isInteractive(e)&&!t&&(r.font=o),a.fill&&(n.fillStyle=a.fill instanceof ei?a.fill.toCSS(null!=a.fillOpacity?a.fillOpacity:1):a.fill),a.shadowColor&&(e.layer.context.shadowColor=a.shadowColor.toCSS(a.shadowOpacity||1)),a.shadowBlur&&(e.layer.context.shadowBlur=a.shadowBlur),a.shadowOffsetX&&(e.layer.context.shadowOffsetX=a.shadowOffsetX),a.shadowOffsetY&&(e.layer.context.shadowOffsetY=a.shadowOffsetY),this._shared(n),this._isInteractive(e)&&!t&&(r.fillStyle=this._getColorId(),this._shared(r))}_getFontStyle(e,t=!1){const i=this.style;let n=[];return e&&e.fontVariant?n.push(e.fontVariant):i.fontVariant&&n.push(i.fontVariant),t||(e&&e.fontWeight?n.push(e.fontWeight):i.fontWeight&&n.push(i.fontWeight)),e&&e.fontStyle?n.push(e.fontStyle):i.fontStyle&&n.push(i.fontStyle),e&&e.fontSize?(Se(e.fontSize)&&(e.fontSize=e.fontSize+"px"),n.push(e.fontSize)):i.fontSize&&(Se(i.fontSize)&&(i.fontSize=i.fontSize+"px"),n.push(i.fontSize)),e&&e.fontFamily?n.push(e.fontFamily):i.fontFamily?n.push(i.fontFamily):n.length&&n.push("Arial"),n.join(" ")}_render(e){if(this._textInfo||this._measure(e),this.textVisible){const t=this._isInteractive(e),i=e.layer.context,n=e.layer.dirty,r=this._renderer._ghostLayer.context;i.save(),r.save(),this._prerender(e),ye(this._textInfo,(a,o)=>{ye(a.textChunks,(l,c)=>{if(l.style&&(i.save(),r.save(),i.font=l.style,this._isInteractive(e)&&(r.font=l.style)),l.fill&&(i.save(),i.fillStyle=l.fill.toCSS()),n&&i.fillText(l.text,l.offsetX,a.offsetY+l.offsetY),"underline"==l.textDecoration||"line-through"==l.textDecoration){let _,h=1,u=1,m=l.height,p=l.offsetX;switch(this.style.textAlign){case"right":case"end":p-=l.width;break;case"center":p-=l.width/2}if(l.style)switch(Ya.getTextStyle(l.style).fontWeight){case"bolder":case"bold":case"700":case"800":case"900":h=2}m&&(u=m/20),_="line-through"==l.textDecoration?h+a.offsetY+l.offsetY-l.height/2:h+1.5*u+a.offsetY+l.offsetY,i.save(),i.beginPath(),l.fill?i.strokeStyle=l.fill.toCSS():this.style.fill&&this.style.fill instanceof ei&&(i.strokeStyle=this.style.fill.toCSS()),i.lineWidth=h*u,i.moveTo(p,_),i.lineTo(p+l.width,_),i.stroke(),i.restore()}t&&this.interactive&&r.fillText(l.text,l.offsetX,a.offsetY+l.offsetY),l.fill&&i.restore(),l.style&&(i.restore(),r.restore())})}),i.restore(),r.restore()}}_addBounds(e){if(this.visible&&this.isMeasured){const t=this._measure({inactive:this.inactive,layer:this.getLayer()});Es(e,{x:t.left,y:t.top}),Es(e,{x:t.right,y:t.bottom})}}_ignoreFontWeight(){return/apple/i.test(navigator.vendor)}_measure(e){const t=e.layer.context,i=this._renderer._ghostLayer.context,n="rtl"==this.style.direction;this._textInfo=[];const r=this.style.oversizedBehavior,a=this.style.maxWidth,o=Se(a)&&"truncate"==r,l=Se(a)&&("wrap"==r||"wrap-no-break"==r);t.save(),i.save(),this._prerender(e,!0,this._ignoreFontWeight());const c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ",h=this.text.toString().replace(/\r/g,"").split(/\n/);let g,u=!0,m=0,p=0,_=0;ye(h,(b,C)=>{let M;for(M=""==b?[{type:"value",text:""}]:Ya.chunk(b,!1,this.style.ignoreFormatting);M.length>0;){let E={offsetY:_,ascent:0,width:0,height:0,left:0,right:0,textChunks:[]};const S=this._measureText(c,t);E.height=S.actualBoundingBoxAscent+S.actualBoundingBoxDescent,E.ascent=S.actualBoundingBoxAscent;let I,O,B,N,L=this.style.textDecoration,Q=!1,pe=!0,ae=[];lp(M,(ee,K)=>{if("format"==ee.type)if("[/]"==ee.text)u||(t.restore(),i.restore(),u=!0),O=void 0,g=void 0,B=void 0,L=this.style.textDecoration,N=void 0,I=ee.text;else{u||(t.restore(),i.restore());let se=Ya.getTextStyle(ee.text);const ue=this._getFontStyle(se);t.save(),i.save(),t.font=ue,g=ue,I=ee.text,se.textDecoration&&(L=se.textDecoration),se.fill&&(O=se.fill),se.width&&(B=_s(se.width)),se.verticalAlign&&(N=se.verticalAlign),u=!1;const re=this._measureText(c,t),xe=re.actualBoundingBoxAscent+re.actualBoundingBoxDescent;xe>E.height&&(E.height=xe),re.actualBoundingBoxAscent>E.ascent&&(E.ascent=re.actualBoundingBoxAscent)}else if("value"==ee.type&&!Q){const se=this._measureText(ee.text,t);let ue=se.actualBoundingBoxLeft+se.actualBoundingBoxRight;if(o){let Fe=pe||this.style.breakWords||!1;const Te=this.style.ellipsis||"",Le=this._measureText(Te,t);E.width+ue>a&&(ee.text=this._truncateText(t,ee.text,a-E.width-(Le.actualBoundingBoxLeft+Le.actualBoundingBoxRight),Fe),ee.text+=Te,Q=!0)}else if(l&&E.width+ue>a){const Te=this._truncateText(t,ee.text,a-E.width,!1,pe&&"wrap-no-break"!=this.style.oversizedBehavior);if(""==Te)return this.textVisible=!0,!1;ae=M.slice(K+1),Sl(Te)!=Sl(ee.text)&&(ae.unshift({type:"value",text:ee.text.substr(Te.length)}),I&&ae.unshift({type:"format",text:I})),ee.text=Sl(Te),M=[],Q=!0}let re=1,xe=1;if(g&&B&&B>ue){const Fe=ue/B;switch(this.style.textAlign){case"right":case"end":re=Fe;break;case"center":re=Fe,xe=Fe;break;default:xe=Fe}ue=B}const Ce=se.actualBoundingBoxAscent+se.actualBoundingBoxDescent;Ce>E.height&&(E.height=Ce),se.actualBoundingBoxAscent>E.ascent&&(E.ascent=se.actualBoundingBoxAscent),E.width+=ue,E.left+=se.actualBoundingBoxLeft/re,E.right+=se.actualBoundingBoxRight/xe,E.textChunks.push({style:g,fill:O,text:ee.text,width:ue,height:Ce,left:se.actualBoundingBoxLeft,right:se.actualBoundingBoxRight,ascent:se.actualBoundingBoxAscent,offsetX:0,offsetY:0,textDecoration:L,verticalAlign:N}),pe=!1}return!0}),this.style.lineHeight instanceof Ti?(E.height*=this.style.lineHeight.value,E.ascent*=this.style.lineHeight.value):(E.height*=this.style.lineHeight||1.2,E.ascent*=this.style.lineHeight||1.2),m<E.left&&(m=E.left),p<E.right&&(p=E.right),this._textInfo.push(E),_+=E.height,M=ae||[]}}),u||(t.restore(),i.restore()),ye(this._textInfo,(b,C)=>{let M=0;ye(b.textChunks,E=>{if(E.offsetX=M+E.left-b.left,E.offsetY+=b.height-b.height*(this.style.baselineRatio||.19),M+=E.width,E.verticalAlign)switch(E.verticalAlign){case"super":E.offsetY-=b.height/2-E.height/2;break;case"sub":E.offsetY+=E.height/2}})});const f={left:n?-p:-m,top:0,right:n?m:p,bottom:_};if("none"!==r){const b=this._fitRatio(f);if(b<1)if("fit"==r)Se(this.style.minScale)&&b<this.style.minScale?(this.textVisible=!1,f.left=0,f.top=0,f.right=0,f.bottom=0):((!this._originalScale||1==this._originalScale)&&(this._originalScale=this.scale),this.scale=b,this.textVisible=!0);else if("hide"==r)this.textVisible=!1,f.left=0,f.top=0,f.right=0,f.bottom=0;else{switch(this.style.textAlign){case"right":case"end":f.left=-a,f.right=0;break;case"center":f.left=-a/2,f.right=a/2;break;default:f.left=0,f.right=a}this.scale=this._originalScale||1,this._originalScale=void 0,this.textVisible=!0}else this.scale=this._originalScale||1,this._originalScale=void 0,this.textVisible=!0}return t.restore(),i.restore(),f}_fitRatio(e){const t=this.style.maxWidth,i=this.style.maxHeight;return Se(t)||Se(i)?Math.min(t/(e.right-e.left)||1,i/(e.bottom-e.top)||1):1}_truncateText(e,t,i,n=!1,r=!0){let a;do{if(n)t=t.slice(0,-1);else{let l=t.replace(/[^,;:!?\\\/\s\u200b]+[,;:!?\\\/\s\u200b]*$/g,"");if(""!=l&&l!==t||!r){if(""==l)return t;t=l}else n=!0}const o=this._measureText(t,e);a=o.actualBoundingBoxLeft+o.actualBoundingBoxRight}while(a>i&&""!=t);return t}_measureText(e,t){let i=t.measureText(e),n={};if(null==i.actualBoundingBoxAscent){const a=document.createElement("div");a.innerText=e,a.style.visibility="hidden",a.style.position="absolute",a.style.top="-1000000px;",a.style.fontFamily=this.style.fontFamily||"",a.style.fontSize=this.style.fontSize+"",document.body.appendChild(a);const o=a.getBoundingClientRect();document.body.removeChild(a);const l=o.height,c=i.width;n={actualBoundingBoxAscent:l,actualBoundingBoxDescent:0,actualBoundingBoxLeft:0,actualBoundingBoxRight:c,fontBoundingBoxAscent:l,fontBoundingBoxDescent:0,width:c}}else n={actualBoundingBoxAscent:i.actualBoundingBoxAscent,actualBoundingBoxDescent:i.actualBoundingBoxDescent,actualBoundingBoxLeft:i.actualBoundingBoxLeft,actualBoundingBoxRight:i.actualBoundingBoxRight,fontBoundingBoxAscent:i.actualBoundingBoxAscent,fontBoundingBoxDescent:i.actualBoundingBoxDescent,width:i.width};const r=i.width;switch(this.style.textAlign){case"right":case"end":n.actualBoundingBoxLeft=r,n.actualBoundingBoxRight=0;break;case"center":n.actualBoundingBoxLeft=r/2,n.actualBoundingBoxRight=r/2;break;default:n.actualBoundingBoxLeft=0,n.actualBoundingBoxRight=r}return n}}class RD{constructor(){Object.defineProperty(this,"fill",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fillOpacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textAlign",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontFamily",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontWeight",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontVariant",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textDecoration",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowBlur",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOpacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lineHeight",{enumerable:!0,configurable:!0,writable:!0,value:ln(120)}),Object.defineProperty(this,"baselineRatio",{enumerable:!0,configurable:!0,writable:!0,value:.19}),Object.defineProperty(this,"direction",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textBaseline",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oversizedBehavior",{enumerable:!0,configurable:!0,writable:!0,value:"none"}),Object.defineProperty(this,"breakWords",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ellipsis",{enumerable:!0,configurable:!0,writable:!0,value:"\u2026"}),Object.defineProperty(this,"maxWidth",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxHeight",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"minScale",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreFormatting",{enumerable:!0,configurable:!0,writable:!0,value:!1})}}class ID extends qy{constructor(){super(...arguments),Object.defineProperty(this,"textType",{enumerable:!0,configurable:!0,writable:!0,value:"circular"}),Object.defineProperty(this,"radius",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"startAngle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inside",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"orientation",{enumerable:!0,configurable:!0,writable:!0,value:"auto"}),Object.defineProperty(this,"kerning",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_textReversed",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_render(e){"circular"===this.textType?this._renderCircular(e):super._render(e)}_renderCircular(e){if(this.textVisible){this._prerender(e);const t=this._isInteractive(e),i=e.layer.context,n=e.layer.dirty,r=this._renderer._ghostLayer.context;i.save(),t&&r.save(),this._textInfo||this._measure(e);let a=this.radius||0,o=this.startAngle||0,l=0,c=this.orientation,h="auto"==c?"auto":"inward"==c;const u=this.inside,m=this.style.textAlign||"left",p=this.kerning||0;let _="left"==m?1:-1;const g=!this._textReversed;if("auto"==h){let f=0,b=0;ye(this._textInfo,(C,M)=>{const E=o+C.width/(a-C.height)/2*-_;E>f&&(f=E)}),b="left"==m?(f+l/2)*Ho:"right"==m?(f-l/2)*Ho:o*Ho,b=Vo(b),h=b>=270||b<=90}1==h&&g&&(this._textInfo.reverse(),this._textReversed=!0),ye(this._textInfo,(f,b)=>{const C=f.height;u||(a+=C),(-1==_&&h||1==_&&!h)&&g&&f.textChunks.reverse();let M=o;l=0,"center"==m&&(M+=f.width/(a-C)/2*-_,l=M-o),M+=Math.PI*(h?0:1),i.save(),t&&r.save(),i.rotate(M),t&&r.rotate(M);let E=0;ye(f.textChunks,(S,P)=>{const I=S.text,L=S.width;E=L/2/(a-C)*_,i.rotate(E),t&&r.rotate(E),S.style&&(i.save(),r.save(),i.font=S.style,t&&(r.font=S.style)),S.fill&&(i.save(),i.fillStyle=S.fill.toCSS()),i.textBaseline="middle",i.textAlign="center",t&&(r.textBaseline="middle",r.textAlign="center"),n&&i.fillText(I,0,(h?1:-1)*(0-a+C/2)),t&&r.fillText(I,0,(h?1:-1)*(0-a+C/2)),S.fill&&i.restore(),S.style&&(i.restore(),r.restore()),E=(L/2+p)/(a-C)*_,i.rotate(E),t&&r.rotate(E)}),i.restore(),t&&r.restore(),u&&(a-=C)}),i.restore(),t&&r.restore()}}_measure(e){return"circular"===this.textType?this._measureCircular(e):super._measure(e)}_measureCircular(e){const t=e.layer.context,i=this._renderer._ghostLayer.context,n="rtl"==this.style.direction,r=this.style.oversizedBehavior,a=this.style.maxWidth,o=Se(a)&&"truncate"==r,l=this.style.ellipsis||"";let c;this.textVisible=!0,this._textInfo=[],this._textReversed=!1,t.save(),i.save(),this._prerender(e,!0);const h=this.text.toString().replace(/\r/g,"").split(/\n/);let u=!0,m=0,p=0;return ye(h,(_,g)=>{let C,M,E,f=Ya.chunk(_,!1,this.style.ignoreFormatting),b={offsetY:p,ascent:0,width:0,height:0,left:0,right:0,textChunks:[]};ye(f,(S,P)=>{if("format"==S.type){if("[/]"==S.text)u||(t.restore(),i.restore(),u=!0),M=void 0,C=void 0,E=void 0;else{let I=Ya.getTextStyle(S.text);const L=this._getFontStyle(I);t.save(),i.save(),t.font=L,C=L,I.fill&&(M=I.fill),I.width&&(E=_s(I.width)),u=!1}o&&(c=this._measureText(l,t))}else if("value"==S.type){const I=S.text.match(/./gu)||[];n&&I.reverse();for(let L=0;L<I.length;L++){const O=I[L],B=this._measureText(O,t);let Q=B.width;C&&E&&E>Q&&(Q=E);const pe=B.actualBoundingBoxAscent+B.actualBoundingBoxDescent;if(pe>b.height&&(b.height=pe),B.actualBoundingBoxAscent>b.ascent&&(b.ascent=B.actualBoundingBoxAscent),m+=Q,o){c||(c=this._measureText(l,t));const ae=c.actualBoundingBoxLeft+c.actualBoundingBoxRight;if(m+ae>a){1==b.textChunks.length?this.textVisible=!1:(b.width+=ae,b.left+=c.actualBoundingBoxLeft,b.right+=c.actualBoundingBoxRight,b.textChunks.push({style:C,fill:M,text:l,width:ae,height:pe+c.actualBoundingBoxDescent,left:c.actualBoundingBoxLeft,right:c.actualBoundingBoxRight,ascent:c.actualBoundingBoxAscent,offsetX:0,offsetY:pe,textDecoration:void 0}));break}}if(b.width+=Q,b.left+=B.actualBoundingBoxLeft,b.right+=B.actualBoundingBoxRight,b.textChunks.push({style:C,fill:M,text:O,width:Q,height:pe+B.actualBoundingBoxDescent,left:B.actualBoundingBoxLeft,right:B.actualBoundingBoxRight,ascent:B.actualBoundingBoxAscent,offsetX:0,offsetY:pe,textDecoration:void 0}),n)break}}}),b.height*=this.style.lineHeight instanceof Ti?this.style.lineHeight.value:this.style.lineHeight||1.2,this._textInfo.push(b),p+=b.height}),u||(t.restore(),i.restore()),"hide"==r&&m>a&&(this.textVisible=!1),ye(this._textInfo,_=>{ye(_.textChunks,g=>{g.offsetY+=Math.round((_.height-g.height+(_.ascent-g.ascent))/2)})}),t.restore(),i.restore(),{left:0,top:0,right:0,bottom:0}}}class LD extends Ip{constructor(e,t){super(e),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"image",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tainted",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowBlur",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOpacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_imageMask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.image=t}_dispose(){super._dispose(),this._imageMask&&Iu(this._imageMask)}getLocalBounds(){if(!this._localBounds){let e=0,t=0;this.width&&(e=this.width),this.height&&(t=this.height),this._localBounds={left:0,top:0,right:e,bottom:t},this._addBounds(this._localBounds)}return this._localBounds}_render(e){if(super._render(e),this.image){if(void 0===this.tainted&&(this.tainted=Zy(this.image),e.layer.tainted=!0),this.tainted&&this._renderer._omitTainted)return;if(e.layer.dirty&&(this.shadowColor&&(e.layer.context.shadowColor=this.shadowColor.toCSS(this.shadowOpacity||1)),this.shadowBlur&&(e.layer.context.shadowBlur=this.shadowBlur),this.shadowOffsetX&&(e.layer.context.shadowOffsetX=this.shadowOffsetX),this.shadowOffsetY&&(e.layer.context.shadowOffsetY=this.shadowOffsetY),e.layer.context.drawImage(this.image,0,0,this.width||this.image.naturalWidth,this.height||this.image.naturalHeight)),this.interactive&&this._isInteractive(e)){const t=this._getMask(this.image);this._renderer._ghostLayer.context.drawImage(t,0,0)}}}clear(){super.clear(),this.image=void 0,this._imageMask=void 0}_getMask(e){if(void 0===this._imageMask){const t=this.width||e.naturalWidth,i=this.height||e.naturalHeight,n=document.createElement("canvas");n.width=t,n.height=i;const r=n.getContext("2d");r.imageSmoothingEnabled=!1,r.fillStyle=this._getColorId(),r.fillRect(0,0,t,i),Zy(e)||(r.globalCompositeOperation="destination-in",r.drawImage(e,0,0,t,i)),this._imageMask=n}return this._imageMask}}class FD{constructor(e,t,i,n){Object.defineProperty(this,"event",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"originalPoint",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"point",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"bbox",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"simulated",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"native",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.id=Ha("touchevents")&&e instanceof Touch?e.identifier:null}}class BD extends mp{constructor(e){if(super(),Object.defineProperty(this,"view",{enumerable:!0,configurable:!0,writable:!0,value:document.createElement("div")}),Object.defineProperty(this,"_layerDom",{enumerable:!0,configurable:!0,writable:!0,value:document.createElement("div")}),Object.defineProperty(this,"layers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_dirtyLayers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"defaultLayer",{enumerable:!0,configurable:!0,writable:!0,value:this.getLayer(0)}),Object.defineProperty(this,"_ghostLayer",{enumerable:!0,configurable:!0,writable:!0,value:new ND}),Object.defineProperty(this,"_patternCanvas",{enumerable:!0,configurable:!0,writable:!0,value:document.createElement("canvas")}),Object.defineProperty(this,"_patternContext",{enumerable:!0,configurable:!0,writable:!0,value:this._patternCanvas.getContext("2d")}),Object.defineProperty(this,"_realWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_realHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_calculatedWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_calculatedHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"resolution",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"interactionsEnabled",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_listeners",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_events",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_colorId",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_colorMap",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_forceInteractive",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_omitTainted",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_hovering",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"_dragging",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_mousedown",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_lastPointerMoveEvent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tapToActivate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"tapToActivateTimeout",{enumerable:!0,configurable:!0,writable:!0,value:3e3}),Object.defineProperty(this,"_touchActive",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_touchActiveTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.resolution=null==e?window.devicePixelRatio:e,this.view.style.position="absolute",this.view.setAttribute("aria-hidden","true"),this.view.appendChild(this._layerDom),this._disposers.push(new Ds(()=>{en(this._events,(t,i)=>{i.disposer.dispose()}),ye(this.layers,t=>{Iu(t.view),t.exportableView&&Iu(t.exportableView)}),Iu(this._ghostLayer.view),Iu(this._patternCanvas)})),this._disposers.push(fp(()=>{null==e&&(this.resolution=window.devicePixelRatio)})),Ha("touchevents")){const t=i=>{0!==this._dragging.length&&lp(this._dragging,n=>!n.value.shouldCancelTouch()||(i.preventDefault(),!1)),this._touchActiveTimeout&&this._delayTouchDeactivate()};this._disposers.push(qn(window,"touchstart",t,{passive:!1})),this._disposers.push(qn(this.view,"touchstart",t,{passive:!1})),this._disposers.push(qn(this.view,"touchmove",()=>{this._touchActiveTimeout&&this._delayTouchDeactivate()},{passive:!0})),this._disposers.push(qn(window,"click",i=>{this._touchActive=!1},{passive:!0})),this._disposers.push(qn(this.view,"click",i=>{window.setTimeout(()=>{this._touchActive=!0,this._delayTouchDeactivate()},100)},{passive:!0}))}Ha("wheelevents")&&this._disposers.push(qn(this.view,"wheel",t=>{let i=!1;this._hovering.forEach(n=>{if(n.wheelable)return i=!0,!1}),i&&t.preventDefault()},{passive:!1}))}_delayTouchDeactivate(){this._touchActiveTimeout&&clearTimeout(this._touchActiveTimeout),this.tapToActivateTimeout>0&&(this._touchActiveTimeout=window.setTimeout(()=>{this._touchActive=!1},this.tapToActivateTimeout))}get debugGhostView(){return!!this._ghostLayer.view.parentNode}set debugGhostView(e){e?this._ghostLayer.view.parentNode||this.view.appendChild(this._ghostLayer.view):this._ghostLayer.view.parentNode&&this._ghostLayer.view.parentNode.removeChild(this._ghostLayer.view)}createLinearGradient(e,t,i,n){return this.defaultLayer.context.createLinearGradient(e,t,i,n)}createRadialGradient(e,t,i,n,r,a){return this.defaultLayer.context.createRadialGradient(e,t,i,n,r,a)}createPattern(e,t,i,n,r){return this._patternCanvas.width=n,this._patternCanvas.height=r,this._patternContext.clearRect(0,0,n,r),t.renderDetached(this._patternContext),e.renderDetached(this._patternContext),this._patternContext.createPattern(this._patternCanvas,i)}makeContainer(){return new pD(this)}makeGraphics(){return new OD(this)}makeText(e,t){return new qy(this,e,t)}makeTextStyle(){return new RD}makeRadialText(e,t){return new ID(this,e,t)}makePicture(e){return new LD(this,e)}resizeLayer(e){e.resize(this._calculatedWidth,this._calculatedHeight,this._calculatedWidth,this._calculatedHeight,this.resolution)}resizeGhost(){this._ghostLayer.resize(this._calculatedWidth,this._calculatedHeight,this._calculatedWidth,this._calculatedHeight,this.resolution)}resize(e,t,i,n){this._realWidth=e,this._realHeight=t,this._calculatedWidth=i,this._calculatedHeight=n,ye(this.layers,r=>{r&&(r.dirty=!0,this.resizeLayer(r))}),this.resizeGhost(),this.view.style.width=i+"px",this.view.style.height=n+"px"}createDetachedLayer(e=!1){const t=document.createElement("canvas"),i=t.getContext("2d",{willReadFrequently:e}),n=new UD(t,i);return t.style.position="absolute",t.style.top="0px",t.style.left="0px",n}getLayerByOrder(e){const t=this.layers,i=t.length;for(let n=0;n<i;n++){const r=t[n];if(r.order==e)return r}}getLayer(e,t=!0){let i=this.getLayerByOrder(e);if(i)return i;const n=this.createDetachedLayer(99==e);n.order=e,n.visible=t,n.view.className="am5-layer-"+e,n.visible&&this.resizeLayer(n);const r=this.layers;r.push(n),r.sort((c,h)=>c.order>h.order?1:c.order<h.order?-1:0);const a=r.length;let l;for(let c=yl(r,n)+1;c<a;c++)if(r[c].visible){l=r[c];break}return n.visible&&(void 0===l?this._layerDom.appendChild(n.view):this._layerDom.insertBefore(n.view,l.view)),n}render(e){if(this._dirtyLayers.length=0,ye(this.layers,t=>{t&&t.dirty&&t.visible&&(this._dirtyLayers.push(t),t.clear())}),this._ghostLayer.clear(),e.render({inactive:null,layer:this.defaultLayer}),this._ghostLayer.context.restore(),ye(this.layers,t=>{if(t){const i=t.context;i.beginPath(),i.moveTo(0,0),i.stroke()}}),ye(this._dirtyLayers,t=>{t.context.restore(),t.dirty=!1}),this._hovering.size&&this._lastPointerMoveEvent){const{events:t,target:i,native:n}=this._lastPointerMoveEvent;ye(t,r=>{this._dispatchGlobalMousemove(r,i,n)})}}paintId(e){const t=function hD(s){const e=[0,0,0];for(let t=0;t<24;t++)e[t%3]<<=1,e[t%3]|=1&s,s>>=1;return(0|e[0])+(e[1]<<8)+(e[2]<<16)}(++this._colorId),i=ei.fromHex(t).toCSS();return this._colorMap[i]=e,i}_removeObject(e){void 0!==e._colorId&&delete this._colorMap[e._colorId]}_adjustBoundingBox(e){const t=this._ghostLayer.margin;return new DOMRect(-t.left,-t.top,e.width+t.left+t.right,e.height+t.top+t.bottom)}getEvent(e,t=!0){const i=this.view.getBoundingClientRect(),n=e.clientX||0,r=e.clientY||0;return new FD(e,{x:n-i.left,y:r-i.top},{x:this._calculatedWidth/this._realWidth*(n-(t?i.left:0)),y:this._calculatedHeight/this._realHeight*(r-(t?i.top:0))},this._adjustBoundingBox(i))}_getHitTarget(e,t,i){if(0===t.width||0===t.height||e.x<t.left||e.x>t.right||e.y<t.top||e.y>t.bottom||!i||!this._layerDom.contains(i))return;const n=this._ghostLayer.getImageData(e,t);if(0===n.data[0]&&0===n.data[1]&&0===n.data[2])return!1;const r=ei.fromRGB(n.data[0],n.data[1],n.data[2]).toCSS();return this._colorMap[r]}getObjectAtPoint(e){const t=this._adjustBoundingBox(this.view.getBoundingClientRect());return this._getHitTarget(e,t,this._layerDom)||void 0}_withEvents(e,t){const i=this._events[e];if(void 0!==i){i.dispatching=!0;try{t(i)}finally{i.dispatching=!1,i.cleanup&&(i.cleanup=!1,Md(i.callbacks,n=>!n.disposed),0===i.callbacks.length&&(i.disposer.dispose(),delete this._events[e]))}}}_dispatchEventAll(e,t){this.interactionsEnabled&&this._withEvents(e,i=>{ye(i.callbacks,n=>{n.disposed||n.callback.call(n.context,t)})})}_dispatchEvent(e,t,i){if(!this.interactionsEnabled)return!1;let n=!1;return this._withEvents(e,r=>{ye(r.callbacks,a=>{!a.disposed&&a.object===t&&(a.callback.call(a.context,i),n=!0)})}),n}_dispatchMousedown(e,t){const i=e.button;if(0!=i&&2!=i&&1!=i&&void 0!==i)return;const n=this.getEvent(e),r=this._getHitTarget(n.originalPoint,n.bbox,t);if(r){const a=n.id;let o=!1;Rp(r,l=>{const c={id:a,value:l};return this._mousedown.push(c),!o&&this._dispatchEvent("pointerdown",l,n)&&(o=!0,this._dragging.some(u=>u.value===l&&u.id===a)||this._dragging.push(c)),!0})}}_dispatchGlobalMousemove(e,t,i){const n=this.getEvent(e),r=this._getHitTarget(n.originalPoint,n.bbox,t);n.native=i,r?(this._hovering.forEach(a=>{a.contains(r)||(this._hovering.delete(a),a.cursorOverStyle&&Dd(document.body,"cursor",a._replacedCursorStyle),this._dispatchEvent("pointerout",a,n))}),n.native&&Rp(r,a=>(this._hovering.has(a)||(this._hovering.add(a),a.cursorOverStyle&&(a._replacedCursorStyle=function X_(s,e){return s.style[e]}(document.body,"cursor"),Dd(document.body,"cursor",a.cursorOverStyle)),this._dispatchEvent("pointerover",a,n)),!0))):(this._hovering.forEach(a=>{a.cursorOverStyle&&Dd(document.body,"cursor",a._replacedCursorStyle),this._dispatchEvent("pointerout",a,n)}),this._hovering.clear()),this._dispatchEventAll("globalpointermove",n)}removeHovering(e){this._hovering.delete(e),e.cursorOverStyle&&Dd(document.body,"cursor",e._replacedCursorStyle)}_dispatchGlobalMouseup(e,t){const i=this.getEvent(e);i.native=t,this._dispatchEventAll("globalpointerup",i)}_dispatchDragMove(e){if(0!==this._dragging.length){const t=this.getEvent(e),i=t.id;this._dragging.forEach(n=>{n.id===i&&this._dispatchEvent("pointermove",n.value,t)})}}_dispatchDragEnd(e,t){const i=e.button;let n;if(0==i||void 0===i)n="click";else if(2==i)n="rightclick";else{if(1!=i)return;n="middleclick"}const r=this.getEvent(e),a=r.id;if(0!==this._mousedown.length){const o=this._getHitTarget(r.originalPoint,r.bbox,t);o&&this._mousedown.forEach(l=>{l.id===a&&l.value.contains(o)&&this._dispatchEvent(n,l.value,r)}),this._mousedown.length=0}0!==this._dragging.length&&(this._dragging.forEach(o=>{o.id===a&&this._dispatchEvent("pointerup",o.value,r)}),this._dragging.length=0)}_dispatchDoubleClick(e,t){const i=this.getEvent(e),n=this._getHitTarget(i.originalPoint,i.bbox,t);n&&Rp(n,r=>!this._dispatchEvent("dblclick",r,i))}_dispatchWheel(e,t){const i=this.getEvent(e),n=this._getHitTarget(i.originalPoint,i.bbox,t);n&&Rp(n,r=>!this._dispatchEvent("wheel",r,i))}_makeSharedEvent(e,t){if(void 0===this._listeners[e]){const i=t();this._listeners[e]=new bu(()=>{delete this._listeners[e],i.dispose()})}return this._listeners[e].increment()}_onPointerEvent(e,t){let i=!1,n=null;function r(){n=null,i=!1}return new mr([new Ds(()=>{null!==n&&clearTimeout(n),r()}),qn(this.view,wu(e),a=>{i=!0,null!==n&&clearTimeout(n),n=window.setTimeout(r,0)}),uD(window,e,(a,o)=>{null!==n&&(clearTimeout(n),n=null),t(a,o,i),i=!1})])}_initEvent(e){switch(e){case"globalpointermove":case"pointerover":case"pointerout":return this._makeSharedEvent("pointermove",()=>{const t=(i,n,r)=>{this._lastPointerMoveEvent={events:i,target:n,native:r},ye(i,a=>{this._dispatchGlobalMousemove(a,n,r)})};return new mr([this._onPointerEvent("pointerdown",t),this._onPointerEvent("pointermove",t)])});case"globalpointerup":return this._makeSharedEvent("pointerup",()=>{const t=this._onPointerEvent("pointerup",(n,r,a)=>{ye(n,o=>{this._dispatchGlobalMouseup(o,a)}),this._lastPointerMoveEvent={events:n,target:r,native:a}}),i=this._onPointerEvent("pointercancel",(n,r,a)=>{ye(n,o=>{this._dispatchGlobalMouseup(o,a)}),this._lastPointerMoveEvent={events:n,target:r,native:a}});return new Ds(()=>{t.dispose(),i.dispose()})});case"click":case"rightclick":case"middleclick":case"pointerdown":case"pointermove":case"pointerup":return this._makeSharedEvent("pointerdown",()=>{const t=this._onPointerEvent("pointerdown",(a,o)=>{ye(a,l=>{this._dispatchMousedown(l,o)})}),i=this._onPointerEvent("pointermove",a=>{ye(a,o=>{this._dispatchDragMove(o)})}),n=this._onPointerEvent("pointerup",(a,o)=>{ye(a,l=>{this._dispatchDragEnd(l,o)})}),r=this._onPointerEvent("pointercancel",(a,o)=>{ye(a,l=>{this._dispatchDragEnd(l,o)})});return new Ds(()=>{t.dispose(),i.dispose(),n.dispose(),r.dispose()})});case"dblclick":return this._makeSharedEvent("dblclick",()=>this._onPointerEvent("dblclick",(t,i)=>{ye(t,n=>{this._dispatchDoubleClick(n,i)})}));case"wheel":return this._makeSharedEvent("wheel",()=>qn(window,wu("wheel"),t=>{this._dispatchWheel(t,q_(t))},{passive:!1}))}}_addEvent(e,t,i,n){let r=this._events[t];void 0===r&&(r=this._events[t]={disposer:this._initEvent(t),callbacks:[],dispatching:!1,cleanup:!1});const a={object:e,context:n,callback:i,disposed:!1};return r.callbacks.push(a),new Ds(()=>{a.disposed=!0,r.dispatching?r.cleanup=!0:(rr(r.callbacks,a),0===r.callbacks.length&&(r.disposer.dispose(),delete this._events[t]))})}getCanvas(e,t){this.render(e),t||(t={});let i=this.resolution,n=Math.floor(this._calculatedWidth*this.resolution),r=Math.floor(this._calculatedHeight*this.resolution);if(t.minWidth&&t.minWidth>n){let p=t.minWidth/n;p>i&&(i=p*this.resolution)}if(t.minHeight&&t.minHeight>r){let p=t.minHeight/r;p>i&&(i=p*this.resolution)}if(t.maxWidth&&t.maxWidth<n){let p=t.maxWidth/n;p<i&&(i=p*this.resolution)}if(t.maxHeight&&t.maxHeight>r){let p=t.maxHeight/r;p<i&&(i=p*this.resolution)}t.maintainPixelRatio&&(i/=this.resolution);const a=[];let o=!1;const l=document.createElement("canvas");i!=this.resolution&&(o=!0,n=n*i/this.resolution,r=r*i/this.resolution),l.width=n,l.height=r,l.style.position="fixed",l.style.top="-10000px",this.view.appendChild(l),a.push(l);const c=l.getContext("2d");let h=0,u=0,m=!1;return ye(this.layers,p=>{if(p&&p.visible&&(p.tainted||o)){m=!0,p.exportableView=p.view,p.exportableContext=p.context,p.view=document.createElement("canvas"),p.view.style.position="fixed",p.view.style.top="-10000px",this.view.appendChild(p.view),a.push(p.view);let _=0,g=0;p.margin&&(_+=p.margin.left||0+p.margin.right||0,g+=p.margin.top||0+p.margin.bottom||0),p.view.width=n+_,p.view.height=r+g,p.context=p.view.getContext("2d"),p.dirty=!0,p.scale=i}}),m&&(this._omitTainted=!0,this.render(e),this._omitTainted=!1),ye(this.layers,p=>{if(p&&p.visible){let _=0,g=0;p.margin&&(_=-(p.margin.left||0)*this.resolution,g=-(p.margin.top||0)*this.resolution),c.drawImage(p.view,_,g),p.exportableView&&(p.view=p.exportableView,p.exportableView=void 0),p.exportableContext&&(p.context=p.exportableContext,p.exportableContext=void 0),h<p.view.clientWidth&&(h=p.view.clientWidth),u<p.view.clientHeight&&(u=p.view.clientHeight),p.scale=void 0}}),l.style.width=h+"px",l.style.height=u+"px",ye(a,p=>{p.style.position="",p.style.top="",this.view.removeChild(p)}),l}}class ND{constructor(){Object.defineProperty(this,"view",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"margin",{enumerable:!0,configurable:!0,writable:!0,value:{left:0,right:0,top:0,bottom:0}}),Object.defineProperty(this,"_width",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_height",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.view=document.createElement("canvas"),this.context=this.view.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.context.imageSmoothingEnabled=!1,this.view.style.position="absolute",this.view.style.top="0px",this.view.style.left="0px"}resize(e,t,i,n,r){e+=this.margin.left+this.margin.right,t+=this.margin.top+this.margin.bottom,i+=this.margin.left+this.margin.right,n+=this.margin.top+this.margin.bottom,this.view.style.left=-this.margin.left+"px",this.view.style.top=-this.margin.top+"px",this._width=Math.floor(e*r),this._height=Math.floor(t*r),this.view.width=this._width,this.view.style.width=i+"px",this.view.height=this._height,this.view.style.height=n+"px"}getImageData(e,t){return this.context.getImageData(Math.round((e.x-t.left)/t.width*this._width),Math.round((e.y-t.top)/t.height*this._height),1,1)}setMargin(e){this.margin.left=0,this.margin.right=0,this.margin.top=0,this.margin.bottom=0,ye(e,t=>{t.margin&&(this.margin.left=Math.max(this.margin.left,t.margin.left),this.margin.right=Math.max(this.margin.right,t.margin.right),this.margin.top=Math.max(this.margin.top,t.margin.top),this.margin.bottom=Math.max(this.margin.bottom,t.margin.bottom))})}clear(){this.context.save(),this.context.fillStyle="#000",this.context.fillRect(0,0,this._width,this._height)}}class UD{constructor(e,t){Object.defineProperty(this,"view",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tainted",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"margin",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"order",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"visible",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"scale",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dirty",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"exportableView",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exportableContext",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_width",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_height",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.view=e,this.context=t}resize(e,t,i,n,r){null!=this.width&&(e=this.width,i=this.width),null!=this.height&&(t=this.height,n=this.height),this.margin?(e+=this.margin.left+this.margin.right,t+=this.margin.top+this.margin.bottom,i+=this.margin.left+this.margin.right,n+=this.margin.top+this.margin.bottom,this.view.style.left=-this.margin.left+"px",this.view.style.top=-this.margin.top+"px"):(this.view.style.left="0px",this.view.style.top="0px"),this._width=Math.floor(e*r),this._height=Math.floor(t*r),this.view.width=this._width,this.view.style.width=i+"px",this.view.height=this._height,this.view.style.height=n+"px"}clear(){this.context.save(),this.context.clearRect(0,0,this._width,this._height)}}function $y(s,e){null==s?requestAnimationFrame(e):setTimeout(()=>{requestAnimationFrame(e)},1e3/s)}class Yo{constructor(e,t={},i){if(Object.defineProperty(this,"dom",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_inner",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isDirtyParents",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dirty",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirtyParents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirtyBounds",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirtyPositions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_ticker",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_tickers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_updateTick",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Cl}),Object.defineProperty(this,"animationTime",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_animations",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_renderer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rootContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tooltipContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipContainerSettings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltip",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"language",{enumerable:!0,configurable:!0,writable:!0,value:iD.new(this,{})}),Object.defineProperty(this,"locale",{enumerable:!0,configurable:!0,writable:!0,value:Gy}),Object.defineProperty(this,"utc",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"timezone",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numberFormatter",{enumerable:!0,configurable:!0,writable:!0,value:JC.new(this,{})}),Object.defineProperty(this,"dateFormatter",{enumerable:!0,configurable:!0,writable:!0,value:eD.new(this,{})}),Object.defineProperty(this,"durationFormatter",{enumerable:!0,configurable:!0,writable:!0,value:tD.new(this,{})}),Object.defineProperty(this,"tabindex",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_tabindexes",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_a11yD",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_focusElementDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_focusElementContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_focusedSprite",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isShift",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_keyboardDragPoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipElementContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_readerAlertElement",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_logo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipDiv",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"nonce",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"interfaceColors",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verticalLayout",{enumerable:!0,configurable:!0,writable:!0,value:Fd.new(this,{})}),Object.defineProperty(this,"horizontalLayout",{enumerable:!0,configurable:!0,writable:!0,value:Ld.new(this,{})}),Object.defineProperty(this,"gridLayout",{enumerable:!0,configurable:!0,writable:!0,value:xc.new(this,{})}),Object.defineProperty(this,"_paused",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"autoResize",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_fontHash",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"_isDisposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_resizeSensorDisposer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltips",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_htmlElementContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_htmlEnabledContainers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),!i)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");let n,r;if(this._settings=t,0==t.accessible&&(this._a11yD=!0),null==t.useSafeResolution&&(t.useSafeResolution=!0),t.useSafeResolution&&(n=function pr(){return function Ay(){return/apple/i.test(navigator.vendor)&&"ontouchend"in document}()?1:void 0}()),this._renderer=new BD(n),r=e instanceof HTMLElement?e:document.getElementById(e),ye(Ea.rootElements,l=>{if(l.dom===r)throw new Error("You cannot have multiple Roots on the same DOM node")}),this.interfaceColors=Op.new(this,{}),null===r)throw new Error("Could not find HTML element with id `"+e+"`");this.dom=r;let a=document.createElement("div");a.style.position="relative",a.style.width="100%",a.style.height="100%",r.appendChild(a);const o=t.tooltipContainerBounds;o&&(this._tooltipContainerSettings=o),this._inner=a,this._updateComputedStyles(),Ea.rootElements.push(this)}static new(e,t){const i=new Yo(e,t,!0);return i._init(),i}moveDOM(e){let t;if(t=e instanceof HTMLElement?e:document.getElementById(e),t){for(;this.dom.childNodes.length>0;)t.appendChild(this.dom.childNodes[0]);this.dom=t,this._initResizeSensor(),this.resize()}}_handleLogo(){this._logo&&(this.dom.offsetWidth<=150||this.dom.offsetHeight<=60?this._logo.hide():this._logo.show())}_showBranding(){if(!this._logo){const e=this.tooltipContainer.children.push(ai.new(this,{interactive:!0,interactiveChildren:!1,position:"absolute",setStateOnChildren:!0,paddingTop:9,paddingRight:9,paddingBottom:9,paddingLeft:9,scale:.6,y:ln(100),centerY:vt,tooltipText:"Created using amCharts 5",tooltipX:vt,cursorOverStyle:"pointer",background:ca.new(this,{fill:kn(4671320),fillOpacity:0,tooltipY:5})})),t=Vr.new(this,{pointerOrientation:"horizontal",paddingTop:4,paddingRight:7,paddingBottom:4,paddingLeft:7});t.label.setAll({fontSize:12}),t.get("background").setAll({fill:this.interfaceColors.get("background"),stroke:this.interfaceColors.get("grid"),strokeOpacity:.3}),e.set("tooltip",t),e.events.on("click",()=>{window.open("https://www.amcharts.com/","_blank")}),e.states.create("hover",{}),e.children.push(rn.new(this,{stroke:kn(13421772),strokeWidth:3,svgPath:"M5 25 L13 25h13.6c3.4 0 6 0 10.3-4.3s5.2-12 8.6-12c3.4 0 4.3 8.6 7.7 8.6M83.4 25H79.8c-3.4 0-6 0-10.3-4.3s-5.2-12-8.6-12-4.3 8.6-7.7 8.6"})).states.create("hover",{stroke:kn(3976191)}),e.children.push(rn.new(this,{stroke:kn(8947848),strokeWidth:3,svgPath:"M83.4 25h-31C37 25 39.5 4.4 28.4 4.4S18.9 24.2 4.3 25H0"})).states.create("hover",{stroke:kn(4671320)}),this._logo=e,this._handleLogo()}}_getRealSize(){return this.dom.getBoundingClientRect()}_getCalculatedSize(e){return this._settings.calculateSize?this._settings.calculateSize(e):{width:e.width,height:e.height}}_init(){const e=this._settings;!1!==e.accessible&&(e.focusable&&(this._inner.setAttribute("focusable","true"),this._inner.setAttribute("tabindex",this.tabindex+"")),e.ariaLabel&&this._inner.setAttribute("aria-label",e.ariaLabel),e.role&&this._inner.setAttribute("role",e.role));const t=this._renderer,i=this._getRealSize(),n=this._getCalculatedSize(i),r=Math.floor(n.width),a=Math.floor(n.height),o=Math.floor(i.width),l=Math.floor(i.height),c=ai.new(this,{visible:!0,width:r,height:a});this._rootContainer=c,this._rootContainer._defaultThemes.push(nD.new(this));const h=c.children.push(ai.new(this,{visible:!0,width:vt,height:vt}));this.container=h,t.resize(o,l,r,a),this._inner.appendChild(t.view),this._initResizeSensor();const u=document.createElement("div");if(this._htmlElementContainer=u,u.className="am5-html-container",u.style.position="absolute",u.style.pointerEvents="none",this._tooltipContainerSettings||(u.style.overflow="hidden"),this._inner.appendChild(u),!0!==this._a11yD){const m=document.createElement("div");m.className="am5-reader-container",m.setAttribute("role","alert"),m.style.position="absolute",m.style.width="1px",m.style.height="1px",m.style.overflow="hidden",m.style.clip="rect(1px, 1px, 1px, 1px)",this._readerAlertElement=m,this._inner.appendChild(this._readerAlertElement);const p=document.createElement("div");p.className="am5-focus-container",p.style.position="absolute",p.style.pointerEvents="none",p.style.top="0px",p.style.left="0px",p.style.overflow="hidden",p.style.width=r+"px",p.style.height=a+"px",p.setAttribute("role","graphics-document"),_c(p,!1),this._focusElementContainer=p,this._inner.appendChild(this._focusElementContainer);const _=document.createElement("div");this._tooltipElementContainer=_,_.className="am5-tooltip-container",this._inner.appendChild(_),Ha("keyboardevents")&&(this._disposers.push(qn(window,"keydown",g=>{16==g.keyCode?this._isShift=!0:9==g.keyCode&&(this._isShift=g.shiftKey)})),this._disposers.push(qn(window,"keyup",g=>{16==g.keyCode&&(this._isShift=!1)})),this._disposers.push(qn(p,"click",()=>{const g=this._focusedSprite;if(g){const f=t.getEvent(new MouseEvent("click"));g.events.dispatch("click",{type:"click",originalEvent:f.event,point:f.point,simulated:!0,target:g})}})),this._disposers.push(qn(p,"keydown",g=>{const f=this._focusedSprite;if(f){27==g.keyCode&&(function j_(){if(document.activeElement&&document.activeElement!=document.body)if(document.activeElement.blur)document.activeElement.blur();else{let s=document.createElement("button");s.style.position="fixed",s.style.top="0px",s.style.left="-10000px",document.body.appendChild(s),s.focus(),s.blur(),document.body.removeChild(s)}}(),this._focusedSprite=void 0);let b=0,C=0;switch(g.keyCode){case 13:g.preventDefault();const M=t.getEvent(new MouseEvent("click"));return void f.events.dispatch("click",{type:"click",originalEvent:M.event,point:M.point,simulated:!0,target:f});case 37:b=-6;break;case 39:b=6;break;case 38:C=-6;break;case 40:C=6;break;default:return}if(0!=b||0!=C){if(g.preventDefault(),!f.isDragging()){this._keyboardDragPoint={x:0,y:0};const S=t.getEvent(new MouseEvent("mousedown",{clientX:0,clientY:0}));f.events.isEnabled("pointerdown")&&f.events.dispatch("pointerdown",{type:"pointerdown",originalEvent:S.event,point:S.point,simulated:!0,target:f})}const M=this._keyboardDragPoint;M.x+=b,M.y+=C;const E=t.getEvent(new MouseEvent("mousemove",{clientX:M.x,clientY:M.y}),!1);f.events.isEnabled("globalpointermove")&&f.events.dispatch("globalpointermove",{type:"globalpointermove",originalEvent:E.event,point:E.point,simulated:!0,target:f})}}})),this._disposers.push(qn(p,"keyup",g=>{if(this._focusedSprite){const f=this._focusedSprite,b=g.keyCode;switch(b){case 37:case 39:case 38:case 40:if(f.isDragging()){const C=this._keyboardDragPoint,M=t.getEvent(new MouseEvent("mouseup",{clientX:C.x,clientY:C.y}));return f.events.isEnabled("globalpointerup")&&f.events.dispatch("globalpointerup",{type:"globalpointerup",originalEvent:M.event,point:M.point,simulated:!0,target:f}),void(this._keyboardDragPoint=void 0)}if(f.get("focusableGroup")){const C=f.get("focusableGroup"),M=this._tabindexes.filter(P=>P.get("focusableGroup")==C&&!1!==P.getPrivate("focusable"));let E=M.indexOf(f);const S=M.length-1;E+=39==b||40==b?1:-1,E<0?E=S:E>S&&(E=0),function Z_(s){s&&s.focus()}(M[E].getPrivate("focusElement").dom)}}}})))}this._startTicker(),this.setThemes([]),this._addTooltip(),this._hasLicense()||this._showBranding()}_initResizeSensor(){this._resizeSensorDisposer&&this._resizeSensorDisposer.dispose(),this._resizeSensorDisposer=new KC(this.dom,()=>{this.autoResize&&this.resize()}),this._disposers.push(this._resizeSensorDisposer)}resize(){const e=this._getRealSize(),t=this._getCalculatedSize(e),i=Math.floor(t.width),n=Math.floor(t.height);if(i>0&&n>0){const r=Math.floor(e.width),a=Math.floor(e.height),o=this._htmlElementContainer;if(o.style.width=i+"px",o.style.height=n+"px",!0!==this._a11yD){const c=this._focusElementContainer;c.style.width=i+"px",c.style.height=n+"px"}this._renderer.resize(r,a,i,n);const l=this._rootContainer;l.setPrivate("width",i),l.setPrivate("height",n),this._render(),this._handleLogo()}}_render(){this._renderer.render(this._rootContainer._display),this._focusElementDirty&&(this._updateCurrentFocus(),this._focusElementDirty=!1)}_runTickers(e){ye(this._tickers,t=>{t(e)})}_runAnimations(e){Md(this._animations,t=>t._runAnimation(e))}_runDirties(){let e={};for(;this._isDirtyParents;)this._isDirtyParents=!1,ys(this._dirtyParents).forEach(a=>{const o=this._dirtyParents[a];delete this._dirtyParents[a],o.isDisposed()||(e[o.uid]=o,o._prepareChildren())});ys(e).forEach(a=>{e[a]._updateChildren()});const t=[];ys(this._dirty).forEach(a=>{const o=this._dirty[a];o.isDisposed()?delete this._dirty[o.uid]:(t.push(o),o._beforeChanged())}),t.forEach(a=>{a._changed(),delete this._dirty[a.uid],a._clearDirty()}),this._isDirty=!1;const i={},n=[];ys(this._dirtyBounds).forEach(a=>{const o=this._dirtyBounds[a];delete this._dirtyBounds[a],o.isDisposed()||(i[o.uid]=o.depth(),n.push(o))}),this._positionHTMLElements(),n.sort((a,o)=>uo(i[o.uid],i[a.uid])),n.forEach(a=>{a._updateBounds()});const r=this._dirtyPositions;ys(r).forEach(a=>{const o=r[a];delete r[a],o.isDisposed()||o._updatePosition()}),t.forEach(a=>{a._afterChanged()})}_renderFrame(e){return!this._updateTick||(this.events.isEnabled("framestarted")&&this.events.dispatch("framestarted",{type:"framestarted",target:this,timestamp:e}),this._checkComputedStyles(),this._runTickers(e),this._runAnimations(e),this._runDirties(),this._render(),this._positionHTMLElements(),this.events.isEnabled("frameended")&&this.events.dispatch("frameended",{type:"frameended",target:this,timestamp:e}),0===this._tickers.length&&0===this._animations.length&&!this._isDirty)}_runTicker(e,t){this.isDisposed()||(this.animationTime=e,this._renderFrame(e)?(this._ticker=null,this.animationTime=null):this._paused||t||$y(this.fps,this._ticker))}_runTickerNow(e=1e4){if(!this.isDisposed()){const t=performance.now()+e;for(;;){const i=performance.now();if(i>=t){this.animationTime=null;break}if(this.animationTime=i,this._renderFrame(i)){this.animationTime=null;break}}}}_startTicker(){null===this._ticker&&(this.animationTime=null,this._ticker=e=>{this._runTicker(e)},$y(this.fps,this._ticker))}get updateTick(){return this._updateTick}set updateTick(e){this._updateTick=e,e&&this._startTicker()}_addDirtyEntity(e){void 0===this._dirty[e.uid]&&(this._isDirty=!0,this._dirty[e.uid]=e,this._startTicker())}_addDirtyParent(e){void 0===this._dirtyParents[e.uid]&&(this._isDirty=!0,this._isDirtyParents=!0,this._dirtyParents[e.uid]=e,this._startTicker())}_addDirtyBounds(e){void 0===this._dirtyBounds[e.uid]&&(this._isDirty=!0,this._dirtyBounds[e.uid]=e,this._startTicker())}_addDirtyPosition(e){void 0===this._dirtyPositions[e.uid]&&(this._isDirty=!0,this._dirtyPositions[e.uid]=e,this._startTicker())}_addAnimation(e){-1===this._animations.indexOf(e)&&(this._animations.push(e),this._startTicker())}_markDirty(){this._isDirty=!0}_markDirtyRedraw(){this.events.once("frameended",()=>{this._isDirty=!0,this._startTicker()})}eachFrame(e){return this._tickers.push(e),this._startTicker(),new Ds(()=>{rr(this._tickers,e)})}markDirtyGlobal(e){e||(e=this.container),e.walkChildren(t=>{t instanceof ai&&this.markDirtyGlobal(t),t.markDirty(),t.markDirtyBounds()})}width(){return Math.floor(this._getCalculatedSize(this._getRealSize()).width)}height(){return Math.floor(this._getCalculatedSize(this._getRealSize()).height)}dispose(){this._isDisposed||(this._isDisposed=!0,this._rootContainer.dispose(),this._renderer.dispose(),this.horizontalLayout.dispose(),this.verticalLayout.dispose(),this.interfaceColors.dispose(),ye(this._disposers,e=>{e.dispose()}),this._inner&&function Y_(s){s.parentNode&&s.parentNode.removeChild(s)}(this._inner),Pr(Ea.rootElements,this))}isDisposed(){return this._isDisposed}readerAlert(e){!0!==this._a11yD&&(this._readerAlertElement.innerHTML=Sd(e))}setThemes(e){this._rootContainer.set("themes",e);const t=this.tooltipContainer;t&&t._applyThemes();const i=this.interfaceColors;i&&i._applyThemes()}_addTooltip(){if(!this.tooltipContainer){const e=this._tooltipContainerSettings,t=this._rootContainer.children.push(ai.new(this,{position:"absolute",isMeasured:!1,width:vt,height:vt,layer:e?35:30,layerMargin:e||void 0}));this.tooltipContainer=t;const i=Vr.new(this,{});this.container.set("tooltip",i),i.hide(0),this._tooltip=i}}_registerTabindexOrder(e){1!=this._a11yD&&(e.get("focusable")?lo(this._tabindexes,e):Pr(this._tabindexes,e),this._invalidateTabindexes())}_unregisterTabindexOrder(e){1!=this._a11yD&&(Pr(this._tabindexes,e),this._invalidateTabindexes())}_invalidateTabindexes(){if(1==this._a11yD)return;this._tabindexes.sort((t,i)=>{const n=t.get("tabindexOrder",0),r=i.get("tabindexOrder",0);return n==r?0:n>r?1:-1});const e=[];ye(this._tabindexes,(t,i)=>{t.getPrivate("focusElement")?this._moveFocusElement(i,t):this._makeFocusElement(i,t);const n=t.get("focusableGroup");n&&!1!==t.getPrivate("focusable")&&(-1!==e.indexOf(n)?t.getPrivate("focusElement").dom.setAttribute("tabindex","-1"):e.push(n))})}_updateCurrentFocus(){1!=this._a11yD&&this._focusedSprite&&(this._decorateFocusElement(this._focusedSprite),this._positionFocusElement(this._focusedSprite))}_decorateFocusElement(e,t){if(1==this._a11yD||(t||(t=e.getPrivate("focusElement").dom),!t))return;const i=e.get("role");i?t.setAttribute("role",i):t.removeAttribute("role");const n=e.get("ariaLabel");if(n){const p=Au(e,n);t.setAttribute("aria-label",p)}else t.removeAttribute("aria-label");const r=e.get("ariaLive");r?t.setAttribute("aria-live",r):t.removeAttribute("aria-live");const a=e.get("ariaChecked");null!=a?t.setAttribute("aria-checked",a?"true":"false"):t.removeAttribute("aria-checked"),e.get("ariaHidden")?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden");const o=e.get("ariaOrientation");o?t.setAttribute("aria-orientation",o):t.removeAttribute("aria-orientation");const l=e.get("ariaValueNow");l?t.setAttribute("aria-valuenow",l):t.removeAttribute("aria-valuenow");const c=e.get("ariaValueMin");c?t.setAttribute("aria-valuemin",c):t.removeAttribute("aria-valuemin");const h=e.get("ariaValueMax");h?t.setAttribute("aria-valuemax",h):t.removeAttribute("aria-valuemax");const u=e.get("ariaValueText");u?t.setAttribute("aria-valuetext",u):t.removeAttribute("aria-valuetext");const m=e.get("ariaControls");m?t.setAttribute("aria-controls",m):t.removeAttribute("aria-controls"),e.get("visible")&&0!==e.get("opacity")&&"tooltip"!=e.get("role")&&!e.isHidden()&&!1!==e.getPrivate("focusable")?("-1"!=t.getAttribute("tabindex")&&t.setAttribute("tabindex",""+this.tabindex),t.removeAttribute("aria-hidden")):(t.removeAttribute("tabindex"),t.setAttribute("aria-hidden","true"))}_makeFocusElement(e,t){if(t.getPrivate("focusElement")||1==this._a11yD)return;const i=document.createElement("div");"tooltip"!=t.get("role")&&(i.tabIndex=this.tabindex),i.style.position="absolute",_c(i,!1);const n=[];t.setPrivate("focusElement",{dom:i,disposers:n}),this._decorateFocusElement(t),n.push(qn(i,"focus",r=>{this._handleFocus(r,e)})),n.push(qn(i,"blur",r=>{this._handleBlur(r,e)})),this._moveFocusElement(e,t)}_removeFocusElement(e){if(1==this._a11yD)return;Pr(this._tabindexes,e);const t=e.getPrivate("focusElement");t&&(this._focusElementContainer.removeChild(t.dom),ye(t.disposers,n=>{n.dispose()}))}_hideFocusElement(e){1!=this._a11yD&&(e.getPrivate("focusElement").dom.style.display="none")}_moveFocusElement(e,t){if(1==this._a11yD)return;const i=this._focusElementContainer,n=t.getPrivate("focusElement").dom;if(n===this._focusElementContainer.children[e])return;const r=this._focusElementContainer.children[e+1];r?i.insertBefore(n,r):i.append(n)}_positionFocusElement(e){if(1==this._a11yD||null==e)return;const t=e.globalBounds();let i=t.right==t.left?e.width():t.right-t.left,n=t.top==t.bottom?e.height():t.bottom-t.top;const r=void 0!==this._settings.focusPadding?this._settings.focusPadding:2;let a=t.left-r,o=t.top-r;i<0&&(a+=i,i=Math.abs(i)),n<0&&(o+=n,n=Math.abs(n));const l=e.getPrivate("focusElement").dom;l.style.top=o+"px",l.style.left=a+"px",l.style.width=i+2*r+"px",l.style.height=n+2*r+"px"}_handleFocus(e,t){if(1==this._a11yD)return;const i=this._tabindexes[t];i.isVisibleDeep()?(this._positionFocusElement(i),this._focusedSprite=i,i.events.isEnabled("focus")&&i.events.dispatch("focus",{type:"focus",originalEvent:e,target:i})):this._focusNext(e.target,this._isShift?-1:1)}_focusNext(e,t){if(1==this._a11yD)return;const i=Array.from(document.querySelectorAll(["a[href]","area[href]","button:not([disabled])","details","input:not([disabled])","iframe:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[contentEditable=""]','[contentEditable="true"]','[contentEditable="TRUE"]','[tabindex]:not([tabindex^="-"])'].join(",")));let n=i.indexOf(e)+t;n<0?n=i.length-1:n>=i.length&&(n=0),i[n].focus()}_handleBlur(e,t){if(1==this._a11yD)return;const i=this._focusedSprite;i&&!i.isDisposed()&&i.events.isEnabled("blur")&&i.events.dispatch("blur",{type:"blur",originalEvent:e,target:i}),this._focusedSprite=void 0}updateTooltip(e){if(1==this._a11yD)return;const t=Sd(e._getText());let i=e.getPrivate("tooltipElement");"tooltip"==e.get("role")&&""!=t?(i||(i=this._makeTooltipElement(e)),i.innerHTML!=t&&(i.innerHTML=t)):i&&(i.remove(),e.removePrivate("tooltipElement"))}_makeTooltipElement(e){const t=this._tooltipElementContainer,i=document.createElement("div");return i.style.position="absolute",i.style.width="1px",i.style.height="1px",i.style.overflow="hidden",i.style.clip="rect(1px, 1px, 1px, 1px)",_c(i,!1),this._decorateFocusElement(e,i),t.append(i),e.setPrivate("tooltipElement",i),i}_removeTooltipElement(e){if(1==this._a11yD)return;const t=e.getPrivate("tooltipElement");if(t){const i=t.parentElement;i&&i.removeChild(t)}}_invalidateAccessibility(e){if(1==this._a11yD)return;this._focusElementDirty=!0;const t=e.getPrivate("focusElement");e.get("focusable")?t&&(this._decorateFocusElement(e),this._positionFocusElement(e)):t&&this._removeFocusElement(e)}focused(e){return this._focusedSprite===e}documentPointToRoot(e){const t=this._getRealSize(),i=this._getCalculatedSize(t);return{x:i.width/t.width*(e.x-t.left),y:i.height/t.height*(e.y-t.top)}}rootPointToDocument(e){const t=this._getRealSize(),i=this._getCalculatedSize(t);return{x:e.x/(i.width/t.width)+t.left,y:e.y/(i.height/t.height)+t.top}}addDisposer(e){return this._disposers.push(e),e}_updateComputedStyles(){const e=window.getComputedStyle(this.dom);let t="";en(e,(n,r)=>{Ml(n)&&n.match(/^font/)&&(t+=r)});const i=t!=this._fontHash;return i&&(this._fontHash=t),i}_checkComputedStyles(){this._updateComputedStyles()&&this._invalidateLabelBounds(this.container)}_invalidateLabelBounds(e){e instanceof ai?e.children.each(t=>{this._invalidateLabelBounds(t)}):e instanceof Mc&&e.markDirtyBounds()}_hasLicense(){for(let e=0;e<Ea.licenses.length;e++)if(Ea.licenses[e].match(/^AM5C.{5,}/i))return!0;return!1}_licenseApplied(){this._logo&&this._logo.set("forceHidden",!0)}get debugGhostView(){return this._renderer.debugGhostView}set debugGhostView(e){this._renderer.debugGhostView=e}set tapToActivate(e){this._renderer.tapToActivate=e}get tapToActivate(){return this._renderer.tapToActivate}set tapToActivateTimeout(e){this._renderer.tapToActivateTimeout=e}get tapToActivateTimeout(){return this._renderer.tapToActivateTimeout}_makeHTMLElement(e){const t=this._htmlElementContainer,i=document.createElement("div");return e.setPrivate("htmlElement",i),i.style.position="absolute",i.style.overflow="auto",i.style.boxSizing="border-box",_c(i,e.get("interactive",!1)),e.events.isEnabled("click")&&(_c(i,!0),this._disposers.push(qn(i,"click",n=>{const r=this._renderer.getEvent(n);e.events.dispatch("click",{type:"click",originalEvent:r.event,point:r.point,simulated:!1,target:e})}))),this._positionHTMLElement(e),t.append(i),lo(this._htmlEnabledContainers,e),i}_positionHTMLElements(){ye(this._htmlEnabledContainers,e=>{this._positionHTMLElement(e)})}_positionHTMLElement(e){const t=e.getPrivate("htmlElement");if(t){ye(["paddingTop","paddingRight","paddingBottom","paddingLeft","minWidth","minHeight","maxWidth","maxHeight"],u=>{const m=e.get(u);t.style[u]=m?m+"px":""});const n=e.compositeOpacity();setTimeout(()=>{t.style.opacity=n+""},10);const r=e.isVisibleDeep();r&&(t.style.display="block");const a=e.globalBounds();t.style.top=a.top+"px",t.style.left=a.left+"px";const o=e.get("width"),l=e.get("height");let c=0,h=0;if(o&&(c=e.width()),l&&(h=e.height()),o&&l)e.removePrivate("minWidth"),e.removePrivate("minHeight");else{t.style.position="fixed",t.style.width="",t.style.height="";const u=t.getBoundingClientRect();t.style.position="absolute",c=u.width,h=u.height,e._adjustedLocalBounds={left:0,right:0,top:0,bottom:0},e.setPrivate("minWidth",c),e.setPrivate("minHeight",h)}c>0&&(t.style.minWidth=c+"px"),h>0&&(t.style.minHeight=h+"px"),(!r||0==n)&&(t.style.display="none")}}_setHTMLContent(e,t){let i=e.getPrivate("htmlElement");i||(i=this._makeHTMLElement(e)),i.innerHTML!=t&&(i.innerHTML=t)}_removeHTMLContent(e){let t=e.getPrivate("htmlElement");t&&(this._htmlElementContainer.removeChild(t),e.removePrivate("htmlElement")),Pr(this._htmlEnabledContainers,e)}}class Tc extends zs{constructor(){super(...arguments),Object.defineProperty(this,"_index",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"series",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){super._afterNewApplyThemes()}_beforeChanged(){if(super._beforeChanged(),this.isDirty("sprite")){const e=this.get("sprite");e&&(e.setAll({position:"absolute",role:"figure"}),this._disposers.push(e))}(this.isDirty("locationX")||this.isDirty("locationY"))&&this.series&&this.series._positionBullet(this)}}Object.defineProperty(Tc,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Bullet"}),Object.defineProperty(Tc,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:zs.classNames.concat([Tc.className])});class Nd extends rn{_afterNew(){super._afterNew(),this._display.isMeasured=!0,this.setPrivateRaw("trustBounds",!0)}_beforeChanged(){super._beforeChanged(),this.isDirty("radius")&&(this._clear=!0)}_changed(){super._changed(),this._clear&&this._display.drawCircle(0,0,this.get("radius",10))}}Object.defineProperty(Nd,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Circle"}),Object.defineProperty(Nd,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:rn.classNames.concat([Nd.className])});class Ud extends zs{_afterNew(){super._afterNewApplyThemes(),this._dirty.colors=!1}_beforeChanged(){this.isDirty("colors")&&this.reset()}generateColors(){this.setPrivate("currentPass",this.getPrivate("currentPass",0)+1);const e=this.getPrivate("currentPass"),t=this.get("colors",[this.get("baseColor",ei.fromHex(16711680))]);this.getPrivate("numColors")||this.setPrivate("numColors",t.length);const i=this.getPrivate("numColors"),r=this.get("passOptions"),a=this.get("reuse");for(let o=0;o<i;o++)if(a)t.push(t[o]);else{const l=t[o].toHSL();let c=l.h+(r.hue||0)*e;for(;c>1;)c-=1;let h=l.s+(r.saturation||0)*e;h>1&&(h=1),h<0&&(h=0);let u=l.l+(r.lightness||0)*e;for(;u>1;)u-=1;t.push(ei.fromHSL(c,h,u))}}getIndex(e){const t=this.get("colors",[]),i=this.get("saturation");return e>=t.length?(this.generateColors(),this.getIndex(e)):null!=i?ei.saturate(t[e],i):t[e]}next(){let e=this.getPrivate("currentStep",this.get("startIndex",0));return this.setPrivate("currentStep",e+this.get("step",1)),this.getIndex(e)}reset(){this.setPrivate("currentStep",this.get("startIndex",0)),this.setPrivate("currentPass",0)}}Object.defineProperty(Ud,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ColorSet"}),Object.defineProperty(Ud,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:zs.classNames.concat([Ud.className])});let xb={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:2629742400,year:31536e6};function Ky(s){switch(s){case"year":return;case"month":return"year";case"week":case"day":return"month";case"hour":return"day";case"minute":return"hour";case"second":return"minute";case"millisecond":return"second"}}function Wr(s,e){return null==e&&(e=1),xb[s]*e}function mo(s){return s?xb[s.timeUnit]*s.count:0}function wb(s,e,t,i,n){const r=s.timeUnit,a=s.count;if("hour"==r||"minute"==r||"second"==r||"millisecond"==r)return xb[s.timeUnit]*s.count;{const o=zd(new Date(e.getTime()),r,a,t,i,void 0,n).getTime();let l=o+a*Wr(r)*1.05;return l=zd(new Date(l),r,1,t,i,void 0,n).getTime(),l-o}}function Jy(s,e,t,i,n){if(e-s>Wr(t,1.2))return!0;let r=new Date(s),a=new Date(e);n&&(r=n.convertLocal(r),a=n.convertLocal(a));let o=0,l=0;!i&&"millisecond"!=t&&(o=r.getTimezoneOffset(),r.setUTCMinutes(r.getUTCMinutes()-o),l=a.getTimezoneOffset(),a.setUTCMinutes(a.getUTCMinutes()-l));let c=!1;switch(t){case"year":r.getUTCFullYear()!=a.getUTCFullYear()&&(c=!0);break;case"month":(r.getUTCFullYear()!=a.getUTCFullYear()||r.getUTCMonth()!=a.getUTCMonth())&&(c=!0);break;case"day":(r.getUTCMonth()!=a.getUTCMonth()||r.getUTCDate()!=a.getUTCDate())&&(c=!0);break;case"hour":r.getUTCHours()!=a.getUTCHours()&&(c=!0);break;case"minute":r.getUTCMinutes()!=a.getUTCMinutes()&&(c=!0);break;case"second":r.getUTCSeconds()!=a.getUTCSeconds()&&(c=!0);break;case"millisecond":r.getTime()!=a.getTime()&&(c=!0)}if(c)return c;let h=Ky(t);return!!h&&Jy(s,e,h,i,n)}function Gr(s,e,t,i,n){let r;return null!=n&&(r=new Date(n)),zd(new Date(s),e,t,i.locale.firstDayOfWeek,i.utc,r,i.timezone).getTime()}function zd(s,e,t,i,n,r,a){if(!a||n){let o=0;switch(!n&&"millisecond"!=e&&(o=s.getTimezoneOffset(),s.setUTCMinutes(s.getUTCMinutes()-o)),e){case"day":let l=s.getUTCDate();if(t>1){if(r){r=zd(r,"day",1);let b=s.getTime()-r.getTime(),C=Math.floor(b/Wr("day")/t),M=Wr("day",C*t);s.setTime(r.getTime()+M-o*Wr("minute"))}}else s.setUTCDate(l);s.setUTCHours(0,0,0,0);break;case"second":let c=s.getUTCSeconds();t>1&&(c=Math.floor(c/t)*t),s.setUTCSeconds(c,0);break;case"millisecond":if(1==t)return s;let h=s.getUTCMilliseconds();h=Math.floor(h/t)*t,s.setUTCMilliseconds(h);break;case"hour":let u=s.getUTCHours();t>1&&(u=Math.floor(u/t)*t),s.setUTCHours(u,0,0,0);break;case"minute":let m=s.getUTCMinutes();t>1&&(m=Math.floor(m/t)*t),s.setUTCMinutes(m,0,0);break;case"month":let p=s.getUTCMonth();t>1&&(p=Math.floor(p/t)*t),s.setUTCMonth(p,1),s.setUTCHours(0,0,0,0);break;case"year":let _=s.getUTCFullYear();t>1&&(_=Math.floor(_/t)*t),s.setUTCFullYear(_,0,1),s.setUTCHours(0,0,0,0);break;case"week":let g=s.getUTCDate(),f=s.getUTCDay();Se(i)||(i=1),g=f>=i?g-f+i:g-(7+f)+i,s.setUTCDate(g),s.setUTCHours(0,0,0,0)}if(!n&&"millisecond"!=e&&(s.setUTCMinutes(s.getUTCMinutes()+o),"day"==e||"week"==e||"month"==e||"year"==e)){let l=s.getTimezoneOffset();if(l!=o){let c=l-o;s.setUTCMinutes(s.getUTCMinutes()+c)}}return s}{if(isNaN(s.getTime()))return s;let o=a.offsetUTC(s),l=s.getTimezoneOffset(),c=a.parseDate(s),h=c.year,u=c.month,m=c.day,p=c.hour,_=c.minute,g=c.second,f=c.millisecond,b=c.weekday,C=o-l;switch(e){case"day":if(t>1&&r){r=zd(r,"day",1,i,n,void 0,a);let P=s.getTime()-r.getTime(),I=Math.floor(P/Wr("day")/t),L=Wr("day",I*t);s.setTime(r.getTime()+L),c=a.parseDate(s),h=c.year,u=c.month,m=c.day}p=0,_=C,g=0,f=0;break;case"second":_+=C,t>1&&(g=Math.floor(g/t)*t),f=0;break;case"millisecond":_+=C,t>1&&(f=Math.floor(f/t)*t);break;case"hour":t>1&&(p=Math.floor(p/t)*t),_=C,g=0,f=0;break;case"minute":t>1&&(_=Math.floor(_/t)*t),_+=C,g=0,f=0;break;case"month":t>1&&(u=Math.floor(u/t)*t),m=1,p=0,_=C,g=0,f=0;break;case"year":t>1&&(h=Math.floor(h/t)*t),u=0,m=1,p=0,_=C,g=0,f=0;break;case"week":Se(i)||(i=1),m=b>=i?m-b+i:m-(7+b)+i,p=0,_=C,g=0,f=0}let M=(s=new Date(h,u,m,p,_,g,f)).getTimezoneOffset(),S=a.offsetUTC(s)-M;return S!=C&&s.setTime(s.getTime()+6e4*(S-C)),s}}function Mb(s,e,t,i){let r=mo(i[s]),a=i.length-1;if(s>=a)return Object.assign({},i[a]);let o=Math.ceil(e/r);return e<r&&s>0?Object.assign({},i[s-1]):o<=t?Object.assign({},i[s]):s+1<i.length?Mb(s+1,e,t,i):Object.assign({},i[s])}class VD extends Pu{setupDefaultRules(){super.setupDefaultRules();const e=this._root.interfaceColors,t=this._root.language,i=this.rule.bind(this);i("XYChart").setAll({colors:Ud.new(this._root,{}),paddingLeft:20,paddingRight:20,paddingTop:16,paddingBottom:16,panX:!1,panY:!1,wheelStep:.25,arrangeTooltips:!0,pinchZoomX:!1,pinchZoomY:!1}),i("XYSeries").setAll({legendLabelText:"{name}"}),i("XYChart",["scrollbar","chart"]).setAll({paddingBottom:0,paddingLeft:0,paddingTop:0,paddingRight:0,colors:Ud.new(this._root,{saturation:0})});{const l=i("Graphics",["scrollbar","overlay"]);l.setAll({fillOpacity:.5}),ti(l,"fill",e,"background")}i("RoundedRectangle",["xy","scrollbar","thumb"]).setAll({cornerRadiusTR:0,cornerRadiusTL:0,cornerRadiusBR:0,cornerRadiusBL:0,fillOpacity:0,focusable:!0}),i("RoundedRectangle",["xy","scrollbar","thumb"]).states.create("hover",{fillOpacity:.4}),i("RoundedRectangle",["xy","scrollbar","chart","background"]).setAll({cornerRadiusTL:0,cornerRadiusBL:0,cornerRadiusTR:0,cornerRadiusBR:0}),i("RoundedRectangle",["xy","scrollbar","chart","background","resize","button"]).setAll({cornerRadiusBL:40,cornerRadiusBR:40,cornerRadiusTL:40,cornerRadiusTR:40}),i("AxisRendererX",["xy","chart","scrollbar"]).setAll({strokeOpacity:0,inside:!0}),i("AxisRendererY",["xy","chart","scrollbar"]).setAll({strokeOpacity:0,inside:!0,minGridDistance:5}),i("AxisLabel",["xy","scrollbar","x"]).setAll({opacity:.5,centerY:vt,minPosition:.01,maxPosition:.99,fontSize:"0.8em"}),i("AxisLabel",["category"]).setAll({text:"{category}",populateText:!0}),i("AxisLabel",["x"]).setAll({centerY:0}),i("AxisLabel",["x","inside"]).setAll({centerY:vt}),i("AxisLabel",["x","inside","opposite"]).setAll({centerY:0}),i("AxisLabel",["x","opposite"]).setAll({centerY:vt}),i("AxisLabel",["y"]).setAll({centerX:vt}),i("AxisLabel",["y","inside"]).setAll({centerX:0}),i("AxisLabel",["y","inside","opposite"]).setAll({centerX:vt}),i("AxisLabel",["y","opposite"]).setAll({centerX:0}),i("AxisLabel",["minor"]).setAll({fontSize:"0.6em"}),i("AxisLabel",["xy","scrollbar","y"]).setAll({visible:!1}),i("Grid",["xy","scrollbar","y"]).setAll({visible:!1}),i("Grid",["xy","scrollbar","x"]).setAll({opacity:.5}),i("XYCursor").setAll({behavior:"none",layer:30,exportable:!1,snapToSeriesBy:"xy",moveThreshold:1});{const l=i("Grid",["cursor","x"]);l.setAll({strokeOpacity:.8,strokeDasharray:[2,2],ariaLabel:t.translate("Use left and right arrows to move selection")}),ti(l,"stroke",e,"alternativeBackground")}{const l=i("Grid",["cursor","y"]);l.setAll({strokeOpacity:.8,strokeDasharray:[2,2],ariaLabel:t.translate("Use up and down arrows to move selection")}),ti(l,"stroke",e,"alternativeBackground")}{const l=i("Graphics",["cursor","selection"]);l.setAll({fillOpacity:.15}),ti(l,"fill",e,"alternativeBackground")}i("Axis").setAll({start:0,end:1,minZoomCount:1,maxZoomCount:1/0,maxZoomFactor:1e3,maxDeviation:.1,snapTooltip:!0,tooltipLocation:.5,panX:!0,panY:!0,zoomX:!0,zoomY:!0,fixAxisSize:!0}),i("AxisLabel").setAll({location:.5,multiLocation:0,centerX:wi,centerY:wi,paddingTop:3,paddingBottom:3,paddingLeft:5,paddingRight:5}),i("Container",["axis","header"]).setAll({layer:30}),i("Rectangle",["axis","header","background"]).setAll({crisp:!0});{const l=i("AxisRenderer");l.setAll({crisp:!0,strokeOpacity:0}),ti(l,"stroke",e,"grid")}i("AxisRendererX").setAll({minGridDistance:120,opposite:!1,inversed:!1,cellStartLocation:0,cellEndLocation:1,width:vt}),i("AxisRendererY").setAll({minGridDistance:40,opposite:!1,inversed:!1,cellStartLocation:0,cellEndLocation:1,height:vt});{const l=i("Rectangle",["axis","thumb"]);l.setAll({fillOpacity:0}),ti(l,"fill",e,"alternativeBackground"),l.states.create("hover",{fillOpacity:.1})}i("Rectangle",["axis","thumb","x"]).setAll({cursorOverStyle:"ew-resize"}),i("Rectangle",["axis","thumb","y"]).setAll({cursorOverStyle:"ns-resize"});{const l=i("Grid");l.setAll({location:0,strokeOpacity:.15,crisp:!0}),ti(l,"stroke",e,"grid")}{const l=i("Grid",["minor"]);l.setAll({location:0,strokeOpacity:.07,crisp:!0}),ti(l,"stroke",e,"grid")}i("Grid",["base"]).setAll({strokeOpacity:.3});{const l=i("Graphics",["axis","fill"]);l.setAll({visible:!1,isMeasured:!1,position:"absolute",fillOpacity:.05}),ti(l,"fill",e,"alternativeBackground")}i("Graphics",["axis","fill","range"]).setAll({isMeasured:!0}),i("Graphics",["series","fill","range"]).setAll({visible:!1,isMeasured:!0}),i("Grid",["series","range"]).setAll({visible:!1}),i("AxisTick",["series","range"]).setAll({visible:!1}),i("AxisLabel",["series","range"]).setAll({visible:!1});{const l=i("AxisTick");l.setAll({location:.5,multiLocation:0,strokeOpacity:1,isMeasured:!1,position:"absolute",visible:!1}),ti(l,"stroke",e,"grid")}i("CategoryAxis").setAll({startLocation:0,endLocation:1,fillRule:(l,c)=>{const h=l.get("axisFill");h&&(Se(c)&&c%2!=0?h.setPrivate("visible",!1):h.setPrivate("visible",!0))}});const n=[{timeUnit:"millisecond",count:1},{timeUnit:"millisecond",count:5},{timeUnit:"millisecond",count:10},{timeUnit:"millisecond",count:50},{timeUnit:"millisecond",count:100},{timeUnit:"millisecond",count:500},{timeUnit:"second",count:1},{timeUnit:"second",count:5},{timeUnit:"second",count:10},{timeUnit:"second",count:30},{timeUnit:"minute",count:1},{timeUnit:"minute",count:5},{timeUnit:"minute",count:10},{timeUnit:"minute",count:15},{timeUnit:"minute",count:30},{timeUnit:"hour",count:1},{timeUnit:"hour",count:3},{timeUnit:"hour",count:6},{timeUnit:"hour",count:12},{timeUnit:"day",count:1},{timeUnit:"day",count:2},{timeUnit:"day",count:3},{timeUnit:"day",count:4},{timeUnit:"day",count:5},{timeUnit:"week",count:1},{timeUnit:"month",count:1},{timeUnit:"month",count:2},{timeUnit:"month",count:3},{timeUnit:"month",count:6},{timeUnit:"year",count:1},{timeUnit:"year",count:2},{timeUnit:"year",count:5},{timeUnit:"year",count:10},{timeUnit:"year",count:50},{timeUnit:"year",count:100},{timeUnit:"year",count:200},{timeUnit:"year",count:500},{timeUnit:"year",count:1e3},{timeUnit:"year",count:2e3},{timeUnit:"year",count:5e3},{timeUnit:"year",count:1e4},{timeUnit:"year",count:1e5}],r={millisecond:t.translate("_date_millisecond"),second:t.translate("_date_second"),minute:t.translate("_date_minute"),hour:t.translate("_date_hour"),day:t.translate("_date_day"),week:t.translate("_date_day"),month:t.translate("_date_month"),year:t.translate("_date_year")},a={millisecond:t.translate("_date_millisecond"),second:t.translate("_date_second"),minute:t.translate("_date_minute"),hour:t.translate("_date_day"),day:t.translate("_date_day"),week:t.translate("_date_day"),month:t.translate("_date_month")+" "+t.translate("_date_year"),year:t.translate("_date_year")},o={millisecond:t.translate("_date_millisecond_full"),second:t.translate("_date_second_full"),minute:t.translate("_date_minute_full"),hour:t.translate("_date_hour_full"),day:t.translate("_date_day_full"),week:t.translate("_date_week_full"),month:t.translate("_date_month_full"),year:t.translate("_date_year")};i("CategoryDateAxis").setAll({markUnitChange:!0,gridIntervals:vd(n),dateFormats:zo(r),periodChangeDateFormats:zo(a)}),i("DateAxis").setAll({maxZoomFactor:null,strictMinMax:!0,startLocation:0,endLocation:1,markUnitChange:!0,groupData:!1,groupCount:500,gridIntervals:vd(n),dateFormats:zo(r),periodChangeDateFormats:zo(a),tooltipDateFormats:o,groupIntervals:[{timeUnit:"millisecond",count:1},{timeUnit:"millisecond",count:10},{timeUnit:"millisecond",count:100},{timeUnit:"second",count:1},{timeUnit:"second",count:10},{timeUnit:"minute",count:1},{timeUnit:"minute",count:10},{timeUnit:"hour",count:1},{timeUnit:"day",count:1},{timeUnit:"week",count:1},{timeUnit:"month",count:1},{timeUnit:"year",count:1}],fillRule:l=>{const c=l.get("axisFill");if(c){const h=l.component,u=l.get("value"),m=l.get("endValue"),p=h.intervalDuration(),_=h.getPrivate("baseInterval"),g=h.getPrivate("gridInterval",_);let f=h.getPrivate("min",0);if(f=zd(new Date(f),g.timeUnit,g.count,this._root.locale.firstDayOfWeek,this._root.utc,void 0,this._root.timezone).getTime(),null!=u&&null!=m){const b=Math.round(Math.round((u-f)/p))/2;b==Math.round(b)?c.setPrivate("visible",!0):c.setPrivate("visible",!1)}}}}),i("GaplessDateAxis").setAll({fillRule:l=>{const c=l.get("axisFill");if(c){const h=l.get("index");let u=!1;(!Se(h)||h%2==0)&&(u=!0),c.setPrivate("visible",u)}}}),i("ValueAxis").setAll({baseValue:0,logarithmic:!1,strictMinMax:!1,autoZoom:!0,fillRule:l=>{const c=l.get("axisFill");if(c){const h=l.component,u=l.get("value"),m=h.getPrivate("step");Se(u)&&Se(m)&&(fr(u/m/2,5)==Math.round(u/m/2)?c.setPrivate("visible",!1):c.setPrivate("visible",!0))}}}),i("DurationAxis").setAll({baseUnit:"second"}),i("XYSeries").setAll({maskBullets:!0,stackToNegative:!0,locationX:.5,locationY:.5,snapTooltip:!1,openValueXGrouped:"open",openValueYGrouped:"open",valueXGrouped:"close",valueYGrouped:"close",seriesTooltipTarget:"series"}),i("BaseColumnSeries").setAll({adjustBulletPosition:!0}),i("ColumnSeries").setAll({clustered:!0}),i("RoundedRectangle",["series","column"]).setAll({position:"absolute",isMeasured:!1,width:ln(70),height:ln(70),strokeWidth:1,strokeOpacity:1,cornerRadiusBL:0,cornerRadiusTL:0,cornerRadiusBR:0,cornerRadiusTR:0,fillOpacity:1,role:"figure"}),i("LineSeries").setAll({connect:!0,autoGapCount:1.1,stackToNegative:!1}),i("Graphics",["series","stroke"]).setAll({position:"absolute",strokeWidth:1,strokeOpacity:1,isMeasured:!1}),i("Graphics",["series","fill"]).setAll({visible:!1,fillOpacity:0,position:"absolute",strokeWidth:0,strokeOpacity:0,isMeasured:!1}),i("Graphics",["line","series","legend","marker","stroke"]).setAll({draw:(l,c)=>{const h=c.parent;if(h){const u=h.height(),m=h.width();l.moveTo(0,u/2),l.lineTo(m,u/2)}}}),ti(i("Graphics",["line","series","legend","marker","stroke"]).states.create("disabled",{}),"stroke",e,"disabled"),i("Graphics",["line","series","legend","marker","fill"]).setAll({draw:(l,c)=>{const h=c.parent;if(h){const u=h.height(),m=h.width();l.moveTo(0,0),l.lineTo(m,0),l.lineTo(m,u),l.lineTo(0,u),l.lineTo(0,0)}}}),ti(i("Graphics",["line","series","legend","marker","fill"]).states.create("disabled",{}),"stroke",e,"disabled"),i("SmoothedXYLineSeries").setAll({tension:.5}),i("SmoothedXLineSeries").setAll({tension:.5}),i("SmoothedYLineSeries").setAll({tension:.5}),i("Candlestick").setAll({position:"absolute",isMeasured:!1,width:ln(50),height:ln(50),strokeWidth:1,strokeOpacity:1,cornerRadiusBL:0,cornerRadiusTL:0,cornerRadiusBR:0,cornerRadiusTR:0,fillOpacity:1,role:"figure"}),i("OHLC").setAll({width:ln(80),height:ln(80)}),i("CandlestickSeries").setAll({lowValueXGrouped:"low",lowValueYGrouped:"low",highValueXGrouped:"high",highValueYGrouped:"high",openValueXGrouped:"open",openValueYGrouped:"open",valueXGrouped:"close",valueYGrouped:"close"});{const l=i("Rectangle",["column","autocolor"]).states.create("riseFromOpen",{});ti(l,"fill",e,"positive"),ti(l,"stroke",e,"positive")}{const l=i("Rectangle",["column","autocolor"]).states.create("dropFromOpen",{});ti(l,"fill",e,"negative"),ti(l,"stroke",e,"negative")}i("Rectangle",["column","autocolor","pro"]).states.create("riseFromOpen",{fillOpacity:0}),i("Rectangle",["column","autocolor","pro"]).states.create("dropFromOpen",{fillOpacity:1});{const l=i("Rectangle",["column","autocolor","pro"]).states.create("riseFromPrevious",{});ti(l,"fill",e,"positive"),ti(l,"stroke",e,"positive")}{const l=i("Rectangle",["column","autocolor","pro"]).states.create("dropFromPrevious",{});ti(l,"fill",e,"negative"),ti(l,"stroke",e,"negative")}i("RoundedRectangle",["rangegrip"]).setAll({strokeOpacity:0,fillOpacity:0,strokeWidth:1,width:12,height:12});{const l=i("Graphics",["rangegrip","button","icon"]);l.setAll({interactive:!1,crisp:!0,strokeOpacity:.5,draw:c=>{c.moveTo(0,.5),c.lineTo(0,12.5),c.moveTo(2,.5),c.lineTo(2,12.5),c.moveTo(4,.5),c.lineTo(4,12.5)}}),ti(l,"stroke",e,"secondaryButtonText")}i("Button",["rangegrip"]).setAll({draggable:!0,paddingTop:0,paddingBottom:0}),i("Button",["rangegrip","vertical"]).setAll({rotation:90,cursorOverStyle:"ns-resize",centerX:wi}),i("Button",["rangegrip","horizontal"]).setAll({cursorOverStyle:"ew-resize",centerX:wi}),i("Button",["rangegrip","vertical","left"]).setAll({centerY:vt}),i("Button",["rangegrip","vertical","right"]).setAll({centerY:0}),i("Button",["rangegrip","horizontal","top"]).setAll({centerY:0}),i("Button",["rangegrip","horizontal","bottom"]).setAll({centerY:vt})}}class Lu extends ai{constructor(){super(...arguments),Object.defineProperty(this,"chartContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(ai.new(this._root,{width:vt,height:vt,interactiveChildren:!1}))}),Object.defineProperty(this,"bulletsContainer",{enumerable:!0,configurable:!0,writable:!0,value:ai.new(this._root,{interactiveChildren:!1,isMeasured:!1,position:"absolute",width:vt,height:vt})})}}Object.defineProperty(Lu,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Chart"}),Object.defineProperty(Lu,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ai.classNames.concat([Lu.className])});class Cc extends Lu{constructor(){super(...arguments),Object.defineProperty(this,"seriesContainer",{enumerable:!0,configurable:!0,writable:!0,value:ai.new(this._root,{width:vt,height:vt,isMeasured:!1})}),Object.defineProperty(this,"series",{enumerable:!0,configurable:!0,writable:!0,value:new Cd})}_afterNew(){super._afterNew(),this._disposers.push(this.series);const e=this.seriesContainer.children;this._disposers.push(this.series.events.onAll(t=>{if("clear"===t.type){ye(t.oldValues,n=>{this._removeSeries(n)});const i=this.get("colors");i&&i.reset()}else if("push"===t.type)e.moveValue(t.newValue),this._processSeries(t.newValue);else if("setIndex"===t.type)e.setIndex(t.index,t.newValue),this._processSeries(t.newValue);else if("insertIndex"===t.type)e.insertIndex(t.index,t.newValue),this._processSeries(t.newValue);else if("removeIndex"===t.type)this._removeSeries(t.oldValue);else{if("moveIndex"!==t.type)throw new Error("Unknown IListEvent type");e.moveValue(t.value,t.newIndex),this._processSeries(t.value)}}))}_processSeries(e){e.chart=this,e._placeBulletsContainer(this)}_removeSeries(e){e.isDisposed()||(this.seriesContainer.children.removeValue(e),e._removeBulletsContainer())}}Object.defineProperty(Cc,"className",{enumerable:!0,configurable:!0,writable:!0,value:"SerialChart"}),Object.defineProperty(Cc,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Lu.classNames.concat([Cc.className])});class po extends ca{_beforeChanged(){super._beforeChanged(),(this.isDirty("cornerRadiusTL")||this.isDirty("cornerRadiusTR")||this.isDirty("cornerRadiusBR")||this.isDirty("cornerRadiusBL"))&&(this._clear=!0)}_draw(){let e=this.width(),t=this.height(),i=e,n=t,r=i/Math.abs(e),a=n/Math.abs(t);if(Se(i)&&Se(n)){let o=Math.min(i,n)/2,l=Oi(this.get("cornerRadiusTL",8),o),c=Oi(this.get("cornerRadiusTR",8),o),h=Oi(this.get("cornerRadiusBR",8),o),u=Oi(this.get("cornerRadiusBL",8),o),m=Math.min(Math.abs(i/2),Math.abs(n/2));l=Hs(l,0,m),c=Hs(c,0,m),h=Hs(h,0,m),u=Hs(u,0,m);const p=this._display;p.moveTo(l*r,0),p.lineTo(i-c*r,0),c>0&&p.arcTo(i,0,i,c*a,c),p.lineTo(i,n-h*a),h>0&&p.arcTo(i,n,i-h*r,n,h),p.lineTo(u*r,n),u>0&&p.arcTo(0,n,0,n-u*a,u),p.lineTo(0,l*a),l>0&&p.arcTo(0,0,l*r,0,l),p.closePath()}}}Object.defineProperty(po,"className",{enumerable:!0,configurable:!0,writable:!0,value:"RoundedRectangle"}),Object.defineProperty(po,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ca.classNames.concat([po.className])});class Fu extends ai{_afterNew(){this._settings.themeTags=ki(this._settings.themeTags,["button"]),super._afterNew(),this._settings.background||this.set("background",po.new(this._root,{themeTags:ki(this._settings.themeTags,["background"])})),this.setPrivate("trustBounds",!0)}_prepareChildren(){if(super._prepareChildren(),this.isDirty("icon")){const e=this._prevSettings.icon,t=this.get("icon");t!==e&&(this._disposeProperty("icon"),e&&e.dispose(),t&&this.children.push(t),this._prevSettings.icon=t)}if(this.isDirty("label")){const e=this._prevSettings.label,t=this.get("label");t!==e&&(this._disposeProperty("label"),e&&e.dispose(),t&&this.children.push(t),this._prevSettings.label=t)}}}Object.defineProperty(Fu,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Button"}),Object.defineProperty(Fu,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ai.classNames.concat([Fu.className])});class ja extends Cc{constructor(){super(...arguments),Object.defineProperty(this,"xAxes",{enumerable:!0,configurable:!0,writable:!0,value:new Cd}),Object.defineProperty(this,"yAxes",{enumerable:!0,configurable:!0,writable:!0,value:new Cd}),Object.defineProperty(this,"topAxesContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.chartContainer.children.push(ai.new(this._root,{width:vt,layout:this._root.verticalLayout}))}),Object.defineProperty(this,"yAxesAndPlotContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.chartContainer.children.push(ai.new(this._root,{width:vt,height:vt,layout:this._root.horizontalLayout}))}),Object.defineProperty(this,"bottomAxesContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.chartContainer.children.push(ai.new(this._root,{width:vt,layout:this._root.verticalLayout}))}),Object.defineProperty(this,"leftAxesContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.yAxesAndPlotContainer.children.push(ai.new(this._root,{height:vt,layout:this._root.horizontalLayout}))}),Object.defineProperty(this,"plotsContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.yAxesAndPlotContainer.children.push(ai.new(this._root,{width:vt,height:vt,maskContent:!1}))}),Object.defineProperty(this,"plotContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.plotsContainer.children.push(ai.new(this._root,{width:vt,height:vt}))}),Object.defineProperty(this,"topPlotContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.plotsContainer.children.push(ai.new(this._root,{width:vt,height:vt}))}),Object.defineProperty(this,"gridContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.plotContainer.children.push(ai.new(this._root,{width:vt,height:vt,isMeasured:!1}))}),Object.defineProperty(this,"topGridContainer",{enumerable:!0,configurable:!0,writable:!0,value:ai.new(this._root,{width:vt,height:vt,isMeasured:!1})}),Object.defineProperty(this,"rightAxesContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.yAxesAndPlotContainer.children.push(ai.new(this._root,{height:vt,layout:this._root.horizontalLayout}))}),Object.defineProperty(this,"axisHeadersContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.plotContainer.children.push(ai.new(this._root,{}))}),Object.defineProperty(this,"zoomOutButton",{enumerable:!0,configurable:!0,writable:!0,value:this.topPlotContainer.children.push(Fu.new(this._root,{themeTags:["zoom"],icon:rn.new(this._root,{themeTags:["button","icon"]})}))}),Object.defineProperty(this,"_movePoint",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0}}),Object.defineProperty(this,"_wheelDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_otherCharts",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_movePoints",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_downStartX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downEndX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downStartY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downEndY",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){this._defaultThemes.push(VD.new(this._root)),super._afterNew(),this._disposers.push(this.xAxes),this._disposers.push(this.yAxes);const e=this._root;let t=this._root.verticalLayout;const i=this.zoomOutButton;i.events.on("click",()=>{this.zoomOut()}),i.hide(0),i.states.lookup("default").set("opacity",1),this.chartContainer.set("layout",t);const n=this.plotContainer;n.children.push(this.seriesContainer),this._disposers.push(this._processAxis(this.xAxes,this.bottomAxesContainer)),this._disposers.push(this._processAxis(this.yAxes,this.leftAxesContainer)),n.children.push(this.topGridContainer),n.children.push(this.bulletsContainer),n.set("interactive",!0),n.set("interactiveChildren",!1),n.set("background",ca.new(e,{themeTags:["xy","background"],fill:ei.fromHex(0),fillOpacity:0})),this._disposers.push(n.events.on("pointerdown",r=>{this._handlePlotDown(r)})),this._disposers.push(n.events.on("globalpointerup",r=>{this._handlePlotUp(r)})),this._disposers.push(n.events.on("globalpointermove",r=>{this._handlePlotMove(r)})),this._maskGrid(),this._setUpTouch()}_beforeChanged(){super._beforeChanged(),(this.isDirty("pinchZoomX")||this.isDirty("pinchZoomY")||this.get("panX")||this.get("panY"))&&this._setUpTouch()}_setUpTouch(){this.plotContainer._display.cancelTouch||(this.plotContainer._display.cancelTouch=!!(this.get("pinchZoomX")||this.get("pinchZoomY")||this.get("panX")||this.get("panY")))}_maskGrid(){this.gridContainer.set("maskContent",!0),this.topGridContainer.set("maskContent",!0)}_removeSeries(e){e._unstack(),e._posXDp&&e._posXDp.dispose(),e._posYDp&&e._posYDp.dispose(),e.set("baseAxis",void 0);const t=e.get("xAxis");t&&(Pr(t.series,e),t.markDirtyExtremes());const i=e.get("yAxis");i&&(Pr(i.series,e),i.markDirtyExtremes());const n=this.get("cursor");if(n){const r=n.get("snapToSeries");r&&Pr(r,e)}super._removeSeries(e)}handleWheel(e){const t=this.get("wheelX"),i=this.get("wheelY"),n=this.plotContainer,r=e.originalEvent;if(!gp(r,this))return;r.preventDefault();const a=n.toLocal(e.point),o=this.get("wheelStep",.2),l=r.deltaY/100,c=r.deltaX/100,h=this.get("wheelZoomPositionX"),u=this.get("wheelZoomPositionY");("zoomX"===t||"zoomXY"===t)&&0!=c&&this.xAxes.each(m=>{if(m.get("zoomX")){let p=m.get("start"),_=m.get("end"),g=m.fixPosition(a.x/n.width());null!=h&&(g=h);let f=p-o*(_-p)*c*g,b=_+o*(_-p)*c*(1-g);1/(b-f)<m.getPrivate("maxZoomFactor",1/0)/m.get("minZoomCount",1)&&this._handleWheelAnimation(m.zoom(f,b))}}),("zoomX"===i||"zoomXY"===i)&&0!=l&&this.xAxes.each(m=>{if(m.get("zoomX")){let p=m.get("start"),_=m.get("end"),g=m.fixPosition(a.x/n.width());null!=h&&(g=h);let f=p-o*(_-p)*l*g,b=_+o*(_-p)*l*(1-g);1/(b-f)<m.getPrivate("maxZoomFactor",1/0)/m.get("minZoomCount",1)&&this._handleWheelAnimation(m.zoom(f,b))}}),("zoomY"===t||"zoomXY"===t)&&0!=c&&this.yAxes.each(m=>{if(m.get("zoomY")){let p=m.get("start"),_=m.get("end"),g=m.fixPosition(a.y/n.height());null!=u&&(g=u);let f=p-o*(_-p)*c*g,b=_+o*(_-p)*c*(1-g);1/(b-f)<m.getPrivate("maxZoomFactor",1/0)/m.get("minZoomCount",1)&&this._handleWheelAnimation(m.zoom(f,b))}}),("zoomY"===i||"zoomXY"===i)&&0!=l&&this.yAxes.each(m=>{if(m.get("zoomY")){let p=m.get("start"),_=m.get("end"),g=m.fixPosition(a.y/n.height());null!=u&&(g=u);let f=p-o*(_-p)*l*g,b=_+o*(_-p)*l*(1-g);1/(b-f)<m.getPrivate("maxZoomFactor",1/0)/m.get("minZoomCount",1)&&this._handleWheelAnimation(m.zoom(f,b))}}),("panX"===t||"panXY"===t)&&0!=c&&this.xAxes.each(m=>{if(m.get("panX")){let p=m.get("start"),_=m.get("end"),g=this._getWheelSign(m)*o*(_-p)*c,f=p+g,b=_+g,C=this._fixWheel(f,b);f=C[0],b=C[1],this._handleWheelAnimation(m.zoom(f,b))}}),("panX"===i||"panXY"===i)&&0!=l&&this.xAxes.each(m=>{if(m.get("panX")){let p=m.get("start"),_=m.get("end"),g=this._getWheelSign(m)*o*(_-p)*l,f=p+g,b=_+g,C=this._fixWheel(f,b);f=C[0],b=C[1],this._handleWheelAnimation(m.zoom(f,b))}}),("panY"===t||"panXY"===t)&&0!=c&&this.yAxes.each(m=>{if(m.get("panY")){let p=m.get("start"),_=m.get("end"),g=this._getWheelSign(m)*o*(_-p)*c,f=p+g,b=_+g,C=this._fixWheel(f,b);f=C[0],b=C[1],this._handleWheelAnimation(m.zoom(f,b))}}),("panY"===i||"panXY"===i)&&0!=l&&this.yAxes.each(m=>{if(m.get("panY")){let p=m.get("start"),_=m.get("end"),g=this._getWheelSign(m)*o*(_-p)*l,f=p-g,b=_-g,C=this._fixWheel(f,b);f=C[0],b=C[1],this._handleWheelAnimation(m.zoom(f,b))}})}_handleSetWheel(){const e=this.get("wheelX"),t=this.get("wheelY");"none"!==e||"none"!==t?(this._wheelDp=this.plotContainer.events.on("wheel",n=>{const r=n.originalEvent;("none"!==e&&0!=Math.abs(r.deltaX)||"none"!==t&&0!=Math.abs(r.deltaY))&&this.handleWheel(n)}),this._disposers.push(this._wheelDp)):this._wheelDp&&this._wheelDp.dispose()}_getWheelSign(e){let t=1;return e.get("renderer").get("inversed")&&(t=-1),t}_fixWheel(e,t){const i=t-e;return e<0&&(t=(e=0)+i),t>1&&(e=(t=1)-i),[e,t]}_handlePlotDown(e){const t=e.originalEvent;if(2==t.button)return;const i=this.plotContainer;let n=i.toLocal(e.point);if((this.get("pinchZoomX")||this.get("pinchZoomY"))&&t.pointerId&&ys(i._downPoints).length>0){const a=this.xAxes.getIndex(0),o=this.yAxes.getIndex(0);a&&(this._downStartX=a.get("start",0),this._downEndX=a.get("end",1)),o&&(this._downStartY=o.get("start",0),this._downEndY=o.get("end",1))}if((this.get("panX")||this.get("panY"))&&n.x>=0&&n.y>=0&&n.x<=i.width()&&n.y<=this.height()){this._downPoint={x:t.clientX,y:t.clientY};const r=this.get("panX"),a=this.get("panY");r&&this.xAxes.each(l=>{l._panStart=l.get("start"),l._panEnd=l.get("end")}),a&&this.yAxes.each(l=>{l._panStart=l.get("start"),l._panEnd=l.get("end")});const o="panstarted";this.events.isEnabled(o)&&this.events.dispatch(o,{type:o,target:this,originalEvent:e.originalEvent})}}_handleWheelAnimation(e){e?e.events.on("stopped",()=>{this._dispatchWheelAnimation()}):this._dispatchWheelAnimation()}_dispatchWheelAnimation(){const e="wheelended";this.events.isEnabled(e)&&this.events.dispatch(e,{type:e,target:this})}_handlePlotUp(e){const t=this._downPoint;if(t&&(this.get("panX")||this.get("panY"))){let i=this.plotContainer.toLocal(e.point);if(i.x==t.x&&i.y==t.y){const r="pancancelled";this.events.isEnabled(r)&&this.events.dispatch(r,{type:r,target:this,originalEvent:e.originalEvent})}const n="panended";this.events.isEnabled(n)&&this.events.dispatch(n,{type:n,target:this,originalEvent:e.originalEvent})}this._downPoint=void 0,this.xAxes.each(i=>{i._isPanning=!1}),this.yAxes.each(i=>{i._isPanning=!1})}_handlePlotMove(e){const t=this.plotContainer;if(this.get("pinchZoomX")||this.get("pinchZoomY")){const r=e.originalEvent.pointerId;if(r&&(this._movePoints[r]=e.point,ys(t._downPoints).length>1))return void this._handlePinch()}let i=this._downPoint;if(i){i=t.toLocal(this._root.documentPointToRoot(i));let n=t.toLocal(e.point);const r=this.get("panX"),a=this.get("panY");if(r){let o=this.get("scrollbarX");o&&o.events.disableType("rangechanged"),this.xAxes.each(l=>{if(l.get("panX")){l._isPanning=!0;let c=l._panStart,h=l._panEnd,m=(h-c)*(i.x-n.x)/t.width();l.get("renderer").get("inversed")&&(m*=-1);let p=c+m,_=h+m;_-p<1+2*l.get("maxDeviation",1)&&(l.set("start",p),l.set("end",_))}}),o&&o.events.enableType("rangechanged")}if(a){let o=this.get("scrollbarY");o&&o.events.disableType("rangechanged"),this.yAxes.each(l=>{if(l.get("panY")){l._isPanning=!0;let c=l._panStart,h=l._panEnd,m=(h-c)*(i.y-n.y)/t.height();l.get("renderer").get("inversed")&&(m*=-1);let p=c-m,_=h-m;_-p<1+2*l.get("maxDeviation",1)&&(l.set("start",p),l.set("end",_))}}),o&&o.events.enableType("rangechanged")}}}_handlePinch(){const e=this.plotContainer;let t=0,i=[],n=[];if(en(e._downPoints,(r,a)=>{i[t]=a;let o=this._movePoints[r];o&&(n[t]=o),t++}),i.length>1&&n.length>1){const r=e.width(),a=e.height();let o=i[0],l=i[1],c=n[0],h=n[1];if(o&&l&&c&&h){if(c=e.toLocal(c),h=e.toLocal(h),o=e.toLocal(o),l=e.toLocal(l),this.get("pinchZoomX")){const u=this._downStartX,m=this._downEndX;if(null!=u&&null!=m){o.x>l.x&&([o,l]=[l,o],[c,h]=[h,c]);let p=u+o.x/r*(m-u),_=u+l.x/r*(m-u),g=u+c.x/r*(m-u),f=u+h.x/r*(m-u),M=Math.max(.001,_-p)/Math.max(.001,f-g),E=u*M+p-g*M,S=m*M+_-f*M;this.xAxes.each(P=>{let I=P.fixPosition(E),L=P.fixPosition(S);P.zoom(I,L,0)})}}if(this.get("pinchZoomY")){const u=this._downStartY,m=this._downEndY;if(null!=u&&null!=m){o.y<l.y&&([o,l]=[l,o],[c,h]=[h,c]);let p=u+(1-o.y/a)*(m-u),_=u+(1-l.y/a)*(m-u),g=u+(1-c.y/a)*(m-u),f=u+(1-h.y/a)*(m-u),M=Math.max(.001,_-p)/Math.max(.001,f-g),E=u*M+p-g*M,S=m*M+_-f*M;this.yAxes.each(P=>{let I=P.fixPosition(E),L=P.fixPosition(S);P.zoom(I,L,0)})}}}}}_handleCursorPosition(){const e=this.get("cursor");if(e){const t=e.getPrivate("point");let i=e.get("snapToSeries");if(e._downPoint&&(i=void 0),i&&t){const n=e.get("snapToSeriesBy"),r=[];ye(i,l=>{if(!l.isHidden()&&!l.isHiding())if("x!"!=n&&"y!"!=n){const c=l.startIndex(),h=l.endIndex();for(let u=c;u<h;u++){const m=l.dataItems[u];m&&!m.isHidden()&&r.push(m)}}else{const c=l.get("tooltipDataItem");c&&r.push(c)}});let o,a=1/0;if(ye(r,l=>{const c=l.get("point");if(c){let h=0;h="x"==n||"x!"==n?Math.abs(t.x-c.x):"y"==n||"y!"==n?Math.abs(t.y-c.y):Math.hypot(t.x-c.x,t.y-c.y),h<a&&(a=h,o=l)}}),ye(i,l=>{const c=l.get("tooltip");c&&c._setDataItem(void 0)}),o){let l=o.component;l.showDataItemTooltip(o);const c=o.get("point");c&&e.handleMove(l.toGlobal({x:c.x-l.x(),y:c.y-l.y()}),!0)}}}}_updateCursor(){let e=this.get("cursor");e&&e.updateCursor()}_addCursor(e){this.plotContainer.children.push(e)}_prepareChildren(){if(super._prepareChildren(),this.series.each(e=>{this._colorize(e)}),(this.isDirty("wheelX")||this.isDirty("wheelY"))&&this._handleSetWheel(),this.isDirty("cursor")){const e=this._prevSettings.cursor,t=this.get("cursor");t!==e&&(this._disposeProperty("cursor"),e&&e.dispose(),t&&(t._setChart(this),this._addCursor(t),this._pushPropertyDisposer("cursor",t.events.on("selectended",()=>{this._handleCursorSelectEnd()}))),this._prevSettings.cursor=t)}if(this.isDirty("scrollbarX")){const e=this._prevSettings.scrollbarX,t=this.get("scrollbarX");t!==e&&(this._disposeProperty("scrollbarX"),e&&e.dispose(),t&&(t.parent||this.topAxesContainer.children.push(t),this._pushPropertyDisposer("scrollbarX",t.events.on("rangechanged",i=>{this._handleScrollbar(this.xAxes,i.start,i.end,i.grip)})),t.setPrivate("positionTextFunction",i=>{const n=this.xAxes.getIndex(0);return n&&n.getTooltipText(i,!1)||""})),this._prevSettings.scrollbarX=t)}if(this.isDirty("scrollbarY")){const e=this._prevSettings.scrollbarY,t=this.get("scrollbarY");t!==e&&(this._disposeProperty("scrollbarY"),e&&e.dispose(),t&&(t.parent||this.rightAxesContainer.children.push(t),this._pushPropertyDisposer("scrollbarY",t.events.on("rangechanged",i=>{this._handleScrollbar(this.yAxes,i.start,i.end,i.grip)})),t.setPrivate("positionTextFunction",i=>{const n=this.yAxes.getIndex(0);return n&&n.getTooltipText(i,!1)||""})),this._prevSettings.scrollbarY=t)}this._handleZoomOut()}_processSeries(e){super._processSeries(e);const t=e.get("xAxis"),i=e.get("yAxis");bd(t.series,e),bd(i.series,e),e._posXDp=e.addDisposer(t.events.on("positionchanged",()=>{e._fixPosition()})),e._posXDp=e.addDisposer(i.events.on("positionchanged",()=>{e._fixPosition()})),e.get("baseAxis")||(i.isType("CategoryAxis")||i.isType("DateAxis")?e.set("baseAxis",i):e.set("baseAxis",t)),e.get("stacked")&&(e._markDirtyKey("stacked"),ye(e.dataItems,n=>{n.set("stackToItemY",void 0),n.set("stackToItemX",void 0)})),e._markDirtyAxes(),i.markDirtyExtremes(),t.markDirtyExtremes(),this._colorize(e)}_colorize(e){const t=this.get("colors");if(t&&null==e.get("fill")){const i=t.next();e._setSoft("stroke",i),e._setSoft("fill",i)}}_handleCursorSelectEnd(){const e=this.get("cursor"),t=e.get("behavior"),i=e.getPrivate("downPositionX",0),n=e.getPrivate("downPositionY",0),r=Math.min(1,Math.max(0,e.getPrivate("positionX",.5))),a=Math.min(1,Math.max(0,e.getPrivate("positionY",.5)));this.xAxes.each(o=>{if("zoomX"===t||"zoomXY"===t){let l=o.toAxisPosition(i),c=o.toAxisPosition(r);o.zoom(l,c)}o.setPrivate("updateScrollbar",!0)}),this.yAxes.each(o=>{if("zoomY"===t||"zoomXY"===t){let l=o.toAxisPosition(n),c=o.toAxisPosition(a);o.zoom(l,c)}o.setPrivate("updateScrollbar",!0)})}_handleScrollbar(e,t,i,n){e.each(r=>{let a=r.fixPosition(t),o=r.fixPosition(i),l=r.zoom(a,o,void 0,n);const c="updateScrollbar";r.setPrivateRaw(c,!1),l?l.events.on("stopped",()=>{r.setPrivateRaw(c,!0)}):r.setPrivateRaw(c,!0)})}_processAxis(e,t){return e.events.onAll(i=>{if("clear"===i.type)ye(i.oldValues,n=>{this._removeAxis(n)});else if("push"===i.type)t.children.push(i.newValue),i.newValue.processChart(this);else if("setIndex"===i.type)t.children.setIndex(i.index,i.newValue),i.newValue.processChart(this);else if("insertIndex"===i.type)t.children.insertIndex(i.index,i.newValue),i.newValue.processChart(this);else if("removeIndex"===i.type)this._removeAxis(i.oldValue);else{if("moveIndex"!==i.type)throw new Error("Unknown IListEvent type");t.children.moveValue(i.value,i.newIndex),i.value.processChart(this)}})}_removeAxis(e){if(!e.isDisposed()){const t=e.parent;t&&t.children.removeValue(e);const i=e.gridContainer,n=i.parent;n&&n.children.removeValue(i);const r=e.topGridContainer,a=r.parent;a&&a.children.removeValue(r)}}_updateChartLayout(){const e=this.leftAxesContainer.width(),t=this.rightAxesContainer.width(),i=this.bottomAxesContainer;i.set("paddingLeft",e),i.set("paddingRight",t);const n=this.topAxesContainer;n.set("paddingLeft",e),n.set("paddingRight",t)}processAxis(e){this.get("cursor")&&(this.addDisposer(e.on("start",()=>{this._updateCursor()})),this.addDisposer(e.on("end",()=>{this._updateCursor()})))}_handleAxisSelection(e,t){let i=e.fixPosition(e.get("start",0)),n=e.fixPosition(e.get("end",1));if(i>n&&([i,n]=[n,i]),-1!=this.xAxes.indexOf(e)){if(t||e.getPrivate("updateScrollbar")){let r=this.get("scrollbarX");r&&(!r.getPrivate("isBusy")||t)&&(r.setRaw("start",i),r.setRaw("end",n),r.updateGrips())}}else if(-1!=this.yAxes.indexOf(e)&&(t||e.getPrivate("updateScrollbar"))){let r=this.get("scrollbarY");r&&(!r.getPrivate("isBusy")||t)&&(r.setRaw("start",i),r.setRaw("end",n),r.updateGrips())}this._handleZoomOut()}_handleZoomOut(){let e=this.zoomOutButton;if(e&&e.parent){let t=!1;this.xAxes.each(i=>{(0!=i.get("start")||1!=i.get("end"))&&(t=!0)}),this.yAxes.each(i=>{(0!=i.get("start")||1!=i.get("end"))&&(t=!0)}),t?e.isHidden()&&e.show():e.hide()}}inPlot(e){const t=this.plotContainer,i=this.getPrivate("otherCharts",this._otherCharts),n=t.toGlobal(e);if(e.x>=-.5&&e.y>=-.5&&e.x<=t.width()+.5&&e.y<=t.height()+.5)return!0;if(i)for(let r=i.length-1;r>=0;r--){const a=i[r];if(a!=this){const o=a.plotContainer,l=this._root.rootPointToDocument(n),c=a._root.documentPointToRoot(l),h=o.toLocal(c);if(h.x>=-.1&&h.y>=-.1&&h.x<=o.width()+.1&&h.y<=o.height()+.1)return!0}}return!1}arrangeTooltips(){const e=this.plotContainer,t=e.width(),i=e.height(),n=this.height();let r=e._display.toGlobal({x:0,y:0}),a=e._display.toGlobal({x:t,y:i});const o=[];let p,_,l=0,c=1/0,h=this._movePoint,u=this.get("maxTooltipDistance"),m=this.get("maxTooltipDistanceBy","xy");Se(u)&&this.series.each(f=>{if(!f.isHidden()){const b=f.get("tooltip");if(b){let C=b.get("pointTo");if(C){let M=Math.hypot(h.x-C.x,h.y-C.y);"x"==m?M=Math.abs(h.x-C.x):"y"==m&&(M=Math.abs(h.y-C.y)),M<c&&(c=M,p=f,_=C)}}}});const g=[];if(this.series.each(f=>{const b=f.get("tooltip");if(b&&!b.get("forceHidden")){let C=!1,M=b.get("pointTo");if(M){if(u>=0){let E=b.get("pointTo");if(E&&_&&f!=p){let S=Math.hypot(_.x-E.x,_.y-E.y);"x"==m?S=Math.abs(_.x-E.x):"y"==m&&(S=Math.abs(_.y-E.y)),S>u&&(C=!0)}}else-1==u&&f!=p&&(C=!0);this.inPlot(this._tooltipToLocal(M))&&b.dataItem?C||(l+=M.y):C=!0,C||f.isHidden()||f.isHiding()?b.hide(0):(b.show(),o.push(b),g.push(f))}}}),this.setPrivate("tooltipSeries",g),this.get("arrangeTooltips")){const f=this._root.tooltipContainer;if(l/o.length>i/2+r.y){o.sort((E,S)=>Uy(S.get("pointTo").y,E.get("pointTo").y));let M=a.y;if(ye(o,E=>{let S=E.height(),P=E.get("centerY");P instanceof Ti&&(S*=P.value),S+=E.get("marginBottom",0),E.set("bounds",{left:r.x,top:r.y,right:a.x,bottom:M}),E.setPrivate("customData",{left:r.x,top:r.y,right:a.x,bottom:M}),M=Math.min(M-S,E._fy-S),E.parent==f&&f.children.moveValue(E,0)}),M<0){o.reverse();let E=M;ye(o,S=>{let P=S.get("bounds");if(P){let I=P.top-M,L=P.bottom-M;I<E&&(I=E,L=I+S.height()),S.set("bounds",{left:P.left,top:I,right:P.right,bottom:L}),E=P.bottom-M+S.get("marginBottom",0)}})}}else{o.reverse(),o.sort((E,S)=>Uy(E.get("pointTo").y,S.get("pointTo").y));let M=0;if(ye(o,E=>{let S=E.height(),P=E.get("centerY");P instanceof Ti&&(S*=P.value),S+=E.get("marginBottom",0),E.set("bounds",{left:r.x,top:M,right:a.x,bottom:Math.max(r.y+n,M+S)}),E.parent==f&&f.children.moveValue(E,0),M=Math.max(M+S,E._fy+S)}),M>n){o.reverse();let E=n;ye(o,S=>{let P=S.get("bounds");if(P){let I=P.top-(n-M),L=P.bottom-(n-M);L>E&&(L=E,I=L-S.height()),S.set("bounds",{left:P.left,top:I,right:P.right,bottom:L}),E=L-S.height()-S.get("marginBottom",0)}})}}}}_tooltipToLocal(e){return this.plotContainer.toLocal(e)}zoomOut(){this.xAxes.each(e=>{e.setPrivate("updateScrollbar",!0),e.zoom(0,1)}),this.yAxes.each(e=>{e.setPrivate("updateScrollbar",!0),e.zoom(0,1)})}}Object.defineProperty(ja,"className",{enumerable:!0,configurable:!0,writable:!0,value:"XYChart"}),Object.defineProperty(ja,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Cc.classNames.concat([ja.className])});class Hd extends rn{_beforeChanged(){super._beforeChanged(),(this.isPrivateDirty("width")||this.isPrivateDirty("height"))&&(this._clear=!0)}}Object.defineProperty(Hd,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Grid"}),Object.defineProperty(Hd,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:rn.classNames.concat([Hd.className])});class Dc extends ai{constructor(){super(...arguments),Object.defineProperty(this,"lineX",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(Hd.new(this._root,{themeTags:["x"]}))}),Object.defineProperty(this,"lineY",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(Hd.new(this._root,{themeTags:["y"]}))}),Object.defineProperty(this,"selection",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(rn.new(this._root,{themeTags:["selection","cursor"],layer:30}))}),Object.defineProperty(this,"_movePoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_lastPoint",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0}}),Object.defineProperty(this,"_tooltipX",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_tooltipY",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"chart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_toX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_toY",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){this._settings.themeTags=ki(this._settings.themeTags,["xy","cursor"]),super._afterNew(),this.setAll({width:vt,height:vt,isMeasured:!0,position:"absolute"}),this.states.create("hidden",{visible:!0,opacity:0}),this._drawLines(),this.setPrivateRaw("visible",!1),this._disposers.push(this.setTimeout(()=>{this.setPrivate("visible",!0)},500)),this._disposers.push(this.lineX.events.on("positionchanged",()=>{this._handleXLine()})),this._disposers.push(this.lineY.events.on("positionchanged",()=>{this._handleYLine()})),this._disposers.push(this.lineX.events.on("focus",e=>this._handleLineFocus(e.target))),this._disposers.push(this.lineX.events.on("blur",e=>this._handleLineBlur(e.target))),this._disposers.push(this.lineY.events.on("focus",e=>this._handleLineFocus(e.target))),this._disposers.push(this.lineY.events.on("blur",e=>this._handleLineBlur(e.target))),Ha("keyboardevents")&&this._disposers.push(qn(document,"keydown",e=>{this._handleLineMove(e.keyCode)}))}_setUpTouch(){const e=this.chart;e&&(e.plotContainer._display.cancelTouch="none"!=this.get("behavior"))}_handleXLine(){let e=this.lineX.x(),t=!0;(e<0||e>this.width())&&(t=!1),this.lineX.setPrivate("visible",t)}_handleYLine(){let e=this.lineY.y(),t=!0;(e<0||e>this.height())&&(t=!1),this.lineY.setPrivate("visible",t)}_handleLineMove(e){let t="",i=0,n=.1;const r=this.chart;this._root.focused(this.lineX)?(r&&r.xAxes.length&&(n=r.xAxes.getIndex(0).getCellWidthPosition()),i=this.getPrivate("positionX",0),t="positionX",37==e?i-=n:39==e&&(i+=n)):this._root.focused(this.lineY)&&(r&&r.yAxes.length&&(n=r.yAxes.getIndex(0).getCellWidthPosition()),i=this.getPrivate("positionY",0),t="positionY",38==e?i-=n:40==e&&(i+=n)),i<0?i=0:i>1&&(i=1),""!=t&&this.set(t,i)}_handleLineFocus(e){this.setAll({positionX:this.getPrivate("positionX"),positionY:this.getPrivate("positionY"),alwaysShow:!0})}_handleLineBlur(e){this.setAll({positionX:void 0,positionY:void 0,alwaysShow:!1})}_prepareChildren(){if(super._prepareChildren(),this.isDirty("xAxis")){this._tooltipX=!1;const e=this.get("xAxis");if(e){const t=e.get("tooltip");t&&(this._tooltipX=!0,this._disposers.push(t.on("pointTo",()=>{this._updateXLine(t)})))}}if(this.isDirty("yAxis")){this._tooltipY=!1;const e=this.get("yAxis");if(e){const t=e.get("tooltip");t&&(this._tooltipY=!0,this._disposers.push(t.on("pointTo",()=>{this._updateYLine(t)})))}}}_handleSyncWith(){const e=this.chart;if(e){const t=this.get("syncWith"),i=[];t&&ye(t,n=>{const r=n.chart;r&&i.push(r)}),e._otherCharts=i}}_updateChildren(){if(super._updateChildren(),this._handleSyncWith(),this.isDirty("positionX")||this.isDirty("positionY")){const e=this.get("positionX"),t=this.get("positionY");null==e&&null==t?this.hide(0):(this._movePoint=this.toGlobal(this._getPoint(this.get("positionX",0),this.get("positionY",0))),this.handleMove())}}_updateXLine(e){let t=fr(this._display.toLocal(e.get("pointTo",{x:0,y:0})).x,2);this._toX!=t&&(this.lineX.animate({key:"x",to:t,duration:e.get("animationDuration",0),easing:e.get("animationEasing")}),this._toX=t)}_updateYLine(e){let t=fr(this._display.toLocal(e.get("pointTo",{x:0,y:0})).y,2);this._toY!=t&&(this.lineY.animate({key:"y",to:t,duration:e.get("animationDuration",0),easing:e.get("animationEasing")}),this._toY=t)}_drawLines(){this.lineX.set("draw",e=>{e.moveTo(0,0),e.lineTo(0,this.height())}),this.lineY.set("draw",e=>{e.moveTo(0,0),e.lineTo(this.width(),0)})}updateCursor(){this.get("alwaysShow")&&(this._movePoint=this.toGlobal(this._getPoint(this.get("positionX",0),this.get("positionY",0)))),this.handleMove()}_setChart(e){this.chart=e,this._handleSyncWith();const t=e.plotContainer;this.events.on("boundschanged",()=>{this._disposers.push(this.setTimeout(()=>{this.updateCursor()},50))}),Ha("touchevents")&&(this._disposers.push(t.events.on("click",n=>{Mu(n.originalEvent)&&this._handleMove(n)})),this._setUpTouch()),this._disposers.push(t.events.on("pointerdown",n=>{this._handleCursorDown(n)})),this._disposers.push(t.events.on("globalpointerup",n=>{this._handleCursorUp(n),!n.native&&!this.isHidden()&&this._handleMove(n)})),this._disposers.push(t.events.on("globalpointermove",n=>{!this.get("syncWith")&&0==ys(t._downPoints).length&&!n.native&&this.isHidden()||this._handleMove(n)}));const i=this.parent;i&&i.children.moveValue(this.selection)}_inPlot(e){const t=this.chart;return!!t&&t.inPlot(e)}_handleCursorDown(e){if(2==e.originalEvent.button)return;let i=this._display.toLocal(e.point);const n=this.chart;if(this.selection.set("draw",()=>{}),n&&this._inPlot(i)){if(this._downPoint=i,"none"!=this.get("behavior")){this.selection.show();const o="selectstarted";this.events.isEnabled(o)&&this.events.dispatch(o,{type:o,target:this,originalEvent:e.originalEvent})}let r=this._getPosition(i).x,a=this._getPosition(i).y;this.setPrivate("downPositionX",r),this.setPrivate("downPositionY",a)}}_handleCursorUp(e){if(this._downPoint){const t=this.get("behavior","none");if("none"!=t){"z"===t.charAt(0)&&this.selection.hide();let n=this._display.toLocal(e.point);const r=this._downPoint,a=this.get("moveThreshold",1);if(n&&r){let o=!1;if(("zoomX"===t||"zoomXY"===t||"selectX"===t||"selectXY"===t)&&Math.abs(n.x-r.x)>a&&(o=!0),("zoomY"===t||"zoomXY"===t||"selectY"===t||"selectXY"===t)&&Math.abs(n.y-r.y)>a&&(o=!0),o){const l="selectended";this.events.isEnabled(l)&&this.events.dispatch(l,{type:l,target:this,originalEvent:e.originalEvent})}else{const l="selectcancelled";this.events.isEnabled(l)&&this.events.dispatch(l,{type:l,target:this,originalEvent:e.originalEvent})}}}}this._downPoint=void 0}_handleMove(e){if(this.getPrivate("visible")){const t=this.chart;if(t&&ys(t.plotContainer._downPoints).length>1)return void this.set("forceHidden",!0);this.set("forceHidden",!1);const i=e.point,n=this._lastPoint;if(Math.round(n.x)===Math.round(i.x)&&Math.round(n.y)===Math.round(i.y))return;this._lastPoint=i,this.setPrivate("lastPoint",i),this.handleMove({x:i.x,y:i.y},!1,e.originalEvent)}}_getPosition(e){return{x:e.x/this.width(),y:e.y/this.height()}}handleMove(e,t,i){e||(e=this._movePoint);const n=this.get("alwaysShow");if(!e)return void this.hide(0);this._movePoint=e;let r=this._display.toLocal(e),a=this.chart;if(a&&(this._inPlot(r)||this._downPoint)){a._movePoint=e,this.isHidden()&&(this.show(),"z"==this.get("behavior","").charAt(0)&&this.selection.set("draw",()=>{}));let o=r.x,l=r.y,c=this._getPosition(r);this.setPrivate("point",r);let h=this.get("snapToSeries");this._downPoint&&(h=void 0);let u=this.get("positionX"),m=c.x;Se(u)&&(m=u);let p=this.get("positionY"),_=c.y;Se(p)&&(_=p),this.setPrivate("positionX",m),this.setPrivate("positionY",_);const g=this._getPoint(m,_);if(o=g.x,l=g.y,a.xAxes.each(f=>{f._handleCursorPosition(m,h),n&&f.handleCursorShow()}),a.yAxes.each(f=>{f._handleCursorPosition(_,h),n&&f.handleCursorShow()}),!t){a._handleCursorPosition();const f="cursormoved";this.events.isEnabled(f)&&this.events.dispatch(f,{type:f,target:this,point:e,originalEvent:i})}this._updateLines(o,l),a.arrangeTooltips()}else if(!this._downPoint&&!n){this.hide(0);const o="cursorhidden";this.events.isEnabled(o)&&this.events.dispatch(o,{type:o,target:this})}this._downPoint&&"none"!=this.get("behavior")&&this._updateSelection(r)}_getPoint(e,t){return{x:this.width()*e,y:this.height()*t}}_updateLines(e,t){this._tooltipX||this.lineX.set("x",e),this._tooltipY||this.lineY.set("y",t),this._drawLines()}_updateSelection(e){const t=this.selection,i=this.get("behavior"),n=this.width(),r=this.height();e.x<0&&(e.x=0),e.x>n&&(e.x=n),e.y<0&&(e.y=0),e.y>r&&(e.y=r),t.set("draw",a=>{const o=this._downPoint;o&&("zoomXY"===i||"selectXY"===i?(a.moveTo(o.x,o.y),a.lineTo(o.x,e.y),a.lineTo(e.x,e.y),a.lineTo(e.x,o.y),a.lineTo(o.x,o.y)):"zoomX"===i||"selectX"===i?(a.moveTo(o.x,0),a.lineTo(o.x,r),a.lineTo(e.x,r),a.lineTo(e.x,0),a.lineTo(o.x,0)):("zoomY"===i||"selectY"===i)&&(a.moveTo(0,o.y),a.lineTo(n,o.y),a.lineTo(n,e.y),a.lineTo(0,e.y),a.lineTo(0,o.y)))})}_onHide(){if(this.isHidden()){let e=this.chart;e&&(e.xAxes.each(t=>{t.handleCursorHide()}),e.yAxes.each(t=>{t.handleCursorHide()}),e.series.each(t=>{t.handleCursorHide()}))}super._onHide()}_onShow(){if(!this.isHidden()){let e=this.chart;e&&(e.xAxes.each(t=>{t.handleCursorShow()}),e.yAxes.each(t=>{t.handleCursorShow()}))}super._onShow()}_dispose(){super._dispose(),this.selection.dispose()}}Object.defineProperty(Dc,"className",{enumerable:!0,configurable:!0,writable:!0,value:"XYCursor"}),Object.defineProperty(Dc,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ai.classNames.concat([Dc.className])});class WD extends Dl{constructor(){super(...arguments),Object.defineProperty(this,"processor",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}incrementRef(){}decrementRef(){}_onPush(e){this.processor&&this.processor.processRow(e),super._onPush(e)}_onInsertIndex(e,t){this.processor&&this.processor.processRow(t),super._onInsertIndex(e,t)}_onSetIndex(e,t,i){this.processor&&this.processor.processRow(i),super._onSetIndex(e,t,i)}}class Za extends zy{constructor(e,t,i){super(i),Object.defineProperty(this,"component",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dataContext",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bullets",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"open",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"close",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.dataContext=t,this.component=e,this._settings.visible=!0,this._checkDirty()}markDirty(){this.component.markDirtyValues(this)}_startAnimation(){this.component._root._addAnimation(this)}_animationTime(){return this.component._root.animationTime}_dispose(){this.component&&this.component.disposeDataItem(this),super._dispose()}show(e){this.setRaw("visible",!0),this.component&&this.component.showDataItem(this,e)}hide(e){this.setRaw("visible",!1),this.component&&this.component.hideDataItem(this,e)}isHidden(){return!this.get("visible")}}class Ec extends ai{constructor(){super(...arguments),Object.defineProperty(this,"_data",{enumerable:!0,configurable:!0,writable:!0,value:new WD}),Object.defineProperty(this,"_dataItems",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_mainDataItems",{enumerable:!0,configurable:!0,writable:!0,value:this._dataItems}),Object.defineProperty(this,"valueFields",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"fields",{enumerable:!0,configurable:!0,writable:!0,value:["id"]}),Object.defineProperty(this,"_valueFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_valueFieldsF",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fieldsF",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_valuesDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dataChanged",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dataGrouped",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"inited",{enumerable:!0,configurable:!0,writable:!0,value:!1})}set data(e){e.incrementRef(),this._data.decrementRef(),this._data=e}get data(){return this._data}_dispose(){super._dispose(),this._data.decrementRef()}_onDataClear(){}_afterNew(){super._afterNew(),this._data.incrementRef(),this._updateFields(),this._disposers.push(this.data.events.onAll(e=>{const t=this._mainDataItems;if(this.markDirtyValues(),this._markDirtyGroup(),this._dataChanged=!0,"clear"===e.type)ye(t,i=>{i.dispose()}),t.length=0,this._onDataClear();else if("push"===e.type){const i=new Za(this,e.newValue,this._makeDataItem(e.newValue));t.push(i),this.processDataItem(i)}else if("setIndex"===e.type){const i=t[e.index],n=this._makeDataItem(e.newValue);i.bullets&&0==i.bullets.length&&(i.bullets=void 0),ys(n).forEach(r=>{i.animate({key:r,to:n[r],duration:this.get("interpolationDuration",0),easing:this.get("interpolationEasing")})}),i.dataContext=e.newValue}else if("insertIndex"===e.type){const i=new Za(this,e.newValue,this._makeDataItem(e.newValue));t.splice(e.index,0,i),this.processDataItem(i)}else if("removeIndex"===e.type)t[e.index].dispose(),t.splice(e.index,1);else{if("moveIndex"!==e.type)throw new Error("Unknown IStreamEvent type");{const i=t[e.oldIndex];t.splice(e.oldIndex,1),t.splice(e.newIndex,0,i)}}this._afterDataChange()}))}_updateFields(){this.valueFields&&(this._valueFields=[],this._valueFieldsF={},ye(this.valueFields,e=>{this.get(e+"Field")&&(this._valueFields.push(e),this._valueFieldsF[e]={fieldKey:e+"Field",workingKey:e+"Working"})})),this.fields&&(this._fields=[],this._fieldsF={},ye(this.fields,e=>{this.get(e+"Field")&&(this._fields.push(e),this._fieldsF[e]=e+"Field")}))}get dataItems(){return this._dataItems}processDataItem(e){}_makeDataItem(e){const t={};return this._valueFields&&ye(this._valueFields,i=>{const n=this.get(this._valueFieldsF[i].fieldKey);t[i]=e[n],t[this._valueFieldsF[i].workingKey]=t[i]}),this._fields&&ye(this._fields,i=>{const n=this.get(this._fieldsF[i]);t[i]=e[n]}),t}makeDataItem(e){let t=new Za(this,void 0,e);return this.processDataItem(t),t}pushDataItem(e){const t=this.makeDataItem(e);return this._mainDataItems.push(t),t}disposeDataItem(e){}showDataItem(e,t){return(0,vs.mG)(this,void 0,void 0,function*(){e.set("visible",!0)})}hideDataItem(e,t){return(0,vs.mG)(this,void 0,void 0,function*(){e.set("visible",!1)})}_clearDirty(){super._clearDirty(),this._valuesDirty=!1}_afterDataChange(){}_afterChanged(){if(super._afterChanged(),this._dataChanged){const e="datavalidated";this.events.isEnabled(e)&&this.events.dispatch(e,{type:e,target:this}),this._dataChanged=!1}this.inited=!0}markDirtyValues(e){this.markDirty(),this._valuesDirty=!0}_markDirtyGroup(){this._dataGrouped=!1}markDirtySize(){this._sizeDirty=!0,this.markDirty()}}Object.defineProperty(Ec,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Component"}),Object.defineProperty(Ec,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ai.classNames.concat([Ec.className])});class Sc extends Ec{constructor(){super(...arguments),Object.defineProperty(this,"_series",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_isPanning",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"minorDataItems",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"labelsContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(ai.new(this._root,{}))}),Object.defineProperty(this,"gridContainer",{enumerable:!0,configurable:!0,writable:!0,value:ai.new(this._root,{width:vt,height:vt})}),Object.defineProperty(this,"topGridContainer",{enumerable:!0,configurable:!0,writable:!0,value:ai.new(this._root,{width:vt,height:vt})}),Object.defineProperty(this,"bulletsContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(ai.new(this._root,{isMeasured:!1,width:vt,height:vt,position:"absolute"}))}),Object.defineProperty(this,"chart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rangesDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_panStart",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_panEnd",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_sAnimation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_eAnimation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_skipSync",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"axisRanges",{enumerable:!0,configurable:!0,writable:!0,value:new Dl}),Object.defineProperty(this,"_seriesAxisRanges",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"ghostLabel",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_cursorPosition",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(this,"_snapToSeries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_seriesValuesDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"axisHeader",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(ai.new(this._root,{themeTags:["axis","header"],position:"absolute",background:ca.new(this._root,{themeTags:["header","background"],fill:this._root.interfaceColors.get("background")})}))}),Object.defineProperty(this,"_bullets",{enumerable:!0,configurable:!0,writable:!0,value:{}})}_dispose(){this.gridContainer.dispose(),this.topGridContainer.dispose(),this.bulletsContainer.dispose(),this.labelsContainer.dispose(),this.axisHeader.dispose(),super._dispose()}_afterNew(){super._afterNew(),this.setPrivate("updateScrollbar",!0),this._disposers.push(this.axisRanges.events.onAll(t=>{if("clear"===t.type)ye(t.oldValues,i=>{this.disposeDataItem(i)});else if("push"===t.type)this._processAxisRange(t.newValue,["range"]);else if("setIndex"===t.type)this._processAxisRange(t.newValue,["range"]);else if("insertIndex"===t.type)this._processAxisRange(t.newValue,["range"]);else if("removeIndex"===t.type)this.disposeDataItem(t.oldValue);else{if("moveIndex"!==t.type)throw new Error("Unknown IStreamEvent type");this._processAxisRange(t.value,["range"])}}));const e=this.get("renderer");e&&(e.axis=this,e.processAxis()),this.children.push(e),this.ghostLabel=e.makeLabel(new Za(this,void 0,{}),[]),this.ghostLabel.adapters.disable("text"),this.ghostLabel.setAll({opacity:0,tooltipText:void 0,tooltipHTML:void 0,interactive:!1}),this.ghostLabel.events.disable()}_updateFinals(e,t){}zoom(e,t,i,n){if(this.get("zoomable",!0))if(this._updateFinals(e,t),this.get("start")!==e||this.get("end")!=t){let r=this._sAnimation,a=this._eAnimation,o=this.get("maxDeviation",.5)*Math.min(1,t-e);e<-o&&(e=-o),t>1+o&&(t=1+o),e>t&&([e,t]=[t,e]),Se(i)||(i=this.get("interpolationDuration",0)),n||(n="end");let l=this.getPrivate("maxZoomFactor",this.get("maxZoomFactor",100)),c=l;1===t&&0!==e&&(n=e<this.get("start")?"start":"end"),0===e&&1!==t&&(n=t>this.get("end")?"end":"start");let h=this.get("minZoomCount"),u=this.get("maxZoomCount");Se(h)&&(l=c/h);let m=1;if(Se(u)&&(m=c/u),"start"===n?(u>0&&1/(t-e)<m&&(t=e+1/m),1/(t-e)>l&&(t=e+1/l),t>1&&t-e<1/l&&(e=t-1/l)):(u>0&&1/(t-e)<m&&(e=t-1/m),1/(t-e)>l&&(e=t-1/l),e<0&&t-e<1/l&&(t=e+1/l)),1/(t-e)>l&&(t=e+1/l),1/(t-e)>l&&(e=t-1/l),null!=u&&null!=h&&e==this.get("start")&&t==this.get("end")){const p=this.chart;p&&p._handleAxisSelection(this,!0)}if((r&&r.playing&&r.to==e||this.get("start")==e)&&(a&&a.playing&&a.to==t||this.get("end")==t))return;if(i>0){let _,g,p=this.get("interpolationEasing");if(this.get("start")!=e&&(_=this.animate({key:"start",to:e,duration:i,easing:p})),this.get("end")!=t&&(g=this.animate({key:"end",to:t,duration:i,easing:p})),this._sAnimation=_,this._eAnimation=g,_)return _;if(g)return g}else this.set("start",e),this.set("end",t),this._root.events.once("frameended",()=>{this._markDirtyKey("start"),this._root._markDirty()})}else this._sAnimation&&this._sAnimation.stop(),this._eAnimation&&this._eAnimation.stop()}get series(){return this._series}_processAxisRange(e,t){e.setRaw("isRange",!0),this._createAssets(e,t),this._rangesDirty=!0,this._prepareDataItem(e);const i=e.get("above"),n=this.topGridContainer,r=e.get("grid");i&&r&&n.children.moveValue(r);const a=e.get("axisFill");i&&a&&n.children.moveValue(a)}_prepareDataItem(e,t){}markDirtyExtremes(){}markDirtySelectionExtremes(){}_calculateTotals(){}_updateAxisRanges(){this._bullets={},this.axisRanges.each(e=>{this._prepareDataItem(e)}),ye(this._seriesAxisRanges,e=>{this._prepareDataItem(e)})}_prepareChildren(){if(super._prepareChildren(),this.get("fixAxisSize")?this.ghostLabel.set("visible",!0):this.ghostLabel.set("visible",!1),this.isDirty("start")||this.isDirty("end")){const t=this.chart;t&&t._updateCursor();let i=this.get("start",0),n=this.get("end",1),r=this.get("maxDeviation",.5)*Math.min(1,n-i);if(i<-r){let a=i+r;i=-r,this.setRaw("start",i),this.isDirty("end")&&this.setRaw("end",n-a)}if(n>1+r){let a=n-1-r;n=1+r,this.setRaw("end",n),this.isDirty("start")&&this.setRaw("start",i-a)}}const e=this.get("renderer");if(e._start=this.get("start"),e._end=this.get("end"),e._inversed=e.get("inversed",!1),e._axisLength=e.axisLength()/(e._end-e._start),e._updateLC(),this.isDirty("tooltip")){const t=this.get("tooltip");if(t){const i=e.get("themeTags");t.addTag("axis"),t.addTag(this.className.toLowerCase()),t._applyThemes(),i&&(t.set("themeTags",ki(t.get("themeTags"),i)),t.label._applyThemes())}}}_updateTooltipBounds(){const e=this.get("tooltip");e&&this.get("renderer").updateTooltipBounds(e)}_updateBounds(){super._updateBounds(),this._updateTooltipBounds()}processChart(e){this.chart=e,this.get("renderer").chart=e,e.gridContainer.children.push(this.gridContainer),e.topGridContainer.children.push(this.topGridContainer),e.axisHeadersContainer.children.push(this.axisHeader),this.on("start",()=>{e._handleAxisSelection(this)}),this.on("end",()=>{e._handleAxisSelection(this)}),e.plotContainer.onPrivate("width",()=>{this.markDirtySize()}),e.plotContainer.onPrivate("height",()=>{this.markDirtySize()}),e.processAxis(this)}hideDataItem(e){return this._toggleFHDataItem(e,!0),super.hideDataItem(e)}showDataItem(e){return this._toggleFHDataItem(e,!1),super.showDataItem(e)}_toggleFHDataItem(e,t){const i="forceHidden",n=e.get("label");n&&n.set(i,t);const r=e.get("grid");r&&r.set(i,t);const a=e.get("tick");a&&a.set(i,t);const o=e.get("axisFill");o&&o.set(i,t);const l=e.get("bullet");if(l){const c=l.get("sprite");c&&c.set(i,t)}}_toggleDataItem(e,t){const i=e.get("label"),n="visible";i&&i.setPrivate(n,t);const r=e.get("grid");r&&r.setPrivate(n,t);const a=e.get("tick");a&&a.setPrivate(n,t);const o=e.get("axisFill");o&&o.setPrivate(n,t);const l=e.get("bullet");if(l){const c=l.get("sprite");c&&c.setPrivate(n,t)}}_createAssets(e,t,i){var n,r,a;const o=this.get("renderer");let l="minor";const c=e.get("label");if(c){let m=c.get("themeTags"),p=!1;i?-1==m?.indexOf(l)&&(p=!0):-1!=m?.indexOf(l)&&(p=!0),p&&(null===(n=c.parent)||void 0===n||n.children.removeValue(c),o.makeLabel(e,t),c.dispose(),o.labels.removeValue(c))}else o.makeLabel(e,t);const h=e.get("grid");if(h){let m=h.get("themeTags"),p=!1;i?-1==m?.indexOf(l)&&(p=!0):-1!=m?.indexOf(l)&&(p=!0),p&&(null===(r=h.parent)||void 0===r||r.children.removeValue(h),o.makeGrid(e,t),h.dispose(),o.grid.removeValue(h))}else o.makeGrid(e,t);const u=e.get("tick");if(u){let m=!1,p=u.get("themeTags");i?-1==p?.indexOf(l)&&(m=!0):-1!=p?.indexOf(l)&&(m=!0),m&&(null===(a=u.parent)||void 0===a||a.children.removeValue(u),o.makeTick(e,t),u.dispose(),o.ticks.removeValue(u))}else o.makeTick(e,t);!i&&!e.get("axisFill")&&o.makeAxisFill(e,t),this._processBullet(e)}_processBullet(e){let t=e.get("bullet"),i=this.get("bullet");if(!t&&i&&!e.get("isRange")&&(t=i(this._root,this,e)),t){t.axis=this;const n=t.get("sprite");n&&(n._setDataItem(e),e.setRaw("bullet",t),n.parent||this.bulletsContainer.children.push(n))}}_afterChanged(){super._afterChanged();const e=this.chart;e&&(e._updateChartLayout(),e.axisHeadersContainer.markDirtySize()),this.get("renderer")._updatePositions()}disposeDataItem(e){super.disposeDataItem(e);const t=this.get("renderer"),i=e.get("label");i&&(t.labels.removeValue(i),i.dispose());const n=e.get("tick");n&&(t.ticks.removeValue(n),n.dispose());const r=e.get("grid");r&&(t.grid.removeValue(r),r.dispose());const a=e.get("axisFill");a&&(t.axisFills.removeValue(a),a.dispose());const o=e.get("bullet");o&&o.dispose()}_updateGhost(){this.setPrivate("cellWidth",this.getCellWidthPosition()*this.get("renderer").axisLength());const e=this.ghostLabel;if(!e.isHidden()){const n=e.localBounds(),r=Math.ceil(n.right-n.left);let a=e.get("text");ye(this.dataItems,o=>{const l=o.get("label");if(l&&!l.isHidden()){const c=l.localBounds();Math.ceil(c.right-c.left)>r&&(a=l.text._getText())}}),e.set("text",a)}let t=this.get("start",0),i=this.get("end",1);this.get("renderer").updateLabel(e,t+.5*(i-t))}_handleCursorPosition(e,t){e=this.get("renderer").toAxisPosition(e),this._cursorPosition=e,this._snapToSeries=t,this.updateTooltip()}updateTooltip(){const e=this._snapToSeries;let t=this._cursorPosition;const i=this.get("tooltip"),n=this.get("renderer");Se(t)&&(ye(this.series,r=>{if(r.get("baseAxis")===this){const a=this.getSeriesItem(r,t,this.get("tooltipLocation"));r.setRaw("tooltipDataItem",a),e&&-1!=e.indexOf(r)?(r.updateLegendMarker(a),r.updateLegendValue(a)):r.showDataItemTooltip(a)}}),i&&(n.updateTooltipBounds(i),this.get("snapTooltip")&&(t=this.roundAxisPosition(t,this.get("tooltipLocation",.5))),Kt(t)?i.hide(0):(this.setPrivateRaw("tooltipPosition",t),this._updateTooltipText(i,t),n.positionTooltip(i,t),t<this.get("start")||t>this.get("end")?i.hide(0):i.show(0))))}_updateTooltipText(e,t){e.label.set("text",this.getTooltipText(t))}roundAxisPosition(e,t){return e}handleCursorShow(){let e=this.get("tooltip");e&&e.show()}handleCursorHide(){let e=this.get("tooltip");e&&e.hide()}processSeriesDataItem(e,t){}_clearDirty(){super._clearDirty(),this._sizeDirty=!1,this._rangesDirty=!1}coordinateToPosition(e){const t=this.get("renderer");return t.toAxisPosition(e/t.axisLength())}toAxisPosition(e){return this.get("renderer").toAxisPosition(e)}toGlobalPosition(e){return this.get("renderer").toGlobalPosition(e)}fixPosition(e){return this.get("renderer").fixPosition(e)}shouldGap(e,t,i,n){return!1}createAxisRange(e){return this.axisRanges.push(e)}_groupSeriesData(e){}getCellWidthPosition(){return.05}}Object.defineProperty(Sc,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Axis"}),Object.defineProperty(Sc,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Ec.classNames.concat([Sc.className])});class ha extends Sc{constructor(){super(...arguments),Object.defineProperty(this,"_dirtyExtremes",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dirtySelectionExtremes",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_deltaMinMax",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_minReal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_maxReal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_baseValue",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_syncDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_minLogAdjusted",{enumerable:!0,configurable:!0,writable:!0,value:1})}markDirtyExtremes(){this._dirtyExtremes=!0,this.markDirty()}markDirtySelectionExtremes(){this._dirtySelectionExtremes=!0,this.markDirty()}_afterNew(){this._settings.themeTags=ki(this._settings.themeTags,["axis"]),this.setPrivateRaw("name","value"),this.addTag("value"),super._afterNew()}_prepareChildren(){if(super._prepareChildren(),this.isDirty("syncWithAxis")){this._prevSettings.syncWithAxis&&this._syncDp&&this._syncDp.dispose();let i=this.get("syncWithAxis");i&&(this._syncDp=new mr([i.onPrivate("selectionMinFinal",()=>{this._dirtySelectionExtremes=!0}),i.onPrivate("selectionMaxFinal",()=>{this._dirtySelectionExtremes=!0})]))}let e=!1;(this.isDirty("min")||this.isDirty("max")||this.isDirty("maxPrecision")||this.isDirty("numberFormat"))&&(e=!0,this.ghostLabel.set("text","")),(this._sizeDirty||this._dirtyExtremes||this._valuesDirty||e||this.isPrivateDirty("width")||this.isPrivateDirty("height")||this.isDirty("extraMin")||this.isDirty("extraMax")||this.isDirty("logarithmic")||this.isDirty("treatZeroAs")||this.isDirty("baseValue")||this.isDirty("strictMinMax")||this.isDirty("strictMinMaxSelection"))&&(this._getMinMax(),this._dirtyExtremes=!1),this._dirtySelectionExtremes&&!this._isPanning&&this.get("autoZoom",!0)&&(this._getSelectionMinMax(),this._dirtySelectionExtremes=!1),this._groupData(),(this._sizeDirty||this._valuesDirty||this.isDirty("start")||this.isDirty("end")||this.isPrivateDirty("min")||this.isPrivateDirty("selectionMax")||this.isPrivateDirty("selectionMin")||this.isPrivateDirty("max")||this.isPrivateDirty("step")||this.isPrivateDirty("width")||this.isPrivateDirty("height")||this.isDirty("logarithmic"))&&(this._handleRangeChange(),this._prepareAxisItems(),this._updateAxisRanges()),this._baseValue=this.baseValue()}_groupData(){}_formatText(e){const t=this.get("numberFormat"),i=this.getNumberFormatter();let n="";return n=t?i.format(e,t):i.format(e,void 0,this.getPrivate("stepDecimalPlaces")),n}_prepareAxisItems(){const e=this.getPrivate("min"),t=this.getPrivate("max");if(Se(e)&&Se(t)){const i=this.get("logarithmic"),n=this.getPrivate("step"),r=this.getPrivate("selectionMin"),a=this.getPrivate("selectionMax")+n;let o=r-n,l=1,c=e;if(i){if(o=this._minLogAdjusted,o<r)for(;o<r;)o+=n;c=o,c<=0&&(c=1,n<1&&(c=n)),l=Math.log(a-n)*Math.LOG10E-Math.log(c)*Math.LOG10E,l>2&&(o=Math.pow(10,Math.log(c)*Math.LOG10E-5))}const h=this.get("renderer"),u=h.get("minorLabelsEnabled"),m=h.get("minorGridEnabled",u);let p=Math.pow(10,Math.floor(Math.log(Math.abs(n))*Math.LOG10E));const _=Math.round(n/p);let g=2;fr(_/5,10)%1==0&&(g=5),fr(_/10,10)%1==0&&(g=10);let f=n/g,b=0,C=0,M=-1/0;for(;o<a;){let E;this.dataItems.length<b+1?(E=new Za(this,void 0,{}),this._dataItems.push(E),this.processDataItem(E)):E=this.dataItems[b],this._createAssets(E,[]),this._toggleDataItem(E,!0),E.setRaw("value",o);const S=E.get("label");S&&S.set("text",this._formatText(o)),this._prepareDataItem(E);let P=o;if(i&&l>2?P=Math.pow(10,Math.log(c)*Math.LOG10E+b-5):P+=n,m){let L=o+f;for(i&&(l>2&&(f=this._adjustMinMax(o,P,10).step),L=o+f);L<P-1e-11*n;){let O;this.minorDataItems.length<C+1?(O=new Za(this,void 0,{}),this.minorDataItems.push(O),this.processDataItem(O)):O=this.minorDataItems[C],this._createAssets(O,["minor"],!0),this._toggleDataItem(O,!0),O.setRaw("value",L);const B=O.get("label");B&&(u?B.set("text",this._formatText(L)):B.setPrivate("visible",!1)),this._prepareDataItem(O),L+=f,C++}}if(o=P,M==o)break;let I=Math.pow(10,Math.floor(Math.log(Math.abs(n))*Math.LOG10E));I<1&&(o=fr(o,Math.round(Math.abs(Math.log(Math.abs(I))*Math.LOG10E))+2)),b++,M=o}for(let E=b;E<this.dataItems.length;E++)this._toggleDataItem(this.dataItems[E],!1);for(let E=C;E<this.minorDataItems.length;E++)this._toggleDataItem(this.minorDataItems[E],!1);ye(this.series,E=>{E.inited&&E._markDirtyAxes()}),this._updateGhost()}}_prepareDataItem(e,t){let i=this.get("renderer"),n=e.get("value"),r=e.get("endValue"),a=this.valueToPosition(n),o=a,l=this.valueToPosition(n+this.getPrivate("step"));Se(r)&&(o=this.valueToPosition(r),l=o),e.get("isRange")&&null==r&&(l=a);let c=o,h=e.get("labelEndValue");null!=h&&(c=this.valueToPosition(h)),i.updateLabel(e.get("label"),a,c,t);const u=e.get("grid");if(i.updateGrid(u,a,o),u&&(n==this.get("baseValue",0)?(u.addTag("base"),u._applyThemes()):u.hasTag("base")&&(u.removeTag("base"),u._applyThemes())),i.updateTick(e.get("tick"),a,c,t),i.updateFill(e.get("axisFill"),a,l),this._processBullet(e),i.updateBullet(e.get("bullet"),a,o),!e.get("isRange")){const m=this.get("fillRule");m&&m(e)}}_handleRangeChange(){let e=this.positionToValue(this.get("start",0)),t=this.positionToValue(this.get("end",1));const i=this.get("renderer").gridCount();let n=this._adjustMinMax(e,t,i,!0),r=function Va(s){let e=(""+s).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0}(n.step);this.setPrivateRaw("stepDecimalPlaces",r),e=fr(e,r),t=fr(t,r),n=this._adjustMinMax(e,t,i,!0);let a=n.step;e=n.min,t=n.max,(this.getPrivate("selectionMin")!==e||this.getPrivate("selectionMax")!==t||this.getPrivate("step")!==a)&&(this.setPrivateRaw("selectionMin",e),this.setPrivateRaw("selectionMax",t),this.setPrivateRaw("step",a))}positionToValue(e){const t=this.getPrivate("min"),i=this.getPrivate("max");return this.get("logarithmic")?Math.pow(Math.E,(e*(Math.log(i)*Math.LOG10E-Math.log(t)*Math.LOG10E)+Math.log(t)*Math.LOG10E)/Math.LOG10E):e*(i-t)+t}valueToPosition(e){const t=this.getPrivate("min"),i=this.getPrivate("max");if(this.get("logarithmic")){if(e<=0){let n=this.get("treatZeroAs");Se(n)&&(e=n)}return(Math.log(e)*Math.LOG10E-Math.log(t)*Math.LOG10E)/(Math.log(i)*Math.LOG10E-Math.log(t)*Math.LOG10E)}return(e-t)/(i-t)}valueToFinalPosition(e){const t=this.getPrivate("minFinal"),i=this.getPrivate("maxFinal");if(this.get("logarithmic")){if(e<=0){let n=this.get("treatZeroAs");Se(n)&&(e=n)}return(Math.log(e)*Math.LOG10E-Math.log(t)*Math.LOG10E)/(Math.log(i)*Math.LOG10E-Math.log(t)*Math.LOG10E)}return(e-t)/(i-t)}getX(e,t,i){const n=this.valueToPosition(e=i+(e-i)*t);return this._settings.renderer.positionToCoordinate(n)}getY(e,t,i){const n=this.valueToPosition(e=i+(e-i)*t);return this._settings.renderer.positionToCoordinate(n)}getDataItemCoordinateX(e,t,i,n){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionX(e,t,i,n))}getDataItemPositionX(e,t,i,n){let r=e.get(t);return r=e.get("stackToItemX")?r*n+e.component.getStackedXValueWorking(e,t):this._baseValue+(r-this._baseValue)*n,this.valueToPosition(r)}getDataItemCoordinateY(e,t,i,n){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionY(e,t,i,n))}getDataItemPositionY(e,t,i,n){let r=e.get(t);return r=e.get("stackToItemY")?r*n+e.component.getStackedYValueWorking(e,t):this._baseValue+(r-this._baseValue)*n,this.valueToPosition(r)}basePosition(){return this.valueToPosition(this.baseValue())}baseValue(){const e=Math.min(this.getPrivate("minFinal",-1/0),this.getPrivate("selectionMin",-1/0)),t=Math.max(this.getPrivate("maxFinal",1/0),this.getPrivate("selectionMax",1/0));let i=this.get("baseValue",0);return i<e&&(i=e),i>t&&(i=t),i}cellEndValue(e){return e}fixSmallStep(e){return 1+e===1?this.fixSmallStep(e*=2):e}_fixMin(e){return e}_fixMax(e){return e}_calculateTotals(){if(this.get("calculateTotals")){let e=this.series[0];if(e){let t=e.startIndex();if(e.dataItems.length>0){t>0&&t--;let n,r,i=e.endIndex();i<e.dataItems.length&&i++,e.get("yAxis")==this?(n="valueY",r="vcy"):e.get("xAxis")==this&&(n="valueX",r="vcx");let a=n+"Working";if(n)for(let o=t;o<i;o++){let l=0,c=0;ye(this.series,h=>{if(!h.get("excludeFromTotal")){let u=h.dataItems[o];if(u){let m=u.get(a)*h.get(r);Kt(m)||(l+=m,c+=Math.abs(m))}}}),ye(this.series,h=>{if(!h.get("excludeFromTotal")){let u=h.dataItems[o];if(u){let m=u.get(a)*h.get(r);Kt(m)||(u.set(n+"Total",c),u.set(n+"Sum",l),u.set(n+"TotalPercent",m/c*100))}}})}}}}}_getSelectionMinMax(){const e=this.getPrivate("minFinal"),t=this.getPrivate("maxFinal"),i=this.get("min"),n=this.get("max");let r=this.get("extraMin",0),a=this.get("extraMax",0);this.get("logarithmic")&&(null==this.get("extraMin")&&(r=.1),null==this.get("extraMax")&&(a=.2));const o=this.get("renderer").gridCount(),l=this.get("strictMinMaxSelection");let c=this.get("strictMinMax");if(Se(e)&&Se(t)){let h=t,u=e;if(ye(this.series,M=>{if(!M.get("ignoreMinMax")){let E,S;const P=M.getPrivate("outOfSelection");if(M.get("xAxis")===this){if(!P){let I=M.getPrivate("minX"),L=M.getPrivate("maxX");(0!=M.startIndex()||M.endIndex()!=M.dataItems.length)&&(I=void 0,L=void 0),E=M.getPrivate("selectionMinX",I),S=M.getPrivate("selectionMaxX",L)}}else if(M.get("yAxis")===this&&!P){let I=M.getPrivate("minY"),L=M.getPrivate("maxY");(0!=M.startIndex()||M.endIndex()!=M.dataItems.length)&&(I=void 0,L=void 0),E=M.getPrivate("selectionMinY",I),S=M.getPrivate("selectionMaxY",L)}!M.isHidden()&&!M.isShowing()&&(Se(E)&&(h=Math.min(h,E)),Se(S)&&(u=Math.max(u,S)))}}),this.axisRanges.each(M=>{if(M.get("affectsMinMax")){let E=M.get("value");null!=E&&(h=Math.min(h,E),u=Math.max(u,E)),E=M.get("endValue"),null!=E&&(h=Math.min(h,E),u=Math.max(u,E))}}),h>u&&([h,u]=[u,h]),Se(i)?h=c?i:e:c&&Se(this._minReal)&&(h=this._minReal),Se(n)?u=c?n:t:c&&Se(this._maxReal)&&(u=this._maxReal),h===u){let M=h;if(h-=this._deltaMinMax,u+=this._deltaMinMax,h<e){let S=M-e;0==S&&(S=this._deltaMinMax),h=M-S,u=M+S,c=!0}let E=this._adjustMinMax(h,u,o,c);h=E.min,u=E.max}let m=h,p=u;h-=(u-h)*r,u+=(u-h)*a;let _=this._adjustMinMax(h,u,o);h=_.min,u=_.max,h=Hs(h,e,t),u=Hs(u,e,t),_=this._adjustMinMax(h,u,o,!0),c||(h=_.min,u=_.max);const g=this.get("syncWithAxis");g&&(_=this._syncAxes(h,u,_.step,g.getPrivate("selectionMinFinal",g.getPrivate("minFinal",0)),g.getPrivate("selectionMaxFinal",g.getPrivate("maxFinal",1)),g.getPrivate("selectionStepFinal",g.getPrivate("step",1))),h=_.min,u=_.max),c&&(Se(i)&&(h=Math.max(h,i)),Se(n)&&(u=Math.min(u,n))),l&&(h=m-(u-h)*r,u=p+(u-h)*a),this.get("logarithmic")&&(h<=0&&(h=m*(1-Math.min(r,.99))),h<e&&(h=e),u>t&&(u=t));let f=Math.min(20,Math.ceil(Math.log(this.getPrivate("maxZoomFactor",100)+1)/Math.LN10)+2),b=fr(this.valueToFinalPosition(h),f),C=fr(this.valueToFinalPosition(u),f);this.setPrivateRaw("selectionMinFinal",h),this.setPrivateRaw("selectionMaxFinal",u),this.setPrivateRaw("selectionStepFinal",_.step),this.zoom(b,C)}}_getMinMax(){let e=this.get("min"),t=this.get("max"),i=1/0,n=-1/0,r=this.get("extraMin",0),a=this.get("extraMax",0);this.get("logarithmic")&&(null==this.get("extraMin")&&(r=.1),null==this.get("extraMax")&&(a=.2));let o=1/0;if(ye(this.series,M=>{if(!M.get("ignoreMinMax")){let E,S;if(M.get("xAxis")===this?(E=M.getPrivate("minX"),S=M.getPrivate("maxX")):M.get("yAxis")===this&&(E=M.getPrivate("minY"),S=M.getPrivate("maxY")),Se(E)&&Se(S)){i=Math.min(i,E),n=Math.max(n,S);let P=S-E;P<=0&&(P=Math.abs(S/100)),P<o&&(o=P)}}}),this.axisRanges.each(M=>{if(M.get("affectsMinMax")){let E=M.get("value");null!=E&&(i=Math.min(i,E),n=Math.max(n,E)),E=M.get("endValue"),null!=E&&(i=Math.min(i,E),n=Math.max(n,E))}}),this.get("logarithmic")){let M=this.get("treatZeroAs");Se(M)&&i<=0&&(i=M),i<=0&&new Error("Logarithmic value axis can not have values <= 0.")}if(0===i&&0===n&&(n=.9,i=-.9),Se(e)&&(i=e),Se(t)&&(n=t),i===1/0||n===-1/0)return this.setPrivate("minFinal",void 0),void this.setPrivate("maxFinal",void 0);const l=i,c=n;let h=this.adapters.fold("min",i),u=this.adapters.fold("max",n);Se(h)&&(i=h),Se(u)&&(n=u),i=this._fixMin(i),n=this._fixMax(n),n-i<=1/Math.pow(10,15)&&(n-i!=0?this._deltaMinMax=(n-i)/2:this._getDelta(n),i-=this._deltaMinMax,n+=this._deltaMinMax),i-=(n-i)*r,n+=(n-i)*a,this.get("logarithmic")&&(i<0&&l>=0&&(i=0),n>0&&c<=0&&(n=0)),this._minReal=i,this._maxReal=n;let m=this.get("strictMinMax"),p=this.get("strictMinMaxSelection",!1);p&&(m=p);let _=m;Se(t)&&(_=!0);let g=this.get("renderer").gridCount(),f=this._adjustMinMax(i,n,g,_);i=f.min,n=f.max,f=this._adjustMinMax(i,n,g,!0),i=f.min,n=f.max,m&&(i=Se(e)?e:this._minReal,n=Se(t)?t:this._maxReal,n-i<=1e-8&&(i-=this._deltaMinMax,n+=this._deltaMinMax),i-=(n-i)*r,n+=(n-i)*a),h=this.adapters.fold("min",i),u=this.adapters.fold("max",n),Se(h)&&(i=h),Se(u)&&(n=u),o==1/0&&(o=n-i);let b=Math.round(Math.abs(Math.log(Math.abs(n-i))*Math.LOG10E))+5;i=fr(i,b),n=fr(n,b);const C=this.get("syncWithAxis");if(C&&(f=this._syncAxes(i,n,f.step,C.getPrivate("minFinal",C.getPrivate("min",0)),C.getPrivate("maxFinal",C.getPrivate("max",1)),C.getPrivate("step",1)),i=f.min,n=f.max),this.setPrivateRaw("maxZoomFactor",Math.max(1,Math.ceil((n-i)/o*this.get("maxZoomFactor",100)))),this._fixZoomFactor(),this.get("logarithmic")&&(this._minLogAdjusted=i,i=this._minReal,n=this._maxReal,i<=0&&(i=l*(1-Math.min(r,.99)))),Se(i)&&Se(n)&&(this.getPrivate("minFinal")!==i||this.getPrivate("maxFinal")!==n)){this.setPrivate("minFinal",i),this.setPrivate("maxFinal",n),this._saveMinMax(i,n);const M=this.get("interpolationDuration",0),E=this.get("interpolationEasing");this.animatePrivate({key:"min",to:i,duration:M,easing:E}),this.animatePrivate({key:"max",to:n,duration:M,easing:E})}}_fixZoomFactor(){}_getDelta(e){let t=Math.log(Math.abs(e))*Math.LOG10E,i=Math.pow(10,Math.floor(t));i/=10,this._deltaMinMax=i}_saveMinMax(e,t){}_adjustMinMax(e,t,i,n){i<=1&&(i=1),i=Math.round(i);let r=e,a=t,o=t-e;0===o&&(o=Math.abs(t));let l=Math.log(Math.abs(o))*Math.LOG10E,c=Math.pow(10,Math.floor(l));c/=10;let h=c;n&&(h=0),n?(e=Math.floor(e/c)*c,t=Math.ceil(t/c)*c):(e=Math.ceil(e/c)*c-h,t=Math.floor(t/c)*c+h),e<0&&r>=0&&(e=0),t>0&&a<=0&&(t=0),l=Math.log(Math.abs(o))*Math.LOG10E,c=Math.pow(10,Math.floor(l)),c/=100;let u=Math.ceil(o/i/c)*c,m=Math.pow(10,Math.floor(Math.log(Math.abs(u))*Math.LOG10E)),p=Math.ceil(u/m);p>5?p=10:p<=5&&p>2&&(p=5),u=Math.ceil(u/(m*p))*m*p;let _=this.get("maxPrecision");if(Se(_)){let C=function jC(s,e){if(!Se(e)||e<=0)return Math.ceil(s);{let t=Math.pow(10,e);return Math.ceil(s*t)/t}}(u,_);_<Number.MAX_VALUE&&u!==C&&(u=C)}let g=0;m<1&&(g=Math.round(Math.abs(Math.log(Math.abs(m))*Math.LOG10E))+1,u=fr(u,g));let b,f=Math.floor(e/u);return e=fr(u*f,g),b=n?Math.floor(t/u):Math.ceil(t/u),b===f&&b++,(t=fr(u*b,g))<a&&(t+=u),e>r&&(e-=u),u=this.fixSmallStep(u),{min:e,max:t,step:u}}getTooltipText(e,t){const i=this.get("tooltipNumberFormat",this.get("numberFormat")),n=this.getNumberFormatter(),r=this.get("extraTooltipPrecision",0),a=this.getPrivate("stepDecimalPlaces",0)+r,o=fr(this.positionToValue(e),a);return i?n.format(o,i):n.format(o,void 0,a)}getSeriesItem(e,t){let r,a,i=this.getPrivate("name")+this.get("renderer").getPrivate("letter"),n=this.positionToValue(t);if(ye(e.dataItems,(o,l)=>{const c=Math.abs(o.get(i)-n);(void 0===r||c<a)&&(r=l,a=c)}),null!=r)return e.dataItems[r]}zoomToValues(e,t,i){const n=this.getPrivate("minFinal",0),r=this.getPrivate("maxFinal",0);null!=this.getPrivate("min")&&null!=this.getPrivate("max")&&this.zoom((e-n)/(r-n),(t-n)/(r-n),i)}_syncAxes(e,t,i,n,r,a){if(this.get("syncWithAxis")){let l=Math.round(r-n)/a,c=Math.round((t-e)/i),h=this.get("renderer").gridCount();if(Se(l)&&Se(c)){let u=!1,m=0,p=.01*(t-e),_=e,g=t,f=i;for(;1!=u;)if(u=this._checkSync(_,g,f,l),m++,m>500&&(u=!0),u)e=_,t=g,i=f;else{m/3==Math.round(m/3)?(_=e-p*m,e>=0&&_<0&&(_=0)):(g=t+p*m,g<=0&&g>0&&(g=0));let b=this._adjustMinMax(_,g,h,!0);_=b.min,g=b.max,f=b.step}}}return{min:e,max:t,step:i}}_checkSync(e,t,i,n){let r=(t-e)/i;for(let a=1;a<n;a++)if(fr(r/a,1)==n||r*a==n)return!0;return!1}getCellWidthPosition(){let e=this.getPrivate("selectionMax",this.getPrivate("max")),t=this.getPrivate("selectionMin",this.getPrivate("min"));return Se(e)&&Se(t)?this.getPrivate("step",1)/(e-t):.05}}Object.defineProperty(ha,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ValueAxis"}),Object.defineProperty(ha,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Sc.classNames.concat([ha.className])});class kc extends ha{constructor(){super(...arguments),Object.defineProperty(this,"_dataGrouped",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_seriesDataGrouped",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_groupingCalculated",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_intervalDuration",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_baseDuration",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_intervalMax",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_intervalMin",{enumerable:!0,configurable:!0,writable:!0,value:{}})}_afterNew(){this._settings.themeTags=ki(this._settings.themeTags,["axis"]),super._afterNew(),this._setBaseInterval(this.get("baseInterval")),this.on("baseInterval",()=>{this._setBaseInterval(this.get("baseInterval"))})}_setBaseInterval(e){this.setPrivateRaw("baseInterval",e),this._baseDuration=mo(e)}_fixZoomFactor(){const e=this.get("maxZoomFactor");this.setPrivateRaw("maxZoomFactor",null!=e&&e!=1/0?e:Math.round((this.getPrivate("max",0)-this.getPrivate("min",0))/this.baseMainDuration()))}_groupData(){const e=this.getPrivate("min"),t=this.getPrivate("max");if(Se(e)&&Se(t)){this._fixZoomFactor();const i=this.getPrivate("groupInterval");if(this._setBaseInterval(i||this.get("baseInterval")),this.isDirty("groupInterval")){let n=this.get("groupInterval");n&&(this.setRaw("groupIntervals",[n]),this._handleRangeChange())}if(this.isDirty("groupData")&&!this._dataGrouped){if(this.get("groupData"))ye(this.series,n=>{this._groupSeriesData(n)}),this._handleRangeChange();else{let n=this.get("baseInterval"),r=n.timeUnit+n.count;ye(this.series,a=>{a.setDataSet(r),a.resetGrouping()}),this._setBaseInterval(n),this.setPrivateRaw("groupInterval",void 0),this.markDirtyExtremes()}this._dataGrouped=!0}}}_groupSeriesData(e){if(this.get("groupData")&&!e.get("groupDataDisabled")){this._dataGrouped=!0,this._seriesDataGrouped=!0;let t=[],i=this.baseMainDuration();ye(this.get("groupIntervals"),p=>{mo(p)>i&&t.push(p)}),e._dataSets={};const r=this.getPrivate("name")+this.get("renderer").getPrivate("letter");let a;const o=e.get("baseAxis");e.get("xAxis")===o?a=e._valueYFields:e.get("yAxis")===o&&(a=e._valueXFields);let l=e._mainDataItems,c=this.get("baseInterval");e._dataSets[c.timeUnit+c.count]=l;const u=e.get("groupDataCallback");let m=e.get("groupDataWithOriginals",!1);u&&(m=!0),ye(t,p=>{let _=-1/0,g=p.timeUnit+p.count;e._dataSets[g]=[];let f,b={},C={},M={},E={};ye(a,O=>{b[O]=0,C[O]=0,M[O]=e.get(O+"Grouped"),E[O]=O+"Working"});let I,L,S=Wr(p.timeUnit);l[0]&&(I=l[0].get(r)),ye(l,O=>{let pe,Q=Gr(O.get(r),p.timeUnit,p.count,this._root,I);_<Q-S/24?(pe=zo(O.dataContext),f=new Za(e,pe,e._makeDataItem(pe)),f.setRaw(r,Q),e._dataSets[g].push(f),ye(a,ae=>{let N=O.get(ae);Se(N)?(f.setRaw(ae,N),f.setRaw(E[ae],N),C[ae]=1,b[ae]=N):(b[ae]=0,C[ae]=0)}),m&&f.set("originals",[O]),u&&L&&u(L,p),L=f):(ye(a,ae=>{let N=M[ae],ee=O.get(ae);if(null!=ee){let K=f.get(ae);switch(N){case"close":f.setRaw(ae,ee);break;case"sum":f.setRaw(ae,K+ee);break;case"open":break;case"low":ee<K&&f.setRaw(ae,ee);break;case"high":ee>K&&f.setRaw(ae,ee);break;case"average":C[ae]++,b[ae]+=ee,f.setRaw(ae,b[ae]/C[ae]);break;case"extreme":Math.abs(ee)>Math.abs(K)&&f.setRaw(ae,ee)}f.setRaw(E[ae],f.get(ae));let se=zo(O.dataContext);se[r]=Q,f.dataContext=se}}),m&&f.get("originals").push(O)),_=Q}),u&&L&&u(L,p)}),e._dataSetId&&e.setDataSet(e._dataSetId),this.markDirtySize()}}_clearDirty(){super._clearDirty(),this._groupingCalculated=!1,this._dataGrouped=!1}getGroupInterval(e){let t=this.get("baseInterval"),i=Mb(0,e,this.get("groupCount",1/0),this.get("groupIntervals"));return mo(i)<mo(t)&&(i=Object.assign({},t)),i}getIntervalMax(e){return this._intervalMax[e.timeUnit+e.count]}getIntervalMin(e){return this._intervalMin[e.timeUnit+e.count]}_handleRangeChange(){super._handleRangeChange();let e=Math.round(this.getPrivate("selectionMin")),t=Math.round(this.getPrivate("selectionMax"));if(Se(e)&&Se(t)){if(0==this.get("endLocation")&&(t+=1),this.get("groupData")&&!this._groupingCalculated){this._groupingCalculated=!0;let i=this.get("groupInterval"),n=this.getPrivate("groupInterval"),r=t-e+(this.get("startLocation",0)+(1-this.get("endLocation",1))*this.baseDuration());if(n){let a=mo(n);r=Math.ceil(r/a)*a}if(i||(i=this.getGroupInterval(r)),i&&(!n||n.timeUnit!==i.timeUnit||n.count!==i.count||this._seriesDataGrouped)){this._seriesDataGrouped=!1,this.setPrivateRaw("groupInterval",i),this._setBaseInterval(i);let a=i.timeUnit+i.count;ye(this.series,o=>{o.get("baseAxis")===this&&o.setDataSet(a)}),this.markDirtyExtremes(),this._root.events.once("frameended",()=>{this._root.events.once("frameended",()=>{const o="groupintervalchanged";this.events.isEnabled(o)&&this.events.dispatch(o,{type:o,target:this})})})}}ye(this.series,i=>{if(i.get("baseAxis")===this){let n=this.getPrivate("name")+this.get("renderer").getPrivate("letter"),a=gu(i.dataItems,g=>uo(g.get(n),e)).index;a>0&&(a-=1),t+=this.baseDuration()*(1-this.get("endLocation",1));let l=fu(i.dataItems,g=>uo(g.get(n),t)).index,c=l;c>1&&c--;const h=i.dataItems[a],u=i.dataItems[c];let m,p;h&&(p=h.get(n)),u&&(m=u.get(n));let _=!1;null!=m&&null!=p&&(m<e||p>t)&&(_=!0),i.setPrivate("outOfSelection",_),i.setPrivate("startIndex",a),i.setPrivate("endIndex",l)}})}}_adjustMinMax(e,t,i,n){return{min:e,max:t,step:(t-e)/i}}intervalDuration(){return this._intervalDuration}_saveMinMax(e,t){let i=this.getPrivate("groupInterval");i||(i=this.get("baseInterval"));let n=i.timeUnit+i.count;this._intervalMin[n]=e,this._intervalMax[n]=t}_getM(e){return"month"==e||"year"==e||"day"==e?1.05:1.01}_getMinorInterval(e){var t;let i,n=e.count,r=e.timeUnit;return n>1&&(10==n||15==n?n=5:12==n?n=2:6==n?n=1:30==n?n=10:n<10&&(n=1),i={timeUnit:r,count:n}),"week"==r&&"week"!=(null===(t=this.getPrivate("baseInterval"))||void 0===t?void 0:t.timeUnit)&&(i={timeUnit:"day",count:1}),i}_prepareAxisItems(){const e=this.getPrivate("min"),t=this.getPrivate("max");if(Se(e)&&Se(t)){const i=this._root,n=Math.round(this.getPrivate("selectionMin")),r=Math.round(this.getPrivate("selectionMax")),a=this.get("renderer"),o=this.getPrivate("baseInterval");let l=n,c=0;const h=this.get("gridIntervals");let u=Mb(0,r-n,a.gridCount(),h);mo(u)<this.baseDuration()&&(u=Object.assign({},o));const m=mo(u);this._intervalDuration=m;const p=Ky(u.timeUnit),_=i.utc,g=i.timezone;l=Gr(n-m,u.timeUnit,u.count,i,e);let b,f=l-m;const C=this.get("dateFormats");this.setPrivateRaw("gridInterval",u);const M=a.get("minorLabelsEnabled"),E=a.get("minorGridEnabled",M);let S,P=0;E&&(S=this._getMinorInterval(u),P=mo(S));let I=0;for(;l<r+m;){let L;this.dataItems.length<c+1?(L=new Za(this,void 0,{}),this._dataItems.push(L),this.processDataItem(L)):L=this.dataItems[c],this._createAssets(L,[]),this._toggleDataItem(L,!0),L.setRaw("value",l),L.setRaw("labelEndValue",void 0);let O=l+Wr(u.timeUnit,u.count*this._getM(u.timeUnit));O=Gr(O,u.timeUnit,1,i),L.setRaw("endValue",O);let B=new Date(l);b=C[u.timeUnit],p&&this.get("markUnitChange")&&Se(f)&&"year"!=u.timeUnit&&Jy(l,f,p,_,g)&&(b=this.get("periodChangeDateFormats")[u.timeUnit]);const Q=L.get("label");Q&&Q.set("text",i.dateFormatter.format(B,b));let pe=u.count;if("week"==u.timeUnit&&L.setRaw("labelEndValue",l),E){pe=1;let ae=u.timeUnit;"week"==ae&&(ae="day");let N=l+Wr(ae,this._getM(ae));N=Gr(N,ae,1,i),L.setRaw("labelEndValue",N)}if(this._prepareDataItem(L,pe),f=l,l=O,S){const ae=S.timeUnit,N=S.count,ee=this._getM(ae);let se,K=Gr(f+P*ee,ae,N,i,f),ue=this.get("minorDateFormats",this.get("dateFormats"));for(;K<l-.01*P;){let re;this.minorDataItems.length<I+1?(re=new Za(this,void 0,{}),this.minorDataItems.push(re),this.processDataItem(re)):re=this.minorDataItems[I],this._createAssets(re,["minor"],!0),this._toggleDataItem(re,!0),re.setRaw("value",K);let xe=K+Wr(ae,N*ee);xe=Gr(xe,ae,1,i),re.setRaw("endValue",xe);let Ce=new Date(K);b=ue[ae];const Fe=re.get("label");if(Fe&&(M?Fe.set("text",i.dateFormatter.format(Ce,b)):Fe.setPrivate("visible",!1)),this._prepareDataItem(re,1),K==se)break;se=K,K=xe,I++}}if(l==f)break;c++}for(let L=c;L<this.dataItems.length;L++)this._toggleDataItem(this.dataItems[L],!1);for(let L=I;L<this.minorDataItems.length;L++)this._toggleDataItem(this.minorDataItems[L],!1);ye(this.series,L=>{L.inited&&L._markDirtyAxes()})}this._updateGhost()}_updateFinals(e,t){this.setPrivateRaw("selectionMinFinal",this.positionToValue(e)),this.setPrivateRaw("selectionMaxFinal",this.positionToValue(t))}_getDelta(){this._deltaMinMax=this.baseDuration()/2}_fixMin(e){const t=this.getPrivate("baseInterval"),i=t.timeUnit;let n=Gr(e,i,t.count,this._root),r=n+Wr(i,t.count*this._getM(i));return r=Gr(r,i,1,this._root),n+(r-n)*this.get("startLocation",0)}_fixMax(e){const t=this.getPrivate("baseInterval"),i=t.timeUnit;let n=Gr(e,i,t.count,this._root),r=n+Wr(i,t.count*this._getM(i));return r=Gr(r,i,1,this._root),n+(r-n)*this.get("endLocation",1)}_updateDates(e,t){}baseDuration(){return this._baseDuration}baseMainDuration(){return mo(this.get("baseInterval"))}processSeriesDataItem(e,t){const i=this.getPrivate("baseInterval");e.open||(e.open={}),e.close||(e.close={}),ye(t,n=>{let r=e.get(n);if(Se(r)){let a=e.open[n],o=e.close[n];if(!(r>=a&&r<=o)){const l=i.timeUnit,c=i.count;a=Gr(r,l,c,this._root),o=a+Wr(l,c*this._getM(l)),o=Gr(o,l,1,this._root),e.open[n]=a,e.close[n]=o}this._updateDates(a,e.component)}})}getDataItemPositionX(e,t,i,n){let r,a;e.open&&e.close?(r=e.open[t],a=e.close[t]):(r=e.get(t),a=r);let o=r+(a-r)*i;return o=this._baseValue+(o-this._baseValue)*n,this.valueToPosition(o)}getDataItemCoordinateX(e,t,i,n){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionX(e,t,i,n))}getDataItemPositionY(e,t,i,n){let r,a;e.open&&e.close?(r=e.open[t],a=e.close[t]):(r=e.get(t),a=r);let o=r+(a-r)*i;return o=this._baseValue+(o-this._baseValue)*n,this.valueToPosition(o)}getDataItemCoordinateY(e,t,i,n){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionY(e,t,i,n))}roundAxisPosition(e,t){let i=this.positionToValue(e);i-=(t-.5)*this.baseDuration();let n=this.getPrivate("baseInterval");if(!Kt(i)){const r=this._root.locale.firstDayOfWeek,a=n.timeUnit,o=this._root.utc,l=this._root.timezone,c=n.count;i=Gr(i,a,c,this._root,this.getPrivate("min",0));let h=wb(n,new Date(i),r,o,l);return l&&(i=Gr(i+.05*this.baseDuration(),a,c,this._root,this.getPrivate("min",0)),h=wb(n,new Date(i+h*t),r,o,l)),this.valueToPosition(i+h*t)}return NaN}getTooltipText(e,t){if(null!=this.getPrivate("min")){let i=this.get("tooltipDateFormats")[this.getPrivate("baseInterval").timeUnit],n=this.positionToValue(e);if(Se(n)){let r=new Date(n),o=wb(this.getPrivate("baseInterval"),r,this._root.locale.firstDayOfWeek,this._root.utc,this._root.timezone);return!1!==t&&(r=new Date(n+this.get("tooltipIntervalOffset",-this.get("tooltipLocation",.5))*o)),this._root.dateFormatter.format(r,this.get("tooltipDateFormat",i))}}return""}getSeriesItem(e,t,i,n){let r=this.getPrivate("name")+this.get("renderer").getPrivate("letter"),a=this.positionToValue(t);null==i&&(i=.5),a-=(i-.5)*this.baseDuration();const o=fu(e.dataItems,l=>{let c=0;return l.open&&(c=l.open[r]),uo(c,a)});if(n||e.get("snapTooltip")){let l=e.dataItems[o.index-1],c=e.dataItems[o.index];if(l&&c&&l.open&&c.close){let u=c.close[r];if(Math.abs(a-l.open[r])>Math.abs(a-u))return c}if(l)return l;if(c)return c}else{const l=e.dataItems[o.index-1];if(l&&l.open&&l.close&&a>=l.open[r]&&a<=l.close[r])return l}}shouldGap(e,t,i,n){const r=e.get(n);return t.get(n)-r>this.baseDuration()*i}zoomToDates(e,t,i){this.zoomToValues(e.getTime(),t.getTime(),i)}positionToDate(e){return new Date(this.positionToValue(e))}dateToPosition(e){return this.valueToPosition(e.getTime())}getCellWidthPosition(){let e=this.getPrivate("selectionMax",this.getPrivate("max")),t=this.getPrivate("selectionMin",this.getPrivate("min"));return Se(e)&&Se(t)?this._intervalDuration/(e-t):.05}}function Qy(s,e){for(let t=0,i=e.length;t<i;t++){const n=e[t];if(n.length>0){let r=n[0];if(r.length>0){let a=r[0];s.moveTo(a.x,a.y);for(let o=0,l=n.length;o<l;o++)ex(s,n[o])}}}}function ex(s,e){for(let t=0,i=e.length;t<i;t++){const n=e[t];s.lineTo(n.x,n.y)}}Object.defineProperty(kc,"className",{enumerable:!0,configurable:!0,writable:!0,value:"DateAxis"}),Object.defineProperty(kc,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ha.classNames.concat([kc.className])});class Bu extends rn{_beforeChanged(){super._beforeChanged(),(this.isDirty("points")||this.isDirty("segments")||this._sizeDirty||this.isPrivateDirty("width")||this.isPrivateDirty("height"))&&(this._clear=!0)}_changed(){if(super._changed(),this._clear){const e=this.get("points"),t=this.get("segments");if(e&&e.length>0){let i=e[0];this._display.moveTo(i.x,i.y),Qy(this._display,[[e]])}else if(t)Qy(this._display,t);else if(!this.get("draw")){let i=this.width(),n=this.height();this._display.moveTo(0,0),this._display.lineTo(i,n)}}}}Object.defineProperty(Bu,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Line"}),Object.defineProperty(Bu,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:rn.classNames.concat([Bu.className])});class Vd extends Bu{}Object.defineProperty(Vd,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Tick"}),Object.defineProperty(Vd,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Bu.classNames.concat([Vd.className])});class Lp extends Vd{constructor(){super(...arguments),Object.defineProperty(this,"_tickPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]})}}Object.defineProperty(Lp,"className",{enumerable:!0,configurable:!0,writable:!0,value:"AxisTick"}),Object.defineProperty(Lp,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Vd.classNames.concat([Lp.className])});class Fp extends _r{constructor(){super(...arguments),Object.defineProperty(this,"_tickPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]})}}Object.defineProperty(Fp,"className",{enumerable:!0,configurable:!0,writable:!0,value:"AxisLabel"}),Object.defineProperty(Fp,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:_r.classNames.concat([Fp.className])});class jo extends rn{constructor(){super(...arguments),Object.defineProperty(this,"_axisLength",{enumerable:!0,configurable:!0,writable:!0,value:100}),Object.defineProperty(this,"_start",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_end",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_inversed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_minSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"chart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_lc",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_ls",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_thumbDownPoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ticks",{enumerable:!0,configurable:!0,writable:!0,value:new bs(An.new({}),()=>Lp._new(this._root,{themeTags:ki(this.ticks.template.get("themeTags",[]),this.get("themeTags",[]))},[this.ticks.template]))}),Object.defineProperty(this,"grid",{enumerable:!0,configurable:!0,writable:!0,value:new bs(An.new({}),()=>Hd._new(this._root,{themeTags:ki(this.grid.template.get("themeTags",[]),this.get("themeTags",[]))},[this.grid.template]))}),Object.defineProperty(this,"axisFills",{enumerable:!0,configurable:!0,writable:!0,value:new bs(An.new({}),()=>rn._new(this._root,{themeTags:ki(this.axisFills.template.get("themeTags",["axis","fill"]),this.get("themeTags",[]))},[this.axisFills.template]))}),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:new bs(An.new({}),()=>Fp._new(this._root,{themeTags:ki(this.labels.template.get("themeTags",[]),this.get("themeTags",[]))},[this.labels.template]))}),Object.defineProperty(this,"axis",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"thumb",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}makeTick(e,t){const i=this.ticks.make();return i._setDataItem(e),e.setRaw("tick",i),i.set("themeTags",ki(i.get("themeTags"),t)),this.axis.labelsContainer.children.push(i),this.ticks.push(i),i}makeGrid(e,t){const i=this.grid.make();return i._setDataItem(e),e.setRaw("grid",i),i.set("themeTags",ki(i.get("themeTags"),t)),this.axis.gridContainer.children.push(i),this.grid.push(i),i}makeAxisFill(e,t){const i=this.axisFills.make();return i._setDataItem(e),i.set("themeTags",ki(i.get("themeTags"),t)),this.axis.gridContainer.children.push(i),e.setRaw("axisFill",i),this.axisFills.push(i),i}makeLabel(e,t){const i=this.labels.make();return i.set("themeTags",ki(i.get("themeTags"),t)),this.axis.labelsContainer.children.moveValue(i,0),i._setDataItem(e),e.setRaw("label",i),this.labels.push(i),i}axisLength(){return 0}gridCount(){return this.axisLength()/this.get("minGridDistance",50)}_updatePositions(){}_afterNew(){super._afterNew(),this.set("isMeasured",!1);const e=this.thumb;e&&(this._disposers.push(e.events.on("pointerdown",t=>{this._handleThumbDown(t)})),this._disposers.push(e.events.on("globalpointerup",t=>{this._handleThumbUp(t)})),this._disposers.push(e.events.on("globalpointermove",t=>{this._handleThumbMove(t)})))}_beforeChanged(){super._beforeChanged(),this.isDirty("minGridDistance")&&this.root.events.once("frameended",()=>{this.axis.markDirtySize()})}_changed(){if(super._changed(),this.isDirty("pan")){const e=this.thumb;if(e){const t=this.axis.labelsContainer,i=this.get("pan");"zoom"==i?t.children.push(e):"none"==i&&t.children.removeValue(e)}}}_handleThumbDown(e){this._thumbDownPoint=this.toLocal(e.point);const t=this.axis;this._downStart=t.get("start"),this._downEnd=t.get("end")}_handleThumbUp(e){this._thumbDownPoint=void 0}_handleThumbMove(e){const t=this._thumbDownPoint;if(t){const i=this.toLocal(e.point),n=this._downStart,r=this._downEnd,a=this._getPan(i,t)*Math.min(1,r-n)/2;this.axis.zoom(n-a,r+a,0)}}_getPan(e,t){return 0}positionToCoordinate(e){return this._inversed?(this._end-e)*this._axisLength:(e-this._start)*this._axisLength}updateTooltipBounds(e){}_updateSize(){this.markDirty(),this._clear=!0}toAxisPosition(e){const t=this._start||0,i=this._end||1;return e*=i-t,this.get("inversed")?i-e:t+e}toGlobalPosition(e){const t=this._start||0,i=this._end||1;return this.get("inversed")?e=i-e:e-=t,e/(i-t)}fixPosition(e){return this.get("inversed")?1-e:e}_updateLC(){}toggleVisibility(e,t,i,n){let r=this.axis;const a=r.get("start",0),o=r.get("end",1);e.setPrivate("visible",!(t<a+(o-a)*(i-1e-4)||t>a+(o-a)*(n+1e-4)))}_positionTooltip(e,t){const i=this.chart;i&&(i.inPlot(t)?e.set("pointTo",this._display.toGlobal(t)):e.hide())}processAxis(){}}Object.defineProperty(jo,"className",{enumerable:!0,configurable:!0,writable:!0,value:"AxisRenderer"}),Object.defineProperty(jo,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:rn.classNames.concat([jo.className])});class fo extends jo{constructor(){super(...arguments),Object.defineProperty(this,"thumb",{enumerable:!0,configurable:!0,writable:!0,value:ca.new(this._root,{width:vt,isMeasured:!1,themeTags:["axis","x","thumb"]})})}_afterNew(){this._settings.themeTags=ki(this._settings.themeTags,["renderer","x"]),super._afterNew(),this.setPrivateRaw("letter","X");const e=this.grid.template;e.set("height",vt),e.set("width",0),e.set("draw",(t,i)=>{t.moveTo(0,0),t.lineTo(0,i.height())}),this.set("draw",(t,i)=>{t.moveTo(0,0),t.lineTo(i.width(),0)})}_changed(){super._changed();const e=this.axis;e.ghostLabel.setPrivate("visible",!this.get("inside")),e.ghostLabel.set("x",-1e3);const t="opposite",i="inside";if(this.isDirty(t)||this.isDirty(i)){const n=this.chart,r=e.children;if(this.get(i)?e.addTag(i):e.removeTag(i),n){if(this.get(t)){const a=n.topAxesContainer.children;-1==a.indexOf(e)&&a.insertIndex(0,e),e.addTag(t),r.moveValue(this)}else{const a=n.bottomAxesContainer.children;-1==a.indexOf(e)&&a.moveValue(e),e.removeTag(t),r.moveValue(this,0)}e.ghostLabel._applyThemes(),this.labels.each(a=>{a._applyThemes()}),this.root._markDirtyRedraw()}e.markDirtySize()}this.thumb.setPrivate("height",e.labelsContainer.height())}_getPan(e,t){return(t.x-e.x)/this.width()}toAxisPosition(e){const t=this._start||0,i=this._end||1;return e=(e-=this._ls)*(i-t)/this._lc,this.get("inversed")?i-e:t+e}toGlobalPosition(e){const t=this._start||0,i=this._end||1;return this.get("inversed")?e=i-e:e-=t,(e=e/(i-t)*this._lc)+this._ls}_updateLC(){const e=this.axis,t=e.parent;if(t){const i=t.innerWidth();this._lc=this.axisLength()/i,this._ls=(e.x()-t.get("paddingLeft",0))/i}}_updatePositions(){const e=this.axis,t=e.x()-Oi(e.get("centerX",0),e.width())-e.parent.get("paddingLeft",0);e.gridContainer.set("x",t),e.topGridContainer.set("x",t),e.bulletsContainer.set("y",this.y());const i=e.chart;if(i){const n=i.plotContainer,r=e.axisHeader;let a=e.get("marginLeft",0),o=e.x()-a;const l=e.parent;l&&(o-=l.get("paddingLeft",0)),r.children.length>0?(a=e.axisHeader.width(),e.set("marginLeft",a+1)):r.set("width",a),r.setAll({x:o,y:-1,height:n.height()+2})}}processAxis(){super.processAxis();const e=this.axis;null==e.get("width")&&e.set("width",vt);const t=this._root.verticalLayout;e.set("layout",t),e.labelsContainer.set("width",vt),e.axisHeader.setAll({layout:t})}axisLength(){return this.axis.width()}positionToPoint(e){return{x:this.positionToCoordinate(e),y:0}}updateTick(e,t,i,n){if(e){Se(t)||(t=0);let r=.5;r=Se(n)&&n>1?e.get("multiLocation",r):e.get("location",r),Se(i)&&i!=t&&(t+=(i-t)*r),e.set("x",this.positionToCoordinate(t));let a=e.get("length",0);const o=e.get("inside",this.get("inside",!1));this.get("opposite")?(e.set("y",vt),o||(a*=-1)):(e.set("y",0),o&&(a*=-1)),e.set("draw",l=>{l.moveTo(0,0),l.lineTo(0,a)}),this.toggleVisibility(e,t,e.get("minPosition",0),e.get("maxPosition",1))}}updateLabel(e,t,i,n){if(e){let r=.5;r=Se(n)&&n>1?e.get("multiLocation",r):e.get("location",r),Se(t)||(t=0);const a=e.get("inside",this.get("inside",!1));this.get("opposite")?a?(e.set("position","absolute"),e.set("y",0)):(e.set("position","relative"),e.set("y",vt)):a?(e.set("y",0),e.set("position","absolute")):(e.set("y",void 0),e.set("position","relative")),Se(i)&&i!=t&&(t+=(i-t)*r),e.set("x",this.positionToCoordinate(t)),this.toggleVisibility(e,t,e.get("minPosition",0),e.get("maxPosition",1))}}updateGrid(e,t,i){if(e){Se(t)||(t=0);let n=e.get("location",.5);Se(i)&&i!=t&&(t+=(i-t)*n),e.set("x",this.positionToCoordinate(t)),this.toggleVisibility(e,t,0,1)}}updateBullet(e,t,i){if(e){const n=e.get("sprite");if(n){Se(t)||(t=0);let r=e.get("location",.5);Se(i)&&i!=t&&(t+=(i-t)*r);let a=this.axis.roundAxisPosition(t,r),o=this.axis._bullets[a],l=-1;if(this.get("opposite")&&(l=1),e.get("stacked"))if(o){let c=o.get("sprite");c&&n.set("y",c.y()+c.height()*l)}else n.set("y",0);this.axis._bullets[a]=e,n.set("x",this.positionToCoordinate(t)),this.toggleVisibility(n,t,0,1)}}}updateFill(e,t,i){if(e){Se(t)||(t=0),Se(i)||(i=1);let n=this.positionToCoordinate(t),r=this.positionToCoordinate(i);this.fillDrawMethod(e,n,r)}}fillDrawMethod(e,t,i){e.set("draw",n=>{const r=this.axis.gridContainer.height(),a=this.width();i<t&&([i,t]=[t,i]),!(t>a||i<0)&&(n.moveTo(t,0),n.lineTo(i,0),n.lineTo(i,r),n.lineTo(t,r),n.lineTo(t,0))})}positionTooltip(e,t){this._positionTooltip(e,{x:this.positionToCoordinate(t),y:0})}updateTooltipBounds(e){const t=this.get("inside"),i=1e5;let n=this._display.toGlobal({x:0,y:0}),r=n.x,a=0,o=this.axisLength(),l=i,c="up";this.get("opposite")?t?(c="up",a=n.y,l=i):(c="down",a=n.y-i,l=i):t?(c="down",a=n.y-i,l=i):(c="up",a=n.y,l=i);const h={left:r,right:r+o,top:a,bottom:a+l};xp(h,e.get("bounds"))||(e.set("bounds",h),e.set("pointerOrientation",c))}}Object.defineProperty(fo,"className",{enumerable:!0,configurable:!0,writable:!0,value:"AxisRendererX"}),Object.defineProperty(fo,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:jo.classNames.concat([fo.className])});class go extends jo{constructor(){super(...arguments),Object.defineProperty(this,"_downY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"thumb",{enumerable:!0,configurable:!0,writable:!0,value:ca.new(this._root,{height:vt,isMeasured:!1,themeTags:["axis","y","thumb"]})})}_afterNew(){this._settings.themeTags=ki(this._settings.themeTags,["renderer","y"]),this._settings.opposite&&this._settings.themeTags.push("opposite"),super._afterNew(),this.setPrivateRaw("letter","Y");const e=this.grid.template;e.set("width",vt),e.set("height",0),e.set("draw",(t,i)=>{t.moveTo(0,0),t.lineTo(i.width(),0)}),this.set("draw",(t,i)=>{t.moveTo(0,0),t.lineTo(0,i.height())})}_getPan(e,t){return(e.y-t.y)/this.height()}_changed(){super._changed();const e=this.axis;e.ghostLabel.setPrivate("visible",!this.get("inside")),e.ghostLabel.set("y",-1e3);const t=this.thumb,i="opposite",n="inside",r=this.chart;if(this.isDirty(i)||this.isDirty(n)){const o=e.children;if(this.get(n)?e.addTag(n):e.removeTag(n),r){if(this.get(i)){const l=r.rightAxesContainer.children;-1==l.indexOf(e)&&l.moveValue(e,0),e.addTag(i),o.moveValue(this,0)}else{const l=r.leftAxesContainer.children;-1==l.indexOf(e)&&l.moveValue(e),e.removeTag(i),o.moveValue(this)}e.ghostLabel._applyThemes(),this.labels.each(l=>{l._applyThemes()}),this.root._markDirtyRedraw()}e.markDirtySize()}const a=e.labelsContainer.width();r&&(this.get(i)?t.set("centerX",0):t.set("centerX",a)),t.setPrivate("width",a)}processAxis(){super.processAxis();const e=this.axis;null==e.get("height")&&e.set("height",vt);const t=this._root.horizontalLayout;e.set("layout",t),e.labelsContainer.set("height",vt),e.axisHeader.set("layout",t)}_updatePositions(){const e=this.axis,t=e.y()-Oi(e.get("centerY",0),e.height());e.gridContainer.set("y",t),e.topGridContainer.set("y",t),e.bulletsContainer.set("x",this.x());const i=e.chart;if(i){const n=i.plotContainer,r=e.axisHeader;let a=e.get("marginTop",0);r.children.length>0?(a=e.axisHeader.height(),e.set("marginTop",a+1)):r.set("height",a),r.setAll({y:e.y()-a,x:-1,width:n.width()+2})}}axisLength(){return this.axis.innerHeight()}positionToPoint(e){return{x:0,y:this.positionToCoordinate(e)}}updateLabel(e,t,i,n){if(e){Se(t)||(t=0);let r=.5;r=Se(n)&&n>1?e.get("multiLocation",r):e.get("location",r);const a=this.get("opposite"),o=e.get("inside",this.get("inside",!1));a?(e.set("x",0),e.set("position",o?"absolute":"relative")):o?(e.set("x",0),e.set("position","absolute")):(e.set("x",void 0),e.set("position","relative")),Se(i)&&i!=t&&(t+=(i-t)*r),e.set("y",this.positionToCoordinate(t)),this.toggleVisibility(e,t,e.get("minPosition",0),e.get("maxPosition",1))}}updateGrid(e,t,i){if(e){Se(t)||(t=0);let n=e.get("location",.5);Se(i)&&i!=t&&(t+=(i-t)*n),e.set("y",this.positionToCoordinate(t)),this.toggleVisibility(e,t,0,1)}}updateTick(e,t,i,n){if(e){Se(t)||(t=0);let r=.5;r=Se(n)&&n>1?e.get("multiLocation",r):e.get("location",r),Se(i)&&i!=t&&(t+=(i-t)*r),e.set("y",this.positionToCoordinate(t));let a=e.get("length",0);const o=e.get("inside",this.get("inside",!1));this.get("opposite")?(e.set("x",0),o&&(a*=-1)):o||(a*=-1),e.set("draw",l=>{l.moveTo(0,0),l.lineTo(a,0)}),this.toggleVisibility(e,t,e.get("minPosition",0),e.get("maxPosition",1))}}updateBullet(e,t,i){if(e){const n=e.get("sprite");if(n){Se(t)||(t=0);let r=e.get("location",.5);Se(i)&&i!=t&&(t+=(i-t)*r);let a=this.axis.roundAxisPosition(t,r),o=this.axis._bullets[a],l=1;if(this.get("opposite")&&(l=-1),e.get("stacked"))if(o){let c=o.get("sprite");c&&n.set("x",c.x()+c.width()*l)}else n.set("x",0);this.axis._bullets[a]=e,n.set("y",this.positionToCoordinate(t)),this.toggleVisibility(n,t,0,1)}}}updateFill(e,t,i){if(e){Se(t)||(t=0),Se(i)||(i=1);let n=this.positionToCoordinate(t),r=this.positionToCoordinate(i);this.fillDrawMethod(e,n,r)}}fillDrawMethod(e,t,i){e.set("draw",n=>{const r=this.axis.gridContainer.width(),a=this.height();i<t&&([i,t]=[t,i]),!(t>a||i<0)&&(n.moveTo(0,t),n.lineTo(r,t),n.lineTo(r,i),n.lineTo(0,i),n.lineTo(0,t))})}positionToCoordinate(e){return this._inversed?(e-this._start)*this._axisLength:(this._end-e)*this._axisLength}positionTooltip(e,t){this._positionTooltip(e,{x:0,y:this.positionToCoordinate(t)})}updateTooltipBounds(e){const t=this.get("inside"),i=1e5;let n=this._display.toGlobal({x:0,y:0}),r=n.y,a=0,o=this.axisLength(),l=i,c="right";this.get("opposite")?t?(c="right",a=n.x-i,l=i):(c="left",a=n.x,l=i):t?(c="left",a=n.x,l=i):(c="right",a=n.x-i,l=i);const h={left:a,right:a+l,top:r,bottom:r+o};xp(h,e.get("bounds"))||(e.set("bounds",h),e.set("pointerOrientation",c))}_updateLC(){const e=this.axis,t=e.parent;if(t){const i=t.innerHeight();this._lc=this.axisLength()/i,this._ls=e.y()/i}}toAxisPosition(e){const t=this._start||0,i=this._end||1;return e=(e-=this._ls)*(i-t)/this._lc,this.get("inversed")?t+e:i-e}toGlobalPosition(e){const t=this._start||0,i=this._end||1;return this.get("inversed")?e-=t:e=i-e,(e=e/(i-t)*this._lc)+this._ls}fixPosition(e){return this.get("inversed")?e:1-e}}Object.defineProperty(go,"className",{enumerable:!0,configurable:!0,writable:!0,value:"AxisRendererY"}),Object.defineProperty(go,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:jo.classNames.concat([go.className])});class Nu extends ai{constructor(){super(...arguments),Object.defineProperty(this,"thumb",{enumerable:!0,configurable:!0,writable:!0,value:this._makeThumb()}),Object.defineProperty(this,"startGrip",{enumerable:!0,configurable:!0,writable:!0,value:this._makeButton()}),Object.defineProperty(this,"endGrip",{enumerable:!0,configurable:!0,writable:!0,value:this._makeButton()}),Object.defineProperty(this,"_thumbBusy",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_startDown",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_endDown",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_thumbDown",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_gripDown",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_addOrientationClass(){this._settings.themeTags=ki(this._settings.themeTags,["scrollbar",this._settings.orientation]),this._settings.background||(this._settings.background=po.new(this._root,{themeTags:ki(this._settings.themeTags,["main","background"])}))}_makeButton(){return this.children.push(Fu.new(this._root,{themeTags:["resize","button",this.get("orientation")],icon:rn.new(this._root,{themeTags:["icon"]})}))}_makeThumb(){return this.children.push(po.new(this._root,{themeTags:["thumb",this.get("orientation")]}))}_handleAnimation(e){e&&this._disposers.push(e.events.on("stopped",()=>{this.setPrivateRaw("isBusy",!1),this._thumbBusy=!1}))}_afterNew(){this._addOrientationClass(),super._afterNew();const e=this.startGrip,t=this.endGrip,i=this.thumb,n=this.get("background");n&&this._disposers.push(n.events.on("click",r=>{this.setPrivateRaw("isBusy",!0);const a=this._display.toLocal(r.point),o=this.width(),l=this.height(),c=this.get("orientation");let h,u,m;h="vertical"==c?(a.y-i.height()/2)/l:(a.x-i.width()/2)/o,"vertical"==c?(u=h*l,m="y"):(u=h*o,m="x");const p=this.get("animationDuration",0);p>0?(this._thumbBusy=!0,this._handleAnimation(this.thumb.animate({key:m,to:u,duration:p,easing:this.get("animationEasing")}))):(this.thumb.set(m,u),this._root.events.once("frameended",()=>{this.setPrivateRaw("isBusy",!1)}))})),this._disposers.push(i.events.on("dblclick",r=>{if(!gp(r.originalEvent,this))return;const a=this.get("animationDuration",0),o=this.get("animationEasing");this.animate({key:"start",to:0,duration:a,easing:o}),this.animate({key:"end",to:1,duration:a,easing:o})})),this._disposers.push(e.events.on("pointerdown",()=>{this.setPrivateRaw("isBusy",!0),this._startDown=!0,this._gripDown="start"})),this._disposers.push(t.events.on("pointerdown",()=>{this.setPrivateRaw("isBusy",!0),this._endDown=!0,this._gripDown="end"})),this._disposers.push(i.events.on("pointerdown",()=>{this.setPrivateRaw("isBusy",!0),this._thumbDown=!0,this._gripDown=void 0})),this._disposers.push(e.events.on("globalpointerup",()=>{this._startDown&&this.setPrivateRaw("isBusy",!1),this._startDown=!1})),this._disposers.push(t.events.on("globalpointerup",()=>{this._endDown&&this.setPrivateRaw("isBusy",!1),this._endDown=!1})),this._disposers.push(i.events.on("globalpointerup",()=>{this._thumbDown&&this.setPrivateRaw("isBusy",!1),this._thumbDown=!1})),this._disposers.push(e.on("x",()=>{this._updateThumb()})),this._disposers.push(t.on("x",()=>{this._updateThumb()})),this._disposers.push(e.on("y",()=>{this._updateThumb()})),this._disposers.push(t.on("y",()=>{this._updateThumb()})),this._disposers.push(i.events.on("positionchanged",()=>{this._updateGripsByThumb()})),"vertical"==this.get("orientation")?(e.set("x",0),t.set("x",0),this._disposers.push(i.adapters.add("y",r=>Math.max(Math.min(Number(r),this.height()-i.height()),0))),this._disposers.push(i.adapters.add("x",r=>this.width()/2)),this._disposers.push(e.adapters.add("x",r=>this.width()/2)),this._disposers.push(t.adapters.add("x",r=>this.width()/2)),this._disposers.push(e.adapters.add("y",r=>Math.max(Math.min(Number(r),this.height()),0))),this._disposers.push(t.adapters.add("y",r=>Math.max(Math.min(Number(r),this.height()),0)))):(e.set("y",0),t.set("y",0),this._disposers.push(i.adapters.add("x",r=>Math.max(Math.min(Number(r),this.width()-i.width()),0))),this._disposers.push(i.adapters.add("y",r=>this.height()/2)),this._disposers.push(e.adapters.add("y",r=>this.height()/2)),this._disposers.push(t.adapters.add("y",r=>this.height()/2)),this._disposers.push(e.adapters.add("x",r=>Math.max(Math.min(Number(r),this.width()),0))),this._disposers.push(t.adapters.add("x",r=>Math.max(Math.min(Number(r),this.width()),0))))}_updateChildren(){super._updateChildren(),(this.isDirty("end")||this.isDirty("start")||this._sizeDirty)&&this.updateGrips()}_changed(){if(super._changed(),this.isDirty("start")||this.isDirty("end")){const e="rangechanged";this.events.isEnabled(e)&&this.events.dispatch(e,{type:e,target:this,start:this.get("start",0),end:this.get("end",1),grip:this._gripDown})}}updateGrips(){const e=this.startGrip,t=this.endGrip,i=this.get("orientation"),n=this.height(),r=this.width();"vertical"==i?(e.set("y",n*this.get("start",0)),t.set("y",n*this.get("end",1))):(e.set("x",r*this.get("start",0)),t.set("x",r*this.get("end",1)));const a=this.getPrivate("positionTextFunction"),o=Math.round(100*this.get("start",0)),l=Math.round(100*this.get("end",0));let c,h;a?(c=a.call(this,this.get("start",0)),h=a.call(this,this.get("end",0))):(c=o+"%",h=l+"%"),e.set("ariaLabel",this._t("From %1",void 0,c)),e.set("ariaValueNow",""+o),e.set("ariaValueText",o+"%"),e.set("ariaValueMin","0"),e.set("ariaValueMax","100"),t.set("ariaLabel",this._t("To %1",void 0,h)),t.set("ariaValueNow",""+l),t.set("ariaValueText",l+"%"),t.set("ariaValueMin","0"),t.set("ariaValueMax","100")}_updateThumb(){const e=this.thumb,t=this.startGrip,i=this.endGrip,n=this.height(),r=this.width();let a=t.x(),o=i.x(),l=t.y(),c=i.y(),h=0,u=1;"vertical"==this.get("orientation")?Se(l)&&Se(c)&&(!this._thumbBusy&&!e.isDragging()&&(e.set("height",c-l),e.set("y",l)),h=l/n,u=c/n):Se(a)&&Se(o)&&(!this._thumbBusy&&!e.isDragging()&&(e.set("width",o-a),e.set("x",a)),h=a/r,u=o/r),this.getPrivate("isBusy")&&(this.get("start")!=h||this.get("end")!=u)&&(this.set("start",h),this.set("end",u));const m=this.getPrivate("positionTextFunction"),p=Math.round(100*this.get("start",0)),_=Math.round(100*this.get("end",0));let g,f;m?(g=m.call(this,this.get("start",0)),f=m.call(this,this.get("end",0))):(g=p+"%",f=_+"%"),e.set("ariaLabel",this._t("From %1 to %2",void 0,g,f)),e.set("ariaValueNow",""+p),e.set("ariaValueText",p+"%")}_updateGripsByThumb(){const e=this.thumb,t=this.startGrip,i=this.endGrip;if("vertical"==this.get("orientation")){const n=e.height();t.set("y",e.y()),i.set("y",e.y()+n)}else{const n=e.width();t.set("x",e.x()),i.set("x",e.x()+n)}}}Object.defineProperty(Nu,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Scrollbar"}),Object.defineProperty(Nu,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ai.classNames.concat([Nu.className])});class Wd extends Nu{constructor(){super(...arguments),Object.defineProperty(this,"chart",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(ja.new(this._root,{themeTags:["chart"],interactive:!1,interactiveChildren:!1,panX:!1,panY:!1,wheelX:"none",wheelY:"none"}))}),Object.defineProperty(this,"overlay",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(rn.new(this._root,{themeTags:["overlay"],interactive:!1}))})}_afterNew(){this._addOrientationClass(),this._settings.themeTags=ki(this._settings.themeTags,["scrollbar","xy","chart",this._settings.orientation]);const e=this.children;e.moveValue(this.thumb),e.moveValue(this.startGrip),e.moveValue(this.endGrip),this.thumb.set("opacity",0),this.thumb.states.create("hover",{opacity:.2});const t=this.chart.plotContainer;t.set("interactive",!1),t.remove("background"),t.children.removeValue(this.chart.zoomOutButton),super._afterNew()}_updateThumb(){super._updateThumb(),this.overlay.set("draw",e=>{const t=this.startGrip,i=this.endGrip;let n=t.x(),r=t.y(),a=i.x(),o=i.y();const l=this.height(),c=this.width();n>a&&([n,a]=[a,n]),r>o&&([r,o]=[o,r]),"horizontal"===this.get("orientation")?(e.moveTo(0,0),e.lineTo(n,0),e.lineTo(n,l),e.lineTo(0,l),e.lineTo(0,0),e.moveTo(a,0),e.lineTo(c,0),e.lineTo(c,l),e.lineTo(a,l),e.lineTo(a,0)):(e.moveTo(0,0),e.lineTo(0,r),e.lineTo(c,r),e.lineTo(c,0),e.lineTo(0,0),e.moveTo(0,o),e.lineTo(0,l),e.lineTo(c,l),e.lineTo(c,o),e.lineTo(0,o))})}}Object.defineProperty(Wd,"className",{enumerable:!0,configurable:!0,writable:!0,value:"XYChartScrollbar"}),Object.defineProperty(Wd,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Nu.classNames.concat([Wd.className])});class Zo extends Ec{constructor(){super(...arguments),Object.defineProperty(this,"_aggregatesCalculated",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_selectionAggregatesCalculated",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dataProcessed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_psi",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pei",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bullets",{enumerable:!0,configurable:!0,writable:!0,value:new Dl}),Object.defineProperty(this,"bulletsContainer",{enumerable:!0,configurable:!0,writable:!0,value:ai.new(this._root,{width:vt,height:vt,position:"absolute"})})}_afterNew(){this.valueFields.push("value","customValue"),super._afterNew(),this.setPrivate("customData",{}),this._disposers.push(this.bullets.events.onAll(e=>{if("clear"===e.type)this._handleBullets(this.dataItems);else if("push"===e.type)this._handleBullets(this.dataItems);else if("setIndex"===e.type)this._handleBullets(this.dataItems);else if("insertIndex"===e.type)this._handleBullets(this.dataItems);else if("removeIndex"===e.type)this._handleBullets(this.dataItems);else{if("moveIndex"!==e.type)throw new Error("Unknown IListEvent type");this._handleBullets(this.dataItems)}}))}_dispose(){this.bulletsContainer.dispose(),super._dispose()}startIndex(){let e=this.dataItems.length;return Math.min(this.getPrivate("startIndex",0),e)}endIndex(){let e=this.dataItems.length;return Math.min(this.getPrivate("endIndex",e),e)}_handleBullets(e){ye(e,t=>{const i=t.bullets;i&&(ye(i,n=>{n.dispose()}),t.bullets=void 0)}),this.markDirtyValues()}getDataItemById(e){return wd(this.dataItems,t=>t.get("id")==e)}_makeBullets(e){this._shouldMakeBullet(e)&&(e.bullets=[],this.bullets.each(t=>{this._makeBullet(e,t)}))}_shouldMakeBullet(e){return!0}_makeBullet(e,t,i){const n=t(this._root,this,e);return n&&(n._index=i,this._makeBulletReal(e,n)),n}_makeBulletReal(e,t){let i=t.get("sprite");i&&(i._setDataItem(e),i.setRaw("position","absolute"),this.bulletsContainer.children.push(i)),t.series=this,e.bullets.push(t)}addBullet(e,t){e.bullets||(e.bullets=[]),t&&this._makeBulletReal(e,t)}_clearDirty(){super._clearDirty(),this._aggregatesCalculated=!1,this._selectionAggregatesCalculated=!1}_prepareChildren(){super._prepareChildren();let e=this.startIndex(),t=this.endIndex();if(this.isDirty("name")&&this.updateLegendValue(),this.isDirty("heatRules")&&(this._valuesDirty=!0),this.isPrivateDirty("baseValueSeries")){const n=this.getPrivate("baseValueSeries");n&&this._disposers.push(n.onPrivate("startIndex",()=>{this.markDirtyValues()}))}if(this.get("calculateAggregates")&&(this._valuesDirty&&!this._dataProcessed&&(this._aggregatesCalculated||(this._calculateAggregates(0,this.dataItems.length),this._aggregatesCalculated=!0,0!=e&&(this._psi=void 0))),(this._psi!=e||this._pei!=t)&&!this._selectionAggregatesCalculated&&(0===e&&t===this.dataItems.length&&this._aggregatesCalculated||this._calculateAggregates(e,t),this._selectionAggregatesCalculated=!0)),this.isDirty("tooltip")){let n=this.get("tooltip");n&&(n.hide(0),n.set("tooltipTarget",this))}if(this.isDirty("fill")||this.isDirty("stroke")){let n;const r=this.get("legendDataItem");if(r&&(n=r.get("markerRectangle"),n&&this.isVisible())){if(this.isDirty("stroke")){let a=this.get("stroke");n.set("stroke",a)}if(this.isDirty("fill")){let a=this.get("fill");n.set("fill",a)}}this.updateLegendMarker(void 0)}if(this.bullets.length>0){let n=this.startIndex(),r=this.endIndex();r<this.dataItems.length&&r++;for(let a=n;a<r;a++){let o=this.dataItems[a];o.bullets||this._makeBullets(o)}}}_calculateAggregates(e,t){let i=this._valueFields;if(!i)throw new Error("No value fields are set for the series.");const n={},r={},a={},o={},l={},c={},h={},u={},m={};ye(i,p=>{n[p]=0,r[p]=0,a[p]=0}),ye(i,p=>{let _=p+"Change",g=p+"ChangePercent",f=p+"ChangePrevious",b=p+"ChangePreviousPercent",C=p+"ChangeSelection",M=p+"ChangeSelectionPercent",E="valueY";("valueX"==p||"openValueX"==p||"lowValueX"==p||"highValueX"==p)&&(E="valueX");const S=this.getPrivate("baseValueSeries");for(let P=e;P<t;P++){const I=this.dataItems[P];let L=I.get(p);null!=L&&(a[p]++,n[p]+=L,r[p]+=Math.abs(L),u[p]=n[p]/a[p],(o[p]>L||null==o[p])&&(o[p]=L),(l[p]<L||null==l[p])&&(l[p]=L),h[p]=L,null==c[p]&&(c[p]=L,m[p]=L,S&&(c[E]=S._getBase(E))),0===e&&(I.setRaw(_,L-c[E]),I.setRaw(g,(L-c[E])/c[E]*100)),I.setRaw(f,L-m[E]),I.setRaw(b,(L-m[E])/m[E]*100),I.setRaw(C,L-c[E]),I.setRaw(M,(L-c[E])/c[E]*100),m[p]=L)}}),ye(i,p=>{this.setPrivate(p+"AverageSelection",u[p]),this.setPrivate(p+"CountSelection",a[p]),this.setPrivate(p+"SumSelection",n[p]),this.setPrivate(p+"AbsoluteSumSelection",r[p]),this.setPrivate(p+"LowSelection",o[p]),this.setPrivate(p+"HighSelection",l[p]),this.setPrivate(p+"OpenSelection",c[p]),this.setPrivate(p+"CloseSelection",h[p])}),0===e&&t===this.dataItems.length&&ye(i,p=>{this.setPrivate(p+"Average",u[p]),this.setPrivate(p+"Count",a[p]),this.setPrivate(p+"Sum",n[p]),this.setPrivate(p+"AbsoluteSum",r[p]),this.setPrivate(p+"Low",o[p]),this.setPrivate(p+"High",l[p]),this.setPrivate(p+"Open",c[p]),this.setPrivate(p+"Close",h[p])})}_updateChildren(){super._updateChildren(),this._psi=this.startIndex(),this._pei=this.endIndex(),this.isDirty("visible")&&this.bulletsContainer.set("visible",this.get("visible"));const e=this.get("heatRules");if(this._valuesDirty&&e&&e.length>0&&ye(e,t=>{const i=t.minValue||this.getPrivate(t.dataField+"Low")||0,n=t.maxValue||this.getPrivate(t.dataField+"High")||0;ye(t.target._entities,r=>{const a=r.dataItem.get(t.dataField);if(Se(a))if(t.customFunction)t.customFunction.call(this,r,i,n,a);else{let o,l;o=t.logarithmic?(Math.log(a)*Math.LOG10E-Math.log(i)*Math.LOG10E)/(Math.log(n)*Math.LOG10E-Math.log(i)*Math.LOG10E):(a-i)/(n-i),Se(a)&&(!Se(o)||Math.abs(o)==1/0)&&(o=.5),Se(t.min)?l=t.min+(t.max-t.min)*o:t.min instanceof ei?l=ei.interpolate(o,t.min,t.max):t.min instanceof Ti&&(l=ob(o,t.min,t.max)),r.set(t.key,l)}else t.neutral&&r.set(t.key,t.neutral)})}),this.get("visible")){let t=this.dataItems.length,i=this.startIndex(),n=this.endIndex();n<t&&n++,i>0&&i--;for(let r=0;r<i;r++)this._hideBullets(this.dataItems[r]);for(let r=i;r<n;r++)this._positionBullets(this.dataItems[r]);for(let r=n;r<t;r++)this._hideBullets(this.dataItems[r])}}_positionBullets(e){e.bullets&&ye(e.bullets,t=>{this._positionBullet(t);const i=t.get("sprite");t.get("dynamic")&&(i&&(i._markDirtyKey("fill"),i.markDirtySize()),i instanceof ai&&i.walkChildren(n=>{n._markDirtyKey("fill"),n.markDirtySize(),n instanceof _r&&n.text.markDirtyText()})),i instanceof _r&&i.get("populateText")&&i.text.markDirtyText()})}_hideBullets(e){e.bullets&&ye(e.bullets,t=>{let i=t.get("sprite");i&&i.setPrivate("visible",!1)})}_positionBullet(e){}_placeBulletsContainer(e){e.bulletsContainer.children.moveValue(this.bulletsContainer)}_removeBulletsContainer(){const e=this.bulletsContainer;e.parent&&e.parent.children.removeValue(e)}disposeDataItem(e){const t=e.bullets;t&&ye(t,i=>{i.dispose()})}_getItemReaderLabel(){return""}showDataItem(e,t){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return(0,vs.mG)(this,void 0,void 0,function*(){const n=[i.showDataItem.call(this,e,t)],r=e.bullets;r&&ye(r,a=>{const o=a.get("sprite");o&&n.push(o.show(t))}),yield Promise.all(n)})}hideDataItem(e,t){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return(0,vs.mG)(this,void 0,void 0,function*(){const n=[i.hideDataItem.call(this,e,t)],r=e.bullets;r&&ye(r,a=>{const o=a.get("sprite");o&&n.push(o.hide(t))}),yield Promise.all(n)})}_sequencedShowHide(e,t){return(0,vs.mG)(this,void 0,void 0,function*(){if(this.get("sequencedInterpolation"))if(Se(t)||(t=this.get("interpolationDuration",0)),t>0){const i=this.startIndex(),n=this.endIndex();yield Promise.all(mu(this.dataItems,(r,a)=>(0,vs.mG)(this,void 0,void 0,function*(){let o=t||0;(a<i-10||a>n+10)&&(o=0);let l=this.get("sequencedDelay",0)+o/(n-i);yield function zD(s){return new Promise((e,t)=>{setTimeout(e,s)})}(l*(a-i)),e?yield this.showDataItem(r,o):yield this.hideDataItem(r,o)})))}else yield Promise.all(mu(this.dataItems,i=>e?this.showDataItem(i,0):this.hideDataItem(i,0)))})}updateLegendValue(e){if(e){const t=e.get("legendDataItem");if(t){const i=t.get("valueLabel");if(i){const r=i.text;let a="";i._setDataItem(e),a=this.get("legendValueText",r.get("text","")),i.set("text",a),r.markDirtyText()}const n=t.get("label");if(n){const r=n.text;let a="";n._setDataItem(e),a=this.get("legendLabelText",r.get("text","")),n.set("text",a),r.markDirtyText()}}}}updateLegendMarker(e){}_onHide(){super._onHide();const e=this.getTooltip();e&&e.hide()}hoverDataItem(e){}unhoverDataItem(e){}_getBase(e){const t=this.dataItems[this.startIndex()];return t?t.get(e):0}}Object.defineProperty(Zo,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Series"}),Object.defineProperty(Zo,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Ec.classNames.concat([Zo.className])});class Ac extends Zo{constructor(){super(...arguments),Object.defineProperty(this,"_xField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_yField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_xOpenField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_yOpenField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_xLowField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_xHighField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_yLowField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_yHighField",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_axesDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_stackDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_selectionProcessed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dataSets",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_mainContainerMask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_x",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_bullets",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"mainContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(ai.new(this._root,{}))}),Object.defineProperty(this,"axisRanges",{enumerable:!0,configurable:!0,writable:!0,value:new Dl}),Object.defineProperty(this,"_skipped",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_couldStackTo",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_reallyStackedTo",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_stackedSeries",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_aLocationX0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_aLocationX1",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_aLocationY0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_aLocationY1",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_showBullets",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"valueXFields",{enumerable:!0,configurable:!0,writable:!0,value:["valueX","openValueX","lowValueX","highValueX"]}),Object.defineProperty(this,"valueYFields",{enumerable:!0,configurable:!0,writable:!0,value:["valueY","openValueY","lowValueY","highValueY"]}),Object.defineProperty(this,"_valueXFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_valueYFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_valueXShowFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_valueYShowFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__valueXShowFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__valueYShowFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_emptyDataItem",{enumerable:!0,configurable:!0,writable:!0,value:new Za(this,void 0,{})}),Object.defineProperty(this,"_dataSetId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipFieldX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipFieldY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_posXDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_posYDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){this.fields.push("categoryX","categoryY","openCategoryX","openCategoryY"),this.valueFields.push("valueX","valueY","openValueX","openValueY","lowValueX","lowValueY","highValueX","highValueY"),this._setRawDefault("vcx",1),this._setRawDefault("vcy",1),this._setRawDefault("valueXShow","valueXWorking"),this._setRawDefault("valueYShow","valueYWorking"),this._setRawDefault("openValueXShow","openValueXWorking"),this._setRawDefault("openValueYShow","openValueYWorking"),this._setRawDefault("lowValueXShow","lowValueXWorking"),this._setRawDefault("lowValueYShow","lowValueYWorking"),this._setRawDefault("highValueXShow","highValueXWorking"),this._setRawDefault("highValueYShow","highValueYWorking"),this._setRawDefault("lowValueXGrouped","low"),this._setRawDefault("lowValueYGrouped","low"),this._setRawDefault("highValueXGrouped","high"),this._setRawDefault("highValueYGrouped","high"),super._afterNew(),this.set("maskContent",!0),this._disposers.push(this.axisRanges.events.onAll(e=>{if("clear"===e.type)ye(e.oldValues,t=>{this._removeAxisRange(t)});else if("push"===e.type)this._processAxisRange(e.newValue);else if("setIndex"===e.type)this._processAxisRange(e.newValue);else if("insertIndex"===e.type)this._processAxisRange(e.newValue);else if("removeIndex"===e.type)this._removeAxisRange(e.oldValue);else{if("moveIndex"!==e.type)throw new Error("Unknown IStreamEvent type");this._processAxisRange(e.value)}})),this.states.create("hidden",{opacity:1,visible:!1}),this._makeFieldNames()}_processAxisRange(e){const t=ai.new(this._root,{});e.container=t,this.children.push(t),e.series=this;const i=e.axisDataItem;i.setRaw("isRange",!0);const n=i.component;if(n){n._processAxisRange(i,["range","series"]);const r=i.get("bullet");if(r){const o=r.get("sprite");o&&o.setPrivate("visible",!1)}const a=i.get("axisFill");a&&t.set("mask",a),n._seriesAxisRanges.push(i)}}_removeAxisRange(e){const t=e.axisDataItem,i=t.component;i.disposeDataItem(t),Pr(i._seriesAxisRanges,t);const n=e.container;n&&n.dispose()}_updateFields(){super._updateFields(),this._valueXFields=[],this._valueYFields=[],this._valueXShowFields=[],this._valueYShowFields=[],this.__valueXShowFields=[],this.__valueYShowFields=[],this.valueXFields&&ye(this.valueXFields,e=>{if(this.get(e+"Field")){this._valueXFields.push(e);let i=this.get(e+"Show");this.__valueXShowFields.push(i),-1!=i.indexOf("Working")?this._valueXShowFields.push(i.split("Working")[0]):this._valueXShowFields.push(i)}}),this.valueYFields&&ye(this.valueYFields,e=>{if(this.get(e+"Field")){this._valueYFields.push(e);let i=this.get(e+"Show");this.__valueYShowFields.push(i),-1!=i.indexOf("Working")?this._valueYShowFields.push(i.split("Working")[0]):this._valueYShowFields.push(i)}})}_dispose(){super._dispose(),this._bullets={};const e=this.chart;e&&e.series.removeValue(this),rr(this.get("xAxis").series,this),rr(this.get("yAxis").series,this)}_min(e,t){let i=function YD(s,e){return null==s?e:null==e?s:e<s?e:s}(this.getPrivate(e),t);this.setPrivate(e,i)}_max(e,t){let i=function jD(s,e){return null==s?e:null==e?s:e>s?e:s}(this.getPrivate(e),t);this.setPrivate(e,i)}_shouldMakeBullet(e){const t=this.get("xAxis"),i=this.get("yAxis"),n=this.get("baseAxis");if(!t.inited||!i.inited)return!1;const r=this.get("minBulletDistance",0);if(r>0){let a=this.startIndex(),l=this.endIndex()-a;if(t==n){if(t.get("renderer").axisLength()/l<r/5)return!1}else if(i==n&&i.get("renderer").axisLength()/l<r/5)return!1}return null!=e.get(this._xField)&&null!=e.get(this._yField)}_makeFieldNames(){const e=this.get("xAxis"),t=this.get("yAxis"),i=e.getPrivate("name"),n=bp(i),r=t.getPrivate("name"),a=bp(r),o=e.get("renderer").getPrivate("letter"),l=t.get("renderer").getPrivate("letter"),c="open",h="low",u="high",m="Show";"ValueAxis"===e.className?(this._xField=this.get(i+o+m),this._xOpenField=this.get(c+n+o+m),this._xLowField=this.get(h+n+o+m),this._xHighField=this.get(u+n+o+m)):(this._xField=i+o,this._xOpenField=c+n+o,this._xLowField=h+n+o,this._xHighField=u+n+o),"ValueAxis"===t.className?(this._yField=this.get(r+l+m),this._yOpenField=this.get(c+a+l+m),this._yLowField=this.get(h+a+l+m),this._yHighField=this.get(u+a+l+m)):(this._yField=r+l,this._yOpenField=c+a+l,this._yLowField=h+a+l,this._yHighField=u+a+l)}_fixVC(){const e=this.get("xAxis"),t=this.get("yAxis"),i=this.get("baseAxis"),n=this.states.lookup("hidden"),r=this.get("sequencedInterpolation");if(n){let a=0;r&&(a=.999999999999),e===i?n.set("vcy",a):(t===i||n.set("vcy",a),n.set("vcx",a))}}_handleMaskBullets(){this.isDirty("maskBullets")&&this.bulletsContainer.set("maskContent",this.get("maskBullets"))}_fixPosition(){const e=this.get("xAxis"),t=this.get("yAxis");this.set("x",e.x()-Oi(e.get("centerX",0),e.width())-e.parent.get("paddingLeft",0)),this.set("y",t.y()-Oi(t.get("centerY",0),t.height())-t.parent.get("paddingTop",0)),this.bulletsContainer.set("y",this.y()),this.bulletsContainer.set("x",this.x())}_prepareChildren(){super._prepareChildren(),this._bullets={},(this.isDirty("valueYShow")||this.isDirty("valueXShow")||this.isDirty("openValueYShow")||this.isDirty("openValueXShow")||this.isDirty("lowValueYShow")||this.isDirty("lowValueXShow")||this.isDirty("highValueYShow")||this.isDirty("highValueXShow"))&&(this._updateFields(),this._makeFieldNames(),this._valuesDirty=!0),(this.isDirty("xAxis")||this.isDirty("yAxis"))&&(this._valuesDirty=!0),this.set("width",this.get("xAxis").width()),this.set("height",this.get("yAxis").height()),this._handleMaskBullets();const e=this.get("xAxis"),t=this.get("yAxis"),i=this.get("baseAxis");let r,o;switch(this.get("tooltipPositionX")){case"open":r=this._xOpenField;break;case"low":r=this._xLowField;break;case"high":r=this._xHighField;break;default:r=this._xField}switch(this._tooltipFieldX=r,this.get("tooltipPositionY")){case"open":o=this._yOpenField;break;case"low":o=this._yLowField;break;case"high":o=this._yHighField;break;default:o=this._yField}this._tooltipFieldY=o,this.isDirty("baseAxis")&&this._fixVC(),this._fixPosition();const l=this.get("stacked");if(this.isDirty("stacked")&&(l?this._valuesDirty&&!this._dataProcessed||this._stack():this._unstack()),this._valuesDirty&&!this._dataProcessed&&(this._dataProcessed=!0,l&&this._stack(),ye(this.dataItems,c=>{ye(this._valueXShowFields,h=>{let u=c.get(h);null!=u&&(l&&(u+=this.getStackedXValue(c,h)),this._min("minX",u),this._max("maxX",u))}),ye(this._valueYShowFields,h=>{let u=c.get(h);null!=u&&(l&&(u+=this.getStackedYValue(c,h)),this._min("minY",u),this._max("maxY",u))}),e.processSeriesDataItem(c,this._valueXFields),t.processSeriesDataItem(c,this._valueYFields)}),e._seriesValuesDirty=!0,t._seriesValuesDirty=!0,this.get("ignoreMinMax")||((this.isPrivateDirty("minX")||this.isPrivateDirty("maxX"))&&e.markDirtyExtremes(),(this.isPrivateDirty("minY")||this.isPrivateDirty("maxY"))&&t.markDirtyExtremes()),this._markStakedDirtyStack(),this.get("tooltipDataItem")||this.updateLegendValue(void 0)),(this.isDirty("vcx")||this.isDirty("vcy"))&&this._markStakedDirtyStack(),this._dataGrouped||(e._groupSeriesData(this),t._groupSeriesData(this),this._dataGrouped=!0),this._valuesDirty||this.isPrivateDirty("startIndex")||this.isPrivateDirty("endIndex")||this.isDirty("vcx")||this.isDirty("vcy")||this._stackDirty){let c=this.startIndex(),h=this.endIndex(),u=this.get("minBulletDistance",0);if(u>0&&i&&(this._showBullets=i.get("renderer").axisLength()/(h-c)>u),(this._psi!=c||this._pei!=h||this.isDirty("vcx")||this.isDirty("vcy")||this._stackDirty||this._valuesDirty)&&!this._selectionProcessed){this._selectionProcessed=!0;const m=this.get("vcx",1),p=this.get("vcy",1),_=this.get("stacked",!1),g=this.getPrivate("outOfSelection");if(i===e||!i)if(t._calculateTotals(),this.setPrivateRaw("selectionMinY",void 0),this.setPrivateRaw("selectionMaxY",void 0),g)t.markDirtySelectionExtremes();else for(let f=c;f<h;f++)this.processYSelectionDataItem(this.dataItems[f],p,_);if(i===t||!i)if(e._calculateTotals(),this.setPrivateRaw("selectionMinX",void 0),this.setPrivateRaw("selectionMaxX",void 0),g)t.markDirtySelectionExtremes();else for(let f=c;f<h;f++)this.processXSelectionDataItem(this.dataItems[f],m,_);if((i===e||!i)&&"valueYWorking"!==this.get("valueYShow")){const f=this.getPrivate("selectionMinY");null!=f&&(this.setPrivateRaw("minY",f),t.markDirtyExtremes());const b=this.getPrivate("selectionMaxY");null!=b&&(this.setPrivateRaw("maxY",b),t.markDirtyExtremes())}if((i===t||!i)&&"valueXWorking"!==this.get("valueXShow")){const f=this.getPrivate("selectionMinX");null!=f&&(this.setPrivateRaw("minX",f),t.markDirtyExtremes());const b=this.getPrivate("selectionMaxX");null!=b&&(this.setPrivateRaw("maxX",b),e.markDirtyExtremes())}(this.isPrivateDirty("selectionMinX")||this.isPrivateDirty("selectionMaxX"))&&e.markDirtySelectionExtremes(),(this.isPrivateDirty("selectionMinY")||this.isPrivateDirty("selectionMaxY"))&&t.markDirtySelectionExtremes()}}}_makeRangeMask(){if(this.axisRanges.length>0){let e=this._mainContainerMask;null==e&&(e=this.children.push(rn.new(this._root,{})),this._mainContainerMask=e,e.set("draw",(t,i)=>{const n=this.parent;if(n){const r=this._root.container.width(),a=this._root.container.height();t.moveTo(-r,-a),t.lineTo(-r,2*a),t.lineTo(2*r,2*a),t.lineTo(2*r,-a),t.lineTo(-r,-a),this.axisRanges.each(o=>{const l=o.axisDataItem.get("axisFill");if(n&&l){let c=l.get("draw");c&&c(t,i)}})}this.mainContainer._display.mask=e._display})),e.markDirty(),e._markDirtyKey("fill")}else this.mainContainer._display.mask=null}_updateChildren(){super._updateChildren(),this._x=this.x(),this._y=this.y(),this._makeRangeMask()}_stack(){const e=this.chart;if(e){const t=e.series.indexOf(this);if(this._couldStackTo=[],t>0){let i;for(let n=t-1;n>=0&&(i=e.series.getIndex(n),i.get("xAxis")!==this.get("xAxis")||i.get("yAxis")!==this.get("yAxis")||i.className!==this.className||(this._couldStackTo.push(i),i.get("stacked")));n--);}this._stackDataItems()}}_unstack(){en(this._reallyStackedTo,(e,t)=>{delete t._stackedSeries[this.uid]}),this._reallyStackedTo={},ye(this.dataItems,e=>{e.setRaw("stackToItemY",void 0),e.setRaw("stackToItemX",void 0)})}_stackDataItems(){const e=this.get("baseAxis"),t=this.get("xAxis"),i=this.get("yAxis");let n,r;e===t?(n="valueY",r="stackToItemY"):e===i&&(n="valueX",r="stackToItemX");let a=this._couldStackTo.length,o=0;const l=this.get("stackToNegative");this._reallyStackedTo={},ye(this.dataItems,c=>{for(let h=0;h<a;h++){let u=this._couldStackTo[h],m=u.dataItems[o],p=c.get(n);if(m){let _=m.get(n);if(l){if(!Se(p))break;if(Se(_)){if(p>=0&&_>=0){c.setRaw(r,m),this._reallyStackedTo[u.uid]=u,u._stackedSeries[this.uid]=this;break}if(p<0&&_<0){c.setRaw(r,m),this._reallyStackedTo[u.uid]=u,u._stackedSeries[this.uid]=this;break}}}else if(Se(p)&&Se(_)){c.setRaw(r,m),this._reallyStackedTo[u.uid]=u,u._stackedSeries[this.uid]=this;break}}}o++})}processXSelectionDataItem(e,t,i){ye(this.__valueXShowFields,n=>{let r=e.get(n);null!=r&&(i&&(r+=this.getStackedXValueWorking(e,n)),this._min("selectionMinX",r),this._max("selectionMaxX",r*t))})}processYSelectionDataItem(e,t,i){ye(this.__valueYShowFields,n=>{let r=e.get(n);null!=r&&(i&&(r+=this.getStackedYValueWorking(e,n)),this._min("selectionMinY",r),this._max("selectionMaxY",r*t))})}getStackedYValueWorking(e,t){const i=e.get("stackToItemY");if(i){const n=i.component;return i.get(t,0)*n.get("vcy",1)+this.getStackedYValueWorking(i,t)}return 0}getStackedXValueWorking(e,t){const i=e.get("stackToItemX");if(i){const n=i.component;return i.get(t,0)*n.get("vcx",1)+this.getStackedXValueWorking(i,t)}return 0}getStackedYValue(e,t){const i=e.get("stackToItemY");return i?i.get(t,0)+this.getStackedYValue(i,t):0}getStackedXValue(e,t){const i=e.get("stackToItemX");return i?i.get(t,0)+this.getStackedXValue(i,t):0}createLegendMarker(e){this.updateLegendMarker()}_markDirtyAxes(){this._axesDirty=!0,this.markDirty()}_markDataSetDirty(){this._afterDataChange(),this._valuesDirty=!0,this._dataProcessed=!1,this._aggregatesCalculated=!1,this.markDirty()}_clearDirty(){super._clearDirty(),this._axesDirty=!1,this._selectionProcessed=!1,this._stackDirty=!1,this._dataProcessed=!1}_positionBullet(e){let t=e.get("sprite");if(t){let i=t.dataItem,n=e.get("locationX",i.get("locationX",.5)),r=e.get("locationY",i.get("locationY",.5)),a=this.get("xAxis"),o=this.get("yAxis"),l=a.getDataItemPositionX(i,this._xField,n,this.get("vcx",1)),c=o.getDataItemPositionY(i,this._yField,r,this.get("vcy",1)),h=this.getPoint(l,c),u=i.get("left",h.x),m=i.get("right",h.x),p=i.get("top",h.y),_=i.get("bottom",h.y),g=0,f=0,b=m-u,C=_-p;if(this._shouldShowBullet(l,c)){t.setPrivate("visible",!e.getPrivate("hidden"));let M=e.get("field");const E=this.get("baseAxis"),S=this.get("xAxis"),P=this.get("yAxis");if(null!=M){let L;E==S?("value"==M?L=this._yField:"open"==M?L=this._yOpenField:"high"==M?L=this._yHighField:"low"==M&&(L=this._yLowField),L&&(c=P.getDataItemPositionY(i,L,0,this.get("vcy",1)),h=P.get("renderer").positionToPoint(c),f=h.y,g=u+b*n)):("value"==M?L=this._xField:"open"==M?L=this._xOpenField:"high"==M?L=this._xHighField:"low"==M&&(L=this._xLowField),L&&(l=S.getDataItemPositionX(i,L,0,this.get("vcx",1)),h=S.get("renderer").positionToPoint(l),g=h.x,f=_-C*r))}else g=u+b*n,f=_-C*r;const I=e.get("stacked");if(I){const L=this.chart;if(E==S){let O=this._bullets[l+"_"+c];if(O){let B=O.bounds(),Q=t.localBounds(),pe=f;f=B.top,"down"==I?f=B.bottom-Q.top:"auto"==I?L&&(pe<L.plotContainer.height()/2?f=B.bottom-Q.top:f+=Q.bottom):f+=Q.bottom}this._bullets[l+"_"+c]=t}else{let O=this._bullets[l+"_"+c];if(O){let B=O.bounds(),Q=t.localBounds(),pe=g;g=B.right,"down"==I?g=B.left-Q.right:"auto"==I?L&&(pe<L.plotContainer.width()/2?g=B.left-Q.right:g-=Q.left):g-=Q.left}this._bullets[l+"_"+c]=t}}t.isType("Label")&&(t.setPrivate("maxWidth",Math.abs(b)),t.setPrivate("maxHeight",Math.abs(C))),t.setAll({x:g,y:f})}else t.setPrivate("visible",!1)}}_shouldShowBullet(e,t){return this._showBullets}setDataSet(e){if(this._dataSets[e]){this._handleDataSetChange(),this._dataItems=this._dataSets[e],this._markDataSetDirty(),this._dataSetId=e;const t="datasetchanged";this.events.isEnabled(t)&&this.events.dispatch(t,{type:t,target:this,id:e})}}resetGrouping(){en(this._dataSets,(e,t)=>{t!=this._mainDataItems&&ye(t,i=>{this.disposeDataItem(i)})}),this._dataSets={},this._dataItems=this.mainDataItems}_handleDataSetChange(){ye(this._dataItems,e=>{let t=e.bullets;t&&ye(t,i=>{if(i){let n=i.get("sprite");n&&n.setPrivate("visible",!1)}})}),this._selectionProcessed=!1}show(e){const t=Object.create(null,{show:{get:()=>super.show}});return(0,vs.mG)(this,void 0,void 0,function*(){this._fixVC();let i=[];i.push(t.show.call(this,e).then(()=>{this._isShowing=!1;let n=this.get("xAxis"),r=this.get("yAxis"),a=this.get("baseAxis");r!==a&&r.markDirtySelectionExtremes(),n!==a&&n.markDirtySelectionExtremes()})),i.push(this.bulletsContainer.show(e)),i.push(this._sequencedShowHide(!0,e)),yield Promise.all(i)})}hide(e){const t=Object.create(null,{hide:{get:()=>super.hide}});return(0,vs.mG)(this,void 0,void 0,function*(){this._fixVC();let i=[];i.push(t.hide.call(this,e).then(()=>{this._isHiding=!1})),i.push(this.bulletsContainer.hide(e)),i.push(this._sequencedShowHide(!1,e)),yield Promise.all(i)})}showDataItem(e,t){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return(0,vs.mG)(this,void 0,void 0,function*(){const n=[i.showDataItem.call(this,e,t)];Se(t)||(t=this.get("stateAnimationDuration",0));const r=this.get("stateAnimationEasing");ye(this._valueFields,a=>{n.push(e.animate({key:a+"Working",to:e.get(a),duration:t,easing:r}).waitForStop())}),yield Promise.all(n)})}hideDataItem(e,t){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return(0,vs.mG)(this,void 0,void 0,function*(){const n=[i.hideDataItem.call(this,e,t)],r=this.states.create("hidden",{});Se(t)||(t=r.get("stateAnimationDuration",this.get("stateAnimationDuration",0)));const a=r.get("stateAnimationEasing",this.get("stateAnimationEasing")),o=this.get("xAxis"),l=this.get("yAxis"),c=this.get("baseAxis"),h=this.get("stacked");if((c===o||!c)&&ye(this._valueYFields,u=>{let m=l.getPrivate("min"),p=l.baseValue();Se(m)&&m>p&&(p=m),h&&(p=0),null!=e.get(u)&&n.push(e.animate({key:u+"Working",to:p,duration:t,easing:a}).waitForStop())}),c===l||!c){let u=o.getPrivate("min"),m=o.baseValue();Se(u)&&u>m&&(m=u),h&&(m=0),ye(this._valueXFields,p=>{null!=e.get(p)&&n.push(e.animate({key:p+"Working",to:m,duration:t,easing:a}).waitForStop())})}yield Promise.all(n)})}_markDirtyStack(){this._stackDirty=!0,this.markDirty(),this._markStakedDirtyStack()}_markStakedDirtyStack(){const e=this._stackedSeries;e&&en(e,(t,i)=>{i._stackDirty||i._markDirtyStack()})}_afterChanged(){super._afterChanged(),this._skipped&&(this._markDirtyAxes(),this._skipped=!1)}showDataItemTooltip(e){this.getPrivate("doNotUpdateLegend")||(this.updateLegendMarker(e),this.updateLegendValue(e));const t=this.get("tooltip");if(t)if(this.isHidden())this.hideTooltip();else if(t._setDataItem(e),e){let i=this.get("locationX",0),n=this.get("locationY",1),r=e.get("locationX",i),a=e.get("locationY",n);const o=this.get("xAxis"),l=this.get("yAxis"),c=this.get("vcx",1),h=this.get("vcy",1),u=o.getDataItemPositionX(e,this._tooltipFieldX,this._aLocationX0+(this._aLocationX1-this._aLocationX0)*r,c),m=l.getDataItemPositionY(e,this._tooltipFieldY,this._aLocationY0+(this._aLocationY1-this._aLocationY0)*a,h),p=this.getPoint(u,m);let _=!0;if(ye(this._valueFields,g=>{null==e.get(g)&&(_=!1)}),_){const g=this.chart;g&&g.inPlot(p)?(t.label.text.markDirtyText(),t.set("tooltipTarget",this._getTooltipTarget(e)),t.set("pointTo",this._display.toGlobal({x:p.x,y:p.y}))):t._setDataItem(void 0)}else t._setDataItem(void 0)}}hideTooltip(){const e=this.get("tooltip");return e&&e.set("tooltipTarget",this),super.hideTooltip()}_getTooltipTarget(e){if("bullet"==this.get("seriesTooltipTarget")){const t=e.bullets;if(t&&t.length>0){const n=t[0].get("sprite");if(n)return n}}return this}updateLegendValue(e){const t=this.get("legendDataItem");if(t){const i=t.get("label");if(i){let r="";e?(i._setDataItem(e),r=this.get("legendLabelText",i.get("text",this.get("name","")))):(i._setDataItem(this._emptyDataItem),r=this.get("legendRangeLabelText",this.get("legendLabelText",i.get("text",this.get("name",""))))),i.set("text",r)}const n=t.get("valueLabel");if(n){let r="";e?(n._setDataItem(e),r=this.get("legendValueText",n.get("text",""))):(n._setDataItem(this._emptyDataItem),r=this.get("legendRangeValueText",n.get("text",""))),n.set("text",r)}}}_getItemReaderLabel(){let e="X: {"+this._xField;return this.get("xAxis").isType("DateAxis")&&(e+=".formatDate()"),e+="}; Y: {"+this._yField,this.get("yAxis").isType("DateAxis")&&(e+=".formatDate()"),e+="}",e}getPoint(e,t){let i=this.get("xAxis").get("renderer").positionToCoordinate(e),n=this.get("yAxis").get("renderer").positionToCoordinate(t),r=999999999;return n<-r&&(n=-r),n>r&&(n=r),i<-r&&(i=-r),i>r&&(i=r),{x:i,y:n}}_shouldInclude(e){return!0}handleCursorHide(){this.hideTooltip(),this.updateLegendValue(void 0),this.updateLegendMarker(void 0)}_afterDataChange(){super._afterDataChange(),this.get("xAxis")._markDirtyKey("start"),this.get("yAxis")._markDirtyKey("start"),this.resetExtremes()}resetExtremes(){this.setPrivate("selectionMinX",void 0),this.setPrivate("selectionMaxX",void 0),this.setPrivate("selectionMinY",void 0),this.setPrivate("selectionMaxY",void 0),this.setPrivate("minX",void 0),this.setPrivate("minY",void 0),this.setPrivate("maxX",void 0),this.setPrivate("maxY",void 0)}createAxisRange(e){return this.axisRanges.push({axisDataItem:e})}get mainDataItems(){return this._mainDataItems}}function tx(s){return"object"==typeof s&&"length"in s?s:Array.from(s)}function Gn(s){return function(){return s}}function ix(s){this._context=s}function nx(s){return new ix(s)}Object.defineProperty(Ac,"className",{enumerable:!0,configurable:!0,writable:!0,value:"XYSeries"}),Object.defineProperty(Ac,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Zo.classNames.concat([Ac.className])}),ix.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(s,e){switch(s=+s,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(s,e):this._context.moveTo(s,e);break;case 1:this._point=2;default:this._context.lineTo(s,e)}}};const Tb=Math.PI,Cb=2*Tb,Pc=1e-6,ZD=Cb-Pc;function sx(s){this._+=s[0];for(let e=1,t=s.length;e<t;++e)this._+=arguments[e]+s[e]}class Bp{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?sx:function XD(s){let e=Math.floor(s);if(!(e>=0))throw new Error(`invalid digits: ${s}`);if(e>15)return sx;const t=10**e;return function(i){this._+=i[0];for(let n=1,r=i.length;n<r;++n)this._+=Math.round(arguments[n]*t)/t+i[n]}}(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,i,n){this._append`Q${+e},${+t},${this._x1=+i},${this._y1=+n}`}bezierCurveTo(e,t,i,n,r,a){this._append`C${+e},${+t},${+i},${+n},${this._x1=+r},${this._y1=+a}`}arcTo(e,t,i,n,r){if(e=+e,t=+t,i=+i,n=+n,(r=+r)<0)throw new Error(`negative radius: ${r}`);let a=this._x1,o=this._y1,l=i-e,c=n-t,h=a-e,u=o-t,m=h*h+u*u;if(null===this._x1)this._append`M${this._x1=e},${this._y1=t}`;else if(m>Pc)if(Math.abs(u*l-c*h)>Pc&&r){let p=i-a,_=n-o,g=l*l+c*c,f=p*p+_*_,b=Math.sqrt(g),C=Math.sqrt(m),M=r*Math.tan((Tb-Math.acos((g+m-f)/(2*b*C)))/2),E=M/C,S=M/b;Math.abs(E-1)>Pc&&this._append`L${e+E*h},${t+E*u}`,this._append`A${r},${r},0,0,${+(u*p>h*_)},${this._x1=e+S*l},${this._y1=t+S*c}`}else this._append`L${this._x1=e},${this._y1=t}`}arc(e,t,i,n,r,a){if(e=+e,t=+t,a=!!a,(i=+i)<0)throw new Error(`negative radius: ${i}`);let o=i*Math.cos(n),l=i*Math.sin(n),c=e+o,h=t+l,u=1^a,m=a?n-r:r-n;null===this._x1?this._append`M${c},${h}`:(Math.abs(this._x1-c)>Pc||Math.abs(this._y1-h)>Pc)&&this._append`L${c},${h}`,i&&(m<0&&(m=m%Cb+Cb),m>ZD?this._append`A${i},${i},0,1,${u},${e-o},${t-l}A${i},${i},0,1,${u},${this._x1=c},${this._y1=h}`:m>Pc&&this._append`A${i},${i},0,${+(m>=Tb)},${u},${this._x1=e+i*Math.cos(r)},${this._y1=t+i*Math.sin(r)}`)}rect(e,t,i,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${i=+i}v${+n}h${-i}Z`}toString(){return this._}}function Db(s){let e=3;return s.digits=function(t){if(!arguments.length)return e;if(null==t)e=null;else{const i=Math.floor(t);if(!(i>=0))throw new RangeError(`invalid digits: ${t}`);e=i}return s},()=>new Bp(e)}function rx(s){return s[0]}function ax(s){return s[1]}function ox(s,e){var t=Gn(!0),i=null,n=nx,r=null,a=Db(o);function o(l){var c,u,p,h=(l=tx(l)).length,m=!1;for(null==i&&(r=n(p=a())),c=0;c<=h;++c)!(c<h&&t(u=l[c],c,l))===m&&((m=!m)?r.lineStart():r.lineEnd()),m&&r.point(+s(u,c,l),+e(u,c,l));if(p)return r=null,p+""||null}return s="function"==typeof s?s:void 0===s?rx:Gn(s),e="function"==typeof e?e:void 0===e?ax:Gn(e),o.x=function(l){return arguments.length?(s="function"==typeof l?l:Gn(+l),o):s},o.y=function(l){return arguments.length?(e="function"==typeof l?l:Gn(+l),o):e},o.defined=function(l){return arguments.length?(t="function"==typeof l?l:Gn(!!l),o):t},o.curve=function(l){return arguments.length?(n=l,null!=i&&(r=n(i)),o):n},o.context=function(l){return arguments.length?(null==l?i=r=null:r=n(i=l),o):i},o}function $D(s,e,t){var i=null,n=Gn(!0),r=null,a=nx,o=null,l=Db(c);function c(u){var m,p,_,f,C,g=(u=tx(u)).length,b=!1,M=new Array(g),E=new Array(g);for(null==r&&(o=a(C=l())),m=0;m<=g;++m){if(!(m<g&&n(f=u[m],m,u))===b)if(b=!b)p=m,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),_=m-1;_>=p;--_)o.point(M[_],E[_]);o.lineEnd(),o.areaEnd()}b&&(M[m]=+s(f,m,u),E[m]=+e(f,m,u),o.point(i?+i(f,m,u):M[m],t?+t(f,m,u):E[m]))}if(C)return o=null,C+""||null}function h(){return ox().defined(n).curve(a).context(r)}return s="function"==typeof s?s:void 0===s?rx:Gn(+s),e="function"==typeof e?e:Gn(void 0===e?0:+e),t="function"==typeof t?t:void 0===t?ax:Gn(+t),c.x=function(u){return arguments.length?(s="function"==typeof u?u:Gn(+u),i=null,c):s},c.x0=function(u){return arguments.length?(s="function"==typeof u?u:Gn(+u),c):s},c.x1=function(u){return arguments.length?(i=null==u?null:"function"==typeof u?u:Gn(+u),c):i},c.y=function(u){return arguments.length?(e="function"==typeof u?u:Gn(+u),t=null,c):e},c.y0=function(u){return arguments.length?(e="function"==typeof u?u:Gn(+u),c):e},c.y1=function(u){return arguments.length?(t=null==u?null:"function"==typeof u?u:Gn(+u),c):t},c.lineX0=c.lineY0=function(){return h().x(s).y(e)},c.lineY1=function(){return h().x(s).y(t)},c.lineX1=function(){return h().x(i).y(e)},c.defined=function(u){return arguments.length?(n="function"==typeof u?u:Gn(!!u),c):n},c.curve=function(u){return arguments.length?(a=u,null!=r&&(o=a(r)),c):a},c.context=function(u){return arguments.length?(null==u?r=o=null:o=a(r=u),c):r},c}class Oc extends Ac{constructor(){super(...arguments),Object.defineProperty(this,"_endIndex",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_strokeGenerator",{enumerable:!0,configurable:!0,writable:!0,value:ox()}),Object.defineProperty(this,"_fillGenerator",{enumerable:!0,configurable:!0,writable:!0,value:$D()}),Object.defineProperty(this,"_legendStroke",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_legendFill",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"strokes",{enumerable:!0,configurable:!0,writable:!0,value:new bs(An.new({}),()=>rn._new(this._root,{themeTags:ki(this.strokes.template.get("themeTags",[]),["line","series","stroke"])},[this.strokes.template]))}),Object.defineProperty(this,"fills",{enumerable:!0,configurable:!0,writable:!0,value:new bs(An.new({}),()=>rn._new(this._root,{themeTags:ki(this.strokes.template.get("themeTags",[]),["line","series","fill"])},[this.fills.template]))}),Object.defineProperty(this,"_fillTemplate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_strokeTemplate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_previousPoint",{enumerable:!0,configurable:!0,writable:!0,value:[0,0,0,0]}),Object.defineProperty(this,"_dindex",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_sindex",{enumerable:!0,configurable:!0,writable:!0,value:0})}_afterNew(){this._fillGenerator.y0(function(e){return e[3]}),this._fillGenerator.x0(function(e){return e[2]}),this._fillGenerator.y1(function(e){return e[1]}),this._fillGenerator.x1(function(e){return e[0]}),super._afterNew()}makeStroke(e){const t=this.mainContainer.children.push(e.make());return e.push(t),t}makeFill(e){const t=this.mainContainer.children.push(e.make());return e.push(t),t}_updateChildren(){this._strokeTemplate=void 0,this._fillTemplate=void 0;let e=this.get("xAxis"),t=this.get("yAxis");if(this.isDirty("stroke")){const i=this.get("stroke");this.strokes.template.set("stroke",i);const n=this._legendStroke;n&&n.states.lookup("default").set("stroke",i)}if(this.isDirty("fill")){const i=this.get("fill");this.fills.template.set("fill",i);const n=this._legendFill;n&&n.states.lookup("default").set("fill",i)}if(this.isDirty("curveFactory")){const i=this.get("curveFactory");i&&(this._strokeGenerator.curve(i),this._fillGenerator.curve(i))}if(e.inited&&t.inited){if(this._axesDirty||this._valuesDirty||this._stackDirty||this.isDirty("vcx")||this.isDirty("vcy")||this._sizeDirty||this.isDirty("connect")||this.isDirty("curveFactory")){this.fills.each(h=>{h.setPrivate("visible",!1)}),this.strokes.each(h=>{h.setPrivate("visible",!1)}),this.axisRanges.each(h=>{let u=h.fills;u&&u.each(p=>{p.setPrivate("visible",!1)});let m=h.strokes;m&&m.each(p=>{p.setPrivate("visible",!1)})});let i=this.startIndex(),n=this.strokes.template.get("templateField"),r=this.fills.template.get("templateField"),a=!0,o=!0;n&&(a=!1),r&&(o=!1);for(let h=i-1;h>=0;h--){let u=this.dataItems[h],m=!0,p=u.dataContext;if(n&&p[n]&&(a=!0),r&&p[r]&&(o=!0),ye(this._valueFields,_=>{Se(u.get(_))||(m=!1)}),m&&a&&o){i=h;break}}let l=this.dataItems.length,c=this.endIndex();if(c<l){c++;for(let h=c;h<l;h++){let u=this.dataItems[h],m=!0;if(ye(this._valueFields,p=>{Se(u.get(p))||(m=!1)}),m){c=h+1;break}}}if(i>0&&i--,this._endIndex=c,this._clearGraphics(),this._sindex=0,this._dindex=i,1==this.dataItems.length)this._startSegment(0);else for(;this._dindex<c-1;)this._startSegment(this._dindex),this._sindex++}}else this._skipped=!0;super._updateChildren()}_clearGraphics(){this.strokes.clear(),this.fills.clear()}_startSegment(e){let t=this._endIndex,i=t;const n=this.get("autoGapCount"),r=this.get("connect"),a=this.makeFill(this.fills),o=this._fillTemplate;o&&o!=this.fills.template&&(a.template=o),a.setPrivate("visible",!0);const c=this.makeStroke(this.strokes),h=this._strokeTemplate;h&&h!=this.strokes.template&&(c.template=h),c.setPrivate("visible",!0);let u=this.get("xAxis"),m=this.get("yAxis"),p=this.get("baseAxis"),_=this.get("vcx",1),g=this.get("vcy",1),f=this._xField,b=this._yField,C=this._xOpenField,M=this._yOpenField;const E=this.get("openValueXField"),S=this.get("openValueYField");E||(C=this._xField),S||(M=this._yField);const P=this.get("stacked"),I=u.basePosition(),L=m.basePosition();let O;O=p===m?this._yField:this._xField;const B=[];let Q=[];B.push(Q);const pe=this.strokes.template.get("templateField"),ae=this.fills.template.get("templateField");let N=this.get("locationX",.5),ee=this.get("locationY",.5),K=this.get("openLocationX",N),se=this.get("openLocationY",ee);const ue=this.get("minDistance",0);let re,xe=this.fills.template.get("visible");this.axisRanges.length>0&&(xe=!0);let Ce=!1;(P||E||S)&&(Ce=!0);const Fe={points:Q,segments:B,stacked:P,getOpen:Ce,basePosX:I,basePosY:L,fillVisible:xe,xField:f,yField:b,xOpenField:C,yOpenField:M,vcx:_,vcy:g,baseAxis:p,xAxis:u,yAxis:m,locationX:N,locationY:ee,openLocationX:K,openLocationY:se,minDistance:ue};for(re=e;re<i;re++){this._dindex=re;const Te=this._dataItems[re];let Le=Te.get(f),Ge=Te.get(b);if(null==Le||null==Ge?r||(Q=[],B.push(Q),Fe.points=Q):this._getPoints(Te,Fe),pe){let $e=Te.dataContext[pe];if($e){if($e instanceof An||($e=An.new($e)),this._strokeTemplate=$e,re>e){i=re;break}c.template=$e}}if(ae){let $e=Te.dataContext[ae];if($e){if($e instanceof An||($e=An.new($e)),this._fillTemplate=$e,re>e){i=re;break}a.template=$e}}if(!r){let $e=this.dataItems[re+1];$e&&p.shouldGap(Te,$e,n,O)&&(Q=[],B.push(Q),Fe.points=Q)}}a.setRaw("userData",[e,re]),c.setRaw("userData",[e,re]),re===t&&this._endLine(Q,B[0][0]),c&&this._drawStroke(c,B),a&&this._drawFill(a,B),this.axisRanges.each(Te=>{const Le=Te.container,$e=this.makeFill(Te.fills);Le&&Le.children.push($e),$e.setPrivate("visible",!0),this._drawFill($e,B);const wt=this.makeStroke(Te.strokes);Le&&Le.children.push(wt),wt.setPrivate("visible",!0),this._drawStroke(wt,B),$e.setRaw("userData",[e,re]),wt.setRaw("userData",[e,re])})}_getPoints(e,t){let i=t.points,n=e.get("locationX",t.locationX),r=e.get("locationY",t.locationY),a=t.xAxis.getDataItemPositionX(e,t.xField,n,t.vcx),o=t.yAxis.getDataItemPositionY(e,t.yField,r,t.vcy);if(this._shouldInclude(a)){const l=this.getPoint(a,o),c=[l.x,l.y];if(l.x+=this._x,l.y+=this._y,e.set("point",l),t.fillVisible){let h=a,u=o;if(t.baseAxis===t.xAxis?u=t.basePosY:t.baseAxis===t.yAxis&&(h=t.basePosX),t.getOpen){let p=e.get(t.xOpenField),_=e.get(t.yOpenField);if(null!=p&&null!=_){let g=e.get("openLocationX",t.openLocationX),f=e.get("openLocationY",t.openLocationY);if(t.stacked){let b=e.get("stackToItemX"),C=e.get("stackToItemY");b?(h=t.xAxis.getDataItemPositionX(b,t.xField,g,b.component.get("vcx")),Kt(h)&&(h=t.basePosX)):h=t.yAxis===t.baseAxis?t.basePosX:t.xAxis.getDataItemPositionX(e,t.xOpenField,g,t.vcx),C?(u=t.yAxis.getDataItemPositionY(C,t.yField,f,C.component.get("vcy")),Kt(u)&&(u=t.basePosY)):u=t.xAxis===t.baseAxis?t.basePosY:t.yAxis.getDataItemPositionY(e,t.yOpenField,f,t.vcy)}else h=t.xAxis.getDataItemPositionX(e,t.xOpenField,g,t.vcx),u=t.yAxis.getDataItemPositionY(e,t.yOpenField,f,t.vcy)}}let m=this.getPoint(h,u);c[2]=m.x,c[3]=m.y}if(t.minDistance>0){const m=c[2],p=c[3],_=this._previousPoint,b=_[2],C=_[3];(Math.hypot(c[0]-_[0],c[1]-_[1])>t.minDistance||m&&p&&Math.hypot(m-b,p-C)>t.minDistance)&&(i.push(c),this._previousPoint=c)}else i.push(c)}}_endLine(e,t){}_drawStroke(e,t){e.get("visible")&&!e.get("forceHidden")&&e.set("draw",i=>{ye(t,n=>{this._strokeGenerator.context(i),this._strokeGenerator(n)})})}_drawFill(e,t){e.get("visible")&&!e.get("forceHidden")&&e.set("draw",i=>{ye(t,n=>{this._fillGenerator.context(i),this._fillGenerator(n)})})}_processAxisRange(e){super._processAxisRange(e),e.fills=new bs(An.new({}),()=>rn._new(this._root,{themeTags:ki(e.fills.template.get("themeTags",[]),["line","series","fill"])},[this.fills.template,e.fills.template])),e.strokes=new bs(An.new({}),()=>rn._new(this._root,{themeTags:ki(e.strokes.template.get("themeTags",[]),["line","series","stroke"])},[this.strokes.template,e.strokes.template]))}createLegendMarker(e){const t=this.get("legendDataItem");if(t){const i=t.get("marker"),n=t.get("markerRectangle");n&&n.setPrivate("visible",!1),i.set("background",ca.new(i._root,{fillOpacity:0,fill:kn(0)}));const r=i.children.push(rn._new(i._root,{themeTags:["line","series","legend","marker","stroke"],interactive:!1},[this.strokes.template]));this._legendStroke=r;const a=i.children.push(rn._new(i._root,{themeTags:["line","series","legend","marker","fill"]},[this.fills.template]));this._legendFill=a;const o=this._root.interfaceColors.get("disabled");if(r.states.create("disabled",{fill:o,stroke:o}),a.states.create("disabled",{fill:o,stroke:o}),this.bullets.length>0){const l=this.bullets.getIndex(0);if(l){const c=l(i._root,this,new Za(this,{legend:!0},{}));if(c){const h=c.get("sprite");h instanceof rn&&h.states.create("disabled",{fill:o,stroke:o}),h&&(h.set("tooltipText",void 0),h.set("tooltipHTML",void 0),i.children.push(h),h.setAll({x:i.width()/2,y:i.height()/2}),i.events.on("boundschanged",()=>{h.setAll({x:i.width()/2,y:i.height()/2})}))}}}}}}Object.defineProperty(Oc,"className",{enumerable:!0,configurable:!0,writable:!0,value:"LineSeries"}),Object.defineProperty(Oc,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Ac.classNames.concat([Oc.className])});const Rc=class KD extends Pu{setupDefaultRules(){super.setupDefaultRules(),this.rule("Component").setAll({interpolationDuration:600}),this.rule("Hierarchy").set("animationDuration",600),this.rule("Scrollbar").set("animationDuration",600),this.rule("Tooltip").set("animationDuration",300),this.rule("MapChart").set("animationDuration",1e3),this.rule("MapChart").set("wheelDuration",300),this.rule("Entity").setAll({stateAnimationDuration:600}),this.rule("Sprite").states.create("default",{stateAnimationDuration:600}),this.rule("Tooltip",["axis"]).setAll({animationDuration:200}),this.rule("WordCloud").set("animationDuration",500),this.rule("Polygon").set("animationDuration",600),this.rule("ArcDiagram").set("animationDuration",600)}};var Eb=V(9880),Gd=V(754),Yr=V(3238);let JD=(()=>{class s{constructor(t,i){this.historicalService=t,this.socketService=i,this.unsubscribe$=new gi.x,this.backgroundColor="transparent"}ngAfterViewInit(){const t=this.config;new Date((new Date).getTime()-1e4),this._root&&this._root.dispose(),this._root=Yo.new("dynamic_chart_"+this.id),this._root.setThemes([Rc.new(this._root)]),t.view.chart.BackgroundColor&&(this.backgroundColor=t.view.chart.BackgroundColor);let r=this._root.container.children.push(ja.new(this._root,{focusable:!0,panX:!0,panY:!0,wheelX:"panX",wheelY:"zoomX",pinchZoomX:!0}));const a=r.set("cursor",Dc.new(this._root,{}));a.lineX.set("visible",!1),a.lineY.set("visible",!1);let o=r.xAxes.push(kc.new(this._root,{baseInterval:{timeUnit:"second",count:1},renderer:fo.new(this._root,{}),tooltip:Vr.new(this._root,{})}));o.set("tooltipDateFormat","yyyy/MM/dd HH:mm:ss");let l=r.yAxes.push(ha.new(this._root,{maxDeviation:.3,renderer:go.new(this._root,{minGridDistance:20,strokeOpacity:.1})}));r.appear(1e3,100),o.set("dateFormats",{second:"HH:mm:ss",minute:"HH:mm:ss",hour:"HH:mm:ss",day:"HH:mm:ss",week:"HH:mm:ss",month:"HH:mm:ss",year:"HH:mm:ss"});let c=[];const h=this;let u,m,p;r.plotContainer.children.push(_r.new(this._root,{x:10,y:10,text:t.view.label?.title,fill:kn(16777215)})),t.view.scrollbarY.enable&&r.set("scrollbarY",Wd.new(this._root,{orientation:"vertical",width:t.view.scrollbarY.width||20})),t.view.scrollbarX.enable&&(u=r.set("scrollbarX",Wd.new(this._root,{orientation:"horizontal",height:t.view.scrollbarX.height||40})),"bottom"===t.view.scrollbarX.position?r.bottomAxesContainer.children.push(u):r.topAxesContainer.children.push(u),m=u.chart.xAxes.push(kc.new(this._root,{baseInterval:{timeUnit:"second",count:1},markUnitChange:!1,renderer:fo.new(this._root,{})})),p=u.chart.yAxes.push(ha.new(this._root,{renderer:go.new(this._root,{})})));const _=new Date((new Date).toLocaleString("fa-IR-u-nu-latn")).getTime();t.content.forEach(g=>{this.generateData(_).pipe((0,ri.U)(f=>{console.log("history",f),f.map(C=>{c.push({date:C.date,[g.outputs.read.name]:C.value})});const b=r.series.push(Oc.new(this._root,{name:g.outputs.read.name,xAxis:o,yAxis:l,fill:kn(g.color||7649791),stroke:kn(g.color||7649791),valueYField:g.outputs.read.name,valueXField:"date",tooltip:Vr.new(this._root,{labelText:`${g.outputs.read.name}:{valueY}`})}));if(b.bullets.push(()=>Tc.new(h._root,{locationY:0,sprite:Nd.new(h._root,{radius:t.view.bullet.size||2,fill:b.get("fill")})})),b.data.setAll(c),u&&m&&p&&"data"===t.view.scrollbarX.type&&u.chart.series.push(Oc.new(this._root,{valueYField:"value",valueXField:"date",xAxis:m,yAxis:p})).data.setAll(f),t.view.target.enabled){const C=l.makeDataItem({value:t.view.target.value||20,endValue:0});b.createAxisRange(C),C.get("grid").setAll({strokeOpacity:1,visible:!0,stroke:kn(0),strokeDasharray:[2,2]}),C.get("label").setAll({location:0,visible:!0,text:t.view.target.title,inside:!0,centerX:0,centerY:vt,fontWeight:"bold"})}return b.appear(1e3),this._root?.resize(),b}),(0,Di.q)(1),(0,Eb.z)(f=>this.socketService.fetchDeviceData(g.topic.id,g.outputs.read.name).pipe((0,ri.U)(b=>{console.log(b),this._root?.resize(),this.addData(f,+b,o,g.outputs.read.name)})))).subscribe()}),r.appear(1e3,100)}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}generateData(t){const i=[];for(let n=10;n>0;n--)i.push({date:t-1e3*n,value:0});return(0,D.of)(i)}addData(t,i,n,r){const a=Id;let o=new Date((new Date).toLocaleString("fa-IR-u-nu-latn")).getTime();t.data.push({date:o,[r]:i});let c=t.dataItems[t.dataItems.length-1].get("valueY");t.dataItems[t.dataItems.length-1].animate({key:"valueYWorking",to:i,from:c,duration:600,easing:a}),t.data.length>9&&t.data.removeIndex(0)}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(Gd.O),d.Y36(Yr.l))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-dynamic-chart"]],inputs:{id:"id",config:"config"},decls:2,vars:3,consts:[[1,"container"],[1,"chat-container",3,"id"]],template:function(i,n){1&i&&(d.TgZ(0,"div",0),d._UZ(1,"div",1),d.qZA()),2&i&&(d.Udp("background-color",n.backgroundColor),d.xp6(1),d.Q6J("id","dynamic_chart_"+n.id))},styles:[".container[_ngcontent-%COMP%]{width:100%;height:100%;padding:0;display:flex;flex-direction:column}.chat-container[_ngcontent-%COMP%]{padding:0;width:100%;height:100%}h6[_ngcontent-%COMP%]{text-align:center;color:#fff}"]})}return s})();class QD extends Pu{setupDefaultRules(){super.setupDefaultRules();const e=this.rule.bind(this),t=this._root.interfaceColors;e("RadarChart").setAll({radius:ln(80),innerRadius:0,startAngle:-90,endAngle:270}),e("RadarColumnSeries").setAll({clustered:!0}),e("Slice",["radar","column","series"]).setAll({width:ln(80),height:ln(80)}),e("RadarLineSeries").setAll({connectEnds:!0}),e("SmoothedRadarLineSeries").setAll({tension:.5}),e("AxisRendererRadial").setAll({minGridDistance:40,axisAngle:-90,inversed:!1,cellStartLocation:0,cellEndLocation:1}),e("AxisRendererCircular").setAll({minGridDistance:100,inversed:!1,cellStartLocation:0,cellEndLocation:1}),e("RadialLabel",["circular"]).setAll({textType:"circular",paddingTop:1,paddingRight:0,paddingBottom:1,paddingLeft:0,centerX:0,centerY:0,radius:8}),e("AxisLabelRadial",["category"]).setAll({text:"{category}",populateText:!0}),e("RadialLabel",["radial"]).setAll({textType:"regular",centerX:0,textAlign:"right"}),e("RadarChart",["gauge"]).setAll({startAngle:180,endAngle:360,innerRadius:ln(90)}),e("ClockHand").setAll({topWidth:1,bottomWidth:10,radius:ln(90),pinRadius:10});{const i=e("Graphics",["clock","hand"]);i.setAll({fillOpacity:1}),ti(i,"fill",t,"alternativeBackground")}{const i=e("Graphics",["clock","pin"]);i.setAll({fillOpacity:1}),ti(i,"fill",t,"alternativeBackground")}}}const lx=Math.abs,yr=Math.atan2,Ic=Math.cos,eE=Math.max,Sb=Math.min,_o=Math.sin,Yd=Math.sqrt,jr=1e-12,Uu=Math.PI,Np=Uu/2,tE=2*Uu;function cx(s){return s>=1?Np:s<=-1?-Np:Math.asin(s)}function nE(s){return s.innerRadius}function sE(s){return s.outerRadius}function rE(s){return s.startAngle}function aE(s){return s.endAngle}function oE(s){return s&&s.padAngle}function Up(s,e,t,i,n,r,a){var o=s-t,l=e-i,c=(a?r:-r)/Yd(o*o+l*l),h=c*l,u=-c*o,m=s+h,p=e+u,_=t+h,g=i+u,f=(m+_)/2,b=(p+g)/2,C=_-m,M=g-p,E=C*C+M*M,S=n-r,P=m*g-_*p,I=(M<0?-1:1)*Yd(eE(0,S*S*E-P*P)),L=(P*M-C*I)/E,O=(-P*C-M*I)/E,B=(P*M+C*I)/E,Q=(-P*C+M*I)/E,pe=L-f,ae=O-b,N=B-f,ee=Q-b;return pe*pe+ae*ae>N*N+ee*ee&&(L=B,O=Q),{cx:L,cy:O,x01:-h,y01:-u,x11:L*(n/S-1),y11:O*(n/S-1)}}function kb(){var s=nE,e=sE,t=Gn(0),i=null,n=rE,r=aE,a=oE,o=null,l=Db(c);function c(){var h,u,m=+s.apply(this,arguments),p=+e.apply(this,arguments),_=n.apply(this,arguments)-Np,g=r.apply(this,arguments)-Np,f=lx(g-_),b=g>_;if(o||(o=h=l()),p<m&&(u=p,p=m,m=u),p>jr)if(f>tE-jr)o.moveTo(p*Ic(_),p*_o(_)),o.arc(0,0,p,_,g,!b),m>jr&&(o.moveTo(m*Ic(g),m*_o(g)),o.arc(0,0,m,g,_,b));else{var ae,N,C=_,M=g,E=_,S=g,P=f,I=f,L=a.apply(this,arguments)/2,O=L>jr&&(i?+i.apply(this,arguments):Yd(m*m+p*p)),B=Sb(lx(p-m)/2,+t.apply(this,arguments)),Q=B,pe=B;if(O>jr){var ee=cx(O/m*_o(L)),K=cx(O/p*_o(L));(P-=2*ee)>jr?(E+=ee*=b?1:-1,S-=ee):(P=0,E=S=(_+g)/2),(I-=2*K)>jr?(C+=K*=b?1:-1,M-=K):(I=0,C=M=(_+g)/2)}var se=p*Ic(C),ue=p*_o(C),re=m*Ic(S),xe=m*_o(S);if(B>jr){var Ge,Ce=p*Ic(M),Fe=p*_o(M),Te=m*Ic(E),Le=m*_o(E);if(f<Uu)if(Ge=function lE(s,e,t,i,n,r,a,o){var l=t-s,c=i-e,h=a-n,u=o-r,m=u*l-h*c;if(!(m*m<jr))return[s+(m=(h*(e-r)-u*(s-n))/m)*l,e+m*c]}(se,ue,Te,Le,Ce,Fe,re,xe)){var $e=se-Ge[0],et=ue-Ge[1],wt=Ce-Ge[0],Jt=Fe-Ge[1],It=1/_o(function iE(s){return s>1?0:s<-1?Uu:Math.acos(s)}(($e*wt+et*Jt)/(Yd($e*$e+et*et)*Yd(wt*wt+Jt*Jt)))/2),oi=Yd(Ge[0]*Ge[0]+Ge[1]*Ge[1]);Q=Sb(B,(m-oi)/(It-1)),pe=Sb(B,(p-oi)/(It+1))}else Q=pe=0}I>jr?pe>jr?(ae=Up(Te,Le,se,ue,p,pe,b),N=Up(Ce,Fe,re,xe,p,pe,b),o.moveTo(ae.cx+ae.x01,ae.cy+ae.y01),pe<B?o.arc(ae.cx,ae.cy,pe,yr(ae.y01,ae.x01),yr(N.y01,N.x01),!b):(o.arc(ae.cx,ae.cy,pe,yr(ae.y01,ae.x01),yr(ae.y11,ae.x11),!b),o.arc(0,0,p,yr(ae.cy+ae.y11,ae.cx+ae.x11),yr(N.cy+N.y11,N.cx+N.x11),!b),o.arc(N.cx,N.cy,pe,yr(N.y11,N.x11),yr(N.y01,N.x01),!b))):(o.moveTo(se,ue),o.arc(0,0,p,C,M,!b)):o.moveTo(se,ue),m>jr&&P>jr?Q>jr?(ae=Up(re,xe,Ce,Fe,m,-Q,b),N=Up(se,ue,Te,Le,m,-Q,b),o.lineTo(ae.cx+ae.x01,ae.cy+ae.y01),Q<B?o.arc(ae.cx,ae.cy,Q,yr(ae.y01,ae.x01),yr(N.y01,N.x01),!b):(o.arc(ae.cx,ae.cy,Q,yr(ae.y01,ae.x01),yr(ae.y11,ae.x11),!b),o.arc(0,0,m,yr(ae.cy+ae.y11,ae.cx+ae.x11),yr(N.cy+N.y11,N.cx+N.x11),b),o.arc(N.cx,N.cy,Q,yr(N.y11,N.x11),yr(N.y01,N.x01),!b))):o.arc(0,0,m,S,E,b):o.lineTo(re,xe)}else o.moveTo(0,0);if(o.closePath(),h)return o=null,h+""||null}return c.centroid=function(){var h=(+s.apply(this,arguments)+ +e.apply(this,arguments))/2,u=(+n.apply(this,arguments)+ +r.apply(this,arguments))/2-Uu/2;return[Ic(u)*h,_o(u)*h]},c.innerRadius=function(h){return arguments.length?(s="function"==typeof h?h:Gn(+h),c):s},c.outerRadius=function(h){return arguments.length?(e="function"==typeof h?h:Gn(+h),c):e},c.cornerRadius=function(h){return arguments.length?(t="function"==typeof h?h:Gn(+h),c):t},c.padRadius=function(h){return arguments.length?(i=null==h?null:"function"==typeof h?h:Gn(+h),c):i},c.startAngle=function(h){return arguments.length?(n="function"==typeof h?h:Gn(+h),c):n},c.endAngle=function(h){return arguments.length?(r="function"==typeof h?h:Gn(+h),c):r},c.padAngle=function(h){return arguments.length?(a="function"==typeof h?h:Gn(+h),c):a},c.context=function(h){return arguments.length?(o=h??null,c):o},c}class zp extends ja{constructor(){super(...arguments),Object.defineProperty(this,"radarContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.plotContainer.children.push(ai.new(this._root,{x:wi,y:wi}))}),Object.defineProperty(this,"_arcGenerator",{enumerable:!0,configurable:!0,writable:!0,value:kb()}),Object.defineProperty(this,"_maxRadius",{enumerable:!0,configurable:!0,writable:!0,value:1})}_afterNew(){this._defaultThemes.push(QD.new(this._root)),super._afterNew();const t=this.gridContainer,n=this.seriesContainer;this.radarContainer.children.pushAll([t,n,this.topGridContainer,this.bulletsContainer]),n.set("mask",rn.new(this._root,{})),t.set("mask",rn.new(this._root,{})),this._disposers.push(this.plotContainer.events.on("boundschanged",()=>{this._updateRadius()}))}_maskGrid(){}_prepareChildren(){if(super._prepareChildren(),this._sizeDirty||this.isDirty("radius")||this.isDirty("innerRadius")||this.isDirty("startAngle")||this.isDirty("endAngle")){const e=this.chartContainer,t=e.innerWidth(),i=e.innerHeight(),n=this.get("startAngle",0),r=this.get("endAngle",0),a=this.get("innerRadius");let o=Eu(0,0,n,r,1);const l=t/(o.right-o.left),c=i/(o.bottom-o.top);let h={left:0,right:0,top:0,bottom:0};if(a instanceof Ti){let m=a.value,p=Math.min(l,c);m=Math.max(p*m,p-Math.min(i,t))/p,h=Eu(0,0,n,r,m),this.setPrivateRaw("irModifyer",m/a.value)}o=Hy([o,h]),this._maxRadius=Math.max(0,Math.min(l,c));const u=Oi(this.get("radius",0),this._maxRadius);this.radarContainer.setAll({dy:-u*(o.bottom+o.top)/2,dx:-u*(o.right+o.left)/2}),this._updateRadius()}}_addCursor(e){this.radarContainer.children.push(e)}_updateRadius(){const e=Oi(this.get("radius",ln(80)),this._maxRadius);this.setPrivateRaw("radius",e);let t=Oi(this.get("innerRadius",0),e);t<0&&(t=e+t),this.setPrivateRaw("innerRadius",t),this.xAxes.each(n=>{n.get("renderer").updateLayout()}),this.yAxes.each(n=>{n.get("renderer").updateLayout()}),this._updateMask(this.seriesContainer,t,e),this._updateMask(this.gridContainer,t,e),this.series.each(n=>{n.get("maskBullets")?this._updateMask(n.bulletsContainer,t,e):n.bulletsContainer.remove("mask")});const i=this.get("cursor");i&&i.updateLayout()}_updateMask(e,t,i){const n=e.get("mask");n&&n.set("draw",r=>{this._arcGenerator.context(r),this._arcGenerator({innerRadius:t,outerRadius:i+.5,startAngle:(this.get("startAngle",0)+90)*la,endAngle:(this.get("endAngle",0)+90)*la})})}processAxis(e){this.radarContainer.children.push(e)}inPlot(e,t,i){const n=Math.hypot(e.x,e.y),r=Vo(Math.atan2(e.y,e.x)*Ho);let a=Vo(this.get("startAngle",0)),o=Vo(this.get("endAngle",0)),l=!1;return a<o&&a<r&&r<o&&(l=!0),a>o&&(r>a&&(l=!0),r<o&&(l=!0)),a==o&&(l=!0),!!l&&(null==t&&(t=this.getPrivate("radius",0)),null==i&&(i=this.getPrivate("innerRadius",0)),i>t&&([i,t]=[t,i]),n<=t+.5&&n>=i-.5)}_tooltipToLocal(e){return this.radarContainer._display.toLocal(e)}_handlePinch(){}}Object.defineProperty(zp,"className",{enumerable:!0,configurable:!0,writable:!0,value:"RadarChart"}),Object.defineProperty(zp,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ja.classNames.concat([zp.className])});class zu extends rn{constructor(){super(...arguments),Object.defineProperty(this,"ix",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"iy",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_generator",{enumerable:!0,configurable:!0,writable:!0,value:kb()})}_getTooltipPoint(){let e=this.get("tooltipX"),t=this.get("tooltipY"),i=0,n=0;Se(e)&&(i=e),Se(t)&&(n=t);let r=this.get("radius",0),a=this.get("innerRadius",0);return r+=this.get("dRadius",0),a+=this.get("dInnerRadius",0),a<0&&(a=r+a),e instanceof Ti&&(i=this.ix*(a+(r-a)*e.value)),t instanceof Ti&&(n=this.iy*(a+(r-a)*t.value)),this.get("arc")>=360&&0==a&&(i=0,n=0),{x:i,y:n}}_beforeChanged(){super._beforeChanged(),(this.isDirty("radius")||this.isDirty("arc")||this.isDirty("innerRadius")||this.isDirty("startAngle")||this.isDirty("dRadius")||this.isDirty("dInnerRadius")||this.isDirty("cornerRadius")||this.isDirty("shiftRadius"))&&(this._clear=!0)}_changed(){if(super._changed(),this._clear){let e=this.get("startAngle",0),t=this.get("arc",0);const i=this._generator;t<0&&(e+=t,t*=-1),t>.1&&i.cornerRadius(this.get("cornerRadius",0)),i.context(this._display);let n=this.get("radius",0),r=this.get("innerRadius",0);n+=this.get("dRadius",0),r+=this.get("dInnerRadius",0),r<0&&(r=n+r),i({innerRadius:r,outerRadius:n,startAngle:(e+90)*la,endAngle:(e+t+90)*la});let l=e+t/2;this.ix=gr(l),this.iy=$s(l);const c=this.get("shiftRadius",0);this.setRaw("dx",this.ix*c),this.setRaw("dy",this.iy*c),this.markDirtyPosition()}}}Object.defineProperty(zu,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Slice"}),Object.defineProperty(zu,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:rn.classNames.concat([zu.className])});class Hp extends Mc{constructor(){super(...arguments),Object.defineProperty(this,"_display",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeRadialText("",this.textStyle)})}_afterNew(){super._afterNew()}_beforeChanged(){super._beforeChanged(),this._display.clear(),this.isDirty("textType")&&(this._display.textType=this.get("textType"),this.markDirtyBounds()),this.isDirty("radius")&&(this._display.radius=this.get("radius"),this.markDirtyBounds()),this.isDirty("startAngle")&&(this._display.startAngle=(this.get("startAngle",0)+90)*la,this.markDirtyBounds()),this.isDirty("inside")&&(this._display.inside=this.get("inside"),this.markDirtyBounds()),this.isDirty("orientation")&&(this._display.orientation=this.get("orientation"),this.markDirtyBounds()),this.isDirty("kerning")&&(this._display.kerning=this.get("kerning"),this.markDirtyBounds())}}Object.defineProperty(Hp,"className",{enumerable:!0,configurable:!0,writable:!0,value:"RadialText"}),Object.defineProperty(Hp,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Mc.classNames.concat([Hp.className])});class jd extends _r{constructor(){super(...arguments),Object.defineProperty(this,"_flipped",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_afterNew(){this._textKeys.push("textType","kerning"),super._afterNew()}_makeText(){this._text=this.children.push(Hp.new(this._root,{}))}baseRadius(){const e=this.getPrivate("radius",0),t=this.getPrivate("innerRadius",0);return t+Oi(this.get("baseRadius",0),e-t)}radius(){const e=this.get("inside",!1);return this.baseRadius()+this.get("radius",0)*(e?-1:1)}_updateChildren(){if(super._updateChildren(),this.isDirty("baseRadius")||this.isPrivateDirty("radius")||this.isPrivateDirty("innerRadius")||this.isDirty("labelAngle")||this.isDirty("radius")||this.isDirty("inside")||this.isDirty("orientation")||this.isDirty("textType")){const e=this.get("textType","adjusted"),t=this.get("inside",!1),i=this.get("orientation");let n=Vo(this.get("labelAngle",0));this._text.set("startAngle",this.get("labelAngle",0)),this._text.set("inside",t);const r=$s(n),a=gr(n);let o=this.baseRadius(),l=this.radius();if(this._display.angle=0,"circular"==e)this.setAll({paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}),this._text.set("orientation",i),this._text.set("radius",l);else{0==o&&(n=0,l=0);let c=l*a,h=l*r;"radial"==e?(this.setRaw("x",c),this.setRaw("y",h),n<90||n>270||"auto"!=i?(this._display.angle=n,this._flipped=!1):(this._display.angle=n+180,this._flipped=!0),this._dirty.rotation=!1):"adjusted"==e?(this.setRaw("centerX",wi),this.setRaw("centerY",wi),this.setRaw("x",c),this.setRaw("y",h)):"regular"==e&&(this.setRaw("x",c),this.setRaw("y",h))}this.markDirtyPosition(),this.markDirtyBounds()}}_updatePosition(){const e=this.get("textType","regular"),t=this.get("inside",!1);let i=0,n=0,r=this.get("labelAngle",0),a=this.localBounds(),o=a.right-a.left,l=a.bottom-a.top;if("radial"==e){if(this._flipped){let c=this.get("centerX");c instanceof Ti&&(o*=1-2*c.value),i=o*gr(r),n=o*$s(r)}}else!t&&"adjusted"==e&&(i=o/2*gr(r),n=l/2*$s(r));this.setRaw("dx",i),this.setRaw("dy",n),super._updatePosition()}get text(){return this._text}}Object.defineProperty(jd,"className",{enumerable:!0,configurable:!0,writable:!0,value:"RadialLabel"}),Object.defineProperty(jd,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:_r.classNames.concat([jd.className])});class Vp extends jd{constructor(){super(...arguments),Object.defineProperty(this,"_tickPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]})}}Object.defineProperty(Vp,"className",{enumerable:!0,configurable:!0,writable:!0,value:"AxisLabelRadial"}),Object.defineProperty(Vp,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:jd.classNames.concat([Vp.className])});class Wp extends jo{constructor(){super(...arguments),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:new bs(An.new({}),()=>Vp._new(this._root,{themeTags:ki(this.labels.template.get("themeTags",[]),this.get("themeTags",[]))},[this.labels.template]))}),Object.defineProperty(this,"axisFills",{enumerable:!0,configurable:!0,writable:!0,value:new bs(An.new({}),()=>zu._new(this._root,{themeTags:ki(this.axisFills.template.get("themeTags",["fill"]),this.get("themeTags",[]))},[this.axisFills.template]))}),Object.defineProperty(this,"_fillGenerator",{enumerable:!0,configurable:!0,writable:!0,value:kb()})}_afterNew(){this._settings.themeTags=ki(this._settings.themeTags,["renderer","circular"]),super._afterNew(),this.setPrivateRaw("letter","X"),this.setRaw("position","absolute")}_changed(){super._changed(),(this.isDirty("radius")||this.isDirty("innerRadius")||this.isDirty("startAngle")||this.isDirty("endAngle"))&&this.updateLayout()}processAxis(){super.processAxis(),this.axis.labelsContainer.set("isMeasured",!1)}updateLayout(){const e=this.chart;if(e){const t=e.getPrivate("radius",0);let i=Oi(this.get("radius",vt),t);i<0&&(i=t+i),this.setPrivate("radius",i);let n=Oi(this.get("innerRadius",e.getPrivate("innerRadius",0)),t)*e.getPrivate("irModifyer",1);n<0&&(n=i+n),this.setPrivate("innerRadius",n);let r=this.get("startAngle",e.get("startAngle",-90)),a=this.get("endAngle",e.get("endAngle",270));this.setPrivate("startAngle",r),this.setPrivate("endAngle",a),this.set("draw",o=>{const l=this.positionToPoint(0);o.moveTo(l.x,l.y),r>a&&([r,a]=[a,r]),o.arc(0,0,i,r*la,a*la)}),this.axis.markDirtySize()}}updateGrid(e,t,i){if(e){null==t&&(t=0);let n=e.get("location",.5);null!=i&&i!=t&&(t+=(i-t)*n);let r=this.getPrivate("radius",0),a=this.getPrivate("innerRadius",0),o=this.positionToAngle(t);this.toggleVisibility(e,t,0,1),null!=r&&e.set("draw",l=>{l.moveTo(a*gr(o),a*$s(o)),l.lineTo(r*gr(o),r*$s(o))})}}positionToAngle(e){const t=this.axis,i=this.getPrivate("startAngle",0),n=this.getPrivate("endAngle",360),r=t.get("start",0),a=t.get("end",1);let l,o=(n-i)/(a-r);return l=this.get("inversed")?i+(a-e)*o:i+(e-r)*o,l}_handleOpposite(){}positionToPoint(e){const t=this.getPrivate("radius",0),i=this.positionToAngle(e);return{x:t*gr(i),y:t*$s(i)}}updateLabel(e,t,i,n){if(e){null==t&&(t=0);let r=.5;r=e.get(null!=n&&n>1?"multiLocation":"location",r),null!=i&&i!=t&&(t+=(i-t)*r);const a=this.getPrivate("radius",0),o=this.getPrivate("innerRadius",0),l=this.positionToAngle(t);e.setPrivate("radius",a),e.setPrivate("innerRadius",o),e.set("labelAngle",l),this.toggleVisibility(e,t,e.get("minPosition",0),e.get("maxPosition",1))}}fillDrawMethod(e,t,i){e.set("draw",n=>{null==t&&(t=this.getPrivate("startAngle",0)),null==i&&(i=this.getPrivate("endAngle",0));const r=this.getPrivate("innerRadius",0),a=this.getPrivate("radius",0);this._fillGenerator.context(n),this._fillGenerator({innerRadius:r,outerRadius:a,startAngle:(t+90)*la,endAngle:(i+90)*la})})}updateTick(e,t,i,n){if(e){null==t&&(t=0);let r=.5;r=e.get(null!=n&&n>1?"multiLocation":"location",r),null!=i&&i!=t&&(t+=(i-t)*r);let a=e.get("length",0);e.get("inside")&&(a*=-1);let l=this.getPrivate("radius",0),c=this.positionToAngle(t);this.toggleVisibility(e,t,e.get("minPosition",0),e.get("maxPosition",1)),null!=l&&e.set("draw",h=>{h.moveTo(l*gr(c),l*$s(c)),l+=a,h.lineTo(l*gr(c),l*$s(c))})}}updateBullet(e,t,i){if(e){const n=e.get("sprite");if(n){null==t&&(t=0);let r=e.get("location",.5);null!=i&&i!=t&&(t+=(i-t)*r);let a=this.getPrivate("radius",0),o=this.positionToAngle(t);this.toggleVisibility(n,t,0,1),n.setAll({rotation:o,x:a*gr(o),y:a*$s(o)})}}}updateFill(e,t,i){if(e){null==t&&(t=0),null==i&&(i=1);let n=this.fitAngle(this.positionToAngle(t)),r=this.fitAngle(this.positionToAngle(i));e.setAll({startAngle:n,arc:r-n}),e._setSoft("innerRadius",this.getPrivate("innerRadius")),e._setSoft("radius",this.getPrivate("radius"))}}fitAngle(e){const t=this.getPrivate("startAngle",0),i=this.getPrivate("endAngle",0),n=Math.min(t,i),r=Math.max(t,i);return e<n&&(e=n),e>r&&(e=r),e}axisLength(){return Math.abs(this.getPrivate("radius",0)*Math.PI*2*(this.getPrivate("endAngle",360)-this.getPrivate("startAngle",0))/360)}positionTooltip(e,t){let i=this.getPrivate("radius",0);const n=this.positionToAngle(t);this._positionTooltip(e,{x:i*gr(n),y:i*$s(n)})}updateTooltipBounds(e){}}Object.defineProperty(Wp,"className",{enumerable:!0,configurable:!0,writable:!0,value:"AxisRendererCircular"}),Object.defineProperty(Wp,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:jo.classNames.concat([Wp.className])});class Gp extends ai{constructor(){super(...arguments),Object.defineProperty(this,"hand",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(rn.new(this._root,{themeTags:["hand"]}))}),Object.defineProperty(this,"pin",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(rn.new(this._root,{themeTags:["pin"]}))})}_afterNew(){this._settings.themeTags=ki(this._settings.themeTags,["clock"]),super._afterNew(),this.set("width",ln(1)),this.adapters.add("x",()=>0),this.adapters.add("y",()=>0),this.pin.set("draw",(e,t)=>{const i=t.parent;if(i){const n=i.dataItem;if(n){const r=n.component;if(r){const a=r.chart;if(a){const o=a.getPrivate("radius",0);let l=Oi(i.get("pinRadius",0),o);l<0&&(l=o+l),e.moveTo(l,0),e.arc(0,0,l,0,360)}}}}}),this.hand.set("draw",(e,t)=>{const i=t.parent;if(i){let n=i.parent;n&&n.set("width",ln(1));const r=i.dataItem;if(r){const a=r.component;if(a){const o=a.chart;if(o){const l=i.get("bottomWidth",10)/2,c=i.get("topWidth",0)/2,h=o.getPrivate("radius",0);let u=Oi(i.get("radius",0),h);u<0&&(u=h+u);let m=i.get("innerRadius",0);m instanceof Ti?m=Oi(m,h):m<0&&m<0&&(m=u+m),e.moveTo(m,-l),e.lineTo(u,-c),e.lineTo(u,c),e.lineTo(m,l),e.lineTo(m,-l)}}}}})}_prepareChildren(){super._prepareChildren(),this.hand._markDirtyKey("fill"),this.pin._markDirtyKey("fill")}}Object.defineProperty(Gp,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ClockHand"}),Object.defineProperty(Gp,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ai.classNames.concat([Gp.className])});class Yp extends zs{constructor(){super(...arguments),Object.defineProperty(this,"axis",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_beforeChanged(){super._beforeChanged();const e=this.get("sprite");if(this.isDirty("sprite")&&e&&(e.setAll({position:"absolute",role:"figure"}),this._disposers.push(e)),this.isDirty("location")){const t=e.dataItem;this.axis&&e&&t&&this.axis._prepareDataItem(t)}}dispose(){const e=this.axis;e&&en(e._bullets,(t,i)=>{i.uid==this.uid&&delete e._bullets[t]}),super.dispose()}}function cE(s){let e,t,i;if(s.match(/^rgb/)){const r=s.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/);e=Number(r[1]),t=Number(r[2]),i=Number(r[3])}else{const r=+("0x"+s.slice(1).replace(s.length<5&&/./g,"$&$&"));e=r>>16,t=r>>8&255,i=255&r}return Math.sqrt(e*e*.299+t*t*.587+i*i*.114)>127.5?"light":"dark"}Object.defineProperty(Yp,"className",{enumerable:!0,configurable:!0,writable:!0,value:"AxisBullet"}),Object.defineProperty(Yp,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:zs.classNames.concat([Yp.className])});let dE=(()=>{class s{constructor(t){this.socketService=t,this.unsubscribe$=new gi.x,this.backgroundColor="transparent"}ngAfterViewInit(){const t=this.config;this._root&&this._root.dispose(),this._root=Yo.new("gauge_chart_"+this.id),this._root.setThemes([Rc.new(this._root)]),t.view.chart.BackgroundColor&&(this.backgroundColor=t.view.chart.BackgroundColor);let i=this._root.container.children.push(zp.new(this._root,{panX:!1,panY:!1,startAngle:t.view.chart.startAngle||180,endAngle:t.view.chart.endAngle||360})),n=Wp.new(this._root,{innerRadius:t.view.axisRenderer.innerRadius||-15});n.grid.template.setAll({stroke:this._root.interfaceColors.get("background"),visible:!0,strokeOpacity:.8});let r=i.xAxes.push(ha.new(this._root,{maxDeviation:0,min:t.view.xAxis.min||0,max:t.view.xAxis.max||100,strictMinMax:!0,renderer:n})),a=r.makeDataItem({}),o=Gp.new(this._root,{pinRadius:ln(t.view.clockHand.pinRadius||10),radius:ln(t.view.clockHand.radius||90),bottomWidth:t.view.clockHand.bottomWidth||10}),l=a.set("bullet",Yp.new(this._root,{sprite:o}));r.createAxisRange(a),i.plotContainer.children.push(_r.new(this._root,{centerX:ln(-30),centerY:ln(-5),textAlign:"center",text:t.view.labels.title,fill:kn("light"===cE(this.backgroundColor)?"#000000":"#ffffff")}));let c=i.radarContainer.children.push(_r.new(this._root,{fill:kn(t.view.label.fill||16777215),centerX:ln(50),textAlign:"center",centerY:ln(50),fontSize:`${t.view.label.fontSize}%`}));a.set("value",0),l.get("sprite").on("rotation",function(){let u=a.get("value");Math.round(a.get("value")||0).toString();let m=kn(0);r.axisRanges.each(function(p){u&&u>=p.get("value")&&u<=p.get("endValue")&&(m=p.get("axisFill").get("fill"))}),c.set("text",Math.round(u||0).toString()),o.pin.animate({key:"fill",to:m,duration:500,easing:Me(y)}),o.hand.animate({key:"fill",to:m,duration:500,easing:Me(y)})}),t.content?.topic.id&&t.content?.outputs.read.name&&this.socketService.fetchDeviceData(t.content?.topic.id,t.content?.outputs.read.name).pipe((0,he.R)(this.unsubscribe$),(0,ri.U)(u=>{a.animate({key:"value",to:u,duration:500,easing:Me(y)})})).subscribe(),i.bulletsContainer.set("mask",void 0),ye(t.view.bands||[{color:"#fdae19",lowScore:0,highScore:20},{color:"#f3eb0c",lowScore:20,highScore:40},{color:"#b0d136",lowScore:40,highScore:60},{color:"#54b947",lowScore:60,highScore:80},{color:"#0f9747",lowScore:80,highScore:100}],function(u){let m=r.createAxisRange(r.makeDataItem({}));m.setAll({value:u.lowScore,endValue:u.highScore}),m.get("axisFill")?.setAll({visible:!0,fill:kn(u.color),fillOpacity:.8})}),i.appear(1e3,100)}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(Yr.l))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-gauge"]],inputs:{id:"id",config:"config"},decls:2,vars:3,consts:[[1,"container"],[1,"chat-container",3,"id"]],template:function(i,n){1&i&&(d.TgZ(0,"div",0),d._UZ(1,"div",1),d.qZA()),2&i&&(d.Udp("background-color",n.backgroundColor),d.xp6(1),d.Q6J("id","gauge_chart_"+n.id))},styles:[".container[_ngcontent-%COMP%]{width:100%;height:100%;padding:0;display:flex;flex-direction:column}.chat-container[_ngcontent-%COMP%]{padding:0;width:100%;height:100%}"]})}return s})();var Ab=V(6188);let dx=(()=>{class s{setStyle(t){}constructor(t){this.el=t,this.backgroundColor="#6F90D5",this.borderColor="#6F90D5"}ngOnChanges(t){this.el.nativeElement.style.backgroundColor=this.backgroundColor,this.el.nativeElement.style.borderColor=this.borderColor}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(d.SBq))};static#t=this.\u0275dir=d.lG2({type:s,selectors:[["","Card",""]],inputs:{backgroundColor:"backgroundColor",borderColor:"borderColor"},features:[d.TTD]})}return s})(),hE=(()=>{class s{constructor(t){this.el=t,this.color="#FFFFFF",this.fontSize="20px"}ngOnChanges(t){this.el.nativeElement.style.color=this.color,this.el.nativeElement.style.fontSize=this.fontSize}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(d.SBq))};static#t=this.\u0275dir=d.lG2({type:s,selectors:[["","Text",""]],inputs:{color:"color",fontSize:"fontSize"},features:[d.TTD]})}return s})();function uE(s,e){if(1&s&&(d.TgZ(0,"div",4),d._uU(1),d.qZA()),2&s){const t=d.oxw();d.xp6(1),d.Oqu(t.Subtitle)}}const mE=function(s){return[s]};let pE=(()=>{class s{constructor(t,i){this.socketService=t,this.historicalService=i,this.unsubscribe$=new gi.x,this.unsubscribeInterval$=new gi.x,this.Title="Title",this.Subtitle="",this.Label="Label",this.Unit="Unit",this.titleSize="25px",this.titleColor="#ffffff",this.titlePosition="TopCenter",this.labelSize="20px",this.labelColor="#ffffff",this.unitSize="15px",this.unitColor="#ffffff",this.backgroundColor="#6F90D5",this.borderColor="#6F90D5"}ngOnInit(){const t=this.config,n=t.view;this.applyContent(t.content),this.applyViewConfig(n)}applyContent(t){this.Title=t?.Title,this.Subtitle=t?.Subtitle||"",this.Unit=t?.Unit,this.Label=t.Label,t.topic&&t.outputs?.read.name&&(t.isApi?(this.historicalService.callAPI(t.api,t.topic.id,t.outputs.read.name).pipe((0,Di.q)(1),(0,ri.U)(i=>{this.Label=i.data.value})).subscribe(),(0,Ab.F)(6e4).pipe((0,he.R)(this.unsubscribeInterval$),(0,Ei.w)(()=>t.topic&&t.outputs?.read.name?this.historicalService.callAPI(t.api,t.topic.id,t.outputs.read.name).pipe((0,Di.q)(1),(0,ri.U)(i=>{this.Label=i.data.value})):(0,D.of)(0))).subscribe()):this.socketService.fetchDeviceData(t.topic.id,t.outputs.read.name).pipe((0,ri.U)(i=>{this.Label=i})).subscribe())}applyViewConfig(t){this.backgroundColor=t.Card.BackgroundColor,this.borderColor=t.Card.BorderColor,this.titleColor=t.Title.color,this.titleSize=`${t.Title.fontSize}px`,this.titlePosition=`${t.Title.position}`,this.labelColor=t.Label.color,this.labelSize=`${t.Label.fontSize}px`,this.unitColor=t.Unit.color,this.unitSize=`${t.Unit.fontSize}px`}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete(),this.unsubscribeInterval$.next(),this.unsubscribeInterval$.complete()}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(Yr.l),d.Y36(Gd.O))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-card"]],inputs:{id:"id",config:"config"},decls:9,vars:15,consts:[["Card","",1,"box",3,"backgroundColor","borderColor"],["Text","",3,"color","fontSize","ngClass"],["class","subtitle",4,"ngIf"],["Text","",3,"color","fontSize"],[1,"subtitle"]],template:function(i,n){1&i&&(d.TgZ(0,"div",0)(1,"h4",1),d._uU(2),d.YNc(3,uE,2,1,"div",2),d.qZA(),d.TgZ(4,"div")(5,"h4",3),d._uU(6),d.qZA(),d.TgZ(7,"h4",3),d._uU(8),d.qZA()()()),2&i&&(d.Q6J("backgroundColor",n.backgroundColor)("borderColor",n.borderColor),d.xp6(1),d.Q6J("color",n.titleColor)("fontSize",n.titleSize)("ngClass",d.VKq(13,mE,n.titlePosition)),d.xp6(1),d.hij(" ",n.Title," "),d.xp6(1),d.Q6J("ngIf",n.Subtitle&&n.Subtitle.length>0),d.xp6(2),d.Q6J("color",n.labelColor)("fontSize",n.labelSize),d.xp6(1),d.Oqu(n.Label),d.xp6(1),d.Q6J("color",n.unitColor)("fontSize",n.unitSize),d.xp6(1),d.Oqu(n.Unit))},dependencies:[x.mk,x.O5,dx,hE],styles:[".box[_ngcontent-%COMP%]{color:#fff;width:100%;height:100%;border:1px solid #ffffff;border-radius:.25rem;display:flex;align-items:center;justify-content:space-evenly;flex-direction:column;padding:.5rem}.box[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{width:90%;margin:0 auto}.box[_ngcontent-%COMP%]   h4.TopCenter[_ngcontent-%COMP%]{text-align:center}.box[_ngcontent-%COMP%]   h4.TopStart[_ngcontent-%COMP%]{text-align:start}.box[_ngcontent-%COMP%]   h4.TopEnd[_ngcontent-%COMP%]{text-align:end}.box[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{opacity:.6;font-size:.7em;display:block}.box[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.5rem}"]})}return s})(),fE=(()=>{class s{constructor(){this.center={lat:43.65107,lng:-79.347015},this.zoom=13,this.mapOptions={zoomControl:!0,scrollwheel:!0,disableDoubleClickZoom:!0,maxZoom:15,mapTypeControl:!1},this.redMarkerIcon={url:"http://maps.google.com/mapfiles/ms/icons/red-dot.png",scaledSize:{width:40,height:40}},this.greenMarkerIcon={url:"http://maps.google.com/mapfiles/ms/icons/green-dot.png"},this.yellowMarkerIcon={url:"http://maps.google.com/mapfiles/ms/icons/yellow-dot.png"},this.markers=[],this.infoWindowOptions={maxWidth:200},this.infoWindowOpen={}}openInfoWindow(t,i){}ngAfterViewInit(){const t=this.config;this.markers.length&&(this.markers=[]);const i=t.view.options;this.mapOptions={...this.mapOptions,zoomControl:i.ZoomControl,scrollwheel:i.ScrollWheel,maxZoom:i.MaxZoom,minZoom:i.MinZoom},t.content&&t.content.length&&t.content.map((n,r)=>{this.markers.push({name:n.device?n.device:`Marker ${r+1}`,topic:n.topic?.name,read:n.outputs?.read?.name,write:n.outputs?.write?.name})})}static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-map"]],inputs:{id:"id",config:"config"},decls:0,vars:0,template:function(i,n){},styles:[".container[_ngcontent-%COMP%]{height:100%;width:100%}  .map-container{height:100%!important;width:100%!important;overflow:hidden}"]})}return s})();var Pb=V(5130);let gE=(()=>{class s{get title(){return this._title}constructor(t,i){this.historicalService=t,this.socketService=i,this.unsubscribe$=new gi.x,this._title="Title",this.backgroundColor="transparent"}ngOnInit(){this._title=this.config.view.labels.title}ngAfterViewInit(){const t=this.config;this._root&&this._root.dispose(),this._root=Yo.new("line_chart_"+this.id),this._root.setThemes([Rc.new(this._root)]),t.view.chart.BackgroundColor&&(this.backgroundColor=t.view.chart.BackgroundColor);let i=this._root.container.children.push(ja.new(this._root,{panX:!1,panY:!1,wheelX:"panX",wheelY:"zoomX"})),n=i.set("cursor",Dc.new(this._root,{behavior:"zoomX"}));n.lineX.set("visible",t.view.cursor.lineX||!1),n.lineY.set("visible",t.view.cursor.lineY||!1);let r=i.xAxes.push(kc.new(this._root,{baseInterval:{timeUnit:"second",count:1},renderer:fo.new(this._root,{minGridDistance:75}),tooltip:Vr.new(this._root,{}),markUnitChange:!1}));r.set("dateFormats",{second:"MM/dd HH:mm:ss",minute:"MM/dd HH:mm:ss",hour:"MM/dd",day:"MM/dd",week:"MM/dd HH:mm:ss",month:"MM/dd HH:mm:ss",year:"MM/dd HH:mm:ss"}),this._root.numberFormatter.set("durationFormat","MM/dd HH:mm:ss"),r.set("tooltipDateFormat","yyyy/MM/dd HH:mm:ss");let a=i.yAxes.push(ha.new(this._root,{renderer:go.new(this._root,{})})),o=i.series.push(Oc.new(this._root,{name:t.content.outputs.read.name,xAxis:r,yAxis:a,fill:kn(t.view.series.color||7649791),stroke:kn(t.view.series.color||7649791),valueYField:"value",valueXField:"date",tooltip:Vr.new(this._root,{labelText:`${t.view.labels.title}:{valueY}`})}));const l=this;return o.bullets.push(()=>Tc.new(l._root,{locationY:0,sprite:Nd.new(l._root,{radius:2,fill:o.get("fill")})})),i.plotContainer.children.push(_r.new(this._root,{y:-20,x:ln(50),textAlign:"center",text:t.view.labels.title,fill:kn(16777215)})),i.zoomOutButton.set("forceHidden",!0),i.appear(1e3,100),this.historicalService.getOutputHistory(t.content.topic.id,t.content.outputs.read.name).pipe((0,ri.U)(c=>{if(o.data.setAll(c),t.view.scroll.enable){let h=i.set("scrollbarX",Wd.new(this._root,{orientation:"horizontal",height:40}));if(i.bottomAxesContainer.children.push(h),"sb"===t.view.scroll.type){let u=h.chart.xAxes.push(kc.new(this._root,{baseInterval:{timeUnit:"second",count:1},markUnitChange:!1,renderer:fo.new(this._root,{})}));u.set("dateFormats",{second:"MM/dd",minute:"MM/dd",hour:"MM/dd",day:"MM/dd",week:"MM/dd",month:"MM/dd",year:"MM/dd"});let m=h.chart.yAxes.push(ha.new(this._root,{renderer:go.new(this._root,{})}));h.chart.series.push(Oc.new(this._root,{valueYField:"value",valueXField:"date",xAxis:u,yAxis:m})).data.setAll(c)}}return o.appear(1e3),o}),(0,Pb.z)(c=>(c.appear(1e3),this._root.resize(),this.socketService.fetchDeviceData(t.content.topic.id,t.content.outputs.read.name).pipe((0,ri.U)(h=>{this.addData(c,h)}),(0,he.R)(this.unsubscribe$)))),(0,he.R)(this.unsubscribe$)).subscribe()}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}addData(t,i){const n=Id;let r=new Date((new Date).toLocaleString("fa-IR-u-nu-latn")).getTime();if(t.data.length>0){let o=t.dataItems[t.dataItems.length-1].get("valueY");t.data.push({date:r,value:i}),t.dataItems[t.dataItems.length-1].animate({key:"valueYWorking",to:i,from:o,duration:500,easing:n})}else t.data.push({date:r,value:i})}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(Gd.O),d.Y36(Yr.l))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-line-chart"]],inputs:{id:"id",config:"config"},decls:2,vars:3,consts:[[1,"container"],[1,"chat-container",3,"id"]],template:function(i,n){1&i&&(d.TgZ(0,"div",0),d._UZ(1,"div",1),d.qZA()),2&i&&(d.Udp("background-color",n.backgroundColor),d.xp6(1),d.Q6J("id","line_chart_"+n.id))},styles:[".container[_ngcontent-%COMP%]{width:100%;height:100%;padding:0;display:flex;flex-direction:column}.chat-container[_ngcontent-%COMP%]{padding:0;width:100%;height:100%}h6[_ngcontent-%COMP%]{text-align:center;color:#fff}"]})}return s})();class Xo extends Sc{constructor(){super(...arguments),Object.defineProperty(this,"_frequency",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_itemMap",{enumerable:!0,configurable:!0,writable:!0,value:{}})}_afterNew(){this._settings.themeTags=ki(this._settings.themeTags,["axis"]),this.fields.push("category"),this.setPrivateRaw("name","category"),this.addTag("category"),super._afterNew()}_prepareChildren(){super._prepareChildren();const e=this.dataItems.length;let t=0;this._valuesDirty&&(this._itemMap={},ye(this.dataItems,i=>{i.setRaw("index",t),this._itemMap[i.get("category")]=i,t++}),this.setPrivateRaw("maxZoomFactor",e)),this.setPrivateRaw("startIndex",Math.max(Math.round(this.get("start",0)*e),0)),this.setPrivateRaw("endIndex",Math.min(Math.round(this.get("end",1)*e),e)),(this._sizeDirty||this._valuesDirty||this.isDirty("start")||this.isDirty("end")||this.isPrivateDirty("endIndex")||this.isPrivateDirty("startIndex")||this.isPrivateDirty("width")||this.isPrivateDirty("height"))&&this.dataItems.length>0&&(this._handleRangeChange(),this._prepareAxisItems(),this._updateAxisRanges())}_handleRangeChange(){ye(this.series,e=>{let t=this.dataItems[this.startIndex()].get("category"),i=this.dataItems[this.endIndex()-1].get("category"),n=e.get("baseAxis"),r=e.get("xAxis"),a=e.get("yAxis");if(r instanceof Xo&&a instanceof Xo)e._markDirtyAxes();else if(n===this){let o,l,c=a;if(r===n?(e.get("categoryXField")&&(o="categoryX"),e.get("openCategoryXField")&&(l="openCategoryX")):a===n&&(e.get("categoryYField")&&(o="categoryY"),e.get("openCategoryYField")&&(l="openCategoryY"),c=r),"ValueAxis"==c.className&&(o||l)){let h,u;for(let g=0,f=e.dataItems.length;g<f;g++){let b=e.dataItems[g];if(o&&b.get(o)===t){h=b;break}if(l&&b.get(l)===t){h=b;break}}for(let g=e.dataItems.length-1;g>=0;g--){let f=e.dataItems[g];if(o&&f.get(o)===i){u=f;break}if(l&&f.get(l)===i){u=f;break}}let m=0,p=e.dataItems.length;h&&(m=e.dataItems.indexOf(h)),u&&(p=e.dataItems.indexOf(u)+1),e.setPrivate("startIndex",m),e.setPrivate("endIndex",p);let _=!1;for(let g=m;g<p;g++){const f=e.dataItems[g];if(ye(e.__valueXShowFields,b=>{null!=f.get(b)&&(_=!0)}),ye(e.__valueYShowFields,b=>{null!=f.get(b)&&(_=!0)}),_)break}e.setPrivate("outOfSelection",!_)}e._markDirtyAxes()}})}_prepareAxisItems(){var e;const t=this.get("renderer"),i=this.dataItems.length;let n=this.startIndex();n>0&&n--;let r=this.endIndex();r<i&&r++;const a=t.get("minorLabelsEnabled"),o=t.get("minorGridEnabled",a);let l=t.axisLength()/Math.max(t.get("minGridDistance"),1),c=Math.max(1,Math.min(i,Math.ceil((r-n)/l)));n=Math.floor(n/c)*c,this._frequency=c;for(let u=0;u<i;u++)this._toggleDataItem(this.dataItems[u],!1);let h=this.dataItems[n].get("index",0);for(let u=n;u<r;u+=c){let m=this.dataItems[u];this._createAssets(m,[]),this._toggleDataItem(m,!0);let p=c;o&&(p=1),this._prepareDataItem(m,h,p),h++}if(t.get("minorGridEnabled"))for(let u=n;u<r;u++){let m=this.dataItems[u];u%c!=0&&(this._createAssets(m,["minor"],!0),this._toggleDataItem(m,!0),this._prepareDataItem(m,0,1),a||null===(e=m.get("label"))||void 0===e||e.setPrivate("visible",!1))}this._updateGhost()}_prepareDataItem(e,t,i){let n=this.get("renderer"),r=e.get("categoryLocation",0),a=e.get("endCategoryLocation",1),o=e.get("index");Se(o)||(o=this.categoryToIndex(e.get("category")));let h,l=this.indexToPosition(o,r),c=e.get("endCategory");c?(h=this.categoryToIndex(c),Se(h)||(h=o)):h=o;let m,p,u=this.indexToPosition(h,a);m=e.get("isRange")?h:o+this._frequency-1,p=this.indexToPosition(m,a),n.updateLabel(e.get("label"),l,u,i),n.updateGrid(e.get("grid"),l,u),n.updateTick(e.get("tick"),l,u,i),n.updateFill(e.get("axisFill"),l,p),this._processBullet(e),n.updateBullet(e.get("bullet"),l,u);const _=this.get("fillRule");_&&_(e,t)}startIndex(){let e=this.dataItems.length;return Math.min(Math.max(this.getPrivate("startIndex",0),0),e-1)}endIndex(){let e=this.dataItems.length;return Math.max(1,Math.min(this.getPrivate("endIndex",e),e))}baseValue(){}basePosition(){return 0}getX(e){let t=this._itemMap[e];return t?this._settings.renderer.positionToCoordinate(this.indexToPosition(t.get("index",0))):NaN}getY(e){let t=this._itemMap[e];return t?this._settings.renderer.positionToCoordinate(this.indexToPosition(t.get("index",0))):NaN}getDataItemPositionX(e,t,i,n){const r=e.get(t),a=this._itemMap[r];return a?this.indexToPosition(a.get("index",0),i):NaN}getDataItemCoordinateX(e,t,i,n){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionX(e,t,i,n))}getDataItemPositionY(e,t,i,n){const r=e.get(t),a=this._itemMap[r];return a?this.indexToPosition(a.get("index",0),i):NaN}getDataItemCoordinateY(e,t,i,n){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionY(e,t,i,n))}indexToPosition(e,t){Se(t)||(t=.5);let i=this.dataItems.length,n=this.get("startLocation",0);i-=n,i-=1-this.get("endLocation",1);let a=(e+t-n)/i,o=this.dataItems[e];return o&&(a+=o.get("deltaPosition",0)),a}categoryToIndex(e){let t=this._itemMap[e];return t?t.get("index"):NaN}dataItemToPosition(e){return this.indexToPosition(e.get("index"))}roundAxisPosition(e,t){return this.indexToPosition(this.axisPositionToIndex(e+=(.5-t)/this.dataItems.length),t)}axisPositionToIndex(e){let t=this.dataItems.length;return Hs(Math.floor(e*t),0,t-1)}getTooltipText(e,t){const i=this.dataItems[this.axisPositionToIndex(e)];if(i){const n=i.get("label");if(n)return Au(n,this.get("tooltipText",""))}}_updateTooltipText(e,t){e._setDataItem(this.dataItems[this.axisPositionToIndex(t)]),e.label.text.markDirtyText()}getSeriesItem(e,t){if(this.dataItems.length>0){let i=this.getPrivate("name")+this.get("renderer").getPrivate("letter"),n=this.axisPositionToIndex(t),r=e.dataItems[n],a=this.dataItems[n],o=a.get("category");if(r&&a&&r.get(i)===o)return r;for(let l=0,c=e.dataItems.length;l<c;l++){let h=e.dataItems[l];if(h.get(i)===o)return h}}}zoomToIndexes(e,t,i){let n=this.dataItems.length;this.zoom(e/n,t/n,i)}zoomToCategories(e,t,i){this.zoomToIndexes(this.categoryToIndex(e),this.categoryToIndex(t)+1,i)}getCellWidthPosition(){return this._frequency/this.dataItems.length/(this.get("end",1)-this.get("start",0))}}Object.defineProperty(Xo,"className",{enumerable:!0,configurable:!0,writable:!0,value:"CategoryAxis"}),Object.defineProperty(Xo,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Sc.classNames.concat([Xo.className])});class Lc extends Ac{constructor(){super(...arguments),Object.defineProperty(this,"_ph",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_pw",{enumerable:!0,configurable:!0,writable:!0,value:0})}_makeGraphics(e,t){return this.makeColumn(t,e)}_makeFieldNames(){super._makeFieldNames();const e=this.get("xAxis"),t=this.get("yAxis"),i="CategoryAxis",n="ValueAxis";e.isType(i)&&(this.get("openCategoryXField")||(this._xOpenField=this._xField)),e.isType(n)&&(this.get("openValueXField")||(this._xOpenField=this._xField)),t.isType(i)&&(this.get("openCategoryYField")||(this._yOpenField=this._yField)),t.isType(n)&&(this.get("openValueYField")||(this._yOpenField=this._yField))}_prepareChildren(){super._prepareChildren();const e=this.get("xAxis"),t=this.get("yAxis"),i=this.dataItems.length,n=Math.max(0,this.startIndex()-2),r=Math.min(this.endIndex()+2,i-1);if(e.inited&&t.inited)for(let a=n;a<=r;a++)this._createGraphics(this.dataItems[a])}_updateChildren(){const e=this.chart;e&&(this._ph=e.plotContainer.height(),this._pw=e.plotContainer.width());const t=this.get("xAxis"),i=this.get("yAxis"),n=this.get("baseAxis"),r=this.columns.template;this.isDirty("fill")&&null==r.get("fill")&&r.set("fill",this.get("fill")),this.isDirty("stroke")&&null==r.get("stroke")&&r.set("stroke",this.get("stroke"));let a=0,o=0,l=0;ye(n.series,b=>{if(b instanceof Lc){const C=b.get("stacked");C&&0==l&&o++,!C&&b.get("clustered")&&o++}b===this&&(a=o-1),l++}),this.get("clustered")||(a=0,o=1),0===o&&(o=1,a=0);const c=t.get("renderer"),h=i.get("renderer"),u="cellStartLocation",m="cellEndLocation",p=c.get(u,0),_=c.get(m,1),g=h.get(u,0),f=h.get(m,1);if(this._aLocationX0=p+a/o*(_-p),this._aLocationX1=p+(a+1)/o*(_-p),this._aLocationY0=g+a/o*(f-g),this._aLocationY1=g+(a+1)/o*(f-g),t.inited&&i.inited){if(this._axesDirty||this._valuesDirty||this._stackDirty||this.isDirty("vcx")||this.isDirty("vcy")||this._sizeDirty){const b=this.dataItems.length;let C=Math.max(0,this.startIndex()-2),M=Math.min(this.endIndex()+2,b-1);for(let S=0;S<C;S++)this._toggleColumn(this.dataItems[S],!1);let E=this.dataItems[C];for(let S=C;S<=M;S++){let P=this.dataItems[S];if(null!=P.get("valueX")&&null!=P.get("valueY")){if(E=P,S>0&&C>0)for(let I=S-1;I>=0;I--){let L=this.dataItems[I];if(null!=L.get("valueX")&&null!=L.get("valueY")){E=L;break}}break}this._toggleColumn(P,!1)}for(let S=C;S<=M;S++){let P=this.dataItems[S];this._updateGraphics(P,E),null!=P.get("valueX")&&null!=P.get("valueY")&&(E=P)}for(let S=M+1;S<b;S++)this._toggleColumn(this.dataItems[S],!1)}}else this._skipped=!0;this.updateLegendMarker(this.get("tooltipDataItem")),super._updateChildren()}_createGraphics(e){let t=e.get("graphics");if(!t){t=this._makeGraphics(this.columns,e),e.set("graphics",t),t._setDataItem(e);const i=e.get("legendDataItem");if(i){const r=i.get("markerRectangle");if(r){const a=r.states.lookup("default");ye(fb,o=>{const l=t.get(o,this.get(o));r.set(o,l),a.set(o,l)})}}let n=e.get("rangeGraphics");n&&ye(n,r=>{r.dispose()}),n=[],e.setRaw("rangeGraphics",n),this.axisRanges.each(r=>{const a=r.container,o=this._makeGraphics(r.columns,e);n&&n.push(o),o.setPrivate("list",r.columns),a.children.push(o)})}}createAxisRange(e){return ye(this.dataItems,t=>{const i=t.get("graphics");i&&(i.dispose(),t.set("graphics",void 0))}),super.createAxisRange(e)}_updateGraphics(e,t){let i=e.get("graphics");const n=this._xField,r=this._yField,a=e.get(n),o=e.get(r);if(null!=a&&null!=o){const l=this._xOpenField,c=this._yOpenField,h=this.get("locationX",e.get("locationX",.5)),u=this.get("locationY",e.get("locationY",.5)),m=this.get("openLocationX",e.get("openLocationX",h)),p=this.get("openLocationY",e.get("openLocationY",u)),_=i.get("width"),g=i.get("height"),f=this.get("stacked"),b=this.get("xAxis"),C=this.get("yAxis"),M=this.get("baseAxis"),E=b.get("start"),S=b.get("end"),P=C.get("start"),I=C.get("end");let L,O,B,Q,pe=this.get("vcy",1),ae=this.get("vcx",1),N=!1,ee=!1;if(C.isType("CategoryAxis")&&b.isType("CategoryAxis")){let se=this._aLocationX0+m-.5,ue=this._aLocationX1+h-.5;if(_ instanceof Ti){let re=(ue-se)*(1-_.value)/2;se+=re,ue-=re}if(L=b.getDataItemPositionX(e,l,se,ae),O=b.getDataItemPositionX(e,n,ue,ae),se=this._aLocationY0+p-.5,ue=this._aLocationY1+u-.5,g instanceof Ti){let re=(ue-se)*(1-g.value)/2;se+=re,ue-=re}B=C.getDataItemPositionY(e,c,se,pe),Q=C.getDataItemPositionY(e,r,ue,pe),e.setRaw("point",{x:L+(O-L)/2,y:B+(Q-B)/2})}else if(b===M){let se=this._aLocationX0+m-.5,ue=this._aLocationX1+h-.5;if(_ instanceof Ti){let re=(ue-se)*(1-_.value)/2;se+=re,ue-=re}if(L=b.getDataItemPositionX(e,l,se,ae),O=b.getDataItemPositionX(e,n,ue,ae),B=C.getDataItemPositionY(e,r,u,pe),this._yOpenField!==this._yField)Q=C.getDataItemPositionY(e,c,p,pe);else if(f){let re=e.get("stackToItemY");Q=re?C.getDataItemPositionY(re,r,p,re.component.get("vcy")):C.basePosition()}else Q=C.basePosition();e.setRaw("point",{x:L+(O-L)/2,y:B}),ee=!0}else if(C===M){let se=this._aLocationY0+p-.5,ue=this._aLocationY1+u-.5;if(g instanceof Ti){let re=(ue-se)*(1-g.value)/2;se+=re,ue-=re}if(B=C.getDataItemPositionY(e,c,se,pe),Q=C.getDataItemPositionY(e,r,ue,pe),O=b.getDataItemPositionX(e,n,h,ae),this._xOpenField!==this._xField)L=b.getDataItemPositionX(e,l,m,ae);else if(f){let re=e.get("stackToItemX");L=re?b.getDataItemPositionX(re,n,m,re.component.get("vcx")):b.basePosition()}else L=b.basePosition();N=!0,e.setRaw("point",{x:O,y:B+(Q-B)/2})}this._updateSeriesGraphics(e,i,L,O,B,Q,N,ee),L<E&&O<E||L>S&&O>S||B<P&&Q<=P||B>=I&&Q>I||Kt(L)||Kt(B)?this._toggleColumn(e,!1):this._toggleColumn(e,!0);let K=e.get("rangeGraphics");K&&ye(K,se=>{this._updateSeriesGraphics(e,se,L,O,B,Q,N,ee)}),this._applyGraphicsStates(e,t)}}_updateSeriesGraphics(e,t,i,n,r,a,o,l){const c=t.get("width"),h=t.get("height"),u=t.get("maxWidth"),m=t.get("maxHeight"),p=this.getPoint(i,r),_=this.getPoint(n,a),g=e.get("point");if(g){const f=this.getPoint(g.x,g.y);g.x=f.x+this._x,g.y=f.y+this._y}if(i=p.x,n=_.x,r=p.y,a=_.y,Se(c)){const f=(n-i-c)/2;i+=f,n-=f}if(Se(u)&&u<Math.abs(n-i)){const f=(n-i-u)/2;i+=f,n-=f}if(Se(h)){const f=(a-r-h)/2;r+=f,a-=f}if(Se(m)&&m<Math.abs(a-r)){const f=(a-r-m)/2;r+=f,a-=f}this.get("adjustBulletPosition")&&(o&&(n=Math.min(Math.max(0,n),this._pw),i=Math.min(Math.max(0,i),this._pw)),l&&(r=Math.min(Math.max(0,r),this._ph),a=Math.min(Math.max(0,a),this._ph))),e.setRaw("left",i),e.setRaw("right",n),e.setRaw("top",r),e.setRaw("bottom",a),t.setPrivate("width",n-i),t.setPrivate("height",a-r),t.set("x",i),t.set("y",a-(a-r))}_handleDataSetChange(){super._handleDataSetChange(),ye(this._dataItems,e=>{this._toggleColumn(e,!1)})}_applyGraphicsStates(e,t){const i=e.get("graphics"),n=i.states.lookup("dropFromOpen"),r=i.states.lookup("riseFromOpen"),a=i.states.lookup("dropFromPrevious"),o=i.states.lookup("riseFromPrevious");if(n||a||r||o){const l=this.get("xAxis"),c=this.get("yAxis"),h=this.get("baseAxis");let u,m,p;h===l&&c.isType("ValueAxis")?(u=e.get(this._yOpenField),m=e.get(this._yField),p=t.get(this._yField)):h===c&&l.isType("ValueAxis")&&(u=e.get(this._xOpenField),m=e.get(this._xField),p=t.get(this._xField)),Se(u)&&Se(m)&&(m<u?n&&n.apply():r&&r.apply(),Se(p)&&(m<p?a&&a.apply():o&&o.apply()))}}disposeDataItem(e){super.disposeDataItem(e);const t=e.get("graphics");t&&(this.columns.removeValue(t),t.dispose());const i=e.get("rangeGraphics");i&&ye(i,n=>{const r=n.getPrivate("list");r&&r.removeValue(n),n.dispose()})}hideDataItem(e,t){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return(0,vs.mG)(this,void 0,void 0,function*(){const n=[i.hideDataItem.call(this,e,t)],r=e.get("graphics");r&&n.push(r.hide(t));const a=e.get("rangeGraphics");a&&ye(a,o=>{n.push(o.hide(t))}),yield Promise.all(n)})}_toggleColumn(e,t){const i=e.get("graphics");i&&i.setPrivate("visible",t);const n=e.get("rangeGraphics");n&&ye(n,a=>{a.setPrivate("visible",t)});const r=e.bullets;r&&ye(r,a=>{a.setPrivate("hidden",!t)})}showDataItem(e,t){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return(0,vs.mG)(this,void 0,void 0,function*(){const n=[i.showDataItem.call(this,e,t)],r=e.get("graphics");r&&n.push(r.show(t));const a=e.get("rangeGraphics");a&&ye(a,o=>{n.push(o.show(t))}),yield Promise.all(n)})}updateLegendMarker(e){let t=this.get("legendDataItem");if(this.get("useLastColorForLegendMarker")&&!e){const i=this.dataItems[this.endIndex()-1];i&&(e=i)}if(t){let i=this.columns.template;if(e){let r=e.get("graphics");r&&(i=r)}const n=t.get("markerRectangle");if(n&&!t.get("itemContainer").get("disabled")){const r=n.states.lookup("default");ye(fb,a=>{const o=i.get(a,this.get(a));n.set(a,o),r.set(a,o)})}}}_getTooltipTarget(e){return"bullet"==this.get("seriesTooltipTarget")?super._getTooltipTarget(e):e.get("graphics")||this}}Object.defineProperty(Lc,"className",{enumerable:!0,configurable:!0,writable:!0,value:"BaseColumnSeries"}),Object.defineProperty(Lc,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Ac.classNames.concat([Lc.className])});class Zd extends Lc{constructor(){super(...arguments),Object.defineProperty(this,"columns",{enumerable:!0,configurable:!0,writable:!0,value:new bs(An.new({}),()=>po._new(this._root,{position:"absolute",themeTags:ki(this.columns.template.get("themeTags",[]),["series","column"])},[this.columns.template]))})}makeColumn(e,t){const i=this.mainContainer.children.push(t.make());return i._setDataItem(e),t.push(i),i}_processAxisRange(e){super._processAxisRange(e),e.columns=new bs(An.new({}),()=>po._new(this._root,{position:"absolute",themeTags:ki(e.columns.template.get("themeTags",[]),["series","column"])},[this.columns.template,e.columns.template]))}}function _E(s,e){if(1&s&&(d.TgZ(0,"h6"),d._uU(1),d.qZA()),2&s){const t=d.oxw();d.xp6(1),d.Oqu(t.config.view.labels.title||"")}}Object.defineProperty(Zd,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ColumnSeries"}),Object.defineProperty(Zd,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Lc.classNames.concat([Zd.className])});let bE=(()=>{class s{constructor(t,i,n){this.socketService=t,this.historicalService=i,this.store=n,this.backgroundColor="transparent",this.unsubscribe$=new gi.x,this.unsubscribeInterval$=new gi.x}ngAfterViewInit(){let t,i=[],n=this.config;this._root&&this._root.dispose(),this._root=Yo.new("column_chart_"+this.id),this._root.setThemes([Rc.new(this._root)]),n.view.chart.BackgroundColor&&(this.backgroundColor=n.view.chart.BackgroundColor);const r=this._root.container.children.push(ja.new(this._root,{panX:!1,panY:!1,wheelX:"none",wheelY:"none",pinchZoomX:!1})),a=fo.new(this._root,{minGridDistance:10}),o=n.view.xRenderer;a.labels.template.setAll({rotation:n.view.xRenderer.rotation||0,centerY:("100"===o.centerY?vt:"50"===o.centerY?wi:El)||wi,centerX:("100"===o.centerX?vt:"50"===o.centerX?wi:El)||vt,breakWords:n.view.xRenderer.breakWords||!0,textAlign:n.view.xRenderer.textAlign||"center",fontSize:n.view.xRenderer.fontSize||"10",visible:n.view.xRenderer.visible||!1}),a.grid.template.setAll({location:1});const h=r.xAxes.push(Xo.new(this._root,{categoryField:"outputs",renderer:a,maxDeviation:.3,tooltip:Vr.new(this._root,{})})),u=r.yAxes.push(ha.new(this._root,{maxDeviation:.3,max:n.view.chart.max||100,min:n.view.chart.min||0,strictMinMax:!0,renderer:go.new(this._root,{minGridDistance:20,strokeOpacity:.1})}));r.set("cursor",Dc.new(this._root,{})).lineY.set("visible",!1);const p=r.series.push(Zd.new(this._root,{name:"Series 1",xAxis:h,yAxis:u,valueYField:"value",sequencedInterpolation:!0,categoryXField:"outputs",tooltip:Vr.new(this._root,{labelText:"{valueY}"})}));n.content.length>0&&(i=n.content.map(_=>({topic:_.topic.id,color:kn(_.color),outputs:this.getItemLabel(_),value:10}))),p.columns.template.setAll({cornerRadiusTL:5,cornerRadiusTR:5,strokeOpacity:0}),p.columns.template.adapters.add("fill",function(_,g){return g.dataItem?g.dataItem.dataContext.color:kn("0xeeeeee")}),p.columns.template.adapters.add("stroke",function(_,g){return g.dataItem?g.dataItem.dataContext.color:kn("0xeeeeee")}),p.events.on("datavalidated",function(){t&&u.setAll({min:0,max:+t+20,start:0,end:1})}),h.data.setAll(i),p.data.setAll(i),r.zoomOutButton.set("forceHidden",!0),p.appear(1e3),r.appear(1e3,100),n.content[0]?.isApi?(t="0",this.store.select((0,ze.rM)(this.id)).pipe((0,Di.q)(1),(0,ri.U)(_=>{const g=_.config.content[0];this.historicalService.callAPI(g.api,g.topic.id,g.outputs.read.name).pipe((0,Di.q)(1),(0,ri.U)(f=>{const b=f.data.map((C,M)=>{+f.data[M].value>+t&&(t=f.data[M].value);const E={...C,outputs:C.topic};return p.data.setIndex(M,E),E});h.data.setAll(b),this._root?.resize()})).subscribe(),(0,Ab.F)(3e3).pipe((0,he.R)(this.unsubscribeInterval$),(0,Ei.w)(()=>this.historicalService.callAPI(g.api,g.topic.id,g.outputs.read.name).pipe((0,Di.q)(1),(0,ri.U)(f=>{const b=f.data.map((C,M)=>{+f.data[M].value>+t&&(t=f.data[M].value);const E={...C,outputs:C.topic};return p.data.setIndex(M,E),E});h.data.setAll(b),this._root?.resize()})))).subscribe()})).subscribe()):n.content.length>0&&(i=n.content.map((_,g)=>(this.socketService.fetchDeviceData(_.topic.id,_.outputs.read.name).pipe((0,ri.U)(f=>{p.data.setIndex(g,{topic:_.topic.id,outputs:this.getItemLabel(_),value:f,color:kn(_.color)}),this._root?.resize()})).subscribe(),{topic:_.topic.id,outputs:this.getItemLabel(_),value:0,color:kn(_.color)})))}getItemLabel(t){return t.outputs?.read?.name?t.outputs?.read?.name:t.Equivalent?t.Equivalent:t.topic?.name??"undefined"}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete(),this.unsubscribeInterval$.next(),this.unsubscribeInterval$.complete(),this._root&&this._root.dispose()}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(Yr.l),d.Y36(Gd.O),d.Y36(Ie.yh))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-column-chart"]],inputs:{id:"id",config:"config"},decls:3,vars:4,consts:[[1,"container"],[4,"ngIf"],[1,"chat-container",3,"id"]],template:function(i,n){1&i&&(d.TgZ(0,"div",0),d.YNc(1,_E,2,1,"h6",1),d._UZ(2,"div",2),d.qZA()),2&i&&(d.Udp("background-color",n.backgroundColor),d.xp6(1),d.Q6J("ngIf",n.config),d.xp6(1),d.Q6J("id","column_chart_"+n.id))},dependencies:[x.O5],styles:[".container[_ngcontent-%COMP%]{width:100%;height:100%;padding:0;display:flex;flex-direction:column;border:1px solid #FFFFFF;border-radius:.5rem}.chat-container[_ngcontent-%COMP%]{padding:0;width:100%;height:100%}h6[_ngcontent-%COMP%]{text-align:center;color:#fff}"]})}return s})();function vE(){}function Ob(s){return null==s?vE:function(){return this.querySelector(s)}}function wE(){return[]}function hx(s){return null==s?wE:function(){return this.querySelectorAll(s)}}function ux(s){return function(){return this.matches(s)}}function mx(s){return function(e){return e.matches(s)}}var CE=Array.prototype.find;function EE(){return this.firstElementChild}var kE=Array.prototype.filter;function AE(){return Array.from(this.children)}function px(s){return new Array(s.length)}function jp(s,e){this.ownerDocument=s.ownerDocument,this.namespaceURI=s.namespaceURI,this._next=null,this._parent=s,this.__data__=e}function FE(s,e,t,i,n,r){for(var o,a=0,l=e.length,c=r.length;a<c;++a)(o=e[a])?(o.__data__=r[a],i[a]=o):t[a]=new jp(s,r[a]);for(;a<l;++a)(o=e[a])&&(n[a]=o)}function BE(s,e,t,i,n,r,a){var o,l,p,c=new Map,h=e.length,u=r.length,m=new Array(h);for(o=0;o<h;++o)(l=e[o])&&(m[o]=p=a.call(l,l.__data__,o,e)+"",c.has(p)?n[o]=l:c.set(p,l));for(o=0;o<u;++o)p=a.call(s,r[o],o,r)+"",(l=c.get(p))?(i[o]=l,l.__data__=r[o],c.delete(p)):t[o]=new jp(s,r[o]);for(o=0;o<h;++o)(l=e[o])&&c.get(m[o])===l&&(n[o]=l)}function NE(s){return s.__data__}function zE(s){return"object"==typeof s&&"length"in s?s:Array.from(s)}function jE(s,e){return s<e?-1:s>e?1:s>=e?0:NaN}jp.prototype={constructor:jp,appendChild:function(s){return this._parent.insertBefore(s,this._next)},insertBefore:function(s,e){return this._parent.insertBefore(s,e)},querySelector:function(s){return this._parent.querySelector(s)},querySelectorAll:function(s){return this._parent.querySelectorAll(s)}};var Rb="http://www.w3.org/1999/xhtml";const fx={svg:"http://www.w3.org/2000/svg",xhtml:Rb,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Zp(s){var e=s+="",t=e.indexOf(":");return t>=0&&"xmlns"!==(e=s.slice(0,t))&&(s=s.slice(t+1)),fx.hasOwnProperty(e)?{space:fx[e],local:s}:s}function QE(s){return function(){this.removeAttribute(s)}}function eS(s){return function(){this.removeAttributeNS(s.space,s.local)}}function tS(s,e){return function(){this.setAttribute(s,e)}}function iS(s,e){return function(){this.setAttributeNS(s.space,s.local,e)}}function nS(s,e){return function(){var t=e.apply(this,arguments);null==t?this.removeAttribute(s):this.setAttribute(s,t)}}function sS(s,e){return function(){var t=e.apply(this,arguments);null==t?this.removeAttributeNS(s.space,s.local):this.setAttributeNS(s.space,s.local,t)}}function gx(s){return s.ownerDocument&&s.ownerDocument.defaultView||s.document&&s||s.defaultView}function aS(s){return function(){this.style.removeProperty(s)}}function oS(s,e,t){return function(){this.style.setProperty(s,e,t)}}function lS(s,e,t){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(s):this.style.setProperty(s,i,t)}}function Xd(s,e){return s.style.getPropertyValue(e)||gx(s).getComputedStyle(s,null).getPropertyValue(e)}function dS(s){return function(){delete this[s]}}function hS(s,e){return function(){this[s]=e}}function uS(s,e){return function(){var t=e.apply(this,arguments);null==t?delete this[s]:this[s]=t}}function _x(s){return s.trim().split(/^|\s+/)}function Ib(s){return s.classList||new bx(s)}function bx(s){this._node=s,this._names=_x(s.getAttribute("class")||"")}function vx(s,e){for(var t=Ib(s),i=-1,n=e.length;++i<n;)t.add(e[i])}function yx(s,e){for(var t=Ib(s),i=-1,n=e.length;++i<n;)t.remove(e[i])}function pS(s){return function(){vx(this,s)}}function fS(s){return function(){yx(this,s)}}function gS(s,e){return function(){(e.apply(this,arguments)?vx:yx)(this,s)}}function bS(){this.textContent=""}function vS(s){return function(){this.textContent=s}}function yS(s){return function(){var e=s.apply(this,arguments);this.textContent=e??""}}function wS(){this.innerHTML=""}function MS(s){return function(){this.innerHTML=s}}function TS(s){return function(){var e=s.apply(this,arguments);this.innerHTML=e??""}}function DS(){this.nextSibling&&this.parentNode.appendChild(this)}function SS(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function AS(s){return function(){var e=this.ownerDocument,t=this.namespaceURI;return t===Rb&&e.documentElement.namespaceURI===Rb?e.createElement(s):e.createElementNS(t,s)}}function PS(s){return function(){return this.ownerDocument.createElementNS(s.space,s.local)}}function xx(s){var e=Zp(s);return(e.local?PS:AS)(e)}function RS(){return null}function LS(){var s=this.parentNode;s&&s.removeChild(this)}function BS(){var s=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(s,this.nextSibling):s}function NS(){var s=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(s,this.nextSibling):s}function WS(s){return function(){var e=this.__on;if(e){for(var r,t=0,i=-1,n=e.length;t<n;++t)r=e[t],s.type&&r.type!==s.type||r.name!==s.name?e[++i]=r:this.removeEventListener(r.type,r.listener,r.options);++i?e.length=i:delete this.__on}}}function GS(s,e,t){return function(){var n,i=this.__on,r=function HS(s){return function(e){s.call(this,e,this.__data__)}}(e);if(i)for(var a=0,o=i.length;a<o;++a)if((n=i[a]).type===s.type&&n.name===s.name)return this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=r,n.options=t),void(n.value=e);this.addEventListener(s.type,r,t),n={type:s.type,name:s.name,value:e,listener:r,options:t},i?i.push(n):this.__on=[n]}}function wx(s,e,t){var i=gx(s),n=i.CustomEvent;"function"==typeof n?n=new n(e,t):(n=i.document.createEvent("Event"),t?(n.initEvent(e,t.bubbles,t.cancelable),n.detail=t.detail):n.initEvent(e,!1,!1)),s.dispatchEvent(n)}function jS(s,e){return function(){return wx(this,s,e)}}function ZS(s,e){return function(){return wx(this,s,e.apply(this,arguments))}}bx.prototype={add:function(s){this._names.indexOf(s)<0&&(this._names.push(s),this._node.setAttribute("class",this._names.join(" ")))},remove:function(s){var e=this._names.indexOf(s);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(s){return this._names.indexOf(s)>=0}};var Mx=[null];function ua(s,e){this._groups=s,this._parents=e}function Tx(){return new ua([[document.documentElement]],Mx)}ua.prototype=Tx.prototype={constructor:ua,select:function yE(s){"function"!=typeof s&&(s=Ob(s));for(var e=this._groups,t=e.length,i=new Array(t),n=0;n<t;++n)for(var l,c,r=e[n],a=r.length,o=i[n]=new Array(a),h=0;h<a;++h)(l=r[h])&&(c=s.call(l,l.__data__,h,r))&&("__data__"in l&&(c.__data__=l.__data__),o[h]=c);return new ua(i,this._parents)},selectAll:function TE(s){s="function"==typeof s?function ME(s){return function(){return function xE(s){return null==s?[]:Array.isArray(s)?s:Array.from(s)}(s.apply(this,arguments))}}(s):hx(s);for(var e=this._groups,t=e.length,i=[],n=[],r=0;r<t;++r)for(var l,a=e[r],o=a.length,c=0;c<o;++c)(l=a[c])&&(i.push(s.call(l,l.__data__,c,a)),n.push(l));return new ua(i,n)},selectChild:function SE(s){return this.select(null==s?EE:function DE(s){return function(){return CE.call(this.children,s)}}("function"==typeof s?s:mx(s)))},selectChildren:function OE(s){return this.selectAll(null==s?AE:function PE(s){return function(){return kE.call(this.children,s)}}("function"==typeof s?s:mx(s)))},filter:function RE(s){"function"!=typeof s&&(s=ux(s));for(var e=this._groups,t=e.length,i=new Array(t),n=0;n<t;++n)for(var l,r=e[n],a=r.length,o=i[n]=[],c=0;c<a;++c)(l=r[c])&&s.call(l,l.__data__,c,r)&&o.push(l);return new ua(i,this._parents)},data:function UE(s,e){if(!arguments.length)return Array.from(this,NE);var t=e?BE:FE,i=this._parents,n=this._groups;"function"!=typeof s&&(s=function LE(s){return function(){return s}}(s));for(var r=n.length,a=new Array(r),o=new Array(r),l=new Array(r),c=0;c<r;++c){var h=i[c],u=n[c],m=u.length,p=zE(s.call(h,h&&h.__data__,c,i)),_=p.length,g=o[c]=new Array(_),f=a[c]=new Array(_);t(h,u,g,f,l[c]=new Array(m),p,e);for(var E,S,C=0,M=0;C<_;++C)if(E=g[C]){for(C>=M&&(M=C+1);!(S=f[M])&&++M<_;);E._next=S||null}}return(a=new ua(a,i))._enter=o,a._exit=l,a},enter:function IE(){return new ua(this._enter||this._groups.map(px),this._parents)},exit:function HE(){return new ua(this._exit||this._groups.map(px),this._parents)},join:function VE(s,e,t){var i=this.enter(),n=this,r=this.exit();return"function"==typeof s?(i=s(i))&&(i=i.selection()):i=i.append(s+""),null!=e&&(n=e(n))&&(n=n.selection()),null==t?r.remove():t(r),i&&n?i.merge(n).order():n},merge:function WE(s){for(var e=s.selection?s.selection():s,t=this._groups,i=e._groups,n=t.length,a=Math.min(n,i.length),o=new Array(n),l=0;l<a;++l)for(var p,c=t[l],h=i[l],u=c.length,m=o[l]=new Array(u),_=0;_<u;++_)(p=c[_]||h[_])&&(m[_]=p);for(;l<n;++l)o[l]=t[l];return new ua(o,this._parents)},selection:function $S(){return this},order:function GE(){for(var s=this._groups,e=-1,t=s.length;++e<t;)for(var a,i=s[e],n=i.length-1,r=i[n];--n>=0;)(a=i[n])&&(r&&4^a.compareDocumentPosition(r)&&r.parentNode.insertBefore(a,r),r=a);return this},sort:function YE(s){function e(u,m){return u&&m?s(u.__data__,m.__data__):!u-!m}s||(s=jE);for(var t=this._groups,i=t.length,n=new Array(i),r=0;r<i;++r){for(var c,a=t[r],o=a.length,l=n[r]=new Array(o),h=0;h<o;++h)(c=a[h])&&(l[h]=c);l.sort(e)}return new ua(n,this._parents).order()},call:function ZE(){var s=arguments[0];return arguments[0]=this,s.apply(null,arguments),this},nodes:function XE(){return Array.from(this)},node:function qE(){for(var s=this._groups,e=0,t=s.length;e<t;++e)for(var i=s[e],n=0,r=i.length;n<r;++n){var a=i[n];if(a)return a}return null},size:function $E(){let s=0;for(const e of this)++s;return s},empty:function KE(){return!this.node()},each:function JE(s){for(var e=this._groups,t=0,i=e.length;t<i;++t)for(var o,n=e[t],r=0,a=n.length;r<a;++r)(o=n[r])&&s.call(o,o.__data__,r,n);return this},attr:function rS(s,e){var t=Zp(s);if(arguments.length<2){var i=this.node();return t.local?i.getAttributeNS(t.space,t.local):i.getAttribute(t)}return this.each((null==e?t.local?eS:QE:"function"==typeof e?t.local?sS:nS:t.local?iS:tS)(t,e))},style:function cS(s,e,t){return arguments.length>1?this.each((null==e?aS:"function"==typeof e?lS:oS)(s,e,t??"")):Xd(this.node(),s)},property:function mS(s,e){return arguments.length>1?this.each((null==e?dS:"function"==typeof e?uS:hS)(s,e)):this.node()[s]},classed:function _S(s,e){var t=_x(s+"");if(arguments.length<2){for(var i=Ib(this.node()),n=-1,r=t.length;++n<r;)if(!i.contains(t[n]))return!1;return!0}return this.each(("function"==typeof e?gS:e?pS:fS)(t,e))},text:function xS(s){return arguments.length?this.each(null==s?bS:("function"==typeof s?yS:vS)(s)):this.node().textContent},html:function CS(s){return arguments.length?this.each(null==s?wS:("function"==typeof s?TS:MS)(s)):this.node().innerHTML},raise:function ES(){return this.each(DS)},lower:function kS(){return this.each(SS)},append:function OS(s){var e="function"==typeof s?s:xx(s);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function IS(s,e){var t="function"==typeof s?s:xx(s),i=null==e?RS:"function"==typeof e?e:Ob(e);return this.select(function(){return this.insertBefore(t.apply(this,arguments),i.apply(this,arguments)||null)})},remove:function FS(){return this.each(LS)},clone:function US(s){return this.select(s?NS:BS)},datum:function zS(s){return arguments.length?this.property("__data__",s):this.node().__data__},on:function YS(s,e,t){var n,a,i=function VS(s){return s.trim().split(/^|\s+/).map(function(e){var t="",i=e.indexOf(".");return i>=0&&(t=e.slice(i+1),e=e.slice(0,i)),{type:e,name:t}})}(s+""),r=i.length;if(!(arguments.length<2)){for(o=e?GS:WS,n=0;n<r;++n)this.each(o(i[n],e,t));return this}var o=this.node().__on;if(o)for(var h,l=0,c=o.length;l<c;++l)for(n=0,h=o[l];n<r;++n)if((a=i[n]).type===h.type&&a.name===h.name)return h.value},dispatch:function XS(s,e){return this.each(("function"==typeof e?ZS:jS)(s,e))},[Symbol.iterator]:function*qS(){for(var s=this._groups,e=0,t=s.length;e<t;++e)for(var a,i=s[e],n=0,r=i.length;n<r;++n)(a=i[n])&&(yield a)}};const Hu=Tx;var KS={value:()=>{}};function Cx(){for(var i,s=0,e=arguments.length,t={};s<e;++s){if(!(i=arguments[s]+"")||i in t||/[\s.]/.test(i))throw new Error("illegal type: "+i);t[i]=[]}return new Xp(t)}function Xp(s){this._=s}function QS(s,e){for(var n,t=0,i=s.length;t<i;++t)if((n=s[t]).name===e)return n.value}function Dx(s,e,t){for(var i=0,n=s.length;i<n;++i)if(s[i].name===e){s[i]=KS,s=s.slice(0,i).concat(s.slice(i+1));break}return null!=t&&s.push({name:e,value:t}),s}Xp.prototype=Cx.prototype={constructor:Xp,on:function(s,e){var n,t=this._,i=function JS(s,e){return s.trim().split(/^|\s+/).map(function(t){var i="",n=t.indexOf(".");if(n>=0&&(i=t.slice(n+1),t=t.slice(0,n)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:i}})}(s+"",t),r=-1,a=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++r<a;)if(n=(s=i[r]).type)t[n]=Dx(t[n],s.name,e);else if(null==e)for(n in t)t[n]=Dx(t[n],s.name,null);return this}for(;++r<a;)if((n=(s=i[r]).type)&&(n=QS(t[n],s.name)))return n},copy:function(){var s={},e=this._;for(var t in e)s[t]=e[t].slice();return new Xp(s)},call:function(s,e){if((n=arguments.length-2)>0)for(var n,r,t=new Array(n),i=0;i<n;++i)t[i]=arguments[i+2];if(!this._.hasOwnProperty(s))throw new Error("unknown type: "+s);for(i=0,n=(r=this._[s]).length;i<n;++i)r[i].value.apply(e,t)},apply:function(s,e,t){if(!this._.hasOwnProperty(s))throw new Error("unknown type: "+s);for(var i=this._[s],n=0,r=i.length;n<r;++n)i[n].value.apply(e,t)}};const ek=Cx;var qp,Gu,qd=0,Vu=0,Wu=0,Ex=1e3,$p=0,Fc=0,Kp=0,Yu="object"==typeof performance&&performance.now?performance:Date,Sx="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(s){setTimeout(s,17)};function Lb(){return Fc||(Sx(tk),Fc=Yu.now()+Kp)}function tk(){Fc=0}function Jp(){this._call=this._time=this._next=null}function kx(s,e,t){var i=new Jp;return i.restart(s,e,t),i}function Ax(){Fc=($p=Yu.now())+Kp,qd=Vu=0;try{!function ik(){Lb(),++qd;for(var e,s=qp;s;)(e=Fc-s._time)>=0&&s._call.call(void 0,e),s=s._next;--qd}()}finally{qd=0,function sk(){for(var s,t,e=qp,i=1/0;e;)e._call?(i>e._time&&(i=e._time),s=e,e=e._next):(t=e._next,e._next=null,e=s?s._next=t:qp=t);Gu=s,Fb(i)}(),Fc=0}}function nk(){var s=Yu.now(),e=s-$p;e>Ex&&(Kp-=e,$p=s)}function Fb(s){qd||(Vu&&(Vu=clearTimeout(Vu)),s-Fc>24?(s<1/0&&(Vu=setTimeout(Ax,s-Yu.now()-Kp)),Wu&&(Wu=clearInterval(Wu))):(Wu||($p=Yu.now(),Wu=setInterval(nk,Ex)),qd=1,Sx(Ax)))}function Px(s,e,t){var i=new Jp;return i.restart(n=>{i.stop(),s(n+e)},e=null==e?0:+e,t),i}Jp.prototype=kx.prototype={constructor:Jp,restart:function(s,e,t){if("function"!=typeof s)throw new TypeError("callback is not a function");t=(null==t?Lb():+t)+(null==e?0:+e),!this._next&&Gu!==this&&(Gu?Gu._next=this:qp=this,Gu=this),this._call=s,this._time=t,Fb()},stop:function(){this._call&&(this._call=null,this._time=1/0,Fb())}};var rk=ek("start","end","cancel","interrupt"),ak=[],Ox=0,Qp=3;function tf(s,e,t,i,n,r){var a=s.__transition;if(a){if(t in a)return}else s.__transition={};!function ok(s,e,t){var n,i=s.__transition;function a(c){var h,u,m,p;if(1!==t.state)return l();for(h in i)if((p=i[h]).name===t.name){if(p.state===Qp)return Px(a);4===p.state?(p.state=6,p.timer.stop(),p.on.call("interrupt",s,s.__data__,p.index,p.group),delete i[h]):+h<e&&(p.state=6,p.timer.stop(),p.on.call("cancel",s,s.__data__,p.index,p.group),delete i[h])}if(Px(function(){t.state===Qp&&(t.state=4,t.timer.restart(o,t.delay,t.time),o(c))}),t.state=2,t.on.call("start",s,s.__data__,t.index,t.group),2===t.state){for(t.state=Qp,n=new Array(m=t.tween.length),h=0,u=-1;h<m;++h)(p=t.tween[h].value.call(s,s.__data__,t.index,t.group))&&(n[++u]=p);n.length=u+1}}function o(c){for(var h=c<t.duration?t.ease.call(null,c/t.duration):(t.timer.restart(l),t.state=5,1),u=-1,m=n.length;++u<m;)n[u].call(s,h);5===t.state&&(t.on.call("end",s,s.__data__,t.index,t.group),l())}function l(){for(var c in t.state=6,t.timer.stop(),delete i[e],i)return;delete s.__transition}i[e]=t,t.timer=kx(function r(c){t.state=1,t.timer.restart(a,t.delay,t.time),t.delay<=c&&a(c-t.delay)},0,t.time)}(s,t,{name:e,index:i,group:n,on:rk,tween:ak,time:r.time,delay:r.delay,duration:r.duration,ease:r.ease,timer:null,state:Ox})}function Ub(s,e){var t=Xa(s,e);if(t.state>Ox)throw new Error("too late; already scheduled");return t}function bo(s,e){var t=Xa(s,e);if(t.state>Qp)throw new Error("too late; already running");return t}function Xa(s,e){var t=s.__transition;if(!t||!(t=t[e]))throw new Error("transition not found");return t}function Ol(s,e){return s=+s,e=+e,function(t){return s*(1-t)+e*t}}var nf,Lx=180/Math.PI,zb={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Fx(s,e,t,i,n,r){var a,o,l;return(a=Math.sqrt(s*s+e*e))&&(s/=a,e/=a),(l=s*t+e*i)&&(t-=s*l,i-=e*l),(o=Math.sqrt(t*t+i*i))&&(t/=o,i/=o,l/=o),s*i<e*t&&(s=-s,e=-e,l=-l,a=-a),{translateX:n,translateY:r,rotate:Math.atan2(e,s)*Lx,skewX:Math.atan(l)*Lx,scaleX:a,scaleY:o}}function Bx(s,e,t,i){function n(c){return c.length?c.pop()+" ":""}return function(c,h){var u=[],m=[];return c=s(c),h=s(h),function r(c,h,u,m,p,_){if(c!==u||h!==m){var g=p.push("translate(",null,e,null,t);_.push({i:g-4,x:Ol(c,u)},{i:g-2,x:Ol(h,m)})}else(u||m)&&p.push("translate("+u+e+m+t)}(c.translateX,c.translateY,h.translateX,h.translateY,u,m),function a(c,h,u,m){c!==h?(c-h>180?h+=360:h-c>180&&(c+=360),m.push({i:u.push(n(u)+"rotate(",null,i)-2,x:Ol(c,h)})):h&&u.push(n(u)+"rotate("+h+i)}(c.rotate,h.rotate,u,m),function o(c,h,u,m){c!==h?m.push({i:u.push(n(u)+"skewX(",null,i)-2,x:Ol(c,h)}):h&&u.push(n(u)+"skewX("+h+i)}(c.skewX,h.skewX,u,m),function l(c,h,u,m,p,_){if(c!==u||h!==m){var g=p.push(n(p)+"scale(",null,",",null,")");_.push({i:g-4,x:Ol(c,u)},{i:g-2,x:Ol(h,m)})}else(1!==u||1!==m)&&p.push(n(p)+"scale("+u+","+m+")")}(c.scaleX,c.scaleY,h.scaleX,h.scaleY,u,m),c=h=null,function(p){for(var f,_=-1,g=m.length;++_<g;)u[(f=m[_]).i]=f.x(p);return u.join("")}}}var uk=Bx(function dk(s){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(s+"");return e.isIdentity?zb:Fx(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),mk=Bx(function hk(s){return null!=s&&(nf||(nf=document.createElementNS("http://www.w3.org/2000/svg","g")),nf.setAttribute("transform",s),s=nf.transform.baseVal.consolidate())?Fx((s=s.matrix).a,s.b,s.c,s.d,s.e,s.f):zb},", ",")",")");function pk(s,e){var t,i;return function(){var n=bo(this,s),r=n.tween;if(r!==t)for(var a=0,o=(i=t=r).length;a<o;++a)if(i[a].name===e){(i=i.slice()).splice(a,1);break}n.tween=i}}function fk(s,e,t){var i,n;if("function"!=typeof t)throw new Error;return function(){var r=bo(this,s),a=r.tween;if(a!==i){n=(i=a).slice();for(var o={name:e,value:t},l=0,c=n.length;l<c;++l)if(n[l].name===e){n[l]=o;break}l===c&&n.push(o)}r.tween=n}}function Hb(s,e,t){var i=s._id;return s.each(function(){var n=bo(this,i);(n.value||(n.value={}))[e]=t.apply(this,arguments)}),function(n){return Xa(n,i).value[e]}}function Vb(s,e,t){s.prototype=e.prototype=t,t.constructor=s}function Nx(s,e){var t=Object.create(s.prototype);for(var i in e)t[i]=e[i];return t}function ju(){}var sf=1/.7,$d="\\s*([+-]?\\d+)\\s*",Xu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",vo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",_k=/^#([0-9a-f]{3,8})$/,bk=new RegExp(`^rgb\\(${$d},${$d},${$d}\\)$`),vk=new RegExp(`^rgb\\(${vo},${vo},${vo}\\)$`),yk=new RegExp(`^rgba\\(${$d},${$d},${$d},${Xu}\\)$`),xk=new RegExp(`^rgba\\(${vo},${vo},${vo},${Xu}\\)$`),wk=new RegExp(`^hsl\\(${Xu},${vo},${vo}\\)$`),Mk=new RegExp(`^hsla\\(${Xu},${vo},${vo},${Xu}\\)$`),Ux={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function zx(){return this.rgb().formatHex()}function Hx(){return this.rgb().formatRgb()}function qu(s){var e,t;return s=(s+"").trim().toLowerCase(),(e=_k.exec(s))?(t=e[1].length,e=parseInt(e[1],16),6===t?Vx(e):3===t?new Zr(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===t?rf(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===t?rf(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=bk.exec(s))?new Zr(e[1],e[2],e[3],1):(e=vk.exec(s))?new Zr(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=yk.exec(s))?rf(e[1],e[2],e[3],e[4]):(e=xk.exec(s))?rf(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=wk.exec(s))?Yx(e[1],e[2]/100,e[3]/100,1):(e=Mk.exec(s))?Yx(e[1],e[2]/100,e[3]/100,e[4]):Ux.hasOwnProperty(s)?Vx(Ux[s]):"transparent"===s?new Zr(NaN,NaN,NaN,0):null}function Vx(s){return new Zr(s>>16&255,s>>8&255,255&s,1)}function rf(s,e,t,i){return i<=0&&(s=e=t=NaN),new Zr(s,e,t,i)}function af(s,e,t,i){return 1===arguments.length?function Dk(s){return s instanceof ju||(s=qu(s)),s?new Zr((s=s.rgb()).r,s.g,s.b,s.opacity):new Zr}(s):new Zr(s,e,t,i??1)}function Zr(s,e,t,i){this.r=+s,this.g=+e,this.b=+t,this.opacity=+i}function Wx(){return`#${Nc(this.r)}${Nc(this.g)}${Nc(this.b)}`}function Gx(){const s=lf(this.opacity);return`${1===s?"rgb(":"rgba("}${Bc(this.r)}, ${Bc(this.g)}, ${Bc(this.b)}${1===s?")":`, ${s})`}`}function lf(s){return isNaN(s)?1:Math.max(0,Math.min(1,s))}function Bc(s){return Math.max(0,Math.min(255,Math.round(s)||0))}function Nc(s){return((s=Bc(s))<16?"0":"")+s.toString(16)}function Yx(s,e,t,i){return i<=0?s=e=t=NaN:t<=0||t>=1?s=e=NaN:e<=0&&(s=NaN),new qa(s,e,t,i)}function jx(s){if(s instanceof qa)return new qa(s.h,s.s,s.l,s.opacity);if(s instanceof ju||(s=qu(s)),!s)return new qa;if(s instanceof qa)return s;var e=(s=s.rgb()).r/255,t=s.g/255,i=s.b/255,n=Math.min(e,t,i),r=Math.max(e,t,i),a=NaN,o=r-n,l=(r+n)/2;return o?(a=e===r?(t-i)/o+6*(t<i):t===r?(i-e)/o+2:(e-t)/o+4,o/=l<.5?r+n:2-r-n,a*=60):o=l>0&&l<1?0:a,new qa(a,o,l,s.opacity)}function qa(s,e,t,i){this.h=+s,this.s=+e,this.l=+t,this.opacity=+i}function Zx(s){return(s=(s||0)%360)<0?s+360:s}function cf(s){return Math.max(0,Math.min(1,s||0))}function Wb(s,e,t){return 255*(s<60?e+(t-e)*s/60:s<180?t:s<240?e+(t-e)*(240-s)/60:e)}function Xx(s,e,t,i,n){var r=s*s,a=r*s;return((1-3*s+3*r-a)*e+(4-6*r+3*a)*t+(1+3*s+3*r-3*a)*i+a*n)/6}Vb(ju,qu,{copy(s){return Object.assign(new this.constructor,this,s)},displayable(){return this.rgb().displayable()},hex:zx,formatHex:zx,formatHex8:function Tk(){return this.rgb().formatHex8()},formatHsl:function Ck(){return jx(this).formatHsl()},formatRgb:Hx,toString:Hx}),Vb(Zr,af,Nx(ju,{brighter(s){return s=null==s?sf:Math.pow(sf,s),new Zr(this.r*s,this.g*s,this.b*s,this.opacity)},darker(s){return s=null==s?.7:Math.pow(.7,s),new Zr(this.r*s,this.g*s,this.b*s,this.opacity)},rgb(){return this},clamp(){return new Zr(Bc(this.r),Bc(this.g),Bc(this.b),lf(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Wx,formatHex:Wx,formatHex8:function Ek(){return`#${Nc(this.r)}${Nc(this.g)}${Nc(this.b)}${Nc(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Gx,toString:Gx})),Vb(qa,function Sk(s,e,t,i){return 1===arguments.length?jx(s):new qa(s,e,t,i??1)},Nx(ju,{brighter(s){return s=null==s?sf:Math.pow(sf,s),new qa(this.h,this.s,this.l*s,this.opacity)},darker(s){return s=null==s?.7:Math.pow(.7,s),new qa(this.h,this.s,this.l*s,this.opacity)},rgb(){var s=this.h%360+360*(this.h<0),e=isNaN(s)||isNaN(this.s)?0:this.s,t=this.l,i=t+(t<.5?t:1-t)*e,n=2*t-i;return new Zr(Wb(s>=240?s-240:s+120,n,i),Wb(s,n,i),Wb(s<120?s+240:s-120,n,i),this.opacity)},clamp(){return new qa(Zx(this.h),cf(this.s),cf(this.l),lf(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const s=lf(this.opacity);return`${1===s?"hsl(":"hsla("}${Zx(this.h)}, ${100*cf(this.s)}%, ${100*cf(this.l)}%${1===s?")":`, ${s})`}`}}));const qx=s=>()=>s;function Kx(s,e){var t=e-s;return t?function $x(s,e){return function(t){return s+t*e}}(s,t):qx(isNaN(s)?e:s)}const Jx=function s(e){var t=function Ok(s){return 1==(s=+s)?Kx:function(e,t){return t-e?function Pk(s,e,t){return s=Math.pow(s,t),e=Math.pow(e,t)-s,t=1/t,function(i){return Math.pow(s+i*e,t)}}(e,t,s):qx(isNaN(e)?t:e)}}(e);function i(n,r){var a=t((n=af(n)).r,(r=af(r)).r),o=t(n.g,r.g),l=t(n.b,r.b),c=Kx(n.opacity,r.opacity);return function(h){return n.r=a(h),n.g=o(h),n.b=l(h),n.opacity=c(h),n+""}}return i.gamma=s,i}(1);function Qx(s){return function(e){var a,o,t=e.length,i=new Array(t),n=new Array(t),r=new Array(t);for(a=0;a<t;++a)o=af(e[a]),i[a]=o.r||0,n[a]=o.g||0,r[a]=o.b||0;return i=s(i),n=s(n),r=s(r),o.opacity=1,function(l){return o.r=i(l),o.g=n(l),o.b=r(l),o+""}}}Qx(function kk(s){var e=s.length-1;return function(t){var i=t<=0?t=0:t>=1?(t=1,e-1):Math.floor(t*e),n=s[i],r=s[i+1];return Xx((t-i/e)*e,i>0?s[i-1]:2*n-r,n,r,i<e-1?s[i+2]:2*r-n)}}),Qx(function Ak(s){var e=s.length;return function(t){var i=Math.floor(((t%=1)<0?++t:t)*e);return Xx((t-i/e)*e,s[(i+e-1)%e],s[i%e],s[(i+1)%e],s[(i+2)%e])}});var Gb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Yb=new RegExp(Gb.source,"g");function Lk(s,e){var i,n,r,t=Gb.lastIndex=Yb.lastIndex=0,a=-1,o=[],l=[];for(s+="",e+="";(i=Gb.exec(s))&&(n=Yb.exec(e));)(r=n.index)>t&&(r=e.slice(t,r),o[a]?o[a]+=r:o[++a]=r),(i=i[0])===(n=n[0])?o[a]?o[a]+=n:o[++a]=n:(o[++a]=null,l.push({i:a,x:Ol(i,n)})),t=Yb.lastIndex;return t<e.length&&(r=e.slice(t),o[a]?o[a]+=r:o[++a]=r),o.length<2?l[0]?function Ik(s){return function(e){return s(e)+""}}(l[0].x):function Rk(s){return function(){return s}}(e):(e=l.length,function(c){for(var u,h=0;h<e;++h)o[(u=l[h]).i]=u.x(c);return o.join("")})}function ew(s,e){var t;return("number"==typeof e?Ol:e instanceof qu?Jx:(t=qu(e))?(e=t,Jx):Lk)(s,e)}function Fk(s){return function(){this.removeAttribute(s)}}function Bk(s){return function(){this.removeAttributeNS(s.space,s.local)}}function Nk(s,e,t){var i,r,n=t+"";return function(){var a=this.getAttribute(s);return a===n?null:a===i?r:r=e(i=a,t)}}function Uk(s,e,t){var i,r,n=t+"";return function(){var a=this.getAttributeNS(s.space,s.local);return a===n?null:a===i?r:r=e(i=a,t)}}function zk(s,e,t){var i,n,r;return function(){var a,l,o=t(this);return null==o?void this.removeAttribute(s):(a=this.getAttribute(s))===(l=o+"")?null:a===i&&l===n?r:(n=l,r=e(i=a,o))}}function Hk(s,e,t){var i,n,r;return function(){var a,l,o=t(this);return null==o?void this.removeAttributeNS(s.space,s.local):(a=this.getAttributeNS(s.space,s.local))===(l=o+"")?null:a===i&&l===n?r:(n=l,r=e(i=a,o))}}function Yk(s,e){var t,i;function n(){var r=e.apply(this,arguments);return r!==i&&(t=(i=r)&&function Gk(s,e){return function(t){this.setAttributeNS(s.space,s.local,e.call(this,t))}}(s,r)),t}return n._value=e,n}function jk(s,e){var t,i;function n(){var r=e.apply(this,arguments);return r!==i&&(t=(i=r)&&function Wk(s,e){return function(t){this.setAttribute(s,e.call(this,t))}}(s,r)),t}return n._value=e,n}function Xk(s,e){return function(){Ub(this,s).delay=+e.apply(this,arguments)}}function qk(s,e){return e=+e,function(){Ub(this,s).delay=e}}function Kk(s,e){return function(){bo(this,s).duration=+e.apply(this,arguments)}}function Jk(s,e){return e=+e,function(){bo(this,s).duration=e}}var mA=Hu.prototype.constructor;function tw(s){return function(){this.style.removeProperty(s)}}var PA=0;function qo(s,e,t,i){this._groups=s,this._parents=e,this._name=t,this._id=i}function iw(){return++PA}var $o=Hu.prototype;qo.prototype=function OA(s){return Hu().transition(s)}.prototype={constructor:qo,select:function hA(s){var e=this._name,t=this._id;"function"!=typeof s&&(s=Ob(s));for(var i=this._groups,n=i.length,r=new Array(n),a=0;a<n;++a)for(var h,u,o=i[a],l=o.length,c=r[a]=new Array(l),m=0;m<l;++m)(h=o[m])&&(u=s.call(h,h.__data__,m,o))&&("__data__"in h&&(u.__data__=h.__data__),c[m]=u,tf(c[m],e,t,m,c,Xa(h,t)));return new qo(r,this._parents,e,t)},selectAll:function uA(s){var e=this._name,t=this._id;"function"!=typeof s&&(s=hx(s));for(var i=this._groups,n=i.length,r=[],a=[],o=0;o<n;++o)for(var h,l=i[o],c=l.length,u=0;u<c;++u)if(h=l[u]){for(var p,m=s.call(h,h.__data__,u,l),_=Xa(h,t),g=0,f=m.length;g<f;++g)(p=m[g])&&tf(p,e,t,g,m,_);r.push(m),a.push(h)}return new qo(r,a,e,t)},selectChild:$o.selectChild,selectChildren:$o.selectChildren,filter:function sA(s){"function"!=typeof s&&(s=ux(s));for(var e=this._groups,t=e.length,i=new Array(t),n=0;n<t;++n)for(var l,r=e[n],a=r.length,o=i[n]=[],c=0;c<a;++c)(l=r[c])&&s.call(l,l.__data__,c,r)&&o.push(l);return new qo(i,this._parents,this._name,this._id)},merge:function rA(s){if(s._id!==this._id)throw new Error;for(var e=this._groups,t=s._groups,i=e.length,r=Math.min(i,t.length),a=new Array(i),o=0;o<r;++o)for(var m,l=e[o],c=t[o],h=l.length,u=a[o]=new Array(h),p=0;p<h;++p)(m=l[p]||c[p])&&(u[p]=m);for(;o<i;++o)a[o]=e[o];return new qo(a,this._parents,this._name,this._id)},selection:function pA(){return new mA(this._groups,this._parents)},transition:function kA(){for(var s=this._name,e=this._id,t=iw(),i=this._groups,n=i.length,r=0;r<n;++r)for(var l,a=i[r],o=a.length,c=0;c<o;++c)if(l=a[c]){var h=Xa(l,e);tf(l,s,t,c,a,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new qo(i,this._parents,s,t)},call:$o.call,nodes:$o.nodes,node:$o.node,size:$o.size,empty:$o.empty,each:$o.each,on:function lA(s,e){var t=this._id;return arguments.length<2?Xa(this.node(),t).on.on(s):this.each(function oA(s,e,t){var i,n,r=function aA(s){return(s+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})}(e)?Ub:bo;return function(){var a=r(this,s),o=a.on;o!==i&&(n=(i=o).copy()).on(e,t),a.on=n}}(t,s,e))},attr:function Vk(s,e){var t=Zp(s),i="transform"===t?mk:ew;return this.attrTween(s,"function"==typeof e?(t.local?Hk:zk)(t,i,Hb(this,"attr."+s,e)):null==e?(t.local?Bk:Fk)(t):(t.local?Uk:Nk)(t,i,e))},attrTween:function Zk(s,e){var t="attr."+s;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;var i=Zp(s);return this.tween(t,(i.local?Yk:jk)(i,e))},style:function vA(s,e,t){var i="transform"==(s+="")?uk:ew;return null==e?this.styleTween(s,function fA(s,e){var t,i,n;return function(){var r=Xd(this,s),a=(this.style.removeProperty(s),Xd(this,s));return r===a?null:r===t&&a===i?n:n=e(t=r,i=a)}}(s,i)).on("end.style."+s,tw(s)):"function"==typeof e?this.styleTween(s,function _A(s,e,t){var i,n,r;return function(){var a=Xd(this,s),o=t(this),l=o+"";return null==o&&(this.style.removeProperty(s),l=o=Xd(this,s)),a===l?null:a===i&&l===n?r:(n=l,r=e(i=a,o))}}(s,i,Hb(this,"style."+s,e))).each(function bA(s,e){var t,i,n,o,r="style."+e,a="end."+r;return function(){var l=bo(this,s),c=l.on,h=null==l.value[r]?o||(o=tw(e)):void 0;(c!==t||n!==h)&&(i=(t=c).copy()).on(a,n=h),l.on=i}}(this._id,s)):this.styleTween(s,function gA(s,e,t){var i,r,n=t+"";return function(){var a=Xd(this,s);return a===n?null:a===i?r:r=e(i=a,t)}}(s,i,e),t).on("end.style."+s,null)},styleTween:function wA(s,e,t){var i="style."+(s+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,function xA(s,e,t){var i,n;function r(){var a=e.apply(this,arguments);return a!==n&&(i=(n=a)&&function yA(s,e,t){return function(i){this.style.setProperty(s,e.call(this,i),t)}}(s,a,t)),i}return r._value=e,r}(s,e,t??""))},text:function CA(s){return this.tween("text","function"==typeof s?function TA(s){return function(){var e=s(this);this.textContent=e??""}}(Hb(this,"text",s)):function MA(s){return function(){this.textContent=s}}(null==s?"":s+""))},textTween:function SA(s){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==s)return this.tween(e,null);if("function"!=typeof s)throw new Error;return this.tween(e,function EA(s){var e,t;function i(){var n=s.apply(this,arguments);return n!==t&&(e=(t=n)&&function DA(s){return function(e){this.textContent=s.call(this,e)}}(n)),e}return i._value=s,i}(s))},remove:function dA(){return this.on("end.remove",function cA(s){return function(){var e=this.parentNode;for(var t in this.__transition)if(+t!==s)return;e&&e.removeChild(this)}}(this._id))},tween:function gk(s,e){var t=this._id;if(s+="",arguments.length<2){for(var a,i=Xa(this.node(),t).tween,n=0,r=i.length;n<r;++n)if((a=i[n]).name===s)return a.value;return null}return this.each((null==e?pk:fk)(t,s,e))},delay:function $k(s){var e=this._id;return arguments.length?this.each(("function"==typeof s?Xk:qk)(e,s)):Xa(this.node(),e).delay},duration:function Qk(s){var e=this._id;return arguments.length?this.each(("function"==typeof s?Kk:Jk)(e,s)):Xa(this.node(),e).duration},ease:function tA(s){var e=this._id;return arguments.length?this.each(function eA(s,e){if("function"!=typeof e)throw new Error;return function(){bo(this,s).ease=e}}(e,s)):Xa(this.node(),e).ease},easeVarying:function nA(s){if("function"!=typeof s)throw new Error;return this.each(function iA(s,e){return function(){var t=e.apply(this,arguments);if("function"!=typeof t)throw new Error;bo(this,s).ease=t}}(this._id,s))},end:function AA(){var s,e,t=this,i=t._id,n=t.size();return new Promise(function(r,a){var o={value:a},l={value:function(){0==--n&&r()}};t.each(function(){var c=bo(this,i),h=c.on;h!==s&&((e=(s=h).copy())._.cancel.push(o),e._.interrupt.push(o),e._.end.push(l)),c.on=e}),0===n&&r()})},[Symbol.iterator]:$o[Symbol.iterator]};var IA={time:null,delay:0,duration:250,ease:function RA(s){return((s*=2)<=1?s*s*s:(s-=2)*s*s+2)/2}};function LA(s,e){for(var t;!(t=s.__transition)||!(t=t[e]);)if(!(s=s.parentNode))throw new Error(`transition ${e} not found`);return t}Hu.prototype.interrupt=function ck(s){return this.each(function(){!function lk(s,e){var i,n,a,t=s.__transition,r=!0;if(t){for(a in e=null==e?null:e+"",t)(i=t[a]).name===e?(n=i.state>2&&i.state<5,i.state=6,i.timer.stop(),i.on.call(n?"interrupt":"cancel",s,s.__data__,i.index,i.group),delete t[a]):r=!1;r&&delete s.__transition}}(this,s)})},Hu.prototype.transition=function FA(s){var e,t;s instanceof qo?(e=s._id,s=s._name):(e=iw(),(t=IA).time=Lb(),s=null==s?null:s+"");for(var i=this._groups,n=i.length,r=0;r<n;++r)for(var l,a=i[r],o=a.length,c=0;c<o;++c)(l=a[c])&&tf(l,s,e,c,a,t||LA(l,e));return new qo(i,this._parents,s,e)};Math;function $u(s){return{type:s}}function yo(s){return"string"==typeof s?new ua([[document.querySelector(s)]],[document.documentElement]):new ua([[s]],Mx)}function Qd(s,e,t){this.k=s,this.x=e,this.y=t}["w","e"].map($u),["n","s"].map($u),["n","w","e","s","nw","ne","sw","se"].map($u),Qd.prototype={constructor:Qd,scale:function(s){return 1===s?this:new Qd(this.k*s,this.x,this.y)},translate:function(s,e){return 0===s&0===e?this:new Qd(this.k,this.x+this.k*s,this.y+this.k*e)},apply:function(s){return[s[0]*this.k+this.x,s[1]*this.k+this.y]},applyX:function(s){return s*this.k+this.x},applyY:function(s){return s*this.k+this.y},invert:function(s){return[(s[0]-this.x)/this.k,(s[1]-this.y)/this.k]},invertX:function(s){return(s-this.x)/this.k},invertY:function(s){return(s-this.y)/this.k},rescaleX:function(s){return s.copy().domain(s.range().map(this.invertX,this).map(s.invert,s))},rescaleY:function(s){return s.copy().domain(s.range().map(this.invertY,this).map(s.invert,s))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new Qd(1,0,0);var xo=function(s){return s[s.dialog=0]="dialog",s[s.hover=1]="hover",s[s.redirect=2]="redirect",s[s.url=3]="url",s}(xo||{}),uf=function(s){return s[s.motion=0]="motion",s[s.conditional=1]="conditional",s}(uf||{}),eh=function(s){return s.GT=">",s.LT="<",s.E="=",s.between0=">>",s.between1="<<",s}(eh||{}),KA=V(9286),$b=V(7560),$a=V(3005);const JA=["Host"];function QA(s,e){}let cw=(()=>{class s{constructor(t){this.componentName=t.componentName,this.componentConfig=t.config}ngAfterViewInit(){this.drawComponent()}drawComponent(){const t=vC[this.componentName],i=this.host;i.clear();const n=i.createComponent(t);n.instance.config=this.componentConfig,n.instance.id=this.componentName}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36($a.WI))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-action-dialog"]],viewQuery:function(i,n){if(1&i&&d.Gf(JA,7,d.s_b),2&i){let r;d.iGM(r=d.CRH())&&(n.host=r.first)}},decls:4,vars:0,consts:[[1,"grid-item-container"],[1,"grid-item-content"],["Host",""]],template:function(i,n){1&i&&(d.TgZ(0,"div",0)(1,"div",1),d.YNc(2,QA,0,0,"ng-template",null,2,d.W1O),d.qZA()())},styles:["*[_ngcontent-%COMP%]{transition:.5s}.grid-item-container[_ngcontent-%COMP%]{background-color:#5d5c61;display:flex;align-items:center;justify-content:center;margin:0;padding:0;width:100%;height:100%;overflow-y:hidden;position:relative}.grid-item-container[_ngcontent-%COMP%]:hover   .action-bar[_ngcontent-%COMP%]{top:0}.grid-item-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#fff}.grid-item-content[_ngcontent-%COMP%]{background-color:#5d5c61;width:100%;height:100%;padding:.5rem}"]})}return s})(),dw=(()=>{class s{constructor(t,i){this.sanitizer=i,this.Url=this.sanitizer.bypassSecurityTrustResourceUrl(t.url)}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36($a.WI),d.Y36(W.H7))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-link-dialog"]],decls:2,vars:1,consts:[[1,"container"],[3,"src"]],template:function(i,n){1&i&&(d.TgZ(0,"div",0),d._UZ(1,"iframe",1),d.qZA()),2&i&&(d.xp6(1),d.Q6J("src",n.Url,d.uOi))},styles:[".container[_ngcontent-%COMP%], iframe[_ngcontent-%COMP%]{width:100%;height:100%}"]})}return s})();var th=V(2939);let eP=(()=>{class s{constructor(t,i,n){this.transmit=t,this.http=i,this.router=n,this.tokenKey="token",this.baseUrl=Na.N.API_BASE,this.httpTransferData={upload:0,download:0}}setBaseUrl(t){this.baseUrl=t}send(t){if(!t)return;void 0===t.reportProgress&&(t.reportProgress=!1),t.headers||(t.headers={}),("POST"===t.method||"PUT"===t.method)&&!t.body&&(t.body=t.params,t.params={}),("GET"===t.method||"DELETE"===t.method)&&!t.params&&(t.params=t.body,t.body={}),t.params||(t.params={}),t.method||(t.method="GET"),t.reportProgress&&!t.contentType&&(t.contentType="multipart/form-data"),t.contentType||(t.contentType="application/json"),this.httpTransferData.upload+=this.lengthInUtf8Bytes(JSON.stringify(t)),t.path.length>0&&!t.path.startsWith("/")&&(t.path="/"+t.path);let i=this.baseUrl;t.baseUrl&&(i=t.baseUrl),i+=t.path,!t.noAuth&&this.getToken()&&(t.headers.Authorization=`Bearer ${this.getToken()}`),t.contentType&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]=t.contentType),void 0===t.responseType&&(t.responseType="json"),t.headers["XX-Skip-Interceptor"]="";const n=new th.WM(t.headers);let r;if(("GET"===t.method||"DELETE"===t.method)&&t.params&&Object.keys(t.params).length>0){let o=[];for(const l in t.params){let c=encodeURIComponent(t.params[l]);o.push(`${l}=${c}`)}i+=`?${o.join("&")}`}("POST"===t.method||"PUT"===t.method||"PATCH"===t.method)&&(t.formData?t.body=t.formData:"application/json"===t.contentType&&(t.body=JSON.stringify(t.body)));let a={headers:n,reportProgress:t.reportProgress};return t.responseType&&(a.responseType=t.responseType),t.observe&&(a.observe=t.observe),"POST"===t.method?r=this.http.post(i,t.body,{...a}):"PUT"===t.method?r=this.http.put(i,t.body,{...a}):"DELETE"===t.method?r=this.http.delete(i,{...a}):"PATCH"===t.method?r=this.http.patch(i,t.body,{...a}):"GET"===t.method&&(r=this.http.get(i,{...a})),r}fetchJson(t,i){var n=this;return(0,On.Z)(function*(){return i||(i={}),void 0===i.redirectIf401&&(i.redirectIf401=!0),void 0===i.showPageLoading&&(i.showPageLoading=!0),void 0===i.toastErrorMessage&&(i.toastErrorMessage=!0),i.showPageLoading&&n.transmit.emit("page-loading",!0),new Promise(r=>{const a=n.send(t)?.subscribe({next:o=>{a?.unsubscribe(),"string"==typeof o&&(o=JSON.parse(o)),n.httpTransferData.download+=n.lengthInUtf8Bytes(JSON.stringify(o)),i?.showPageLoading&&n.transmit.emit("page-loading",!1),o.status=200,o.success=!0,r(o)},error:(o=(0,On.Z)(function*(l){if(a?.unsubscribe(),i?.showPageLoading&&n.transmit.emit("page-loading",!1),!l)return n.lastStatusCode=404,r({data:null,message:"HTTP_404_NOT_FOUND",status:n.lastStatusCode,success:!1});const c=l.status||404;let h=l?.error.message??l.message;if(h||(h=l.statusText??"Http Error"),n.httpTransferData.download+=n.lengthInUtf8Bytes(JSON.stringify(l)),n.lastStatusCode=c,401===c){if(i?.redirectIf401&&!n.getToken(!0))return n.clearLocalStorageAndNavigateToLogin(),r({data:null,message:"unauthorized",status:n.lastStatusCode,success:!1});if(n.getToken(!0)&&!(yield n.renewToken()))return n.lastStatusCode=401,i?.redirectIf401&&n.clearLocalStorageAndNavigateToLogin(),r({data:null,message:"unauthorized",status:n.lastStatusCode,success:!1})}i?.toastErrorMessage&&n.transmit.emit("snackbar-message",{text:c+" - "+h,mode:"error"}),r({data:null,message:h,status:c,success:!1})}),function(c){return o.apply(this,arguments)}),complete:()=>{a?.unsubscribe()}});var o})})()}fetchJsonSuccessResult(t,i,n){var r=this;return(0,On.Z)(function*(){const a=yield r.fetchJson(t,n);return 200===a.status?a.data?a.data:a:i})()}downloadFile(t,i,n=!0){var r=this;return(0,On.Z)(function*(){return t.responseType="blob",new Promise(a=>{n&&r.transmit.emit("page-loading",!0);const o=r.send(t)?.subscribe({next:l=>{o?.unsubscribe(),r.httpTransferData.download+=r.lengthInUtf8Bytes(JSON.stringify(l)),n&&r.transmit.emit("page-loading",!1);const c=URL.createObjectURL(l),h=document.createElement("a");h.href=c,h.setAttribute("download",i),document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(c),a(!0)},error:l=>{if(o?.unsubscribe(),!l)return r.lastStatusCode=404,a(!1);r.httpTransferData.download+=r.lengthInUtf8Bytes(JSON.stringify(l)),r.lastStatusCode=l?.status||404,n&&r.transmit.emit("page-loading",!1),a(!1)},complete:()=>{o?.unsubscribe()}})})})()}getToken(t=!1){const i=localStorage.getItem(this.tokenKey);if(i)try{return JSON.parse(i)[t?"refreshToken":"accessToken"]}catch{return}}clearLocalStorageAndNavigateToLogin(){localStorage.clear(),sessionStorage.clear(),this.router.navigate(["auth/login"])}renewToken(){return(0,On.Z)(function*(){return!1})()}lengthInUtf8Bytes(t){var i=encodeURIComponent(t).match(/%[89ABab]/g);return t.length+(i?i.length:0)}static#e=this.\u0275fac=function(i){return new(i||s)(d.LFG(qt.U),d.LFG(th.eN),d.LFG(_e.F0))};static#t=this.\u0275prov=d.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})(),hw=(()=>{class s{constructor(t,i,n){this.http=t,this.sharedStore=i,this.httpService=n,this.baseUrl=Na.N.API_BASE_REPOSITORY}getFileUrl(t){return this.http.get(`${this.baseUrl}/v1/file/load/${t}`)}getFileUrlV2(t){var i=this;return(0,On.Z)(function*(){return yield i.httpService.fetchJsonSuccessResult({baseUrl:i.baseUrl,path:`v1/file/load/${t}`},{message:"ERROR",url:{error:"bad request"}})})()}getFile(t){const i=new th.WM({"X-Skip-Interceptor":"",responseType:"text, image/svg+xml",accept:"image/svg+xml"});return i.delete("Authorization"),this.http.get(t,{headers:i})}getPreviewFile(t){const i=new th.WM({"X-Skip-Interceptor":"",responseType:"text, image/svg+xml",accept:"image/svg+xml"});return i.delete("Authorization"),this.http.get(`https://stageapi.i4twins.com/repository-management/v1/file/load/preview/${t}`,{headers:i})}static#e=this.\u0275fac=function(i){return new(i||s)(d.LFG(th.eN),d.LFG(Ie.yh),d.LFG(eP))};static#t=this.\u0275prov=d.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var uw=V(4852);let tP=(()=>{class s{get svg(){return this._svg}constructor(t,i,n,r,a,o,l){this.sanitizer=t,this.uploadService=i,this.socketService=n,this.dialog=r,this.store=a,this.dashboardService=o,this.sharedStore=l,this._svg="",this.Action=xo,this.Animation=uf,this.unsubscribe$=new gi.x,this.backgroundStyle={background:"transparent"}}ngOnInit(){this.config.backgroundColor&&(this.backgroundStyle={background:this.config.backgroundColor}),this.store.select(ce.K8).pipe((0,Di.q)(1),(0,Eb.z)(t=>this.config.background?t?this.uploadService.getPreviewFile(this.config.background).pipe((0,Di.q)(1),(0,ri.U)(i=>i.url.url),(0,Pb.z)(i=>this.uploadService.getFile(i).pipe((0,$b.K)(n=>{if(200===n.status){const o=(new DOMParser).parseFromString(n.error.text,"text/html").getElementsByTagName("svg")[0];o&&this.addBackground(o)}return(0,D.of)(n)}),(0,he.R)(this.unsubscribe$))),(0,he.R)(this.unsubscribe$)):this.uploadService.getFileUrl(this.config.background).pipe((0,Di.q)(1),(0,ri.U)(i=>i.url.url),(0,Pb.z)(i=>this.uploadService.getFile(i).pipe((0,$b.K)(n=>{if(200===n.status){const o=(new DOMParser).parseFromString(n.error.text,"text/html").getElementsByTagName("svg")[0];o&&this.addBackground(o)}return(0,D.of)(n)}),(0,he.R)(this.unsubscribe$))),(0,he.R)(this.unsubscribe$)):(0,D.of)())).subscribe()}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}addBackground(t){const n=(new XMLSerializer).serializeToString(t);this._svg=this.sanitizer.bypassSecurityTrustHtml(n);let r=t.id;setTimeout(()=>{this.applyConfig(r)},500)}applyConfig(t){const i=yo(t?`#${t}`:"svg");this.applyEmbedLabels(this.config.labels.embed),this.config.labels.dynamic.forEach(o=>this.addDynamicLabel(i,o)),this.applyShapes(this.config.shapes)}applyShapes(t){t.forEach(i=>{this.applyShapeConfig(i),i.animation?.type&&this.applyAnimation(i.animation,i.elementId),i.action&&this.applyAction(i.action,i.elementId)})}applyEmbedLabels(t){t.forEach(i=>{yo(`#${i.id}`)&&(this.applyTextConfig(i.text),this.applyShapeConfig(i.shape),i.animation?.type&&this.applyAnimation(i.animation,i.shape.elementId))})}applyAction(t,i){t.type===xo.dialog?yo(`#${i}`).on("click",()=>{this.dialog.open(cw,{width:"60%",height:"60%",panelClass:"HMI-Dialog",data:{componentName:t.component,config:t.config}})}).style("cursor","pointer"):t.type===xo.url?yo(`#${i}`).on("click",()=>{this.dialog.open(dw,{width:"60%",height:"60%",panelClass:"HMI-Dialog",data:{url:t.url}})}).style("cursor","pointer"):t.type===xo.redirect&&yo(`#${i}`).on("click",()=>{t.dashboard&&this.store.select((0,ze.Et)(t.dashboard)).pipe((0,Di.q)(1),(0,Ei.w)(n=>this.sharedStore.select(ce.K8).pipe((0,Di.q)(1),(0,ri.U)(r=>{t.dashboard&&this.store.dispatch(n?(0,Gi.Fi)({dashboard:n}):(0,Gi.bu)({dashboardId:t.dashboard,isPreview:r}))})))).subscribe()}).style("cursor","pointer")}applyAnimation(t,i){const n=yo(`#${i}`);let r,a,o=i.slice(6);isNaN(+o)||(o="label_"+(JSON.parse(o)+1),a=yo(`#${o}`),r=a.text());let c,l=n.attr("fill"),h=t.color;("#FFFFFF"===l||"#ffffff"===l)&&(l="transparent"),t.type===uf.motion?this.blink(t.duration,n,l,h).subscribe():t.type===uf.conditional&&t.topic&&t.output&&this.socketService.fetchDeviceData(t.topic.id,t.output.name).pipe((0,ri.U)(u=>{u&&t.output&&h&&("string"==typeof u&&(u=JSON.parse(u)),t.condition===eh.E?u!=t.value||c?(c&&u!=t.value&&(c.unsubscribe(),c=void 0),a&&r&&a.text(r),n.attr("fill",l)):t.duration?c=this.blink(t.duration,n,l,h).subscribe():(a&&t.text&&a.text(t.text),n.attr("fill",h)):t.condition===eh.LT?n.attr("fill",u<(t.value||0)?h||"#ffffff":l):t.condition===eh.GT?n.attr("fill",u>(t.value||0)?h||"#ffffff":l):t.condition===eh.between0?n.attr("fill",(t.value||0)>u&&u>(t.otherValue||0)?h||"#ffffff":l):t.condition===eh.between1&&n.attr("fill",(t.value||0)<u&&u<(t.otherValue||0)?h||"#ffffff":l))}),(0,he.R)(this.unsubscribe$)).subscribe()}applyShapeConfig(t){if(t.elementId){const i=yo(`#${t.elementId}`);for(const n in t.view)i.attr(n,t.view[n]);("circle"===t.shape||"ellipse"===t.shape)&&(i.attr("cx",t.view.x),i.attr("cy",t.view.y))}}applyTextConfig(t){const i=yo(`#${t.elementId}`),n=t.view;for(const a in n)i.attr(a,n[a]);i.attr("text-anchor","middle").attr("alignment-baseline","middle");const r=t.content;i.text(r.dynamic.output?.name||r.label),r.dynamic.topic&&r.dynamic.output?.name&&this.socketService.fetchDeviceData(r.dynamic.topic.id,r.dynamic.output.name).pipe((0,ri.U)(a=>{i.text(a)}),(0,he.R)(this.unsubscribe$)).subscribe()}addDynamicLabel(t,i){const n=t.append("g").attr("id",i.id);this.addLabel(n,i.text.elementId,i.shape.shape,i.shape.elementId),this.applyTextConfig(i.text),this.applyShapeConfig(i.shape),i.animation?.type&&this.applyAnimation(i.animation,i.shape.elementId),i.action&&this.applyAction(i.action,i.id)}addLabel(t,i,n,r){t.append(n).attr("id",r),t.append("text").attr("id",i)}blink(t=0,i,n,r){return(0,Ab.F)(2*t).pipe((0,Zn.b)(()=>{i.attr("fill",r||n)}),(0,KA.g)(t),(0,Zn.b)(()=>{i.attr("fill",n)}),(0,he.R)(this.unsubscribe$))}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(W.H7),d.Y36(hw),d.Y36(Yr.l),d.Y36($a.uw),d.Y36(Ie.yh),d.Y36(uw.s),d.Y36(Ie.yh))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-hmi"]],inputs:{config:"config",id:"id"},decls:1,vars:3,consts:[["id","hmi-main",3,"innerHTML"]],template:function(i,n){1&i&&d._UZ(0,"main",0),2&i&&(d.Akn(n.backgroundStyle),d.Q6J("innerHTML",n.svg,d.oJD))},styles:["main[_ngcontent-%COMP%]{width:100%;height:100%}"]})}return s})();var Xr=V(6125),Ku=V(8675),Rl=V(5735),mf=V(9742);function iP(s,e){1&s&&(d.TgZ(0,"mat-form-field",7)(1,"mat-icon",8),d._uU(2,"search"),d.qZA(),d._UZ(3,"input",9),d.qZA())}function nP(s,e){if(1&s){const t=d.EpF();d.TgZ(0,"th")(1,"mat-checkbox",4),d.NdJ("change",function(n){const a=d.CHM(t).$implicit,o=d.oxw();return d.KtG(o.onSelectTopic(n,a.id))}),d.qZA()()}if(2&s){const t=e.$implicit,i=d.oxw();d.xp6(1),d.Q6J("checked",i.isTopicSelected(t.id))}}function sP(s,e){if(1&s&&(d.TgZ(0,"td"),d._uU(1),d.qZA()),2&s){const t=e.$implicit,i=d.oxw().$implicit;d.xp6(1),d.Oqu(t.values[i.key])}}function rP(s,e){if(1&s&&(d.TgZ(0,"tr")(1,"td",10),d._uU(2),d.qZA(),d.YNc(3,sP,2,1,"td",11),d.qZA()),2&s){const t=e.$implicit,i=d.oxw();d.xp6(2),d.Oqu(t.value),d.xp6(1),d.Q6J("ngForOf",i.topics)("ngForTrackBy",i.trackData)}}function aP(s,e){1&s&&(d.TgZ(0,"div",12)(1,"mat-label"),d._uU(2,"item per page"),d.qZA(),d.TgZ(3,"div",13)(4,"mat-select",14)(5,"mat-option",14),d._uU(6,"5"),d.qZA(),d.TgZ(7,"mat-option",14),d._uU(8,"10"),d.qZA(),d.TgZ(9,"mat-option",14),d._uU(10,"25"),d.qZA(),d.TgZ(11,"mat-option",14),d._uU(12,"100"),d.qZA()()(),d.TgZ(13,"mat-label"),d._uU(14," page 1 of 1"),d.qZA()()),2&s&&(d.xp6(4),d.Q6J("value",5),d.xp6(1),d.Q6J("value",5),d.xp6(2),d.Q6J("value",10),d.xp6(2),d.Q6J("value",25),d.xp6(2),d.Q6J("value",100))}let oP=(()=>{class s{isTopicSelected(t){return this.selectedTopics.includes(t)}get isAllTopicsSelected(){return this.topics.map(i=>i.id).every(i=>this.selectedTopics.includes(i))}constructor(t,i,n){this.store=t,this.dialog=i,this.socketService=n,this.topics=[],this.selectedTopics=[],this.borderConfig={BorderWidth:3,BorderRadius:12,BorderColor:"#FFFFFF"},this.headerBackgroundColor="#6F90D5",this.headerColor="#FFFFFF",this.bodyColor="#000000",this.rowColor="#000000",this.labelColor="#0A0A0A",this.Search=!0,this.Select=!0,this.Paginator=!0,this.No=!0,this.Action=!0,this.Label="Label",this.titles=[],this.unsubscribe$=new gi.x,this.rawData={}}ngOnInit(){const i=this.config.content,n=i.map(a=>({key:a.outputs.read.name,value:a.Equivalent}));this.titles=n;let r={};n.forEach(a=>{r={...r,[a.key]:0}}),this.topics=i[0].topic.map(a=>({id:a.id,name:a.name,values:{\u062f\u0633\u062a\u06af\u0627\u0647:a.name,...r}})),this.store.dispatch((0,Gi.Pg)({devices:this.topics.map(a=>a.id)})),this.applyContent(this.config.content),this.applyView(this.config.view)}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}applyContent(t){this.selectedTopics=t[0].topic.map(i=>i.id),this.store.dispatch((0,Gi.Pg)({devices:this.topics.map(i=>i.id)})),this.topics.forEach(i=>{this.socketService.fetchDeviceAllData(i.id).pipe((0,ri.U)(n=>{this.titles.forEach(r=>{n[r.key]?i.values[r.value]=n[r.key]:i.values[i.name][r.value]="-"})}),(0,he.R)(this.unsubscribe$)).subscribe()})}trackData(t,i){return`${i.id}`}applyView(t){this.borderConfig=t.Border,this.headerColor=t.Content.HeaderColor,this.bodyColor=t.Content.BodyColor,this.headerBackgroundColor=t.Chart.HeaderColor,this.rowColor=t.Chart.RowColor,this.Search=t.Chart.Search,this.Paginator=t.Chart.Pagination,this.No=t.Chart.No,this.Action=t.Chart.Action,this.Label=t.Labels.Title}onSelectAll(t){this.selectedTopics=t.checked?this.topics.map(i=>i.id):[],this.store.dispatch((0,Gi.Pg)({devices:this.topics.map(i=>i.id)}))}onSelectTopic(t,i){t.checked?this.selectedTopics.push(i):this.selectedTopics=this.selectedTopics.filter(n=>i!==n),this.store.dispatch((0,Gi.Pg)({devices:this.selectedTopics}))}onSimulation(t){}onReport(t){}onTrip(t){}onEIO(t){}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(Ie.yh),d.Y36($a.uw),d.Y36(Yr.l))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-linked-table"]],inputs:{id:"id",config:"config"},decls:15,vars:6,consts:[[1,"container"],[1,"table-action-bar"],["appearance","outline",4,"ngIf"],[1,"table-wrapper"],[3,"checked","change"],[4,"ngFor","ngForOf"],["class","paginator",4,"ngIf"],["appearance","outline"],["matPrefix",""],["matInput","","placeholder","Search"],[1,"main-title"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"paginator"],[1,"options"],[3,"value"]],template:function(i,n){1&i&&(d.TgZ(0,"div",0)(1,"div",1)(2,"label"),d._uU(3),d.qZA(),d.YNc(4,iP,4,0,"mat-form-field",2),d.qZA(),d.TgZ(5,"div",3)(6,"table")(7,"thead")(8,"tr")(9,"th")(10,"mat-checkbox",4),d.NdJ("change",function(a){return n.onSelectAll(a)}),d.qZA()(),d.YNc(11,nP,2,1,"th",5),d.qZA()(),d.TgZ(12,"tbody"),d.YNc(13,rP,4,3,"tr",5),d.qZA()(),d.YNc(14,aP,15,5,"div",6),d.qZA()()),2&i&&(d.xp6(3),d.Oqu(n.Label),d.xp6(1),d.Q6J("ngIf",n.Search),d.xp6(6),d.Q6J("checked",n.isAllTopicsSelected),d.xp6(1),d.Q6J("ngForOf",n.topics),d.xp6(2),d.Q6J("ngForOf",n.titles),d.xp6(1),d.Q6J("ngIf",n.Paginator))},dependencies:[x.sg,x.O5,jn.Hw,Xr.KE,Xr.hX,Xr.qo,Ku.gD,R.ey,Rl.Nt,mf.oG],styles:[".container[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden;display:grid;grid-template-rows:1fr 11fr;border:1px solid #FFFFFF;border-radius:.5rem}.container[_ngcontent-%COMP%]   .table-action-bar[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;justify-content:flex-end;gap:.5rem}.table-wrapper[_ngcontent-%COMP%]{overflow:auto;width:100%;height:100%}table[_ngcontent-%COMP%]{width:100%;height:100%;border-collapse:collapse;direction:rtl}thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:100;border-bottom:1px solid #ddd;background-color:#6f90d5;text-align:center;color:#fff}thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{border-radius:0 5px 0 0;text-align:start}thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{border-radius:5px 0 0}.paginator[_ngcontent-%COMP%]{width:100%;display:flex;flex-wrap:wrap;align-items:center;justify-content:flex-start;gap:1rem;position:sticky;bottom:0;z-index:100;background-color:#f7f7f7;padding:.5rem}.options[_ngcontent-%COMP%]{border:solid thin #eeeeee;width:20%}tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:1px solid #ddd;border-top:1px solid #ddd;text-align:center}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{text-align:center;padding:.2rem;background-color:#fff}td[_ngcontent-%COMP%]   .unit[_ngcontent-%COMP%], th[_ngcontent-%COMP%]   .unit[_ngcontent-%COMP%]{font-size:.75em}.main-title[_ngcontent-%COMP%]{background-color:#6f90d5;color:#0a0a0a;text-align:start!important}.mat-checkbox[_ngcontent-%COMP%]   .mat-checkbox-frame[_ngcontent-%COMP%], .mat-checkbox-checked[_ngcontent-%COMP%]   .mat-checkbox-background[_ngcontent-%COMP%]{transform:scale(2)}label[_ngcontent-%COMP%]{color:#0a0a0a;font-size:1.25em}"]})}return s})();var lP=V(7462),mw=V(8004);let pf=(()=>{class s{constructor(t){this.http=t,this.url=Na.N.API_BASE_REPOSITORY}submitForm(t,i){return i.deviceId||(i={...i,deviceId:"kn6r4fpx8yr"}),this.http.post(`${this.url}/v1/fixedformfilling`,{formId:t,values:i})}static#e=this.\u0275fac=function(i){return new(i||s)(d.LFG(th.eN))};static#t=this.\u0275prov=d.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();const cP=["sliderElement"],pw=function(s,e){return{"background-color":s,color:e}};function dP(s,e){if(1&s){const t=d.EpF();d.TgZ(0,"button",9),d.NdJ("click",function(){d.CHM(t);const n=d.oxw();return d.KtG(n.stepUp())}),d._uU(1," + "),d.qZA()}if(2&s){const t=d.oxw();d.Q6J("ngStyle",d.WLB(2,pw,t.config.view.Button.btnBgColor,t.config.view.Button.btnColor))("disabled",!t.isRemote)}}function hP(s,e){if(1&s){const t=d.EpF();d.TgZ(0,"button",10),d.NdJ("click",function(){d.CHM(t);const n=d.oxw();return d.KtG(n.stepDown())}),d._uU(1," - "),d.qZA()}if(2&s){const t=d.oxw();d.Q6J("ngStyle",d.WLB(2,pw,t.config.view.Button.btnBgColor,t.config.view.Button.btnColor))("disabled",!t.isRemote)}}let uP=(()=>{class s{get isRemote(){return this._isRemote}constructor(t,i,n,r){this.socketService=t,this.formService=i,this.store=n,this.formBuilder=r,this.title="Title",this.unsubscribe$=new gi.x,this.value=0,this._isRemote=!1,this.sliderValue$=new ss.X(-1),this.filterPips=(a,o)=>0===o?-1:a%this.config.view.Ticks.bigLabelStep==0?1:a%this.config.view.Ticks.smallLabelStep==0?2:this.config.view.Ticks.showTicksBetweenLabels?0:-1,this.setRangeColor=a=>{this.sliderElement.nativeElement.querySelector(".noUi-connect").style.backgroundColor=a}}ngOnInit(){this.generateForm()}ngAfterViewInit(){this.checkFieldValue(),this.submitValue(),this.createSlider(this.config),this.store.select(ze.Gt).pipe((0,ri.U)(t=>{t?this.sliderForm.controls.value.enable():this.sliderForm.controls.value.disable(),this.slider&&(t?this.slider.enable():this.slider.disable()),this._isRemote=t}),(0,he.R)(this.unsubscribe$)).subscribe()}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete(),this.slider&&this.slider.destroy()}generateForm(){this.sliderForm=this.formBuilder.group({value:[0]})}createSlider(t){this.slider&&this.slider.destroy(),this.slider=lP.create(this.sliderElement.nativeElement,{start:0,step:t.content?.step||5,connect:"lower",direction:"rtl",range:{min:t.content?.min||0,max:t.content?.max||100},tooltips:t.view.Chart.showTooltip||!1,orientation:"vertical",pips:this.config.view.Ticks.showTicks?{mode:"steps",filter:this.filterPips}:void 0}),this.setRangeColor(this.config.view.Chart.color),this.slider.on("end",o=>{this.value!==+o[0]&&(this.value=+o[0],this.updateSlider())});const i=document.querySelector(".noUi-handle"),n=document.getElementById("slider"),r=i?.offsetWidth/n.offsetWidth*100,a=i?.offsetHeight/n.offsetHeight*100;n?.style.setProperty("--noui-handle-width-percentage",`${r}%`),n?.style.setProperty("--noui-handle-height-percentage",`${a}%`),t.content?.topic?.id&&t.content?.outputs?.read.name&&(this.deviceId=t.content.topic.id,this.output=t.content.outputs.write.name,this.socketService.fetchDeviceData(t.content.topic.id,t.content.outputs.read.name).pipe((0,ri.U)(o=>{"string"==typeof o&&(o=parseInt(o)),o!==this.value&&(this.value=o,this.slider.set(o),this.sliderForm.controls.value.setValue(o))}),(0,he.R)(this.unsubscribe$)).subscribe()),this.listenOnRangeChange()}listenOnRangeChange(){this.slider.on("update.one",t=>{const i=parseInt(t[0]);i!==this.value&&(this.value=i,this.sliderForm.controls.value.setValue(this.value),this.sliderValue$.next(this.value))})}stepUp(){this.config.content&&this.value>=this.config.content.max||this.config.content&&(this.value+=this.config.content.step,this.updateSlider())}stepDown(){this.config.content&&this.value<=this.config.content.min||this.config.content&&(this.value-=this.config.content.step,this.updateSlider())}checkFieldValue(){this.sliderForm.controls.value.valueChanges.pipe((0,he.R)(this.unsubscribe$),(0,au.b)(300),(0,mw.x)(),(0,ri.U)(t=>{(t=this.checkValueValidation(t))!==this.value&&(this.value=t,this.updateSlider())})).subscribe()}submitValue(){this.sliderValue$.pipe((0,au.b)(500),(0,mw.x)(),(0,Ei.w)(t=>t>0?this.formService.submitForm("__FIXEDFORM__432125517577425",{deviceId:this.deviceId,[this.output]:t}):(0,D.of)(null))).subscribe()}updateSlider(){this.slider.set(this.value),this.sliderForm.controls.value.setValue(this.value),this.sliderValue$.next(this.value)}checkValueValidation(t){return this.config.content&&(t>this.config.content.max&&(t=this.config.content.max),t<this.config.content.min&&(t=this.config.content.min)),t}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(Yr.l),d.Y36(pf),d.Y36(Ie.yh),d.Y36(A.qu))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-slider"]],viewQuery:function(i,n){if(1&i&&d.Gf(cP,5),2&i){let r;d.iGM(r=d.CRH())&&(n.sliderElement=r.first)}},inputs:{id:"id",config:"config"},decls:10,vars:5,consts:[[1,"slider-container"],[1,"range-slider-cmp-container","w-100","h-100"],["class","range-action-btn",3,"ngStyle","disabled","click",4,"ngIf"],["id","slider",1,"slider"],["sliderElement",""],["class","range-action-btn mt-4",3,"ngStyle","disabled","click",4,"ngIf"],[3,"formGroup"],["type","text","formControlName","value",1,"value-box",3,"disabled"],[1,"text-center","m-0"],[1,"range-action-btn",3,"ngStyle","disabled","click"],[1,"range-action-btn","mt-4",3,"ngStyle","disabled","click"]],template:function(i,n){1&i&&(d.TgZ(0,"div",0)(1,"div",1),d.YNc(2,dP,2,5,"button",2),d._UZ(3,"div",3,4),d.YNc(5,hP,2,5,"button",5),d.TgZ(6,"form",6),d._UZ(7,"input",7),d.qZA(),d.TgZ(8,"h2",8),d._uU(9),d.qZA()()()),2&i&&(d.xp6(2),d.Q6J("ngIf",n.config.view.Button.showButtons),d.xp6(3),d.Q6J("ngIf",n.config.view.Button.showButtons),d.xp6(1),d.Q6J("formGroup",n.sliderForm),d.xp6(1),d.Q6J("disabled",!n.isRemote),d.xp6(2),d.Oqu(n.config.view.Labels.title))},dependencies:[x.O5,x.PC,A._Y,A.Fj,A.JJ,A.JL,A.sg,A.u],styles:[".slider-container{width:100%;height:100%;border:1px solid #FFFFFF;border-radius:.5rem}.range-slider-cmp-container{width:100%;height:100%}.range-slider-cmp-container .range-action-btn{width:25px;height:25px;background-color:#c5c5c5;border:1px solid #909090;border-radius:50%;display:flex;justify-content:center;align-items:center;margin:auto;font-size:18px}.range-slider-cmp-container #slider{margin:1rem auto;height:calc(100% - 170px)}.range-slider-cmp-container .value-box{min-width:70px;min-height:30px;outline:none;width:70px;text-align:center;border:1px solid #757575;margin:.5rem auto;border-radius:4px;display:flex;justify-content:center;align-items:center}h2{color:#fff;font-size:1.5em}\n"],encapsulation:2})}return s})(),mP=(()=>{class s{onMouseDown(){this.formService.submitForm(this._FormId,{deviceId:this.deviceId,[this.output]:!0}).subscribe()}onMouseUp(){let t={deviceId:this.deviceId,[this.output]:!1};this.renderer2.setStyle(this.el.nativeElement,"background-color","#00FF00");const i=document.getElementById(this.LinkedElementId);this.renderer2.setStyle(i,"background-color","#FF0000"),this.formService.submitForm(this._FormId,t).subscribe()}constructor(t,i,n){this.formService=t,this.renderer2=i,this.el=n,this.LinkedElementId="",this.deviceId="",this.output="",this.color="#ffffff",this._FormId="__FIXEDFORM__432125517577425"}ngOnInit(){this.renderer2.setStyle(this.el.nativeElement,"background-color",this.color)}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(pf),d.Y36(d.Qsj),d.Y36(d.SBq))};static#t=this.\u0275dir=d.lG2({type:s,selectors:[["","Button",""]],hostBindings:function(i,n){1&i&&d.NdJ("mousedown",function(){return n.onMouseDown()})("mouseup",function(){return n.onMouseUp()})},inputs:{LinkedElementId:"LinkedElementId",deviceId:"deviceId",output:"output",color:"color"}})}return s})(),pP=(()=>{class s{constructor(t,i){this.socketService=t,this.formService=i,this.color="#DC143C",this.unsubscribe$=new gi.x}ngAfterViewInit(){const t=this.config,i=t.content,n={mainColor:t.view.Button.color,conditionColor:t.view.Animation.color};i&&i.topic?.id&&i.outputs?.read?.name&&(this.deviceId=i.topic?.id,this.output=i.outputs?.read?.name,this.socketService.fetchDeviceData(i.topic.id,i.outputs.read.name).pipe((0,ri.U)(r=>{"string"==typeof r&&(r=JSON.parse(r)),this.value=r,this.savedData=r,this.color=r?n.conditionColor:n.mainColor}),(0,he.R)(this.unsubscribe$)).subscribe())}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(Yr.l),d.Y36(pf))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-button"]],inputs:{id:"id",config:"config"},decls:4,vars:6,consts:[[1,"container"],["button",""],["Button","",3,"id","color","deviceId","output","LinkedElementId"]],template:function(i,n){1&i&&(d.TgZ(0,"div",0,1)(2,"button",2),d._uU(3),d.qZA()()),2&i&&(d.xp6(2),d.Q6J("id",n.id)("color",n.config.view.Button.color)("deviceId",n.deviceId)("output",n.output)("LinkedElementId",n.config.content.LinkedElementId),d.xp6(1),d.Oqu(n.config.view.Labels.title))},dependencies:[mP],styles:[".container[_ngcontent-%COMP%]{width:100%;height:100%;padding:0}.container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;height:100%;border:none;border-radius:.25rem}"]})}return s})();var fw=function(s){return s[s.TEXT=0]="TEXT",s[s.NUMBER=1]="NUMBER",s[s.EMAIL=2]="EMAIL",s[s.PASSWORD=3]="PASSWORD",s[s.PHONE=4]="PHONE",s[s.DATE=5]="DATE",s[s.SELECT=6]="SELECT",s[s.TIME=7]="TIME",s[s.TEXTAREA=8]="TEXTAREA",s[s.CHECKBOX=9]="CHECKBOX",s[s.ARRAY=10]="ARRAY",s}(fw||{});function fP(s,e){if(1&s&&(d.TgZ(0,"div",8),d._uU(1),d.qZA()),2&s){const t=d.oxw(2);d.xp6(1),d.Oqu(t.config.view.Labels.hint)}}function gP(s,e){if(1&s&&(d.ynx(0),d.TgZ(1,"div",4)(2,"div",5)(3,"label"),d._uU(4),d.qZA(),d._UZ(5,"input",6),d.ALo(6,"async"),d.qZA(),d.YNc(7,fP,2,1,"div",7),d.qZA(),d.BQk()),2&s){const t=d.oxw();d.xp6(4),d.Oqu(t.config.view.Labels.label),d.xp6(1),d.Q6J("disabled",d.lcZ(6,4,t.disable$)||!1)("formControlName",t.config.content.Name),d.xp6(2),d.Q6J("ngIf",t.config.view.Labels.hint)}}function _P(s,e){if(1&s&&(d.TgZ(0,"div",8),d._uU(1),d.qZA()),2&s){const t=d.oxw(2);d.xp6(1),d.Oqu(t.config.view.Labels.hint)}}function bP(s,e){if(1&s&&(d.ynx(0),d.TgZ(1,"div",4)(2,"div",5)(3,"div",9)(4,"label"),d._uU(5),d.qZA(),d.YNc(6,_P,2,1,"div",7),d.qZA(),d.TgZ(7,"div",10),d._UZ(8,"input",11),d.TgZ(9,"label"),d._uU(10),d.qZA()()()(),d.BQk()),2&s){const t=d.oxw();d.xp6(5),d.Oqu(t.config.view.Labels.label),d.xp6(1),d.Q6J("ngIf",t.config.view.Labels.hint),d.xp6(2),d.Q6J("formControlName",t.config.content.Name)("min",t.min)("max",t.max),d.xp6(2),d.Oqu(t.fieldValue)}}function vP(s,e){1&s&&(d.TgZ(0,"div"),d._uU(1,"Unknown type"),d.qZA())}let yP=(()=>{class s{get fieldValue(){return this._fieldValue}constructor(t,i,n){this.socketService=t,this.rootFormGroup=i,this.store=n,this.min=0,this.max=100,this.unsubscribe$=new gi.x,this.fromControlType=fw,this.disable$=(0,D.of)(!0),this._fieldValue=0}ngOnInit(){this.store.select(ze.Gt).pipe((0,ri.U)(i=>{i?this.rootFormGroup.control.controls[this.config.content.Name].enable():this.rootFormGroup.control.controls[this.config.content.Name].disable()})).subscribe();const t=this.config.content.Name;this.form=this.rootFormGroup.control,this.config.content.topic?.id&&this.config.content.outputs?.read.name&&this.socketService.fetchDeviceData(this.config.content.topic?.id,this.config.content.outputs?.read.name,!0,!0).pipe((0,ri.U)(i=>{this.config.content.isHint?this._fieldValue=i:(this.form.controls[t].setValue(i),this._fieldValue="")}),(0,he.R)(this.unsubscribe$)).subscribe(),this.form.controls[t].valueChanges.pipe((0,he.R)(this.unsubscribe$),(0,ri.U)(i=>{i>this.max&&this.form.controls[t].setValue(this.max),i<this.min&&this.form.controls[t].setValue(this.min)})).subscribe()}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(Yr.l),d.Y36(A.sg),d.Y36(Ie.yh))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-form-field"]],inputs:{config:"config",id:"id",min:"min",max:"max"},decls:5,vars:4,consts:[[3,"ngSwitch"],[1,"dynamicForm",3,"formGroup"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"form-group"],[1,"input"],["type","text",3,"disabled","formControlName"],["class","hint",4,"ngIf"],[1,"hint"],[1,"labels"],[1,"value"],["type","number","step","0.1",3,"formControlName","min","max"]],template:function(i,n){1&i&&(d.ynx(0,0),d.TgZ(1,"div",1),d.YNc(2,gP,8,6,"ng-container",2),d.YNc(3,bP,11,6,"ng-container",2),d.YNc(4,vP,2,0,"div",3),d.qZA(),d.BQk()),2&i&&(d.Q6J("ngSwitch",n.config.content.type),d.xp6(1),d.Q6J("formGroup",n.form),d.xp6(1),d.Q6J("ngSwitchCase","text"),d.xp6(1),d.Q6J("ngSwitchCase","number"))},dependencies:[x.O5,x.RF,x.n9,x.ED,A.Fj,A.wV,A.JJ,A.JL,A.qQ,A.Fd,A.sg,A.u,x.Ov],styles:[".dynamicForm[_ngcontent-%COMP%]{border:1px solid #ffffff;border-radius:.5rem;padding:.2rem;width:100%;height:100%}.form-group[_ngcontent-%COMP%]{display:grid;width:100%;height:100%}.labels[_ngcontent-%COMP%], .value[_ngcontent-%COMP%]{display:flex;gap:.2rem;flex-direction:column}label[_ngcontent-%COMP%]{font-weight:700;display:flex;align-items:center;justify-content:center;color:#0a0a0a;word-break:break-all;overflow-wrap:break-word;font-size:.95em}.input[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:.25rem}input[_ngcontent-%COMP%]{width:100%;height:60%;padding:10px;border:1px solid #0a0a0a;border-radius:4px;font-size:16px;box-sizing:border-box;color:#0a0a0a}.hint[_ngcontent-%COMP%]{font-style:italic;color:#0a0a0a;text-align:center}@media screen and (max-width: 480px){input[_ngcontent-%COMP%]{font-size:14px}}@media screen and (max-width: 1440px){input[_ngcontent-%COMP%], label[_ngcontent-%COMP%]{font-size:.75em}.hint[_ngcontent-%COMP%]{font-size:.85em}}"]})}return s})(),xP=(()=>{class s{constructor(t,i){this.store=t,this.formService=i,this.config={content:{idList:[],selectedForm:null,deviceId:""},view:{color:"primary",label:"Submit"}},this.unsubscribe$=new gi.x,this.disable$=(0,D.of)(!0)}ngOnInit(){this.disable$=this.store.select(ze.Gt).pipe((0,ri.U)(t=>!t))}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}onClick(){const t=this.form.value,i=this.config.content.selectedForm;let n={};this.config.content.idList.forEach(r=>{"SetpointFlow"===r.name?n.FIC_Remote_St=t[r.name]:"SetpointLevel"===r.name?n.LIC_Remote_St=t[r.name]:"SetpointTemp"===r.name?n.TIC_Remote_St=t[r.name]:"Hystersis"===r.name&&(n.TIC_Remote_Hystersis=t[r.name])}),i&&this.formService.submitForm(i,n).subscribe()}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(Ie.yh),d.Y36(pf))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-submit"]],inputs:{config:"config",id:"id",form:"form"},decls:4,vars:5,consts:[[1,"container"],["mat-raised-button","",3,"color","disabled","click"]],template:function(i,n){1&i&&(d.TgZ(0,"div",0)(1,"button",1),d.NdJ("click",function(){return n.onClick()}),d.ALo(2,"async"),d._uU(3),d.qZA()()),2&i&&(d.xp6(1),d.Q6J("color",n.config.view.color)("disabled",d.lcZ(2,3,n.disable$)),d.xp6(2),d.Oqu(n.config.view.label))},dependencies:[pn.lW,x.Ov],styles:[".container[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;height:100%}"]})}return s})();const _w=1,TP=2,Jo=3,gf=0,XP=1,qP=2,Ll=0,$P=1,KP=2,JP=3,QP=4,eO=5,tO=6,Mw="attached",Fl=301,zc=302,Qu=306,el=1e3,ar=1001,Ss=1003,xs=1006,tl=1008,Bl=1009,Nl=1014,Mo=1015,im=1016,Hc=1020,ma=1023,Vc=1026,rh=1027,nm=2300,ah=2301,Wc=3001,Un="srgb",or="srgb-linear",hv="display-p3",yf="display-p3-linear",xf="linear",Kn="srgb",wf="rec709",Mf="p3",ch=7680,l1="300 es",To=2e3;class Yc{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const r=n.indexOf(t);-1!==r&&n.splice(r,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const n=i.slice(0);for(let r=0,a=n.length;r<a;r++)n[r].call(this,e);e.target=null}}}const Mr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const jc=Math.PI/180,dh=180/Math.PI;function pa(){const s=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Mr[255&s]+Mr[s>>8&255]+Mr[s>>16&255]+Mr[s>>24&255]+"-"+Mr[255&e]+Mr[e>>8&255]+"-"+Mr[e>>16&15|64]+Mr[e>>24&255]+"-"+Mr[63&t|128]+Mr[t>>8&255]+"-"+Mr[t>>16&255]+Mr[t>>24&255]+Mr[255&i]+Mr[i>>8&255]+Mr[i>>16&255]+Mr[i>>24&255]).toLowerCase()}function ws(s,e,t){return Math.max(e,Math.min(t,s))}function mv(s,e){return(s%e+e)%e}function rm(s,e,t){return(1-t)*s+t*e}function pv(s){return 0==(s&s-1)&&0!==s}function Cf(s){return Math.pow(2,Math.floor(Math.log(s)/Math.LN2))}function $r(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return s/4294967295;case Uint16Array:return s/65535;case Uint8Array:return s/255;case Int32Array:return Math.max(s/2147483647,-1);case Int16Array:return Math.max(s/32767,-1);case Int8Array:return Math.max(s/127,-1);default:throw new Error("Invalid component type.")}}function Yi(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return Math.round(4294967295*s);case Uint16Array:return Math.round(65535*s);case Uint8Array:return Math.round(255*s);case Int32Array:return Math.round(2147483647*s);case Int16Array:return Math.round(32767*s);case Int8Array:return Math.round(127*s);default:throw new Error("Invalid component type.")}}const br_DEG2RAD=jc,br_degToRad=function LO(s){return s*jc},br_radToDeg=function FO(s){return s*dh};class Xe{constructor(e=0,t=0){Xe.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,n=e.elements;return this.x=n[0]*t+n[3]*i+n[6],this.y=n[1]*t+n[4]*i+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(ws(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),n=Math.sin(t),r=this.x-e.x,a=this.y-e.y;return this.x=r*i-a*n+e.x,this.y=r*n+a*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Xi{constructor(e,t,i,n,r,a,o,l,c){Xi.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,n,r,a,o,l,c)}set(e,t,i,n,r,a,o,l,c){const h=this.elements;return h[0]=e,h[1]=n,h[2]=o,h[3]=t,h[4]=r,h[5]=l,h[6]=i,h[7]=a,h[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,n=t.elements,r=this.elements,a=i[0],o=i[3],l=i[6],c=i[1],h=i[4],u=i[7],m=i[2],p=i[5],_=i[8],g=n[0],f=n[3],b=n[6],C=n[1],M=n[4],E=n[7],S=n[2],P=n[5],I=n[8];return r[0]=a*g+o*C+l*S,r[3]=a*f+o*M+l*P,r[6]=a*b+o*E+l*I,r[1]=c*g+h*C+u*S,r[4]=c*f+h*M+u*P,r[7]=c*b+h*E+u*I,r[2]=m*g+p*C+_*S,r[5]=m*f+p*M+_*P,r[8]=m*b+p*E+_*I,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8];return t*a*h-t*o*c-i*r*h+i*o*l+n*r*c-n*a*l}invert(){const e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8],u=h*a-o*c,m=o*l-h*r,p=c*r-a*l,_=t*u+i*m+n*p;if(0===_)return this.set(0,0,0,0,0,0,0,0,0);const g=1/_;return e[0]=u*g,e[1]=(n*c-h*i)*g,e[2]=(o*i-n*a)*g,e[3]=m*g,e[4]=(h*t-n*l)*g,e[5]=(n*r-o*t)*g,e[6]=p*g,e[7]=(i*l-c*t)*g,e[8]=(a*t-i*r)*g,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,n,r,a,o){const l=Math.cos(r),c=Math.sin(r);return this.set(i*l,i*c,-i*(l*a+c*o)+a+e,-n*c,n*l,-n*(-c*a+l*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(gv.makeScale(e,t)),this}rotate(e){return this.premultiply(gv.makeRotation(-e)),this}translate(e,t){return this.premultiply(gv.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let n=0;n<9;n++)if(t[n]!==i[n])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const gv=new Xi;function d1(s){for(let e=s.length-1;e>=0;--e)if(s[e]>=65535)return!0;return!1}function am(s){return document.createElementNS("http://www.w3.org/1999/xhtml",s)}function zO(){const s=am("canvas");return s.style.display="block",s}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const h1={};function om(s){s in h1||(h1[s]=!0,console.warn(s))}const u1=(new Xi).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),m1=(new Xi).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Df={[or]:{transfer:xf,primaries:wf,toReference:s=>s,fromReference:s=>s},[Un]:{transfer:Kn,primaries:wf,toReference:s=>s.convertSRGBToLinear(),fromReference:s=>s.convertLinearToSRGB()},[yf]:{transfer:xf,primaries:Mf,toReference:s=>s.applyMatrix3(m1),fromReference:s=>s.applyMatrix3(u1)},[hv]:{transfer:Kn,primaries:Mf,toReference:s=>s.convertSRGBToLinear().applyMatrix3(m1),fromReference:s=>s.applyMatrix3(u1).convertLinearToSRGB()}},HO=new Set([or,yf]),Dn={enabled:!0,_workingColorSpace:or,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(s){if(!HO.has(s))throw new Error(`Unsupported working color space, "${s}".`);this._workingColorSpace=s},convert:function(s,e,t){return!1!==this.enabled&&e!==t&&e&&t?(0,Df[t].fromReference)((0,Df[e].toReference)(s)):s},fromWorkingColorSpace:function(s,e){return this.convert(s,this._workingColorSpace,e)},toWorkingColorSpace:function(s,e){return this.convert(s,e,this._workingColorSpace)},getPrimaries:function(s){return Df[s].primaries},getTransfer:function(s){return""===s?xf:Df[s].transfer}};function uh(s){return s<.04045?.0773993808*s:Math.pow(.9478672986*s+.0521327014,2.4)}function _v(s){return s<.0031308?12.92*s:1.055*Math.pow(s,.41666)-.055}let mh;class p1{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===mh&&(mh=am("canvas")),mh.width=e.width,mh.height=e.height;const i=mh.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=mh}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=am("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const n=i.getImageData(0,0,e.width,e.height),r=n.data;for(let a=0;a<r.length;a++)r[a]=255*uh(r[a]/255);return i.putImageData(n,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*uh(t[i]/255)):uh(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let VO=0;class ph{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:VO++}),this.uuid=pa(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},n=this.data;if(null!==n){let r;if(Array.isArray(n)){r=[];for(let a=0,o=n.length;a<o;a++)r.push(bv(n[a].isDataTexture?n[a].image:n[a]))}else r=bv(n);i.url=r}return t||(e.images[this.uuid]=i),i}}function bv(s){return typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap?p1.getDataURL(s):s.data?{data:Array.from(s.data),width:s.width,height:s.height,type:s.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let WO=0,Kr=(()=>{class s extends Yc{constructor(t=s.DEFAULT_IMAGE,i=s.DEFAULT_MAPPING,n=ar,r=ar,a=xs,o=tl,l=ma,c=Bl,h=s.DEFAULT_ANISOTROPY,u=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:WO++}),this.uuid=pa(),this.name="",this.source=new ph(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=a,this.minFilter=o,this.anisotropy=h,this.format=l,this.internalFormat=null,this.type=c,this.offset=new Xe(0,0),this.repeat=new Xe(1,1),this.center=new Xe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Xi,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof u?this.colorSpace=u:(om("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=u===Wc?Un:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),i||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case el:t.x=t.x-Math.floor(t.x);break;case ar:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case el:t.y=t.y-Math.floor(t.y);break;case ar:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return om("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Un?Wc:3e3}set encoding(t){om("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===Wc?Un:""}}return s.DEFAULT_IMAGE=null,s.DEFAULT_MAPPING=300,s.DEFAULT_ANISOTROPY=1,s})();class yn{constructor(e=0,t=0,i=0,n=1){yn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,n=this.z,r=this.w,a=e.elements;return this.x=a[0]*t+a[4]*i+a[8]*n+a[12]*r,this.y=a[1]*t+a[5]*i+a[9]*n+a[13]*r,this.z=a[2]*t+a[6]*i+a[10]*n+a[14]*r,this.w=a[3]*t+a[7]*i+a[11]*n+a[15]*r,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,n,r;const l=e.elements,c=l[0],h=l[4],u=l[8],m=l[1],p=l[5],_=l[9],g=l[2],f=l[6],b=l[10];if(Math.abs(h-m)<.01&&Math.abs(u-g)<.01&&Math.abs(_-f)<.01){if(Math.abs(h+m)<.1&&Math.abs(u+g)<.1&&Math.abs(_+f)<.1&&Math.abs(c+p+b-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const M=(c+1)/2,E=(p+1)/2,S=(b+1)/2,P=(h+m)/4,I=(u+g)/4,L=(_+f)/4;return M>E&&M>S?M<.01?(i=0,n=.707106781,r=.707106781):(i=Math.sqrt(M),n=P/i,r=I/i):E>S?E<.01?(i=.707106781,n=0,r=.707106781):(n=Math.sqrt(E),i=P/n,r=L/n):S<.01?(i=.707106781,n=.707106781,r=0):(r=Math.sqrt(S),i=I/r,n=L/r),this.set(i,n,r,t),this}let C=Math.sqrt((f-_)*(f-_)+(u-g)*(u-g)+(m-h)*(m-h));return Math.abs(C)<.001&&(C=1),this.x=(f-_)/C,this.y=(u-g)/C,this.z=(m-h)/C,this.w=Math.acos((c+p+b-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class GO extends Yc{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new yn(0,0,e,t),this.scissorTest=!1,this.viewport=new yn(0,0,e,t);const n={width:e,height:t,depth:1};void 0!==i.encoding&&(om("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===Wc?Un:""),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:xs,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new Kr(n,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new ph(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Zc extends GO{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class vv extends Kr{constructor(e=null,t=1,i=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:n},this.magFilter=Ss,this.minFilter=Ss,this.wrapR=ar,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class f1 extends Kr{constructor(e=null,t=1,i=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:n},this.magFilter=Ss,this.minFilter=Ss,this.wrapR=ar,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Jn{constructor(e=0,t=0,i=0,n=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=n}static slerpFlat(e,t,i,n,r,a,o){let l=i[n+0],c=i[n+1],h=i[n+2],u=i[n+3];const m=r[a+0],p=r[a+1],_=r[a+2],g=r[a+3];if(0===o)return e[t+0]=l,e[t+1]=c,e[t+2]=h,void(e[t+3]=u);if(1===o)return e[t+0]=m,e[t+1]=p,e[t+2]=_,void(e[t+3]=g);if(u!==g||l!==m||c!==p||h!==_){let f=1-o;const b=l*m+c*p+h*_+u*g,C=b>=0?1:-1,M=1-b*b;if(M>Number.EPSILON){const S=Math.sqrt(M),P=Math.atan2(S,b*C);f=Math.sin(f*P)/S,o=Math.sin(o*P)/S}const E=o*C;if(l=l*f+m*E,c=c*f+p*E,h=h*f+_*E,u=u*f+g*E,f===1-o){const S=1/Math.sqrt(l*l+c*c+h*h+u*u);l*=S,c*=S,h*=S,u*=S}}e[t]=l,e[t+1]=c,e[t+2]=h,e[t+3]=u}static multiplyQuaternionsFlat(e,t,i,n,r,a){const o=i[n],l=i[n+1],c=i[n+2],h=i[n+3],u=r[a],m=r[a+1],p=r[a+2],_=r[a+3];return e[t]=o*_+h*u+l*p-c*m,e[t+1]=l*_+h*m+c*u-o*p,e[t+2]=c*_+h*p+o*m-l*u,e[t+3]=h*_-o*u-l*m-c*p,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,n=e._y,r=e._z,a=e._order,o=Math.cos,l=Math.sin,c=o(i/2),h=o(n/2),u=o(r/2),m=l(i/2),p=l(n/2),_=l(r/2);switch(a){case"XYZ":this._x=m*h*u+c*p*_,this._y=c*p*u-m*h*_,this._z=c*h*_+m*p*u,this._w=c*h*u-m*p*_;break;case"YXZ":this._x=m*h*u+c*p*_,this._y=c*p*u-m*h*_,this._z=c*h*_-m*p*u,this._w=c*h*u+m*p*_;break;case"ZXY":this._x=m*h*u-c*p*_,this._y=c*p*u+m*h*_,this._z=c*h*_+m*p*u,this._w=c*h*u-m*p*_;break;case"ZYX":this._x=m*h*u-c*p*_,this._y=c*p*u+m*h*_,this._z=c*h*_-m*p*u,this._w=c*h*u+m*p*_;break;case"YZX":this._x=m*h*u+c*p*_,this._y=c*p*u+m*h*_,this._z=c*h*_-m*p*u,this._w=c*h*u-m*p*_;break;case"XZY":this._x=m*h*u-c*p*_,this._y=c*p*u-m*h*_,this._z=c*h*_+m*p*u,this._w=c*h*u+m*p*_;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,n=Math.sin(i);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],n=t[4],r=t[8],a=t[1],o=t[5],l=t[9],c=t[2],h=t[6],u=t[10],m=i+o+u;if(m>0){const p=.5/Math.sqrt(m+1);this._w=.25/p,this._x=(h-l)*p,this._y=(r-c)*p,this._z=(a-n)*p}else if(i>o&&i>u){const p=2*Math.sqrt(1+i-o-u);this._w=(h-l)/p,this._x=.25*p,this._y=(n+a)/p,this._z=(r+c)/p}else if(o>u){const p=2*Math.sqrt(1+o-i-u);this._w=(r-c)/p,this._x=(n+a)/p,this._y=.25*p,this._z=(l+h)/p}else{const p=2*Math.sqrt(1+u-i-o);this._w=(a-n)/p,this._x=(r+c)/p,this._y=(l+h)/p,this._z=.25*p}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(ws(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const n=Math.min(1,t/i);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,n=e._y,r=e._z,a=e._w,o=t._x,l=t._y,c=t._z,h=t._w;return this._x=i*h+a*o+n*c-r*l,this._y=n*h+a*l+r*o-i*c,this._z=r*h+a*c+i*l-n*o,this._w=a*h-i*o-n*l-r*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,n=this._y,r=this._z,a=this._w;let o=a*e._w+i*e._x+n*e._y+r*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=i,this._y=n,this._z=r,this;const l=1-o*o;if(l<=Number.EPSILON){const p=1-t;return this._w=p*a+t*this._w,this._x=p*i+t*this._x,this._y=p*n+t*this._y,this._z=p*r+t*this._z,this.normalize(),this}const c=Math.sqrt(l),h=Math.atan2(c,o),u=Math.sin((1-t)*h)/c,m=Math.sin(t*h)/c;return this._w=a*u+this._w*m,this._x=i*u+this._x*m,this._y=n*u+this._y*m,this._z=r*u+this._z*m,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),n=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(t*Math.cos(n),i*Math.sin(r),i*Math.cos(r),t*Math.sin(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Z{constructor(e=0,t=0,i=0){Z.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(g1.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(g1.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6]*n,this.y=r[1]*t+r[4]*i+r[7]*n,this.z=r[2]*t+r[5]*i+r[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,n=this.z,r=e.elements,a=1/(r[3]*t+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*t+r[4]*i+r[8]*n+r[12])*a,this.y=(r[1]*t+r[5]*i+r[9]*n+r[13])*a,this.z=(r[2]*t+r[6]*i+r[10]*n+r[14])*a,this}applyQuaternion(e){const t=this.x,i=this.y,n=this.z,r=e.x,a=e.y,o=e.z,l=e.w,c=2*(a*n-o*i),h=2*(o*t-r*n),u=2*(r*i-a*t);return this.x=t+l*c+a*u-o*h,this.y=i+l*h+o*c-r*u,this.z=n+l*u+r*h-a*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[4]*i+r[8]*n,this.y=r[1]*t+r[5]*i+r[9]*n,this.z=r[2]*t+r[6]*i+r[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,n=e.y,r=e.z,a=t.x,o=t.y,l=t.z;return this.x=n*l-r*o,this.y=r*a-i*l,this.z=i*o-n*a,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return yv.copy(this).projectOnVector(e),this.sub(yv)}reflect(e){return this.sub(yv.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(ws(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,n=this.z-e.z;return t*t+i*i+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const n=Math.sin(t)*e;return this.x=n*Math.sin(i),this.y=Math.cos(t)*e,this.z=n*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const yv=new Z,g1=new Jn;class Vs{constructor(e=new Z(1/0,1/0,1/0),t=new Z(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Ka.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Ka.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Ka.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i){const r=i.getAttribute("position");if(!0===t&&void 0!==r&&!0!==e.isInstancedMesh)for(let a=0,o=r.count;a<o;a++)!0===e.isMesh?e.getVertexPosition(a,Ka):Ka.fromBufferAttribute(r,a),Ka.applyMatrix4(e.matrixWorld),this.expandByPoint(Ka);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),Ef.copy(e.boundingBox)):(null===i.boundingBox&&i.computeBoundingBox(),Ef.copy(i.boundingBox)),Ef.applyMatrix4(e.matrixWorld),this.union(Ef)}const n=e.children;for(let r=0,a=n.length;r<a;r++)this.expandByObject(n[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Ka),Ka.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(lm),Sf.subVectors(this.max,lm),fh.subVectors(e.a,lm),gh.subVectors(e.b,lm),_h.subVectors(e.c,lm),Ul.subVectors(gh,fh),zl.subVectors(_h,gh),Xc.subVectors(fh,_h);let t=[0,-Ul.z,Ul.y,0,-zl.z,zl.y,0,-Xc.z,Xc.y,Ul.z,0,-Ul.x,zl.z,0,-zl.x,Xc.z,0,-Xc.x,-Ul.y,Ul.x,0,-zl.y,zl.x,0,-Xc.y,Xc.x,0];return!(!xv(t,fh,gh,_h,Sf)||(t=[1,0,0,0,1,0,0,0,1],!xv(t,fh,gh,_h,Sf)))&&(kf.crossVectors(Ul,zl),t=[kf.x,kf.y,kf.z],xv(t,fh,gh,_h,Sf))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Ka).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Ka).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(il[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),il[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),il[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),il[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),il[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),il[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),il[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),il[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(il)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const il=[new Z,new Z,new Z,new Z,new Z,new Z,new Z,new Z],Ka=new Z,Ef=new Vs,fh=new Z,gh=new Z,_h=new Z,Ul=new Z,zl=new Z,Xc=new Z,lm=new Z,Sf=new Z,kf=new Z,qc=new Z;function xv(s,e,t,i,n){for(let r=0,a=s.length-3;r<=a;r+=3){qc.fromArray(s,r);const o=n.x*Math.abs(qc.x)+n.y*Math.abs(qc.y)+n.z*Math.abs(qc.z),l=e.dot(qc),c=t.dot(qc),h=i.dot(qc);if(Math.max(-Math.max(l,c,h),Math.min(l,c,h))>o)return!1}return!0}const YO=new Vs,cm=new Z,wv=new Z;class Tr{constructor(e=new Z,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):YO.setFromPoints(e).getCenter(i);let n=0;for(let r=0,a=e.length;r<a;r++)n=Math.max(n,i.distanceToSquared(e[r]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;cm.subVectors(e,this.center);const t=cm.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),n=.5*(i-this.radius);this.center.addScaledVector(cm,n/i),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(wv.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(cm.copy(e.center).add(wv)),this.expandByPoint(cm.copy(e.center).sub(wv))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const nl=new Z,Mv=new Z,Af=new Z,Hl=new Z,Tv=new Z,Pf=new Z,Cv=new Z;class bh{constructor(e=new Z,t=new Z(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,nl)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=nl.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(nl.copy(this.origin).addScaledVector(this.direction,t),nl.distanceToSquared(e))}distanceSqToSegment(e,t,i,n){Mv.copy(e).add(t).multiplyScalar(.5),Af.copy(t).sub(e).normalize(),Hl.copy(this.origin).sub(Mv);const r=.5*e.distanceTo(t),a=-this.direction.dot(Af),o=Hl.dot(this.direction),l=-Hl.dot(Af),c=Hl.lengthSq(),h=Math.abs(1-a*a);let u,m,p,_;if(h>0)if(u=a*l-o,m=a*o-l,_=r*h,u>=0)if(m>=-_)if(m<=_){const g=1/h;u*=g,m*=g,p=u*(u+a*m+2*o)+m*(a*u+m+2*l)+c}else m=r,u=Math.max(0,-(a*m+o)),p=-u*u+m*(m+2*l)+c;else m=-r,u=Math.max(0,-(a*m+o)),p=-u*u+m*(m+2*l)+c;else m<=-_?(u=Math.max(0,-(-a*r+o)),m=u>0?-r:Math.min(Math.max(-r,-l),r),p=-u*u+m*(m+2*l)+c):m<=_?(u=0,m=Math.min(Math.max(-r,-l),r),p=m*(m+2*l)+c):(u=Math.max(0,-(a*r+o)),m=u>0?r:Math.min(Math.max(-r,-l),r),p=-u*u+m*(m+2*l)+c);else m=a>0?-r:r,u=Math.max(0,-(a*m+o)),p=-u*u+m*(m+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,u),n&&n.copy(Mv).addScaledVector(Af,m),p}intersectSphere(e,t){nl.subVectors(e.center,this.origin);const i=nl.dot(this.direction),n=nl.dot(nl)-i*i,r=e.radius*e.radius;if(n>r)return null;const a=Math.sqrt(r-n),o=i-a,l=i+a;return l<0?null:this.at(o<0?l:o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,n,r,a,o,l;const c=1/this.direction.x,h=1/this.direction.y,u=1/this.direction.z,m=this.origin;return c>=0?(i=(e.min.x-m.x)*c,n=(e.max.x-m.x)*c):(i=(e.max.x-m.x)*c,n=(e.min.x-m.x)*c),h>=0?(r=(e.min.y-m.y)*h,a=(e.max.y-m.y)*h):(r=(e.max.y-m.y)*h,a=(e.min.y-m.y)*h),i>a||r>n||((r>i||isNaN(i))&&(i=r),(a<n||isNaN(n))&&(n=a),u>=0?(o=(e.min.z-m.z)*u,l=(e.max.z-m.z)*u):(o=(e.max.z-m.z)*u,l=(e.min.z-m.z)*u),i>l||o>n)||((o>i||i!=i)&&(i=o),(l<n||n!=n)&&(n=l),n<0)?null:this.at(i>=0?i:n,t)}intersectsBox(e){return null!==this.intersectBox(e,nl)}intersectTriangle(e,t,i,n,r){Tv.subVectors(t,e),Pf.subVectors(i,e),Cv.crossVectors(Tv,Pf);let o,a=this.direction.dot(Cv);if(a>0){if(n)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}Hl.subVectors(this.origin,e);const l=o*this.direction.dot(Pf.crossVectors(Hl,Pf));if(l<0)return null;const c=o*this.direction.dot(Tv.cross(Hl));if(c<0||l+c>a)return null;const h=-o*Hl.dot(Cv);return h<0?null:this.at(h/a,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Ut{constructor(e,t,i,n,r,a,o,l,c,h,u,m,p,_,g,f){Ut.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,n,r,a,o,l,c,h,u,m,p,_,g,f)}set(e,t,i,n,r,a,o,l,c,h,u,m,p,_,g,f){const b=this.elements;return b[0]=e,b[4]=t,b[8]=i,b[12]=n,b[1]=r,b[5]=a,b[9]=o,b[13]=l,b[2]=c,b[6]=h,b[10]=u,b[14]=m,b[3]=p,b[7]=_,b[11]=g,b[15]=f,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Ut).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,n=1/vh.setFromMatrixColumn(e,0).length(),r=1/vh.setFromMatrixColumn(e,1).length(),a=1/vh.setFromMatrixColumn(e,2).length();return t[0]=i[0]*n,t[1]=i[1]*n,t[2]=i[2]*n,t[3]=0,t[4]=i[4]*r,t[5]=i[5]*r,t[6]=i[6]*r,t[7]=0,t[8]=i[8]*a,t[9]=i[9]*a,t[10]=i[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,n=e.y,r=e.z,a=Math.cos(i),o=Math.sin(i),l=Math.cos(n),c=Math.sin(n),h=Math.cos(r),u=Math.sin(r);if("XYZ"===e.order){const m=a*h,p=a*u,_=o*h,g=o*u;t[0]=l*h,t[4]=-l*u,t[8]=c,t[1]=p+_*c,t[5]=m-g*c,t[9]=-o*l,t[2]=g-m*c,t[6]=_+p*c,t[10]=a*l}else if("YXZ"===e.order){const m=l*h,p=l*u,_=c*h,g=c*u;t[0]=m+g*o,t[4]=_*o-p,t[8]=a*c,t[1]=a*u,t[5]=a*h,t[9]=-o,t[2]=p*o-_,t[6]=g+m*o,t[10]=a*l}else if("ZXY"===e.order){const m=l*h,p=l*u,_=c*h,g=c*u;t[0]=m-g*o,t[4]=-a*u,t[8]=_+p*o,t[1]=p+_*o,t[5]=a*h,t[9]=g-m*o,t[2]=-a*c,t[6]=o,t[10]=a*l}else if("ZYX"===e.order){const m=a*h,p=a*u,_=o*h,g=o*u;t[0]=l*h,t[4]=_*c-p,t[8]=m*c+g,t[1]=l*u,t[5]=g*c+m,t[9]=p*c-_,t[2]=-c,t[6]=o*l,t[10]=a*l}else if("YZX"===e.order){const m=a*l,p=a*c,_=o*l,g=o*c;t[0]=l*h,t[4]=g-m*u,t[8]=_*u+p,t[1]=u,t[5]=a*h,t[9]=-o*h,t[2]=-c*h,t[6]=p*u+_,t[10]=m-g*u}else if("XZY"===e.order){const m=a*l,p=a*c,_=o*l,g=o*c;t[0]=l*h,t[4]=-u,t[8]=c*h,t[1]=m*u+g,t[5]=a*h,t[9]=p*u-_,t[2]=_*u-p,t[6]=o*h,t[10]=g*u+m}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(jO,e,ZO)}lookAt(e,t,i){const n=this.elements;return fa.subVectors(e,t),0===fa.lengthSq()&&(fa.z=1),fa.normalize(),Vl.crossVectors(i,fa),0===Vl.lengthSq()&&(1===Math.abs(i.z)?fa.x+=1e-4:fa.z+=1e-4,fa.normalize(),Vl.crossVectors(i,fa)),Vl.normalize(),Of.crossVectors(fa,Vl),n[0]=Vl.x,n[4]=Of.x,n[8]=fa.x,n[1]=Vl.y,n[5]=Of.y,n[9]=fa.y,n[2]=Vl.z,n[6]=Of.z,n[10]=fa.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,n=t.elements,r=this.elements,a=i[0],o=i[4],l=i[8],c=i[12],h=i[1],u=i[5],m=i[9],p=i[13],_=i[2],g=i[6],f=i[10],b=i[14],C=i[3],M=i[7],E=i[11],S=i[15],P=n[0],I=n[4],L=n[8],O=n[12],B=n[1],Q=n[5],pe=n[9],ae=n[13],N=n[2],ee=n[6],K=n[10],se=n[14],ue=n[3],re=n[7],xe=n[11],Ce=n[15];return r[0]=a*P+o*B+l*N+c*ue,r[4]=a*I+o*Q+l*ee+c*re,r[8]=a*L+o*pe+l*K+c*xe,r[12]=a*O+o*ae+l*se+c*Ce,r[1]=h*P+u*B+m*N+p*ue,r[5]=h*I+u*Q+m*ee+p*re,r[9]=h*L+u*pe+m*K+p*xe,r[13]=h*O+u*ae+m*se+p*Ce,r[2]=_*P+g*B+f*N+b*ue,r[6]=_*I+g*Q+f*ee+b*re,r[10]=_*L+g*pe+f*K+b*xe,r[14]=_*O+g*ae+f*se+b*Ce,r[3]=C*P+M*B+E*N+S*ue,r[7]=C*I+M*Q+E*ee+S*re,r[11]=C*L+M*pe+E*K+S*xe,r[15]=C*O+M*ae+E*se+S*Ce,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],n=e[8],r=e[12],a=e[1],o=e[5],l=e[9],c=e[13],h=e[2],u=e[6],m=e[10],p=e[14];return e[3]*(+r*l*u-n*c*u-r*o*m+i*c*m+n*o*p-i*l*p)+e[7]*(+t*l*p-t*c*m+r*a*m-n*a*p+n*c*h-r*l*h)+e[11]*(+t*c*u-t*o*p-r*a*u+i*a*p+r*o*h-i*c*h)+e[15]*(-n*o*h-t*l*u+t*o*m+n*a*u-i*a*m+i*l*h)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8],u=e[9],m=e[10],p=e[11],_=e[12],g=e[13],f=e[14],b=e[15],C=u*f*c-g*m*c+g*l*p-o*f*p-u*l*b+o*m*b,M=_*m*c-h*f*c-_*l*p+a*f*p+h*l*b-a*m*b,E=h*g*c-_*u*c+_*o*p-a*g*p-h*o*b+a*u*b,S=_*u*l-h*g*l-_*o*m+a*g*m+h*o*f-a*u*f,P=t*C+i*M+n*E+r*S;if(0===P)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const I=1/P;return e[0]=C*I,e[1]=(g*m*r-u*f*r-g*n*p+i*f*p+u*n*b-i*m*b)*I,e[2]=(o*f*r-g*l*r+g*n*c-i*f*c-o*n*b+i*l*b)*I,e[3]=(u*l*r-o*m*r-u*n*c+i*m*c+o*n*p-i*l*p)*I,e[4]=M*I,e[5]=(h*f*r-_*m*r+_*n*p-t*f*p-h*n*b+t*m*b)*I,e[6]=(_*l*r-a*f*r-_*n*c+t*f*c+a*n*b-t*l*b)*I,e[7]=(a*m*r-h*l*r+h*n*c-t*m*c-a*n*p+t*l*p)*I,e[8]=E*I,e[9]=(_*u*r-h*g*r-_*i*p+t*g*p+h*i*b-t*u*b)*I,e[10]=(a*g*r-_*o*r+_*i*c-t*g*c-a*i*b+t*o*b)*I,e[11]=(h*o*r-a*u*r-h*i*c+t*u*c+a*i*p-t*o*p)*I,e[12]=S*I,e[13]=(h*g*n-_*u*n+_*i*m-t*g*m-h*i*f+t*u*f)*I,e[14]=(_*o*n-a*g*n-_*i*l+t*g*l+a*i*f-t*o*f)*I,e[15]=(a*u*n-h*o*n+h*i*l-t*u*l-a*i*m+t*o*m)*I,this}scale(e){const t=this.elements,i=e.x,n=e.y,r=e.z;return t[0]*=i,t[4]*=n,t[8]*=r,t[1]*=i,t[5]*=n,t[9]*=r,t[2]*=i,t[6]*=n,t[10]*=r,t[3]*=i,t[7]*=n,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),n=Math.sin(t),r=1-i,a=e.x,o=e.y,l=e.z,c=r*a,h=r*o;return this.set(c*a+i,c*o-n*l,c*l+n*o,0,c*o+n*l,h*o+i,h*l-n*a,0,c*l-n*o,h*l+n*a,r*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,n,r,a){return this.set(1,i,r,0,e,1,a,0,t,n,1,0,0,0,0,1),this}compose(e,t,i){const n=this.elements,r=t._x,a=t._y,o=t._z,l=t._w,c=r+r,h=a+a,u=o+o,m=r*c,p=r*h,_=r*u,g=a*h,f=a*u,b=o*u,C=l*c,M=l*h,E=l*u,S=i.x,P=i.y,I=i.z;return n[0]=(1-(g+b))*S,n[1]=(p+E)*S,n[2]=(_-M)*S,n[3]=0,n[4]=(p-E)*P,n[5]=(1-(m+b))*P,n[6]=(f+C)*P,n[7]=0,n[8]=(_+M)*I,n[9]=(f-C)*I,n[10]=(1-(m+g))*I,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,i){const n=this.elements;let r=vh.set(n[0],n[1],n[2]).length();const a=vh.set(n[4],n[5],n[6]).length(),o=vh.set(n[8],n[9],n[10]).length();this.determinant()<0&&(r=-r),e.x=n[12],e.y=n[13],e.z=n[14],Ja.copy(this);const c=1/r,h=1/a,u=1/o;return Ja.elements[0]*=c,Ja.elements[1]*=c,Ja.elements[2]*=c,Ja.elements[4]*=h,Ja.elements[5]*=h,Ja.elements[6]*=h,Ja.elements[8]*=u,Ja.elements[9]*=u,Ja.elements[10]*=u,t.setFromRotationMatrix(Ja),i.x=r,i.y=a,i.z=o,this}makePerspective(e,t,i,n,r,a,o=To){const l=this.elements,c=2*r/(t-e),h=2*r/(i-n),u=(t+e)/(t-e),m=(i+n)/(i-n);let p,_;if(o===To)p=-(a+r)/(a-r),_=-2*a*r/(a-r);else{if(2001!==o)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);p=-a/(a-r),_=-a*r/(a-r)}return l[0]=c,l[4]=0,l[8]=u,l[12]=0,l[1]=0,l[5]=h,l[9]=m,l[13]=0,l[2]=0,l[6]=0,l[10]=p,l[14]=_,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,n,r,a,o=To){const l=this.elements,c=1/(t-e),h=1/(i-n),u=1/(a-r),m=(t+e)*c,p=(i+n)*h;let _,g;if(o===To)_=(a+r)*u,g=-2*u;else{if(2001!==o)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);_=r*u,g=-1*u}return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-m,l[1]=0,l[5]=2*h,l[9]=0,l[13]=-p,l[2]=0,l[6]=0,l[10]=g,l[14]=-_,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let n=0;n<16;n++)if(t[n]!==i[n])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const vh=new Z,Ja=new Ut,jO=new Z(0,0,0),ZO=new Z(1,1,1),Vl=new Z,Of=new Z,fa=new Z,_1=new Ut,b1=new Jn;let Qa=(()=>{class s{constructor(t=0,i=0,n=0,r=s.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=n,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,n,r=this._order){return this._x=t,this._y=i,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,n=!0){const r=t.elements,a=r[0],o=r[4],l=r[8],c=r[1],h=r[5],u=r[9],m=r[2],p=r[6],_=r[10];switch(i){case"XYZ":this._y=Math.asin(ws(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,_),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(p,h),this._z=0);break;case"YXZ":this._x=Math.asin(-ws(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(l,_),this._z=Math.atan2(c,h)):(this._y=Math.atan2(-m,a),this._z=0);break;case"ZXY":this._x=Math.asin(ws(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-m,_),this._z=Math.atan2(-o,h)):(this._y=0,this._z=Math.atan2(c,a));break;case"ZYX":this._y=Math.asin(-ws(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(p,_),this._z=Math.atan2(c,a)):(this._x=0,this._z=Math.atan2(-o,h));break;case"YZX":this._z=Math.asin(ws(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-u,h),this._y=Math.atan2(-m,a)):(this._x=0,this._y=Math.atan2(l,_));break;case"XZY":this._z=Math.asin(-ws(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(p,h),this._y=Math.atan2(l,a)):(this._x=Math.atan2(-u,_),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===n&&this._onChangeCallback(),this}setFromQuaternion(t,i,n){return _1.makeRotationFromQuaternion(t),this.setFromRotationMatrix(_1,i,n)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return b1.setFromEuler(this),this.setFromQuaternion(b1,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return s.DEFAULT_ORDER="XYZ",s})();class Dv{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let XO=0;const v1=new Z,yh=new Jn,sl=new Ut,Rf=new Z,dm=new Z,qO=new Z,$O=new Jn,y1=new Z(1,0,0),x1=new Z(0,1,0),w1=new Z(0,0,1),KO={type:"added"},JO={type:"removed"};let Qn=(()=>{class s extends Yc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:XO++}),this.uuid=pa(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=s.DEFAULT_UP.clone();const t=new Z,i=new Qa,n=new Jn,r=new Z(1,1,1);i._onChange(function a(){n.setFromEuler(i,!1)}),n._onChange(function o(){i.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Ut},normalMatrix:{value:new Xi}}),this.matrix=new Ut,this.matrixWorld=new Ut,this.matrixAutoUpdate=s.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=s.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Dv,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return yh.setFromAxisAngle(t,i),this.quaternion.multiply(yh),this}rotateOnWorldAxis(t,i){return yh.setFromAxisAngle(t,i),this.quaternion.premultiply(yh),this}rotateX(t){return this.rotateOnAxis(y1,t)}rotateY(t){return this.rotateOnAxis(x1,t)}rotateZ(t){return this.rotateOnAxis(w1,t)}translateOnAxis(t,i){return v1.copy(t).applyQuaternion(this.quaternion),this.position.add(v1.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(y1,t)}translateY(t){return this.translateOnAxis(x1,t)}translateZ(t){return this.translateOnAxis(w1,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(sl.copy(this.matrixWorld).invert())}lookAt(t,i,n){t.isVector3?Rf.copy(t):Rf.set(t,i,n);const r=this.parent;this.updateWorldMatrix(!0,!1),dm.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?sl.lookAt(dm,Rf,this.up):sl.lookAt(Rf,dm,this.up),this.quaternion.setFromRotationMatrix(sl),r&&(sl.extractRotation(r.matrixWorld),yh.setFromRotationMatrix(sl),this.quaternion.premultiply(yh.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(KO)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(JO)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),sl.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),sl.multiply(t.parent.matrixWorld)),t.applyMatrix4(sl),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let n=0,r=this.children.length;n<r;n++){const o=this.children[n].getObjectByProperty(t,i);if(void 0!==o)return o}}getObjectsByProperty(t,i,n=[]){this[t]===i&&n.push(this);const r=this.children;for(let a=0,o=r.length;a<o;a++)r[a].getObjectsByProperty(t,i,n);return n}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(dm,t,qO),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(dm,$O,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let n=0,r=i.length;n<r;n++)i[n].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let n=0,r=i.length;n<r;n++)i[n].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let n=0,r=i.length;n<r;n++){const a=i[n];(!0===a.matrixWorldAutoUpdate||!0===t)&&a.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const n=this.parent;if(!0===t&&null!==n&&!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i){const r=this.children;for(let a=0,o=r.length;a<o;a++){const l=r[a];!0===l.matrixWorldAutoUpdate&&l.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=void 0===t||"string"==typeof t,n={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};function a(l,c){return void 0===l[c.uuid]&&(l[c.uuid]=c.toJSON(t)),c.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(l=>({boxInitialized:l.boxInitialized,boxMin:l.box.min.toArray(),boxMax:l.box.max.toArray(),sphereInitialized:l.sphereInitialized,sphereRadius:l.sphere.radius,sphereCenter:l.sphere.center.toArray()})),r.maxGeometryCount=this._maxGeometryCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(t),null!==this.boundingSphere&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),null!==this.boundingBox&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=a(t.geometries,this.geometry);const l=this.geometry.parameters;if(void 0!==l&&void 0!==l.shapes){const c=l.shapes;if(Array.isArray(c))for(let h=0,u=c.length;h<u;h++)a(t.shapes,c[h]);else a(t.shapes,c)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(a(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const l=[];for(let c=0,h=this.material.length;c<h;c++)l.push(a(t.materials,this.material[c]));r.material=l}else r.material=a(t.materials,this.material);if(this.children.length>0){r.children=[];for(let l=0;l<this.children.length;l++)r.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(let l=0;l<this.animations.length;l++)r.animations.push(a(t.animations,this.animations[l]))}if(i){const l=o(t.geometries),c=o(t.materials),h=o(t.textures),u=o(t.images),m=o(t.shapes),p=o(t.skeletons),_=o(t.animations),g=o(t.nodes);l.length>0&&(n.geometries=l),c.length>0&&(n.materials=c),h.length>0&&(n.textures=h),u.length>0&&(n.images=u),m.length>0&&(n.shapes=m),p.length>0&&(n.skeletons=p),_.length>0&&(n.animations=_),g.length>0&&(n.nodes=g)}return n.object=r,n;function o(l){const c=[];for(const h in l){const u=l[h];delete u.metadata,c.push(u)}return c}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let n=0;n<t.children.length;n++)this.add(t.children[n].clone());return this}}return s.DEFAULT_UP=new Z(0,1,0),s.DEFAULT_MATRIX_AUTO_UPDATE=!0,s.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,s})();const eo=new Z,rl=new Z,Ev=new Z,al=new Z,xh=new Z,wh=new Z,M1=new Z,Sv=new Z,kv=new Z,Av=new Z;let If=!1;class ga{constructor(e=new Z,t=new Z,i=new Z){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,n){n.subVectors(i,t),eo.subVectors(e,t),n.cross(eo);const r=n.lengthSq();return r>0?n.multiplyScalar(1/Math.sqrt(r)):n.set(0,0,0)}static getBarycoord(e,t,i,n,r){eo.subVectors(n,t),rl.subVectors(i,t),Ev.subVectors(e,t);const a=eo.dot(eo),o=eo.dot(rl),l=eo.dot(Ev),c=rl.dot(rl),h=rl.dot(Ev),u=a*c-o*o;if(0===u)return r.set(0,0,0),null;const m=1/u,p=(c*l-o*h)*m,_=(a*h-o*l)*m;return r.set(1-p-_,_,p)}static containsPoint(e,t,i,n){return null!==this.getBarycoord(e,t,i,n,al)&&al.x>=0&&al.y>=0&&al.x+al.y<=1}static getUV(e,t,i,n,r,a,o,l){return!1===If&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),If=!0),this.getInterpolation(e,t,i,n,r,a,o,l)}static getInterpolation(e,t,i,n,r,a,o,l){return null===this.getBarycoord(e,t,i,n,al)?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(r,al.x),l.addScaledVector(a,al.y),l.addScaledVector(o,al.z),l)}static isFrontFacing(e,t,i,n){return eo.subVectors(i,t),rl.subVectors(e,t),eo.cross(rl).dot(n)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,n){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,t,i,n){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return eo.subVectors(this.c,this.b),rl.subVectors(this.a,this.b),.5*eo.cross(rl).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ga.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ga.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,n,r){return!1===If&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),If=!0),ga.getInterpolation(e,this.a,this.b,this.c,t,i,n,r)}getInterpolation(e,t,i,n,r){return ga.getInterpolation(e,this.a,this.b,this.c,t,i,n,r)}containsPoint(e){return ga.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ga.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,n=this.b,r=this.c;let a,o;xh.subVectors(n,i),wh.subVectors(r,i),Sv.subVectors(e,i);const l=xh.dot(Sv),c=wh.dot(Sv);if(l<=0&&c<=0)return t.copy(i);kv.subVectors(e,n);const h=xh.dot(kv),u=wh.dot(kv);if(h>=0&&u<=h)return t.copy(n);const m=l*u-h*c;if(m<=0&&l>=0&&h<=0)return a=l/(l-h),t.copy(i).addScaledVector(xh,a);Av.subVectors(e,r);const p=xh.dot(Av),_=wh.dot(Av);if(_>=0&&p<=_)return t.copy(r);const g=p*c-l*_;if(g<=0&&c>=0&&_<=0)return o=c/(c-_),t.copy(i).addScaledVector(wh,o);const f=h*_-p*u;if(f<=0&&u-h>=0&&p-_>=0)return M1.subVectors(r,n),o=(u-h)/(u-h+(p-_)),t.copy(n).addScaledVector(M1,o);const b=1/(f+g+m);return a=g*b,o=m*b,t.copy(i).addScaledVector(xh,a).addScaledVector(wh,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const T1={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Wl={h:0,s:0,l:0},Lf={h:0,s:0,l:0};function Pv(s,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?s+6*(e-s)*t:t<.5?e:t<2/3?s+6*(e-s)*(2/3-t):s}class xt{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(void 0===t&&void 0===i){const n=e;n&&n.isColor?this.copy(n):"number"==typeof n?this.setHex(n):"string"==typeof n&&this.setStyle(n)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Un){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Dn.toWorkingColorSpace(this,t),this}setRGB(e,t,i,n=Dn.workingColorSpace){return this.r=e,this.g=t,this.b=i,Dn.toWorkingColorSpace(this,n),this}setHSL(e,t,i,n=Dn.workingColorSpace){if(e=mv(e,1),t=ws(t,0,1),i=ws(i,0,1),0===t)this.r=this.g=this.b=i;else{const r=i<=.5?i*(1+t):i+t-i*t,a=2*i-r;this.r=Pv(a,r,e+1/3),this.g=Pv(a,r,e),this.b=Pv(a,r,e-1/3)}return Dn.toWorkingColorSpace(this,n),this}setStyle(e,t=Un){function i(r){void 0!==r&&parseFloat(r)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const o=n[2];switch(n[1]){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,t);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,t);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){const r=n[1],a=r.length;if(3===a)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,t);if(6===a)return this.setHex(parseInt(r,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Un){const i=T1[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=uh(e.r),this.g=uh(e.g),this.b=uh(e.b),this}copyLinearToSRGB(e){return this.r=_v(e.r),this.g=_v(e.g),this.b=_v(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Un){return Dn.fromWorkingColorSpace(Cr.copy(this),e),65536*Math.round(ws(255*Cr.r,0,255))+256*Math.round(ws(255*Cr.g,0,255))+Math.round(ws(255*Cr.b,0,255))}getHexString(e=Un){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Dn.workingColorSpace){Dn.fromWorkingColorSpace(Cr.copy(this),t);const i=Cr.r,n=Cr.g,r=Cr.b,a=Math.max(i,n,r),o=Math.min(i,n,r);let l,c;const h=(o+a)/2;if(o===a)l=0,c=0;else{const u=a-o;switch(c=h<=.5?u/(a+o):u/(2-a-o),a){case i:l=(n-r)/u+(n<r?6:0);break;case n:l=(r-i)/u+2;break;case r:l=(i-n)/u+4}l/=6}return e.h=l,e.s=c,e.l=h,e}getRGB(e,t=Dn.workingColorSpace){return Dn.fromWorkingColorSpace(Cr.copy(this),t),e.r=Cr.r,e.g=Cr.g,e.b=Cr.b,e}getStyle(e=Un){Dn.fromWorkingColorSpace(Cr.copy(this),e);const t=Cr.r,i=Cr.g,n=Cr.b;return e!==Un?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${n.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*n)})`}offsetHSL(e,t,i){return this.getHSL(Wl),this.setHSL(Wl.h+e,Wl.s+t,Wl.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Wl),e.getHSL(Lf);const i=rm(Wl.h,Lf.h,t),n=rm(Wl.s,Lf.s,t),r=rm(Wl.l,Lf.l,t);return this.setHSL(i,n,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,n=this.b,r=e.elements;return this.r=r[0]*t+r[3]*i+r[6]*n,this.g=r[1]*t+r[4]*i+r[7]*n,this.b=r[2]*t+r[5]*i+r[8]*n,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Cr=new xt;xt.NAMES=T1;let QO=0;class _a extends Yc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:QO++}),this.uuid=pa(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new xt(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ch,this.stencilZFail=ch,this.stencilZPass=ch,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const n=this[t];void 0!==n?n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[t]=i:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function n(r){const a=[];for(const o in r){const l=r[o];delete l.metadata,a.push(l)}return a}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),!0===this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=!0),204!==this.blendSrc&&(i.blendSrc=this.blendSrc),205!==this.blendDst&&(i.blendDst=this.blendDst),100!==this.blendEquation&&(i.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(i.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(i.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(i.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(i.depthFunc=this.depthFunc),!1===this.depthTest&&(i.depthTest=this.depthTest),!1===this.depthWrite&&(i.depthWrite=this.depthWrite),!1===this.colorWrite&&(i.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(i.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(i.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(i.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==ch&&(i.stencilFail=this.stencilFail),this.stencilZFail!==ch&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==ch&&(i.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(i.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=!0),!0===this.alphaToCoverage&&(i.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=!0),!0===this.forceSinglePass&&(i.forceSinglePass=!0),!0===this.wireframe&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const r=n(e.textures),a=n(e.images);r.length>0&&(i.textures=r),a.length>0&&(i.images=a)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const n=t.length;i=new Array(n);for(let r=0;r!==n;++r)i[r]=t[r].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class ka extends _a{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new xt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=gf,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Ws=new Z,Ff=new Xe;class os{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Mo,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return console.warn("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let n=0,r=this.itemSize;n<r;n++)this.array[e+n]=t.array[i+n];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)Ff.fromBufferAttribute(this,t),Ff.applyMatrix3(e),this.setXY(t,Ff.x,Ff.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)Ws.fromBufferAttribute(this,t),Ws.applyMatrix3(e),this.setXYZ(t,Ws.x,Ws.y,Ws.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Ws.fromBufferAttribute(this,t),Ws.applyMatrix4(e),this.setXYZ(t,Ws.x,Ws.y,Ws.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Ws.fromBufferAttribute(this,t),Ws.applyNormalMatrix(e),this.setXYZ(t,Ws.x,Ws.y,Ws.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Ws.fromBufferAttribute(this,t),Ws.transformDirection(e),this.setXYZ(t,Ws.x,Ws.y,Ws.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=$r(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Yi(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=$r(t,this.array)),t}setX(e,t){return this.normalized&&(t=Yi(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=$r(t,this.array)),t}setY(e,t){return this.normalized&&(t=Yi(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=$r(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Yi(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=$r(t,this.array)),t}setW(e,t){return this.normalized&&(t=Yi(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Yi(t,this.array),i=Yi(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,n){return e*=this.itemSize,this.normalized&&(t=Yi(t,this.array),i=Yi(i,this.array),n=Yi(n,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this}setXYZW(e,t,i,n,r){return e*=this.itemSize,this.normalized&&(t=Yi(t,this.array),i=Yi(i,this.array),n=Yi(n,this.array),r=Yi(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),e}}class Ov extends os{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class C1 extends os{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Xt extends os{constructor(e,t,i){super(new Float32Array(e),t,i)}}let tR=0;const Aa=new Ut,Rv=new Qn,Mh=new Z,ba=new Vs,um=new Vs,lr=new Z;class Ui extends Yc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:tR++}),this.uuid=pa(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(d1(e)?C1:Ov)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const r=(new Xi).getNormalMatrix(e);i.applyNormalMatrix(r),i.needsUpdate=!0}const n=this.attributes.tangent;return void 0!==n&&(n.transformDirection(e),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Aa.makeRotationFromQuaternion(e),this.applyMatrix4(Aa),this}rotateX(e){return Aa.makeRotationX(e),this.applyMatrix4(Aa),this}rotateY(e){return Aa.makeRotationY(e),this.applyMatrix4(Aa),this}rotateZ(e){return Aa.makeRotationZ(e),this.applyMatrix4(Aa),this}translate(e,t,i){return Aa.makeTranslation(e,t,i),this.applyMatrix4(Aa),this}scale(e,t,i){return Aa.makeScale(e,t,i),this.applyMatrix4(Aa),this}lookAt(e){return Rv.lookAt(e),Rv.updateMatrix(),this.applyMatrix4(Rv.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Mh).negate(),this.translate(Mh.x,Mh.y,Mh.z),this}setFromPoints(e){const t=[];for(let i=0,n=e.length;i<n;i++){const r=e[i];t.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new Xt(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Vs);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Z(-1/0,-1/0,-1/0),new Z(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,n=t.length;i<n;i++)ba.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(lr.addVectors(this.boundingBox.min,ba.min),this.boundingBox.expandByPoint(lr),lr.addVectors(this.boundingBox.max,ba.max),this.boundingBox.expandByPoint(lr)):(this.boundingBox.expandByPoint(ba.min),this.boundingBox.expandByPoint(ba.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Tr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Z,1/0);if(e){const i=this.boundingSphere.center;if(ba.setFromBufferAttribute(e),t)for(let r=0,a=t.length;r<a;r++)um.setFromBufferAttribute(t[r]),this.morphTargetsRelative?(lr.addVectors(ba.min,um.min),ba.expandByPoint(lr),lr.addVectors(ba.max,um.max),ba.expandByPoint(lr)):(ba.expandByPoint(um.min),ba.expandByPoint(um.max));ba.getCenter(i);let n=0;for(let r=0,a=e.count;r<a;r++)lr.fromBufferAttribute(e,r),n=Math.max(n,i.distanceToSquared(lr));if(t)for(let r=0,a=t.length;r<a;r++){const o=t[r],l=this.morphTargetsRelative;for(let c=0,h=o.count;c<h;c++)lr.fromBufferAttribute(o,c),l&&(Mh.fromBufferAttribute(e,c),lr.add(Mh)),n=Math.max(n,i.distanceToSquared(lr))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,n=t.position.array,r=t.normal.array,a=t.uv.array,o=n.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new os(new Float32Array(4*o),4));const l=this.getAttribute("tangent").array,c=[],h=[];for(let B=0;B<o;B++)c[B]=new Z,h[B]=new Z;const u=new Z,m=new Z,p=new Z,_=new Xe,g=new Xe,f=new Xe,b=new Z,C=new Z;function M(B,Q,pe){u.fromArray(n,3*B),m.fromArray(n,3*Q),p.fromArray(n,3*pe),_.fromArray(a,2*B),g.fromArray(a,2*Q),f.fromArray(a,2*pe),m.sub(u),p.sub(u),g.sub(_),f.sub(_);const ae=1/(g.x*f.y-f.x*g.y);isFinite(ae)&&(b.copy(m).multiplyScalar(f.y).addScaledVector(p,-g.y).multiplyScalar(ae),C.copy(p).multiplyScalar(g.x).addScaledVector(m,-f.x).multiplyScalar(ae),c[B].add(b),c[Q].add(b),c[pe].add(b),h[B].add(C),h[Q].add(C),h[pe].add(C))}let E=this.groups;0===E.length&&(E=[{start:0,count:i.length}]);for(let B=0,Q=E.length;B<Q;++B){const pe=E[B],ae=pe.start;for(let ee=ae,K=ae+pe.count;ee<K;ee+=3)M(i[ee+0],i[ee+1],i[ee+2])}const S=new Z,P=new Z,I=new Z,L=new Z;function O(B){I.fromArray(r,3*B),L.copy(I);const Q=c[B];S.copy(Q),S.sub(I.multiplyScalar(I.dot(Q))).normalize(),P.crossVectors(L,Q);const ae=P.dot(h[B])<0?-1:1;l[4*B]=S.x,l[4*B+1]=S.y,l[4*B+2]=S.z,l[4*B+3]=ae}for(let B=0,Q=E.length;B<Q;++B){const pe=E[B],ae=pe.start;for(let ee=ae,K=ae+pe.count;ee<K;ee+=3)O(i[ee+0]),O(i[ee+1]),O(i[ee+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new os(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let m=0,p=i.count;m<p;m++)i.setXYZ(m,0,0,0);const n=new Z,r=new Z,a=new Z,o=new Z,l=new Z,c=new Z,h=new Z,u=new Z;if(e)for(let m=0,p=e.count;m<p;m+=3){const _=e.getX(m+0),g=e.getX(m+1),f=e.getX(m+2);n.fromBufferAttribute(t,_),r.fromBufferAttribute(t,g),a.fromBufferAttribute(t,f),h.subVectors(a,r),u.subVectors(n,r),h.cross(u),o.fromBufferAttribute(i,_),l.fromBufferAttribute(i,g),c.fromBufferAttribute(i,f),o.add(h),l.add(h),c.add(h),i.setXYZ(_,o.x,o.y,o.z),i.setXYZ(g,l.x,l.y,l.z),i.setXYZ(f,c.x,c.y,c.z)}else for(let m=0,p=t.count;m<p;m+=3)n.fromBufferAttribute(t,m+0),r.fromBufferAttribute(t,m+1),a.fromBufferAttribute(t,m+2),h.subVectors(a,r),u.subVectors(n,r),h.cross(u),i.setXYZ(m+0,h.x,h.y,h.z),i.setXYZ(m+1,h.x,h.y,h.z),i.setXYZ(m+2,h.x,h.y,h.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)lr.fromBufferAttribute(e,t),lr.normalize(),e.setXYZ(t,lr.x,lr.y,lr.z)}toNonIndexed(){function e(o,l){const c=o.array,h=o.itemSize,u=o.normalized,m=new c.constructor(l.length*h);let p=0,_=0;for(let g=0,f=l.length;g<f;g++){p=o.isInterleavedBufferAttribute?l[g]*o.data.stride+o.offset:l[g]*h;for(let b=0;b<h;b++)m[_++]=c[p++]}return new os(m,h,u)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Ui,i=this.index.array,n=this.attributes;for(const o in n){const c=e(n[o],i);t.setAttribute(o,c)}const r=this.morphAttributes;for(const o in r){const l=[],c=r[o];for(let h=0,u=c.length;h<u;h++){const p=e(c[h],i);l.push(p)}t.morphAttributes[o]=l}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,l=a.length;o<l;o++){const c=a[o];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i)e.data.attributes[l]=i[l].toJSON(e.data);const n={};let r=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],h=[];for(let u=0,m=c.length;u<m;u++)h.push(c[u].toJSON(e.data));h.length>0&&(n[l]=h,r=!0)}r&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return null!==o&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const n=e.attributes;for(const c in n)this.setAttribute(c,n[c].clone(t));const r=e.morphAttributes;for(const c in r){const h=[],u=r[c];for(let m=0,p=u.length;m<p;m++)h.push(u[m].clone(t));this.morphAttributes[c]=h}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let c=0,h=a.length;c<h;c++){const u=a[c];this.addGroup(u.start,u.count,u.materialIndex)}const o=e.boundingBox;null!==o&&(this.boundingBox=o.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const D1=new Ut,$c=new bh,Bf=new Tr,E1=new Z,Th=new Z,Ch=new Z,Dh=new Z,Iv=new Z,Nf=new Z,Uf=new Xe,zf=new Xe,Hf=new Xe,S1=new Z,k1=new Z,A1=new Z,Vf=new Z,Wf=new Z;class Js extends Qn{constructor(e=new Ui,t=new ka){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const n=t[i[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,a=n.length;r<a;r++){const o=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=r}}}}getVertexPosition(e,t){const i=this.geometry,r=i.morphAttributes.position,a=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const o=this.morphTargetInfluences;if(r&&o){Nf.set(0,0,0);for(let l=0,c=r.length;l<c;l++){const h=o[l];0!==h&&(Iv.fromBufferAttribute(r[l],e),Nf.addScaledVector(a?Iv:Iv.sub(t),h))}t.add(Nf)}return t}raycast(e,t){const i=this.geometry,r=this.matrixWorld;void 0!==this.material&&(null===i.boundingSphere&&i.computeBoundingSphere(),Bf.copy(i.boundingSphere),Bf.applyMatrix4(r),$c.copy(e.ray).recast(e.near),(!1!==Bf.containsPoint($c.origin)||!(null===$c.intersectSphere(Bf,E1)||$c.origin.distanceToSquared(E1)>(e.far-e.near)**2))&&(D1.copy(r).invert(),$c.copy(e.ray).applyMatrix4(D1),(null===i.boundingBox||!1!==$c.intersectsBox(i.boundingBox))&&this._computeIntersections(e,t,$c)))}_computeIntersections(e,t,i){let n;const r=this.geometry,a=this.material,o=r.index,l=r.attributes.position,c=r.attributes.uv,h=r.attributes.uv1,u=r.attributes.normal,m=r.groups,p=r.drawRange;if(null!==o)if(Array.isArray(a))for(let _=0,g=m.length;_<g;_++){const f=m[_],b=a[f.materialIndex];for(let E=Math.max(f.start,p.start),S=Math.min(o.count,Math.min(f.start+f.count,p.start+p.count));E<S;E+=3)n=Gf(this,b,e,i,c,h,u,o.getX(E),o.getX(E+1),o.getX(E+2)),n&&(n.faceIndex=Math.floor(E/3),n.face.materialIndex=f.materialIndex,t.push(n))}else for(let f=Math.max(0,p.start),b=Math.min(o.count,p.start+p.count);f<b;f+=3)n=Gf(this,a,e,i,c,h,u,o.getX(f),o.getX(f+1),o.getX(f+2)),n&&(n.faceIndex=Math.floor(f/3),t.push(n));else if(void 0!==l)if(Array.isArray(a))for(let _=0,g=m.length;_<g;_++){const f=m[_],b=a[f.materialIndex];for(let E=Math.max(f.start,p.start),S=Math.min(l.count,Math.min(f.start+f.count,p.start+p.count));E<S;E+=3)n=Gf(this,b,e,i,c,h,u,E,E+1,E+2),n&&(n.faceIndex=Math.floor(E/3),n.face.materialIndex=f.materialIndex,t.push(n))}else for(let f=Math.max(0,p.start),b=Math.min(l.count,p.start+p.count);f<b;f+=3)n=Gf(this,a,e,i,c,h,u,f,f+1,f+2),n&&(n.faceIndex=Math.floor(f/3),t.push(n))}}function Gf(s,e,t,i,n,r,a,o,l,c){s.getVertexPosition(o,Th),s.getVertexPosition(l,Ch),s.getVertexPosition(c,Dh);const h=function iR(s,e,t,i,n,r,a,o){let l;if(l=1===e.side?i.intersectTriangle(a,r,n,!0,o):i.intersectTriangle(n,r,a,0===e.side,o),null===l)return null;Wf.copy(o),Wf.applyMatrix4(s.matrixWorld);const c=t.ray.origin.distanceTo(Wf);return c<t.near||c>t.far?null:{distance:c,point:Wf.clone(),object:s}}(s,e,t,i,Th,Ch,Dh,Vf);if(h){n&&(Uf.fromBufferAttribute(n,o),zf.fromBufferAttribute(n,l),Hf.fromBufferAttribute(n,c),h.uv=ga.getInterpolation(Vf,Th,Ch,Dh,Uf,zf,Hf,new Xe)),r&&(Uf.fromBufferAttribute(r,o),zf.fromBufferAttribute(r,l),Hf.fromBufferAttribute(r,c),h.uv1=ga.getInterpolation(Vf,Th,Ch,Dh,Uf,zf,Hf,new Xe),h.uv2=h.uv1),a&&(S1.fromBufferAttribute(a,o),k1.fromBufferAttribute(a,l),A1.fromBufferAttribute(a,c),h.normal=ga.getInterpolation(Vf,Th,Ch,Dh,S1,k1,A1,new Z),h.normal.dot(i.direction)>0&&h.normal.multiplyScalar(-1));const u={a:o,b:l,c,normal:new Z,materialIndex:0};ga.getNormal(Th,Ch,Dh,u.normal),h.face=u}return h}class Eh extends Ui{constructor(e=1,t=1,i=1,n=1,r=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:n,heightSegments:r,depthSegments:a};const o=this;n=Math.floor(n),r=Math.floor(r),a=Math.floor(a);const l=[],c=[],h=[],u=[];let m=0,p=0;function _(g,f,b,C,M,E,S,P,I,L,O){const B=E/I,Q=S/L,pe=E/2,ae=S/2,N=P/2,ee=I+1,K=L+1;let se=0,ue=0;const re=new Z;for(let xe=0;xe<K;xe++){const Ce=xe*Q-ae;for(let Fe=0;Fe<ee;Fe++)re[g]=(Fe*B-pe)*C,re[f]=Ce*M,re[b]=N,c.push(re.x,re.y,re.z),re[g]=0,re[f]=0,re[b]=P>0?1:-1,h.push(re.x,re.y,re.z),u.push(Fe/I),u.push(1-xe/L),se+=1}for(let xe=0;xe<L;xe++)for(let Ce=0;Ce<I;Ce++){const Te=m+Ce+ee*(xe+1),Le=m+(Ce+1)+ee*(xe+1),Ge=m+(Ce+1)+ee*xe;l.push(m+Ce+ee*xe,Te,Ge),l.push(Te,Le,Ge),ue+=6}o.addGroup(p,ue,O),p+=ue,m+=se}_("z","y","x",-1,-1,i,t,e,a,r,0),_("z","y","x",1,-1,i,t,-e,a,r,1),_("x","z","y",1,1,e,i,t,n,a,2),_("x","z","y",1,-1,e,i,-t,n,a,3),_("x","y","z",1,-1,e,t,i,n,r,4),_("x","y","z",-1,-1,e,t,-i,n,r,5),this.setIndex(l),this.setAttribute("position",new Xt(c,3)),this.setAttribute("normal",new Xt(h,3)),this.setAttribute("uv",new Xt(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Eh(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Sh(s){const e={};for(const t in s){e[t]={};for(const i in s[t]){const n=s[t][i];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?n.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=n.clone():e[t][i]=Array.isArray(n)?n.slice():n}}return e}function Or(s){const e={};for(let t=0;t<s.length;t++){const i=Sh(s[t]);for(const n in i)e[n]=i[n]}return e}function P1(s){return null===s.getRenderTarget()?s.outputColorSpace:Dn.workingColorSpace}const sR={clone:Sh,merge:Or};class Gl extends _a{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Sh(e.uniforms),this.uniformsGroups=function nR(s){const e=[];for(let t=0;t<s.length;t++)e.push(s[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const n in this.uniforms){const a=this.uniforms[n].value;t.uniforms[n]=a&&a.isTexture?{type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?{type:"c",value:a.getHex()}:a&&a.isVector2?{type:"v2",value:a.toArray()}:a&&a.isVector3?{type:"v3",value:a.toArray()}:a&&a.isVector4?{type:"v4",value:a.toArray()}:a&&a.isMatrix3?{type:"m3",value:a.toArray()}:a&&a.isMatrix4?{type:"m4",value:a.toArray()}:{value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const n in this.extensions)!0===this.extensions[n]&&(i[n]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class Lv extends Qn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ut,this.projectionMatrix=new Ut,this.projectionMatrixInverse=new Ut,this.coordinateSystem=To}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Qs extends Lv{constructor(e=50,t=1,i=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*dh*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*jc*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*dh*Math.atan(Math.tan(.5*jc*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,n,r,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*jc*this.fov)/this.zoom,i=2*t,n=this.aspect*i,r=-.5*n;const a=this.view;if(null!==this.view&&this.view.enabled){const l=a.fullWidth,c=a.fullHeight;r+=a.offsetX*n/l,t-=a.offsetY*i/c,n*=a.width/l,i*=a.height/c}const o=this.filmOffset;0!==o&&(r+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+n,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class oR extends Qn{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const n=new Qs(-90,1,e,t);n.layers=this.layers,this.add(n);const r=new Qs(-90,1,e,t);r.layers=this.layers,this.add(r);const a=new Qs(-90,1,e,t);a.layers=this.layers,this.add(a);const o=new Qs(-90,1,e,t);o.layers=this.layers,this.add(o);const l=new Qs(-90,1,e,t);l.layers=this.layers,this.add(l);const c=new Qs(-90,1,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,n,r,a,o,l]=t;for(const c of t)this.remove(c);if(e===To)i.up.set(0,1,0),i.lookAt(1,0,0),n.up.set(0,1,0),n.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);i.up.set(0,-1,0),i.lookAt(-1,0,0),n.up.set(0,-1,0),n.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1)}for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:n}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,a,o,l,c,h]=this.children,u=e.getRenderTarget(),m=e.getActiveCubeFace(),p=e.getActiveMipmapLevel(),_=e.xr.enabled;e.xr.enabled=!1;const g=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,n),e.render(t,r),e.setRenderTarget(i,1,n),e.render(t,a),e.setRenderTarget(i,2,n),e.render(t,o),e.setRenderTarget(i,3,n),e.render(t,l),e.setRenderTarget(i,4,n),e.render(t,c),i.texture.generateMipmaps=g,e.setRenderTarget(i,5,n),e.render(t,h),e.setRenderTarget(u,m,p),e.xr.enabled=_,i.texture.needsPMREMUpdate=!0}}class Yf extends Kr{constructor(e,t,i,n,r,a,o,l,c,h){super(e=void 0!==e?e:[],t=void 0!==t?t:Fl,i,n,r,a,o,l,c,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class lR extends Zc{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},n=[i,i,i,i,i,i];void 0!==t.encoding&&(om("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===Wc?Un:""),this.texture=new Yf(n,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:xs}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",n=new Eh(5,5,5),r=new Gl({name:"CubemapFromEquirect",uniforms:Sh(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});r.uniforms.tEquirect.value=t;const a=new Js(n,r),o=t.minFilter;return t.minFilter===tl&&(t.minFilter=xs),new oR(1,10,this).update(e,a),t.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,i,n){const r=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,i,n);e.setRenderTarget(r)}}const Fv=new Z,cR=new Z,dR=new Xi;class Yl{constructor(e=new Z(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,n){return this.normal.set(e,t,i),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const n=Fv.subVectors(i,t).cross(cR.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(Fv),n=this.normal.dot(i);if(0===n)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/n;return r<0||r>1?null:t.copy(e.start).addScaledVector(i,r)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||dR.getNormalMatrix(e),n=this.coplanarPoint(Fv).applyMatrix4(e),r=this.normal.applyMatrix3(i).normalize();return this.constant=-n.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Kc=new Tr,jf=new Z;class Zf{constructor(e=new Yl,t=new Yl,i=new Yl,n=new Yl,r=new Yl,a=new Yl){this.planes=[e,t,i,n,r,a]}set(e,t,i,n,r,a){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(i),o[3].copy(n),o[4].copy(r),o[5].copy(a),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=To){const i=this.planes,n=e.elements,r=n[0],a=n[1],o=n[2],l=n[3],c=n[4],h=n[5],u=n[6],m=n[7],p=n[8],_=n[9],g=n[10],f=n[11],b=n[12],C=n[13],M=n[14],E=n[15];if(i[0].setComponents(l-r,m-c,f-p,E-b).normalize(),i[1].setComponents(l+r,m+c,f+p,E+b).normalize(),i[2].setComponents(l+a,m+h,f+_,E+C).normalize(),i[3].setComponents(l-a,m-h,f-_,E-C).normalize(),i[4].setComponents(l-o,m-u,f-g,E-M).normalize(),t===To)i[5].setComponents(l+o,m+u,f+g,E+M).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);i[5].setComponents(o,u,g,M).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),Kc.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),Kc.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Kc)}intersectsSprite(e){return Kc.center.set(0,0,0),Kc.radius=.7071067811865476,Kc.applyMatrix4(e.matrixWorld),this.intersectsSphere(Kc)}intersectsSphere(e){const t=this.planes,i=e.center,n=-e.radius;for(let r=0;r<6;r++)if(t[r].distanceToPoint(i)<n)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const n=t[i];if(jf.x=n.normal.x>0?e.max.x:e.min.x,jf.y=n.normal.y>0?e.max.y:e.min.y,jf.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(jf)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function O1(){let s=null,e=!1,t=null,i=null;function n(r,a){t(r,a),i=s.requestAnimationFrame(n)}return{start:function(){!0!==e&&null!==t&&(i=s.requestAnimationFrame(n),e=!0)},stop:function(){s.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(r){t=r},setContext:function(r){s=r}}}function hR(s,e){const t=e.isWebGL2,i=new WeakMap;return{get:function a(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)},remove:function o(c){c.isInterleavedBufferAttribute&&(c=c.data);const h=i.get(c);h&&(s.deleteBuffer(h.buffer),i.delete(c))},update:function l(c,h){if(c.isGLBufferAttribute){const m=i.get(c);return void((!m||m.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version}))}c.isInterleavedBufferAttribute&&(c=c.data);const u=i.get(c);if(void 0===u)i.set(c,function n(c,h){const u=c.array,m=c.usage,p=u.byteLength,_=s.createBuffer();let g;if(s.bindBuffer(h,_),s.bufferData(h,u,m),c.onUploadCallback(),u instanceof Float32Array)g=s.FLOAT;else if(u instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");g=s.HALF_FLOAT}else g=s.UNSIGNED_SHORT;else if(u instanceof Int16Array)g=s.SHORT;else if(u instanceof Uint32Array)g=s.UNSIGNED_INT;else if(u instanceof Int32Array)g=s.INT;else if(u instanceof Int8Array)g=s.BYTE;else if(u instanceof Uint8Array)g=s.UNSIGNED_BYTE;else{if(!(u instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);g=s.UNSIGNED_BYTE}return{buffer:_,type:g,bytesPerElement:u.BYTES_PER_ELEMENT,version:c.version,size:p}}(c,h));else if(u.version<c.version){if(u.size!==c.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");(function r(c,h,u){const m=h.array,p=h._updateRange,_=h.updateRanges;if(s.bindBuffer(u,c),-1===p.count&&0===_.length&&s.bufferSubData(u,0,m),0!==_.length){for(let g=0,f=_.length;g<f;g++){const b=_[g];t?s.bufferSubData(u,b.start*m.BYTES_PER_ELEMENT,m,b.start,b.count):s.bufferSubData(u,b.start*m.BYTES_PER_ELEMENT,m.subarray(b.start,b.start+b.count))}h.clearUpdateRanges()}-1!==p.count&&(t?s.bufferSubData(u,p.offset*m.BYTES_PER_ELEMENT,m,p.offset,p.count):s.bufferSubData(u,p.offset*m.BYTES_PER_ELEMENT,m.subarray(p.offset,p.offset+p.count)),p.count=-1),h.onUploadCallback()})(u.buffer,c,h),u.version=c.version}}}}class Xf extends Ui{constructor(e=1,t=1,i=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:n};const r=e/2,a=t/2,o=Math.floor(i),l=Math.floor(n),c=o+1,h=l+1,u=e/o,m=t/l,p=[],_=[],g=[],f=[];for(let b=0;b<h;b++){const C=b*m-a;for(let M=0;M<c;M++)_.push(M*u-r,-C,0),g.push(0,0,1),f.push(M/o),f.push(1-b/l)}for(let b=0;b<l;b++)for(let C=0;C<o;C++){const E=C+c*(b+1),S=C+1+c*(b+1),P=C+1+c*b;p.push(C+c*b,E,P),p.push(E,S,P)}this.setIndex(p),this.setAttribute("position",new Xt(_,3)),this.setAttribute("normal",new Xt(g,3)),this.setAttribute("uv",new Xt(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Xf(e.width,e.height,e.widthSegments,e.heightSegments)}}const qi={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\tattribute float batchId;\n\tuniform highp sampler2D batchingTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( batchId );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor *= toneMappingExposure;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\treturn color;\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},Rt={common:{diffuse:{value:new xt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Xi},alphaMap:{value:null},alphaMapTransform:{value:new Xi},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Xi}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Xi}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Xi}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Xi},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Xi},normalScale:{value:new Xe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Xi},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Xi}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Xi}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Xi}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new xt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new xt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Xi},alphaTest:{value:0},uvTransform:{value:new Xi}},sprite:{diffuse:{value:new xt(16777215)},opacity:{value:1},center:{value:new Xe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Xi},alphaMap:{value:null},alphaMapTransform:{value:new Xi},alphaTest:{value:0}}},Co={basic:{uniforms:Or([Rt.common,Rt.specularmap,Rt.envmap,Rt.aomap,Rt.lightmap,Rt.fog]),vertexShader:qi.meshbasic_vert,fragmentShader:qi.meshbasic_frag},lambert:{uniforms:Or([Rt.common,Rt.specularmap,Rt.envmap,Rt.aomap,Rt.lightmap,Rt.emissivemap,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,Rt.fog,Rt.lights,{emissive:{value:new xt(0)}}]),vertexShader:qi.meshlambert_vert,fragmentShader:qi.meshlambert_frag},phong:{uniforms:Or([Rt.common,Rt.specularmap,Rt.envmap,Rt.aomap,Rt.lightmap,Rt.emissivemap,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,Rt.fog,Rt.lights,{emissive:{value:new xt(0)},specular:{value:new xt(1118481)},shininess:{value:30}}]),vertexShader:qi.meshphong_vert,fragmentShader:qi.meshphong_frag},standard:{uniforms:Or([Rt.common,Rt.envmap,Rt.aomap,Rt.lightmap,Rt.emissivemap,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,Rt.roughnessmap,Rt.metalnessmap,Rt.fog,Rt.lights,{emissive:{value:new xt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:qi.meshphysical_vert,fragmentShader:qi.meshphysical_frag},toon:{uniforms:Or([Rt.common,Rt.aomap,Rt.lightmap,Rt.emissivemap,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,Rt.gradientmap,Rt.fog,Rt.lights,{emissive:{value:new xt(0)}}]),vertexShader:qi.meshtoon_vert,fragmentShader:qi.meshtoon_frag},matcap:{uniforms:Or([Rt.common,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,Rt.fog,{matcap:{value:null}}]),vertexShader:qi.meshmatcap_vert,fragmentShader:qi.meshmatcap_frag},points:{uniforms:Or([Rt.points,Rt.fog]),vertexShader:qi.points_vert,fragmentShader:qi.points_frag},dashed:{uniforms:Or([Rt.common,Rt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:qi.linedashed_vert,fragmentShader:qi.linedashed_frag},depth:{uniforms:Or([Rt.common,Rt.displacementmap]),vertexShader:qi.depth_vert,fragmentShader:qi.depth_frag},normal:{uniforms:Or([Rt.common,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,{opacity:{value:1}}]),vertexShader:qi.meshnormal_vert,fragmentShader:qi.meshnormal_frag},sprite:{uniforms:Or([Rt.sprite,Rt.fog]),vertexShader:qi.sprite_vert,fragmentShader:qi.sprite_frag},background:{uniforms:{uvTransform:{value:new Xi},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:qi.background_vert,fragmentShader:qi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:qi.backgroundCube_vert,fragmentShader:qi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:qi.cube_vert,fragmentShader:qi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:qi.equirect_vert,fragmentShader:qi.equirect_frag},distanceRGBA:{uniforms:Or([Rt.common,Rt.displacementmap,{referencePosition:{value:new Z},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:qi.distanceRGBA_vert,fragmentShader:qi.distanceRGBA_frag},shadow:{uniforms:Or([Rt.lights,Rt.fog,{color:{value:new xt(0)},opacity:{value:1}}]),vertexShader:qi.shadow_vert,fragmentShader:qi.shadow_frag}};Co.physical={uniforms:Or([Co.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Xi},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Xi},clearcoatNormalScale:{value:new Xe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Xi},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Xi},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Xi},sheen:{value:0},sheenColor:{value:new xt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Xi},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Xi},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Xi},transmissionSamplerSize:{value:new Xe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Xi},attenuationDistance:{value:0},attenuationColor:{value:new xt(0)},specularColor:{value:new xt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Xi},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Xi},anisotropyVector:{value:new Xe},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Xi}}]),vertexShader:qi.meshphysical_vert,fragmentShader:qi.meshphysical_frag};const qf={r:0,b:0,g:0};function u2(s,e,t,i,n,r,a){const o=new xt(0);let c,h,l=!0===r?0:1,u=null,m=0,p=null;function g(f,b){f.getRGB(qf,P1(s)),i.buffers.color.setClear(qf.r,qf.g,qf.b,b,a)}return{getClearColor:function(){return o},setClearColor:function(f,b=1){o.set(f),l=b,g(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(f){l=f,g(o,l)},render:function _(f,b){let C=!1,M=!0===b.isScene?b.background:null;M&&M.isTexture&&(M=(b.backgroundBlurriness>0?t:e).get(M)),null===M?g(o,l):M&&M.isColor&&(g(M,1),C=!0);const E=s.xr.getEnvironmentBlendMode();"additive"===E?i.buffers.color.setClear(0,0,0,1,a):"alpha-blend"===E&&i.buffers.color.setClear(0,0,0,0,a),(s.autoClear||C)&&s.clear(s.autoClearColor,s.autoClearDepth,s.autoClearStencil),M&&(M.isCubeTexture||M.mapping===Qu)?(void 0===h&&(h=new Js(new Eh(1,1,1),new Gl({name:"BackgroundCubeMaterial",uniforms:Sh(Co.backgroundCube.uniforms),vertexShader:Co.backgroundCube.vertexShader,fragmentShader:Co.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(S,P,I){this.matrixWorld.copyPosition(I.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(h)),h.material.uniforms.envMap.value=M,h.material.uniforms.flipEnvMap.value=M.isCubeTexture&&!1===M.isRenderTargetTexture?-1:1,h.material.uniforms.backgroundBlurriness.value=b.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=b.backgroundIntensity,h.material.toneMapped=Dn.getTransfer(M.colorSpace)!==Kn,(u!==M||m!==M.version||p!==s.toneMapping)&&(h.material.needsUpdate=!0,u=M,m=M.version,p=s.toneMapping),h.layers.enableAll(),f.unshift(h,h.geometry,h.material,0,0,null)):M&&M.isTexture&&(void 0===c&&(c=new Js(new Xf(2,2),new Gl({name:"BackgroundMaterial",uniforms:Sh(Co.background.uniforms),vertexShader:Co.background.vertexShader,fragmentShader:Co.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(c)),c.material.uniforms.t2D.value=M,c.material.uniforms.backgroundIntensity.value=b.backgroundIntensity,c.material.toneMapped=Dn.getTransfer(M.colorSpace)!==Kn,!0===M.matrixAutoUpdate&&M.updateMatrix(),c.material.uniforms.uvTransform.value.copy(M.matrix),(u!==M||m!==M.version||p!==s.toneMapping)&&(c.material.needsUpdate=!0,u=M,m=M.version,p=s.toneMapping),c.layers.enableAll(),f.unshift(c,c.geometry,c.material,0,0,null))}}}function m2(s,e,t,i){const n=s.getParameter(s.MAX_VERTEX_ATTRIBS),r=i.isWebGL2?null:e.get("OES_vertex_array_object"),a=i.isWebGL2||null!==r,o={},l=f(null);let c=l,h=!1;function p(N){return i.isWebGL2?s.bindVertexArray(N):r.bindVertexArrayOES(N)}function _(N){return i.isWebGL2?s.deleteVertexArray(N):r.deleteVertexArrayOES(N)}function f(N){const ee=[],K=[],se=[];for(let ue=0;ue<n;ue++)ee[ue]=0,K[ue]=0,se[ue]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:ee,enabledAttributes:K,attributeDivisors:se,object:N,attributes:{},index:null}}function M(){const N=c.newAttributes;for(let ee=0,K=N.length;ee<K;ee++)N[ee]=0}function E(N){S(N,0)}function S(N,ee){const se=c.enabledAttributes,ue=c.attributeDivisors;c.newAttributes[N]=1,0===se[N]&&(s.enableVertexAttribArray(N),se[N]=1),ue[N]!==ee&&((i.isWebGL2?s:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](N,ee),ue[N]=ee)}function P(){const N=c.newAttributes,ee=c.enabledAttributes;for(let K=0,se=ee.length;K<se;K++)ee[K]!==N[K]&&(s.disableVertexAttribArray(K),ee[K]=0)}function I(N,ee,K,se,ue,re,xe){!0===xe?s.vertexAttribIPointer(N,ee,K,ue,re):s.vertexAttribPointer(N,ee,K,se,ue,re)}function pe(){ae(),h=!0,c!==l&&(c=l,p(c.object))}function ae(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function u(N,ee,K,se,ue){let re=!1;if(a){const xe=function g(N,ee,K){const se=!0===K.wireframe;let ue=o[N.id];void 0===ue&&(ue={},o[N.id]=ue);let re=ue[ee.id];void 0===re&&(re={},ue[ee.id]=re);let xe=re[se];return void 0===xe&&(xe=f(function m(){return i.isWebGL2?s.createVertexArray():r.createVertexArrayOES()}()),re[se]=xe),xe}(se,K,ee);c!==xe&&(c=xe,p(c.object)),re=function b(N,ee,K,se){const ue=c.attributes,re=ee.attributes;let xe=0;const Ce=K.getAttributes();for(const Fe in Ce)if(Ce[Fe].location>=0){const Le=ue[Fe];let Ge=re[Fe];if(void 0===Ge&&("instanceMatrix"===Fe&&N.instanceMatrix&&(Ge=N.instanceMatrix),"instanceColor"===Fe&&N.instanceColor&&(Ge=N.instanceColor)),void 0===Le||Le.attribute!==Ge||Ge&&Le.data!==Ge.data)return!0;xe++}return c.attributesNum!==xe||c.index!==se}(N,se,K,ue),re&&function C(N,ee,K,se){const ue={},re=ee.attributes;let xe=0;const Ce=K.getAttributes();for(const Fe in Ce)if(Ce[Fe].location>=0){let Le=re[Fe];void 0===Le&&("instanceMatrix"===Fe&&N.instanceMatrix&&(Le=N.instanceMatrix),"instanceColor"===Fe&&N.instanceColor&&(Le=N.instanceColor));const Ge={};Ge.attribute=Le,Le&&Le.data&&(Ge.data=Le.data),ue[Fe]=Ge,xe++}c.attributes=ue,c.attributesNum=xe,c.index=se}(N,se,K,ue)}else{const xe=!0===ee.wireframe;(c.geometry!==se.id||c.program!==K.id||c.wireframe!==xe)&&(c.geometry=se.id,c.program=K.id,c.wireframe=xe,re=!0)}null!==ue&&t.update(ue,s.ELEMENT_ARRAY_BUFFER),(re||h)&&(h=!1,function L(N,ee,K,se){if(!1===i.isWebGL2&&(N.isInstancedMesh||se.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;M();const ue=se.attributes,re=K.getAttributes(),xe=ee.defaultAttributeValues;for(const Ce in re){const Fe=re[Ce];if(Fe.location>=0){let Te=ue[Ce];if(void 0===Te&&("instanceMatrix"===Ce&&N.instanceMatrix&&(Te=N.instanceMatrix),"instanceColor"===Ce&&N.instanceColor&&(Te=N.instanceColor)),void 0!==Te){const Le=Te.normalized,Ge=Te.itemSize,$e=t.get(Te);if(void 0===$e)continue;const et=$e.buffer,wt=$e.type,Jt=$e.bytesPerElement,It=!0===i.isWebGL2&&(wt===s.INT||wt===s.UNSIGNED_INT||1013===Te.gpuType);if(Te.isInterleavedBufferAttribute){const oi=Te.data,me=oi.stride,gt=Te.offset;if(oi.isInstancedInterleavedBuffer){for(let Ze=0;Ze<Fe.locationSize;Ze++)S(Fe.location+Ze,oi.meshPerAttribute);!0!==N.isInstancedMesh&&void 0===se._maxInstanceCount&&(se._maxInstanceCount=oi.meshPerAttribute*oi.count)}else for(let Ze=0;Ze<Fe.locationSize;Ze++)E(Fe.location+Ze);s.bindBuffer(s.ARRAY_BUFFER,et);for(let Ze=0;Ze<Fe.locationSize;Ze++)I(Fe.location+Ze,Ge/Fe.locationSize,wt,Le,me*Jt,(gt+Ge/Fe.locationSize*Ze)*Jt,It)}else{if(Te.isInstancedBufferAttribute){for(let oi=0;oi<Fe.locationSize;oi++)S(Fe.location+oi,Te.meshPerAttribute);!0!==N.isInstancedMesh&&void 0===se._maxInstanceCount&&(se._maxInstanceCount=Te.meshPerAttribute*Te.count)}else for(let oi=0;oi<Fe.locationSize;oi++)E(Fe.location+oi);s.bindBuffer(s.ARRAY_BUFFER,et);for(let oi=0;oi<Fe.locationSize;oi++)I(Fe.location+oi,Ge/Fe.locationSize,wt,Le,Ge*Jt,Ge/Fe.locationSize*oi*Jt,It)}}else if(void 0!==xe){const Le=xe[Ce];if(void 0!==Le)switch(Le.length){case 2:s.vertexAttrib2fv(Fe.location,Le);break;case 3:s.vertexAttrib3fv(Fe.location,Le);break;case 4:s.vertexAttrib4fv(Fe.location,Le);break;default:s.vertexAttrib1fv(Fe.location,Le)}}}}P()}(N,ee,K,se),null!==ue&&s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,t.get(ue).buffer))},reset:pe,resetDefaultState:ae,dispose:function O(){pe();for(const N in o){const ee=o[N];for(const K in ee){const se=ee[K];for(const ue in se)_(se[ue].object),delete se[ue];delete ee[K]}delete o[N]}},releaseStatesOfGeometry:function B(N){if(void 0===o[N.id])return;const ee=o[N.id];for(const K in ee){const se=ee[K];for(const ue in se)_(se[ue].object),delete se[ue];delete ee[K]}delete o[N.id]},releaseStatesOfProgram:function Q(N){for(const ee in o){const K=o[ee];if(void 0===K[N.id])continue;const se=K[N.id];for(const ue in se)_(se[ue].object),delete se[ue];delete K[N.id]}},initAttributes:M,enableAttribute:E,disableUnusedAttributes:P}}function p2(s,e,t,i){const n=i.isWebGL2;let r;this.setMode=function a(h){r=h},this.render=function o(h,u){s.drawArrays(r,h,u),t.update(u,r,1)},this.renderInstances=function l(h,u,m){if(0===m)return;let p,_;if(n)p=s,_="drawArraysInstanced";else if(p=e.get("ANGLE_instanced_arrays"),_="drawArraysInstancedANGLE",null===p)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");p[_](r,h,u,m),t.update(u,r,m)},this.renderMultiDraw=function c(h,u,m){if(0===m)return;const p=e.get("WEBGL_multi_draw");if(null===p)for(let _=0;_<m;_++)this.render(h[_],u[_]);else{p.multiDrawArraysWEBGL(r,h,0,u,0,m);let _=0;for(let g=0;g<m;g++)_+=u[g];t.update(_,r,1)}}}function f2(s,e,t){let i;function r(I){if("highp"===I){if(s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.HIGH_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision>0)return"highp";I="mediump"}return"mediump"===I&&s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.MEDIUM_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const a=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===s.constructor.name;let o=void 0!==t.precision?t.precision:"highp";const l=r(o);l!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",l,"instead."),o=l);const c=a||e.has("WEBGL_draw_buffers"),h=!0===t.logarithmicDepthBuffer,u=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),m=s.getParameter(s.MAX_VERTEX_TEXTURE_IMAGE_UNITS),p=s.getParameter(s.MAX_TEXTURE_SIZE),_=s.getParameter(s.MAX_CUBE_MAP_TEXTURE_SIZE),g=s.getParameter(s.MAX_VERTEX_ATTRIBS),f=s.getParameter(s.MAX_VERTEX_UNIFORM_VECTORS),b=s.getParameter(s.MAX_VARYING_VECTORS),C=s.getParameter(s.MAX_FRAGMENT_UNIFORM_VECTORS),M=m>0,E=a||e.has("OES_texture_float");return{isWebGL2:a,drawBuffers:c,getMaxAnisotropy:function n(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const I=e.get("EXT_texture_filter_anisotropic");i=s.getParameter(I.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:r,precision:o,logarithmicDepthBuffer:h,maxTextures:u,maxVertexTextures:m,maxTextureSize:p,maxCubemapSize:_,maxAttributes:g,maxVertexUniforms:f,maxVaryings:b,maxFragmentUniforms:C,vertexTextures:M,floatFragmentTextures:E,floatVertexTextures:M&&E,maxSamples:a?s.getParameter(s.MAX_SAMPLES):0}}function g2(s){const e=this;let t=null,i=0,n=!1,r=!1;const a=new Yl,o=new Xi,l={value:null,needsUpdate:!1};function h(u,m,p,_){const g=null!==u?u.length:0;let f=null;if(0!==g){if(f=l.value,!0!==_||null===f){const b=p+4*g,C=m.matrixWorldInverse;o.getNormalMatrix(C),(null===f||f.length<b)&&(f=new Float32Array(b));for(let M=0,E=p;M!==g;++M,E+=4)a.copy(u[M]).applyMatrix4(C,o),a.normal.toArray(f,E),f[E+3]=a.constant}l.value=f,l.needsUpdate=!0}return e.numPlanes=g,e.numIntersection=0,f}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(u,m){const p=0!==u.length||m||0!==i||n;return n=m,i=u.length,p},this.beginShadows=function(){r=!0,h(null)},this.endShadows=function(){r=!1},this.setGlobalState=function(u,m){t=h(u,m,0)},this.setState=function(u,m,p){const _=u.clippingPlanes,g=u.clipIntersection,f=u.clipShadows,b=s.get(u);if(!n||null===_||0===_.length||r&&!f)r?h(null):function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const C=r?0:i,M=4*C;let E=b.clippingState||null;l.value=E,E=h(_,m,M,p);for(let S=0;S!==M;++S)E[S]=t[S];b.clippingState=E,this.numIntersection=g?this.numPlanes:0,this.numPlanes+=C}}}function _2(s){let e=new WeakMap;function t(a,o){return 303===o?a.mapping=Fl:304===o&&(a.mapping=zc),a}function n(a){const o=a.target;o.removeEventListener("dispose",n);const l=e.get(o);void 0!==l&&(e.delete(o),l.dispose())}return{get:function i(a){if(a&&a.isTexture){const o=a.mapping;if(303===o||304===o){if(e.has(a))return t(e.get(a).texture,a.mapping);{const l=a.image;if(l&&l.height>0){const c=new lR(l.height/2);return c.fromEquirectangularTexture(s,a),e.set(a,c),a.addEventListener("dispose",n),t(c.texture,a.mapping)}return null}}}return a},dispose:function r(){e=new WeakMap}}}class mm extends Lv{constructor(e=-1,t=1,i=1,n=-1,r=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=n,this.near=r,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,n,r,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2;let r=i-e,a=i+e,o=n+t,l=n-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=c*this.view.offsetX,a=r+c*this.view.width,o-=h*this.view.offsetY,l=o-h*this.view.height}this.projectionMatrix.makeOrthographic(r,a,o,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const R1=[.125,.215,.35,.446,.526,.582],Bv=new mm,I1=new xt;let Nv=null,Uv=0,zv=0;const Qc=(1+Math.sqrt(5))/2,Oh=1/Qc,L1=[new Z(1,1,1),new Z(-1,1,1),new Z(1,1,-1),new Z(-1,1,-1),new Z(0,Qc,Oh),new Z(0,Qc,-Oh),new Z(Oh,0,Qc),new Z(-Oh,0,Qc),new Z(Qc,Oh,0),new Z(-Qc,Oh,0)];class F1{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,n=100){Nv=this._renderer.getRenderTarget(),Uv=this._renderer.getActiveCubeFace(),zv=this._renderer.getActiveMipmapLevel(),this._setSize(256);const r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(e,i,n,r),t>0&&this._blur(r,0,0,t),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=U1(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=N1(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Nv,Uv,zv),e.scissorTest=!1,$f(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===Fl||e.mapping===zc?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),Nv=this._renderer.getRenderTarget(),Uv=this._renderer.getActiveCubeFace(),zv=this._renderer.getActiveMipmapLevel();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:xs,minFilter:xs,generateMipmaps:!1,type:im,format:ma,colorSpace:or,depthBuffer:!1},n=B1(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=B1(e,t,i);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function b2(s){const e=[],t=[],i=[];let n=s;const r=s-4+1+R1.length;for(let a=0;a<r;a++){const o=Math.pow(2,n);t.push(o);let l=1/o;a>s-4?l=R1[a-s+4-1]:0===a&&(l=0),i.push(l);const c=1/(o-2),h=-c,u=1+c,m=[h,h,u,h,u,u,h,h,u,u,h,u],p=6,_=6,g=3,f=2,b=1,C=new Float32Array(g*_*p),M=new Float32Array(f*_*p),E=new Float32Array(b*_*p);for(let P=0;P<p;P++){const I=P%3*2/3-1,L=P>2?0:-1;C.set([I,L,0,I+2/3,L,0,I+2/3,L+1,0,I,L,0,I+2/3,L+1,0,I,L+1,0],g*_*P),M.set(m,f*_*P),E.set([P,P,P,P,P,P],b*_*P)}const S=new Ui;S.setAttribute("position",new os(C,g)),S.setAttribute("uv",new os(M,f)),S.setAttribute("faceIndex",new os(E,b)),e.push(S),n>4&&n--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(r)),this._blurMaterial=function v2(s,e,t){const i=new Float32Array(20),n=new Z(0,1,0);return new Gl({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${s}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(r,e,t)}return n}_compileMaterial(e){const t=new Js(this._lodPlanes[0],e);this._renderer.compile(t,Bv)}_sceneToCubeUV(e,t,i,n){const o=new Qs(90,1,t,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],h=this._renderer,u=h.autoClear,m=h.toneMapping;h.getClearColor(I1),h.toneMapping=Ll,h.autoClear=!1;const p=new ka({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),_=new Js(new Eh,p);let g=!1;const f=e.background;f?f.isColor&&(p.color.copy(f),e.background=null,g=!0):(p.color.copy(I1),g=!0);for(let b=0;b<6;b++){const C=b%3;0===C?(o.up.set(0,l[b],0),o.lookAt(c[b],0,0)):1===C?(o.up.set(0,0,l[b]),o.lookAt(0,c[b],0)):(o.up.set(0,l[b],0),o.lookAt(0,0,c[b]));const M=this._cubeSize;$f(n,C*M,b>2?M:0,M,M),h.setRenderTarget(n),g&&h.render(_,o),h.render(e,o)}_.geometry.dispose(),_.material.dispose(),h.toneMapping=m,h.autoClear=u,e.background=f}_textureToCubeUV(e,t){const i=this._renderer,n=e.mapping===Fl||e.mapping===zc;n?(null===this._cubemapMaterial&&(this._cubemapMaterial=U1()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=N1());const r=n?this._cubemapMaterial:this._equirectMaterial,a=new Js(this._lodPlanes[0],r);r.uniforms.envMap.value=e;const l=this._cubeSize;$f(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(a,Bv)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let n=1;n<this._lodPlanes.length;n++){const r=Math.sqrt(this._sigmas[n]*this._sigmas[n]-this._sigmas[n-1]*this._sigmas[n-1]);this._blur(e,n-1,n,r,L1[(n-1)%L1.length])}t.autoClear=i}_blur(e,t,i,n,r){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,i,n,"latitudinal",r),this._halfBlur(a,e,i,i,n,"longitudinal",r)}_halfBlur(e,t,i,n,r,a,o){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");const u=new Js(this._lodPlanes[n],c),m=c.uniforms,p=this._sizeLods[i]-1,_=isFinite(r)?Math.PI/(2*p):2*Math.PI/39,g=r/_,f=isFinite(r)?1+Math.floor(3*g):20;f>20&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${f} samples when the maximum is set to 20`);const b=[];let C=0;for(let I=0;I<20;++I){const L=I/g,O=Math.exp(-L*L/2);b.push(O),0===I?C+=O:I<f&&(C+=2*O)}for(let I=0;I<b.length;I++)b[I]=b[I]/C;m.envMap.value=e.texture,m.samples.value=f,m.weights.value=b,m.latitudinal.value="latitudinal"===a,o&&(m.poleAxis.value=o);const{_lodMax:M}=this;m.dTheta.value=_,m.mipInt.value=M-i;const E=this._sizeLods[n];$f(t,3*E*(n>M-4?n-M+4:0),4*(this._cubeSize-E),3*E,2*E),l.setRenderTarget(t),l.render(u,Bv)}}function B1(s,e,t){const i=new Zc(s,e,t);return i.texture.mapping=Qu,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function $f(s,e,t,i,n){s.viewport.set(e,t,i,n),s.scissor.set(e,t,i,n)}function N1(){return new Gl({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function U1(){return new Gl({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function y2(s){let e=new WeakMap,t=null;function r(o){const l=o.target;l.removeEventListener("dispose",r);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function i(o){if(o&&o.isTexture){const l=o.mapping,c=303===l||304===l,h=l===Fl||l===zc;if(c||h){if(o.isRenderTargetTexture&&!0===o.needsPMREMUpdate){o.needsPMREMUpdate=!1;let u=e.get(o);return null===t&&(t=new F1(s)),u=c?t.fromEquirectangular(o,u):t.fromCubemap(o,u),e.set(o,u),u.texture}if(e.has(o))return e.get(o).texture;{const u=o.image;if(c&&u&&u.height>0||h&&u&&function n(o){let l=0;for(let h=0;h<6;h++)void 0!==o[h]&&l++;return 6===l}(u)){null===t&&(t=new F1(s));const m=c?t.fromEquirectangular(o):t.fromCubemap(o);return e.set(o,m),o.addEventListener("dispose",r),m.texture}return null}}}return o},dispose:function a(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function x2(s){const e={};function t(i){if(void 0!==e[i])return e[i];let n;switch(i){case"WEBGL_depth_texture":n=s.getExtension("WEBGL_depth_texture")||s.getExtension("MOZ_WEBGL_depth_texture")||s.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=s.getExtension("WEBGL_compressed_texture_s3tc")||s.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=s.getExtension("WEBGL_compressed_texture_pvrtc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=s.getExtension(i)}return e[i]=n,n}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?(t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance")):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const n=t(i);return null===n&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),n}}}function w2(s,e,t,i){const n={},r=new WeakMap;function a(u){const m=u.target;null!==m.index&&e.remove(m.index);for(const _ in m.attributes)e.remove(m.attributes[_]);for(const _ in m.morphAttributes){const g=m.morphAttributes[_];for(let f=0,b=g.length;f<b;f++)e.remove(g[f])}m.removeEventListener("dispose",a),delete n[m.id];const p=r.get(m);p&&(e.remove(p),r.delete(m)),i.releaseStatesOfGeometry(m),!0===m.isInstancedBufferGeometry&&delete m._maxInstanceCount,t.memory.geometries--}function c(u){const m=[],p=u.index,_=u.attributes.position;let g=0;if(null!==p){const C=p.array;g=p.version;for(let M=0,E=C.length;M<E;M+=3){const S=C[M+0],P=C[M+1],I=C[M+2];m.push(S,P,P,I,I,S)}}else{if(void 0===_)return;g=_.version;for(let M=0,E=_.array.length/3-1;M<E;M+=3){const S=M+0,P=M+1,I=M+2;m.push(S,P,P,I,I,S)}}const f=new(d1(m)?C1:Ov)(m,1);f.version=g;const b=r.get(u);b&&e.remove(b),r.set(u,f)}return{get:function o(u,m){return!0===n[m.id]||(m.addEventListener("dispose",a),n[m.id]=!0,t.memory.geometries++),m},update:function l(u){const m=u.attributes;for(const _ in m)e.update(m[_],s.ARRAY_BUFFER);const p=u.morphAttributes;for(const _ in p){const g=p[_];for(let f=0,b=g.length;f<b;f++)e.update(g[f],s.ARRAY_BUFFER)}},getWireframeAttribute:function h(u){const m=r.get(u);if(m){const p=u.index;null!==p&&m.version<p.version&&c(u)}else c(u);return r.get(u)}}}function M2(s,e,t,i){const n=i.isWebGL2;let r,o,l;this.setMode=function a(p){r=p},this.setIndex=function c(p){o=p.type,l=p.bytesPerElement},this.render=function h(p,_){s.drawElements(r,_,o,p*l),t.update(_,r,1)},this.renderInstances=function u(p,_,g){if(0===g)return;let f,b;if(n)f=s,b="drawElementsInstanced";else if(f=e.get("ANGLE_instanced_arrays"),b="drawElementsInstancedANGLE",null===f)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");f[b](r,_,o,p*l,g),t.update(_,r,g)},this.renderMultiDraw=function m(p,_,g){if(0===g)return;const f=e.get("WEBGL_multi_draw");if(null===f)for(let b=0;b<g;b++)this.render(p[b]/l,_[b]);else{f.multiDrawElementsWEBGL(r,_,0,o,p,0,g);let b=0;for(let C=0;C<g;C++)b+=_[C];t.update(b,r,1)}}}function T2(s){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function n(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(r,a,o){switch(t.calls++,a){case s.TRIANGLES:t.triangles+=o*(r/3);break;case s.LINES:t.lines+=o*(r/2);break;case s.LINE_STRIP:t.lines+=o*(r-1);break;case s.LINE_LOOP:t.lines+=o*r;break;case s.POINTS:t.points+=o*r;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a)}}}}function C2(s,e){return s[0]-e[0]}function D2(s,e){return Math.abs(e[1])-Math.abs(s[1])}function E2(s,e,t){const i={},n=new Float32Array(8),r=new WeakMap,a=new yn,o=[];for(let c=0;c<8;c++)o[c]=[c,0];return{update:function l(c,h,u){const m=c.morphTargetInfluences;if(!0===e.isWebGL2){const p=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,_=void 0!==p?p.length:0;let g=r.get(h);if(void 0===g||g.count!==_){let N=function(){pe.dispose(),r.delete(h),h.removeEventListener("dispose",N)};void 0!==g&&g.texture.dispose();const C=void 0!==h.morphAttributes.position,M=void 0!==h.morphAttributes.normal,E=void 0!==h.morphAttributes.color,S=h.morphAttributes.position||[],P=h.morphAttributes.normal||[],I=h.morphAttributes.color||[];let L=0;!0===C&&(L=1),!0===M&&(L=2),!0===E&&(L=3);let O=h.attributes.position.count*L,B=1;O>e.maxTextureSize&&(B=Math.ceil(O/e.maxTextureSize),O=e.maxTextureSize);const Q=new Float32Array(O*B*4*_),pe=new vv(Q,O,B,_);pe.type=Mo,pe.needsUpdate=!0;const ae=4*L;for(let ee=0;ee<_;ee++){const K=S[ee],se=P[ee],ue=I[ee],re=O*B*4*ee;for(let xe=0;xe<K.count;xe++){const Ce=xe*ae;!0===C&&(a.fromBufferAttribute(K,xe),Q[re+Ce+0]=a.x,Q[re+Ce+1]=a.y,Q[re+Ce+2]=a.z,Q[re+Ce+3]=0),!0===M&&(a.fromBufferAttribute(se,xe),Q[re+Ce+4]=a.x,Q[re+Ce+5]=a.y,Q[re+Ce+6]=a.z,Q[re+Ce+7]=0),!0===E&&(a.fromBufferAttribute(ue,xe),Q[re+Ce+8]=a.x,Q[re+Ce+9]=a.y,Q[re+Ce+10]=a.z,Q[re+Ce+11]=4===ue.itemSize?a.w:1)}}g={count:_,texture:pe,size:new Xe(O,B)},r.set(h,g),h.addEventListener("dispose",N)}let f=0;for(let C=0;C<m.length;C++)f+=m[C];const b=h.morphTargetsRelative?1:1-f;u.getUniforms().setValue(s,"morphTargetBaseInfluence",b),u.getUniforms().setValue(s,"morphTargetInfluences",m),u.getUniforms().setValue(s,"morphTargetsTexture",g.texture,t),u.getUniforms().setValue(s,"morphTargetsTextureSize",g.size)}else{const p=void 0===m?0:m.length;let _=i[h.id];if(void 0===_||_.length!==p){_=[];for(let M=0;M<p;M++)_[M]=[M,0];i[h.id]=_}for(let M=0;M<p;M++){const E=_[M];E[0]=M,E[1]=m[M]}_.sort(D2);for(let M=0;M<8;M++)M<p&&_[M][1]?(o[M][0]=_[M][0],o[M][1]=_[M][1]):(o[M][0]=Number.MAX_SAFE_INTEGER,o[M][1]=0);o.sort(C2);const g=h.morphAttributes.position,f=h.morphAttributes.normal;let b=0;for(let M=0;M<8;M++){const E=o[M],S=E[0],P=E[1];S!==Number.MAX_SAFE_INTEGER&&P?(g&&h.getAttribute("morphTarget"+M)!==g[S]&&h.setAttribute("morphTarget"+M,g[S]),f&&h.getAttribute("morphNormal"+M)!==f[S]&&h.setAttribute("morphNormal"+M,f[S]),n[M]=P,b+=P):(g&&!0===h.hasAttribute("morphTarget"+M)&&h.deleteAttribute("morphTarget"+M),f&&!0===h.hasAttribute("morphNormal"+M)&&h.deleteAttribute("morphNormal"+M),n[M]=0)}const C=h.morphTargetsRelative?1:1-b;u.getUniforms().setValue(s,"morphTargetBaseInfluence",C),u.getUniforms().setValue(s,"morphTargetInfluences",n)}}}}function S2(s,e,t,i){let n=new WeakMap;function o(l){const c=l.target;c.removeEventListener("dispose",o),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function r(l){const c=i.render.frame,u=e.get(l,l.geometry);if(n.get(u)!==c&&(e.update(u),n.set(u,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",o)&&l.addEventListener("dispose",o),n.get(l)!==c&&(t.update(l.instanceMatrix,s.ARRAY_BUFFER),null!==l.instanceColor&&t.update(l.instanceColor,s.ARRAY_BUFFER),n.set(l,c))),l.isSkinnedMesh){const m=l.skeleton;n.get(m)!==c&&(m.update(),n.set(m,c))}return u},dispose:function a(){n=new WeakMap}}}class z1 extends Kr{constructor(e,t,i,n,r,a,o,l,c,h){if((h=void 0!==h?h:Vc)!==Vc&&h!==rh)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&h===Vc&&(i=Nl),void 0===i&&h===rh&&(i=Hc),super(null,n,r,a,o,l,h,i,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==o?o:Ss,this.minFilter=void 0!==l?l:Ss,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}const H1=new Kr,V1=new z1(1,1);V1.compareFunction=515;const W1=new vv,G1=new f1,Y1=new Yf,j1=[],Z1=[],X1=new Float32Array(16),q1=new Float32Array(9),$1=new Float32Array(4);function Rh(s,e,t){const i=s[0];if(i<=0||i>0)return s;const n=e*t;let r=j1[n];if(void 0===r&&(r=new Float32Array(n),j1[n]=r),0!==e){i.toArray(r,0);for(let a=1,o=0;a!==e;++a)o+=t,s[a].toArray(r,o)}return r}function er(s,e){if(s.length!==e.length)return!1;for(let t=0,i=s.length;t<i;t++)if(s[t]!==e[t])return!1;return!0}function tr(s,e){for(let t=0,i=e.length;t<i;t++)s[t]=e[t]}function Kf(s,e){let t=Z1[e];void 0===t&&(t=new Int32Array(e),Z1[e]=t);for(let i=0;i!==e;++i)t[i]=s.allocateTextureUnit();return t}function k2(s,e){const t=this.cache;t[0]!==e&&(s.uniform1f(this.addr,e),t[0]=e)}function A2(s,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(er(t,e))return;s.uniform2fv(this.addr,e),tr(t,e)}}function P2(s,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(s.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(er(t,e))return;s.uniform3fv(this.addr,e),tr(t,e)}}function O2(s,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(er(t,e))return;s.uniform4fv(this.addr,e),tr(t,e)}}function R2(s,e){const t=this.cache,i=e.elements;if(void 0===i){if(er(t,e))return;s.uniformMatrix2fv(this.addr,!1,e),tr(t,e)}else{if(er(t,i))return;$1.set(i),s.uniformMatrix2fv(this.addr,!1,$1),tr(t,i)}}function I2(s,e){const t=this.cache,i=e.elements;if(void 0===i){if(er(t,e))return;s.uniformMatrix3fv(this.addr,!1,e),tr(t,e)}else{if(er(t,i))return;q1.set(i),s.uniformMatrix3fv(this.addr,!1,q1),tr(t,i)}}function L2(s,e){const t=this.cache,i=e.elements;if(void 0===i){if(er(t,e))return;s.uniformMatrix4fv(this.addr,!1,e),tr(t,e)}else{if(er(t,i))return;X1.set(i),s.uniformMatrix4fv(this.addr,!1,X1),tr(t,i)}}function F2(s,e){const t=this.cache;t[0]!==e&&(s.uniform1i(this.addr,e),t[0]=e)}function B2(s,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(er(t,e))return;s.uniform2iv(this.addr,e),tr(t,e)}}function N2(s,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(er(t,e))return;s.uniform3iv(this.addr,e),tr(t,e)}}function U2(s,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(er(t,e))return;s.uniform4iv(this.addr,e),tr(t,e)}}function z2(s,e){const t=this.cache;t[0]!==e&&(s.uniform1ui(this.addr,e),t[0]=e)}function H2(s,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(er(t,e))return;s.uniform2uiv(this.addr,e),tr(t,e)}}function V2(s,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(er(t,e))return;s.uniform3uiv(this.addr,e),tr(t,e)}}function W2(s,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(er(t,e))return;s.uniform4uiv(this.addr,e),tr(t,e)}}function G2(s,e,t){const i=this.cache,n=t.allocateTextureUnit();i[0]!==n&&(s.uniform1i(this.addr,n),i[0]=n),t.setTexture2D(e||(this.type===s.SAMPLER_2D_SHADOW?V1:H1),n)}function Y2(s,e,t){const i=this.cache,n=t.allocateTextureUnit();i[0]!==n&&(s.uniform1i(this.addr,n),i[0]=n),t.setTexture3D(e||G1,n)}function j2(s,e,t){const i=this.cache,n=t.allocateTextureUnit();i[0]!==n&&(s.uniform1i(this.addr,n),i[0]=n),t.setTextureCube(e||Y1,n)}function Z2(s,e,t){const i=this.cache,n=t.allocateTextureUnit();i[0]!==n&&(s.uniform1i(this.addr,n),i[0]=n),t.setTexture2DArray(e||W1,n)}function q2(s,e){s.uniform1fv(this.addr,e)}function $2(s,e){const t=Rh(e,this.size,2);s.uniform2fv(this.addr,t)}function K2(s,e){const t=Rh(e,this.size,3);s.uniform3fv(this.addr,t)}function J2(s,e){const t=Rh(e,this.size,4);s.uniform4fv(this.addr,t)}function Q2(s,e){const t=Rh(e,this.size,4);s.uniformMatrix2fv(this.addr,!1,t)}function eL(s,e){const t=Rh(e,this.size,9);s.uniformMatrix3fv(this.addr,!1,t)}function tL(s,e){const t=Rh(e,this.size,16);s.uniformMatrix4fv(this.addr,!1,t)}function iL(s,e){s.uniform1iv(this.addr,e)}function nL(s,e){s.uniform2iv(this.addr,e)}function sL(s,e){s.uniform3iv(this.addr,e)}function rL(s,e){s.uniform4iv(this.addr,e)}function aL(s,e){s.uniform1uiv(this.addr,e)}function oL(s,e){s.uniform2uiv(this.addr,e)}function lL(s,e){s.uniform3uiv(this.addr,e)}function cL(s,e){s.uniform4uiv(this.addr,e)}function dL(s,e,t){const i=this.cache,n=e.length,r=Kf(t,n);er(i,r)||(s.uniform1iv(this.addr,r),tr(i,r));for(let a=0;a!==n;++a)t.setTexture2D(e[a]||H1,r[a])}function hL(s,e,t){const i=this.cache,n=e.length,r=Kf(t,n);er(i,r)||(s.uniform1iv(this.addr,r),tr(i,r));for(let a=0;a!==n;++a)t.setTexture3D(e[a]||G1,r[a])}function uL(s,e,t){const i=this.cache,n=e.length,r=Kf(t,n);er(i,r)||(s.uniform1iv(this.addr,r),tr(i,r));for(let a=0;a!==n;++a)t.setTextureCube(e[a]||Y1,r[a])}function mL(s,e,t){const i=this.cache,n=e.length,r=Kf(t,n);er(i,r)||(s.uniform1iv(this.addr,r),tr(i,r));for(let a=0;a!==n;++a)t.setTexture2DArray(e[a]||W1,r[a])}class fL{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=function X2(s){switch(s){case 5126:return k2;case 35664:return A2;case 35665:return P2;case 35666:return O2;case 35674:return R2;case 35675:return I2;case 35676:return L2;case 5124:case 35670:return F2;case 35667:case 35671:return B2;case 35668:case 35672:return N2;case 35669:case 35673:return U2;case 5125:return z2;case 36294:return H2;case 36295:return V2;case 36296:return W2;case 35678:case 36198:case 36298:case 36306:case 35682:return G2;case 35679:case 36299:case 36307:return Y2;case 35680:case 36300:case 36308:case 36293:return j2;case 36289:case 36303:case 36311:case 36292:return Z2}}(t.type)}}class gL{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function pL(s){switch(s){case 5126:return q2;case 35664:return $2;case 35665:return K2;case 35666:return J2;case 35674:return Q2;case 35675:return eL;case 35676:return tL;case 5124:case 35670:return iL;case 35667:case 35671:return nL;case 35668:case 35672:return sL;case 35669:case 35673:return rL;case 5125:return aL;case 36294:return oL;case 36295:return lL;case 36296:return cL;case 35678:case 36198:case 36298:case 36306:case 35682:return dL;case 35679:case 36299:case 36307:return hL;case 35680:case 36300:case 36308:case 36293:return uL;case 36289:case 36303:case 36311:case 36292:return mL}}(t.type)}}class _L{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const n=this.seq;for(let r=0,a=n.length;r!==a;++r){const o=n[r];o.setValue(e,t[o.id],i)}}}const Vv=/(\w+)(\])?(\[|\.)?/g;function K1(s,e){s.seq.push(e),s.map[e.id]=e}function bL(s,e,t){const i=s.name,n=i.length;for(Vv.lastIndex=0;;){const r=Vv.exec(i);let o=r[1];const c=r[3];if("]"===r[2]&&(o|=0),void 0===c||"["===c&&Vv.lastIndex+2===n){K1(t,void 0===c?new fL(o,s,e):new gL(o,s,e));break}{let u=t.map[o];void 0===u&&(u=new _L(o),K1(t,u)),t=u}}}class Jf{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let n=0;n<i;++n){const r=e.getActiveUniform(t,n);bL(r,e.getUniformLocation(t,r.name),this)}}setValue(e,t,i,n){const r=this.map[t];void 0!==r&&r.setValue(e,i,n)}setOptional(e,t,i){const n=t[i];void 0!==n&&this.setValue(e,i,n)}static upload(e,t,i,n){for(let r=0,a=t.length;r!==a;++r){const o=t[r],l=i[o.id];!1!==l.needsUpdate&&o.setValue(e,l.value,n)}}static seqWithValue(e,t){const i=[];for(let n=0,r=e.length;n!==r;++n){const a=e[n];a.id in t&&i.push(a)}return i}}function J1(s,e,t){const i=s.createShader(e);return s.shaderSource(i,t),s.compileShader(i),i}const vL=37297;let yL=0;function Q1(s,e,t){const i=s.getShaderParameter(e,s.COMPILE_STATUS),n=s.getShaderInfoLog(e).trim();if(i&&""===n)return"";const r=/ERROR: 0:(\d+)/.exec(n);if(r){const a=parseInt(r[1]);return t.toUpperCase()+"\n\n"+n+"\n\n"+function xL(s,e){const t=s.split("\n"),i=[],n=Math.max(e-6,0),r=Math.min(e+6,t.length);for(let a=n;a<r;a++){const o=a+1;i.push(`${o===e?">":" "} ${o}: ${t[a]}`)}return i.join("\n")}(s.getShaderSource(e),a)}return n}function ML(s,e){const t=function wL(s){const e=Dn.getPrimaries(Dn.workingColorSpace),t=Dn.getPrimaries(s);let i;switch(e===t?i="":e===Mf&&t===wf?i="LinearDisplayP3ToLinearSRGB":e===wf&&t===Mf&&(i="LinearSRGBToLinearDisplayP3"),s){case or:case yf:return[i,"LinearTransferOETF"];case Un:case hv:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",s),[i,"LinearTransferOETF"]}}(e);return`vec4 ${s}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function TL(s,e){let t;switch(e){case $P:t="Linear";break;case KP:t="Reinhard";break;case JP:t="OptimizedCineon";break;case QP:t="ACESFilmic";break;case tO:t="AgX";break;case eO:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+s+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Ih(s){return""!==s}function eM(s,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return s.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function tM(s,e){return s.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const kL=/^[ \t]*#include +<([\w\d./]+)>/gm;function Wv(s){return s.replace(kL,PL)}const AL=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function PL(s,e){let t=qi[e];if(void 0===t){const i=AL.get(e);if(void 0===i)throw new Error("Can not resolve #include <"+e+">");t=qi[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i)}return Wv(t)}const OL=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function iM(s){return s.replace(OL,RL)}function RL(s,e,t,i){let n="";for(let r=parseInt(e);r<parseInt(t);r++)n+=i.replace(/\[\s*i\s*\]/g,"[ "+r+" ]").replace(/UNROLLED_LOOP_INDEX/g,r);return n}function nM(s){let e="precision "+s.precision+" float;\nprecision "+s.precision+" int;";return"highp"===s.precision?e+="\n#define HIGH_PRECISION":"mediump"===s.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===s.precision&&(e+="\n#define LOW_PRECISION"),e}function UL(s,e,t,i){const n=s.getContext(),r=t.defines;let a=t.vertexShader,o=t.fragmentShader;const l=function IL(s){let e="SHADOWMAP_TYPE_BASIC";return s.shadowMapType===_w?e="SHADOWMAP_TYPE_PCF":s.shadowMapType===TP?e="SHADOWMAP_TYPE_PCF_SOFT":s.shadowMapType===Jo&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function LL(s){let e="ENVMAP_TYPE_CUBE";if(s.envMap)switch(s.envMapMode){case Fl:case zc:e="ENVMAP_TYPE_CUBE";break;case Qu:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),h=function FL(s){let e="ENVMAP_MODE_REFLECTION";return s.envMap&&s.envMapMode===zc&&(e="ENVMAP_MODE_REFRACTION"),e}(t),u=function BL(s){let e="ENVMAP_BLENDING_NONE";if(s.envMap)switch(s.combine){case gf:e="ENVMAP_BLENDING_MULTIPLY";break;case XP:e="ENVMAP_BLENDING_MIX";break;case qP:e="ENVMAP_BLENDING_ADD"}return e}(t),m=function NL(s){const e=s.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),p=t.isWebGL2?"":function CL(s){return[s.extensionDerivatives||s.envMapCubeUVHeight||s.bumpMap||s.normalMapTangentSpace||s.clearcoatNormalMap||s.flatShading||"physical"===s.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(s.extensionFragDepth||s.logarithmicDepthBuffer)&&s.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",s.extensionDrawBuffers&&s.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(s.extensionShaderTextureLOD||s.envMap||s.transmission)&&s.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ih).join("\n")}(t),_=function DL(s){return[s.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":""].filter(Ih).join("\n")}(t),g=function EL(s){const e=[];for(const t in s){const i=s[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(r),f=n.createProgram();let b,C,M=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(b=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g].filter(Ih).join("\n"),b.length>0&&(b+="\n"),C=[p,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g].filter(Ih).join("\n"),C.length>0&&(C+="\n")):(b=[nM(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ih).join("\n"),C=[p,nM(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+h:"",t.envMap?"#define "+u:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Ll?"#define TONE_MAPPING":"",t.toneMapping!==Ll?qi.tonemapping_pars_fragment:"",t.toneMapping!==Ll?TL("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",qi.colorspace_pars_fragment,ML("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(Ih).join("\n")),a=Wv(a),a=eM(a,t),a=tM(a,t),o=Wv(o),o=eM(o,t),o=tM(o,t),a=iM(a),o=iM(o),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(M="#version 300 es\n",b=[_,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+b,C=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===l1?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===l1?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+C);const S=M+C+o,P=J1(n,n.VERTEX_SHADER,M+b+a),I=J1(n,n.FRAGMENT_SHADER,S);function L(pe){if(s.debug.checkShaderErrors){const ae=n.getProgramInfoLog(f).trim(),N=n.getShaderInfoLog(P).trim(),ee=n.getShaderInfoLog(I).trim();let K=!0,se=!0;if(!1===n.getProgramParameter(f,n.LINK_STATUS))if(K=!1,"function"==typeof s.debug.onShaderError)s.debug.onShaderError(n,f,P,I);else{const ue=Q1(n,P,"vertex"),re=Q1(n,I,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(f,n.VALIDATE_STATUS)+"\n\nProgram Info Log: "+ae+"\n"+ue+"\n"+re)}else""!==ae?console.warn("THREE.WebGLProgram: Program Info Log:",ae):(""===N||""===ee)&&(se=!1);se&&(pe.diagnostics={runnable:K,programLog:ae,vertexShader:{log:N,prefix:b},fragmentShader:{log:ee,prefix:C}})}n.deleteShader(P),n.deleteShader(I),O=new Jf(n,f),B=function SL(s,e){const t={},i=s.getProgramParameter(e,s.ACTIVE_ATTRIBUTES);for(let n=0;n<i;n++){const r=s.getActiveAttrib(e,n),a=r.name;let o=1;r.type===s.FLOAT_MAT2&&(o=2),r.type===s.FLOAT_MAT3&&(o=3),r.type===s.FLOAT_MAT4&&(o=4),t[a]={type:r.type,location:s.getAttribLocation(e,a),locationSize:o}}return t}(n,f)}let O,B;n.attachShader(f,P),n.attachShader(f,I),void 0!==t.index0AttributeName?n.bindAttribLocation(f,0,t.index0AttributeName):!0===t.morphTargets&&n.bindAttribLocation(f,0,"position"),n.linkProgram(f),this.getUniforms=function(){return void 0===O&&L(this),O},this.getAttributes=function(){return void 0===B&&L(this),B};let Q=!1===t.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===Q&&(Q=n.getProgramParameter(f,vL)),Q},this.destroy=function(){i.releaseStatesOfProgram(this),n.deleteProgram(f),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=yL++,this.cacheKey=e,this.usedTimes=1,this.program=f,this.vertexShader=P,this.fragmentShader=I,this}let zL=0;class HL{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,n=this._getShaderStage(e.vertexShader),r=this._getShaderStage(i),a=this._getShaderCacheForMaterial(e);return!1===a.has(n)&&(a.add(n),n.usedTimes++),!1===a.has(r)&&(a.add(r),r.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new VL(e),t.set(e,i)),i}}class VL{constructor(e){this.id=zL++,this.code=e,this.usedTimes=0}}function WL(s,e,t,i,n,r,a){const o=new Dv,l=new HL,c=[],h=n.isWebGL2,u=n.logarithmicDepthBuffer,m=n.vertexTextures;let p=n.precision;const _={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(O){return 0===O?"uv":`uv${O}`}return{getParameters:function f(O,B,Q,pe,ae){const N=pe.fog,ee=ae.geometry,se=(O.isMeshStandardMaterial?t:e).get(O.envMap||(O.isMeshStandardMaterial?pe.environment:null)),ue=se&&se.mapping===Qu?se.image.height:null,re=_[O.type];null!==O.precision&&(p=n.getMaxPrecision(O.precision),p!==O.precision&&console.warn("THREE.WebGLProgram.getParameters:",O.precision,"not supported, using",p,"instead."));const xe=ee.morphAttributes.position||ee.morphAttributes.normal||ee.morphAttributes.color,Ce=void 0!==xe?xe.length:0;let Te,Le,Ge,$e,Fe=0;if(void 0!==ee.morphAttributes.position&&(Fe=1),void 0!==ee.morphAttributes.normal&&(Fe=2),void 0!==ee.morphAttributes.color&&(Fe=3),re){const Fr=Co[re];Te=Fr.vertexShader,Le=Fr.fragmentShader}else Te=O.vertexShader,Le=O.fragmentShader,l.update(O),Ge=l.getVertexShaderID(O),$e=l.getFragmentShaderID(O);const et=s.getRenderTarget(),wt=!0===ae.isInstancedMesh,It=!!O.map,me=!!se,gt=!!O.aoMap,Ze=!!O.lightMap,pt=!!O.bumpMap,qe=!!O.normalMap,lt=!!O.displacementMap,ft=!!O.emissiveMap,q=!!O.metalnessMap,G=!!O.roughnessMap,Oe=O.anisotropy>0,ct=O.clearcoat>0,st=O.iridescence>0,nt=O.sheen>0,ii=O.transmission>0,Ft=Oe&&!!O.anisotropyMap,Gt=ct&&!!O.clearcoatMap,vi=ct&&!!O.clearcoatNormalMap,Ii=ct&&!!O.clearcoatRoughnessMap,rt=st&&!!O.iridescenceMap,tn=st&&!!O.iridescenceThicknessMap,de=nt&&!!O.sheenColorMap,at=nt&&!!O.sheenRoughnessMap,Pt=!!O.specularMap,yt=!!O.specularColorMap,di=!!O.specularIntensityMap,nn=ii&&!!O.transmissionMap,dn=ii&&!!O.thicknessMap,At=!!O.alphaMap,Et=!!O.extensions,Mi=!!ee.attributes.uv1,hi=!!ee.attributes.uv2,xn=!!ee.attributes.uv3;let wn=Ll;return O.toneMapped&&(null===et||!0===et.isXRRenderTarget)&&(wn=s.toneMapping),{isWebGL2:h,shaderID:re,shaderType:O.type,shaderName:O.name,vertexShader:Te,fragmentShader:Le,defines:O.defines,customVertexShaderID:Ge,customFragmentShaderID:$e,isRawShaderMaterial:!0===O.isRawShaderMaterial,glslVersion:O.glslVersion,precision:p,batching:!0===ae.isBatchedMesh,instancing:wt,instancingColor:wt&&null!==ae.instanceColor,supportsVertexTextures:m,outputColorSpace:null===et?s.outputColorSpace:!0===et.isXRRenderTarget?et.texture.colorSpace:or,map:It,matcap:!!O.matcap,envMap:me,envMapMode:me&&se.mapping,envMapCubeUVHeight:ue,aoMap:gt,lightMap:Ze,bumpMap:pt,normalMap:qe,displacementMap:m&&lt,emissiveMap:ft,normalMapObjectSpace:qe&&1===O.normalMapType,normalMapTangentSpace:qe&&0===O.normalMapType,metalnessMap:q,roughnessMap:G,anisotropy:Oe,anisotropyMap:Ft,clearcoat:ct,clearcoatMap:Gt,clearcoatNormalMap:vi,clearcoatRoughnessMap:Ii,iridescence:st,iridescenceMap:rt,iridescenceThicknessMap:tn,sheen:nt,sheenColorMap:de,sheenRoughnessMap:at,specularMap:Pt,specularColorMap:yt,specularIntensityMap:di,transmission:ii,transmissionMap:nn,thicknessMap:dn,gradientMap:!!O.gradientMap,opaque:!1===O.transparent&&1===O.blending,alphaMap:At,alphaTest:O.alphaTest>0,alphaHash:!!O.alphaHash,combine:O.combine,mapUv:It&&g(O.map.channel),aoMapUv:gt&&g(O.aoMap.channel),lightMapUv:Ze&&g(O.lightMap.channel),bumpMapUv:pt&&g(O.bumpMap.channel),normalMapUv:qe&&g(O.normalMap.channel),displacementMapUv:lt&&g(O.displacementMap.channel),emissiveMapUv:ft&&g(O.emissiveMap.channel),metalnessMapUv:q&&g(O.metalnessMap.channel),roughnessMapUv:G&&g(O.roughnessMap.channel),anisotropyMapUv:Ft&&g(O.anisotropyMap.channel),clearcoatMapUv:Gt&&g(O.clearcoatMap.channel),clearcoatNormalMapUv:vi&&g(O.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Ii&&g(O.clearcoatRoughnessMap.channel),iridescenceMapUv:rt&&g(O.iridescenceMap.channel),iridescenceThicknessMapUv:tn&&g(O.iridescenceThicknessMap.channel),sheenColorMapUv:de&&g(O.sheenColorMap.channel),sheenRoughnessMapUv:at&&g(O.sheenRoughnessMap.channel),specularMapUv:Pt&&g(O.specularMap.channel),specularColorMapUv:yt&&g(O.specularColorMap.channel),specularIntensityMapUv:di&&g(O.specularIntensityMap.channel),transmissionMapUv:nn&&g(O.transmissionMap.channel),thicknessMapUv:dn&&g(O.thicknessMap.channel),alphaMapUv:At&&g(O.alphaMap.channel),vertexTangents:!!ee.attributes.tangent&&(qe||Oe),vertexColors:O.vertexColors,vertexAlphas:!0===O.vertexColors&&!!ee.attributes.color&&4===ee.attributes.color.itemSize,vertexUv1s:Mi,vertexUv2s:hi,vertexUv3s:xn,pointsUvs:!0===ae.isPoints&&!!ee.attributes.uv&&(It||At),fog:!!N,useFog:!0===O.fog,fogExp2:N&&N.isFogExp2,flatShading:!0===O.flatShading,sizeAttenuation:!0===O.sizeAttenuation,logarithmicDepthBuffer:u,skinning:!0===ae.isSkinnedMesh,morphTargets:void 0!==ee.morphAttributes.position,morphNormals:void 0!==ee.morphAttributes.normal,morphColors:void 0!==ee.morphAttributes.color,morphTargetsCount:Ce,morphTextureStride:Fe,numDirLights:B.directional.length,numPointLights:B.point.length,numSpotLights:B.spot.length,numSpotLightMaps:B.spotLightMap.length,numRectAreaLights:B.rectArea.length,numHemiLights:B.hemi.length,numDirLightShadows:B.directionalShadowMap.length,numPointLightShadows:B.pointShadowMap.length,numSpotLightShadows:B.spotShadowMap.length,numSpotLightShadowsWithMaps:B.numSpotLightShadowsWithMaps,numLightProbes:B.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:O.dithering,shadowMapEnabled:s.shadowMap.enabled&&Q.length>0,shadowMapType:s.shadowMap.type,toneMapping:wn,useLegacyLights:s._useLegacyLights,decodeVideoTexture:It&&!0===O.map.isVideoTexture&&Dn.getTransfer(O.map.colorSpace)===Kn,premultipliedAlpha:O.premultipliedAlpha,doubleSided:2===O.side,flipSided:1===O.side,useDepthPacking:O.depthPacking>=0,depthPacking:O.depthPacking||0,index0AttributeName:O.index0AttributeName,extensionDerivatives:Et&&!0===O.extensions.derivatives,extensionFragDepth:Et&&!0===O.extensions.fragDepth,extensionDrawBuffers:Et&&!0===O.extensions.drawBuffers,extensionShaderTextureLOD:Et&&!0===O.extensions.shaderTextureLOD,extensionClipCullDistance:Et&&O.extensions.clipCullDistance&&i.has("WEBGL_clip_cull_distance"),rendererExtensionFragDepth:h||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||i.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:O.customProgramCacheKey()}},getProgramCacheKey:function b(O){const B=[];if(O.shaderID?B.push(O.shaderID):(B.push(O.customVertexShaderID),B.push(O.customFragmentShaderID)),void 0!==O.defines)for(const Q in O.defines)B.push(Q),B.push(O.defines[Q]);return!1===O.isRawShaderMaterial&&(function C(O,B){O.push(B.precision),O.push(B.outputColorSpace),O.push(B.envMapMode),O.push(B.envMapCubeUVHeight),O.push(B.mapUv),O.push(B.alphaMapUv),O.push(B.lightMapUv),O.push(B.aoMapUv),O.push(B.bumpMapUv),O.push(B.normalMapUv),O.push(B.displacementMapUv),O.push(B.emissiveMapUv),O.push(B.metalnessMapUv),O.push(B.roughnessMapUv),O.push(B.anisotropyMapUv),O.push(B.clearcoatMapUv),O.push(B.clearcoatNormalMapUv),O.push(B.clearcoatRoughnessMapUv),O.push(B.iridescenceMapUv),O.push(B.iridescenceThicknessMapUv),O.push(B.sheenColorMapUv),O.push(B.sheenRoughnessMapUv),O.push(B.specularMapUv),O.push(B.specularColorMapUv),O.push(B.specularIntensityMapUv),O.push(B.transmissionMapUv),O.push(B.thicknessMapUv),O.push(B.combine),O.push(B.fogExp2),O.push(B.sizeAttenuation),O.push(B.morphTargetsCount),O.push(B.morphAttributeCount),O.push(B.numDirLights),O.push(B.numPointLights),O.push(B.numSpotLights),O.push(B.numSpotLightMaps),O.push(B.numHemiLights),O.push(B.numRectAreaLights),O.push(B.numDirLightShadows),O.push(B.numPointLightShadows),O.push(B.numSpotLightShadows),O.push(B.numSpotLightShadowsWithMaps),O.push(B.numLightProbes),O.push(B.shadowMapType),O.push(B.toneMapping),O.push(B.numClippingPlanes),O.push(B.numClipIntersection),O.push(B.depthPacking)}(B,O),function M(O,B){o.disableAll(),B.isWebGL2&&o.enable(0),B.supportsVertexTextures&&o.enable(1),B.instancing&&o.enable(2),B.instancingColor&&o.enable(3),B.matcap&&o.enable(4),B.envMap&&o.enable(5),B.normalMapObjectSpace&&o.enable(6),B.normalMapTangentSpace&&o.enable(7),B.clearcoat&&o.enable(8),B.iridescence&&o.enable(9),B.alphaTest&&o.enable(10),B.vertexColors&&o.enable(11),B.vertexAlphas&&o.enable(12),B.vertexUv1s&&o.enable(13),B.vertexUv2s&&o.enable(14),B.vertexUv3s&&o.enable(15),B.vertexTangents&&o.enable(16),B.anisotropy&&o.enable(17),B.alphaHash&&o.enable(18),B.batching&&o.enable(19),O.push(o.mask),o.disableAll(),B.fog&&o.enable(0),B.useFog&&o.enable(1),B.flatShading&&o.enable(2),B.logarithmicDepthBuffer&&o.enable(3),B.skinning&&o.enable(4),B.morphTargets&&o.enable(5),B.morphNormals&&o.enable(6),B.morphColors&&o.enable(7),B.premultipliedAlpha&&o.enable(8),B.shadowMapEnabled&&o.enable(9),B.useLegacyLights&&o.enable(10),B.doubleSided&&o.enable(11),B.flipSided&&o.enable(12),B.useDepthPacking&&o.enable(13),B.dithering&&o.enable(14),B.transmission&&o.enable(15),B.sheen&&o.enable(16),B.opaque&&o.enable(17),B.pointsUvs&&o.enable(18),B.decodeVideoTexture&&o.enable(19),O.push(o.mask)}(B,O),B.push(s.outputColorSpace)),B.push(O.customProgramCacheKey),B.join()},getUniforms:function E(O){const B=_[O.type];let Q;return Q=B?sR.clone(Co[B].uniforms):O.uniforms,Q},acquireProgram:function S(O,B){let Q;for(let pe=0,ae=c.length;pe<ae;pe++){const N=c[pe];if(N.cacheKey===B){Q=N,++Q.usedTimes;break}}return void 0===Q&&(Q=new UL(s,B,O,r),c.push(Q)),Q},releaseProgram:function P(O){if(0==--O.usedTimes){const B=c.indexOf(O);c[B]=c[c.length-1],c.pop(),O.destroy()}},releaseShaderCache:function I(O){l.remove(O)},programs:c,dispose:function L(){l.dispose()}}}function GL(){let s=new WeakMap;return{get:function e(r){let a=s.get(r);return void 0===a&&(a={},s.set(r,a)),a},remove:function t(r){s.delete(r)},update:function i(r,a,o){s.get(r)[a]=o},dispose:function n(){s=new WeakMap}}}function YL(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.material.id!==e.material.id?s.material.id-e.material.id:s.z!==e.z?s.z-e.z:s.id-e.id}function sM(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.z!==e.z?e.z-s.z:s.id-e.id}function rM(){const s=[];let e=0;const t=[],i=[],n=[];function a(u,m,p,_,g,f){let b=s[e];return void 0===b?(b={id:u.id,object:u,geometry:m,material:p,groupOrder:_,renderOrder:u.renderOrder,z:g,group:f},s[e]=b):(b.id=u.id,b.object=u,b.geometry=m,b.material=p,b.groupOrder=_,b.renderOrder=u.renderOrder,b.z=g,b.group=f),e++,b}return{opaque:t,transmissive:i,transparent:n,init:function r(){e=0,t.length=0,i.length=0,n.length=0},push:function o(u,m,p,_,g,f){const b=a(u,m,p,_,g,f);p.transmission>0?i.push(b):!0===p.transparent?n.push(b):t.push(b)},unshift:function l(u,m,p,_,g,f){const b=a(u,m,p,_,g,f);p.transmission>0?i.unshift(b):!0===p.transparent?n.unshift(b):t.unshift(b)},finish:function h(){for(let u=e,m=s.length;u<m;u++){const p=s[u];if(null===p.id)break;p.id=null,p.object=null,p.geometry=null,p.material=null,p.group=null}},sort:function c(u,m){t.length>1&&t.sort(u||YL),i.length>1&&i.sort(m||sM),n.length>1&&n.sort(m||sM)}}}function jL(){let s=new WeakMap;return{get:function e(i,n){const r=s.get(i);let a;return void 0===r?(a=new rM,s.set(i,[a])):n>=r.length?(a=new rM,r.push(a)):a=r[n],a},dispose:function t(){s=new WeakMap}}}function ZL(){const s={};return{get:function(e){if(void 0!==s[e.id])return s[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Z,color:new xt};break;case"SpotLight":t={position:new Z,direction:new Z,color:new xt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Z,color:new xt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Z,skyColor:new xt,groundColor:new xt};break;case"RectAreaLight":t={color:new xt,position:new Z,halfWidth:new Z,halfHeight:new Z}}return s[e.id]=t,t}}}let qL=0;function $L(s,e){return(e.castShadow?2:0)-(s.castShadow?2:0)+(e.map?1:0)-(s.map?1:0)}function KL(s,e){const t=new ZL,i=function XL(){const s={};return{get:function(e){if(void 0!==s[e.id])return s[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xe};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xe,shadowCameraNear:1,shadowCameraFar:1e3}}return s[e.id]=t,t}}}(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let h=0;h<9;h++)n.probe.push(new Z);const r=new Z,a=new Ut,o=new Ut;return{setup:function l(h,u){let m=0,p=0,_=0;for(let pe=0;pe<9;pe++)n.probe[pe].set(0,0,0);let g=0,f=0,b=0,C=0,M=0,E=0,S=0,P=0,I=0,L=0,O=0;h.sort($L);const B=!0===u?Math.PI:1;for(let pe=0,ae=h.length;pe<ae;pe++){const N=h[pe],ee=N.color,K=N.intensity,se=N.distance,ue=N.shadow&&N.shadow.map?N.shadow.map.texture:null;if(N.isAmbientLight)m+=ee.r*K*B,p+=ee.g*K*B,_+=ee.b*K*B;else if(N.isLightProbe){for(let re=0;re<9;re++)n.probe[re].addScaledVector(N.sh.coefficients[re],K);O++}else if(N.isDirectionalLight){const re=t.get(N);if(re.color.copy(N.color).multiplyScalar(N.intensity*B),N.castShadow){const xe=N.shadow,Ce=i.get(N);Ce.shadowBias=xe.bias,Ce.shadowNormalBias=xe.normalBias,Ce.shadowRadius=xe.radius,Ce.shadowMapSize=xe.mapSize,n.directionalShadow[g]=Ce,n.directionalShadowMap[g]=ue,n.directionalShadowMatrix[g]=N.shadow.matrix,E++}n.directional[g]=re,g++}else if(N.isSpotLight){const re=t.get(N);re.position.setFromMatrixPosition(N.matrixWorld),re.color.copy(ee).multiplyScalar(K*B),re.distance=se,re.coneCos=Math.cos(N.angle),re.penumbraCos=Math.cos(N.angle*(1-N.penumbra)),re.decay=N.decay,n.spot[b]=re;const xe=N.shadow;if(N.map&&(n.spotLightMap[I]=N.map,I++,xe.updateMatrices(N),N.castShadow&&L++),n.spotLightMatrix[b]=xe.matrix,N.castShadow){const Ce=i.get(N);Ce.shadowBias=xe.bias,Ce.shadowNormalBias=xe.normalBias,Ce.shadowRadius=xe.radius,Ce.shadowMapSize=xe.mapSize,n.spotShadow[b]=Ce,n.spotShadowMap[b]=ue,P++}b++}else if(N.isRectAreaLight){const re=t.get(N);re.color.copy(ee).multiplyScalar(K),re.halfWidth.set(.5*N.width,0,0),re.halfHeight.set(0,.5*N.height,0),n.rectArea[C]=re,C++}else if(N.isPointLight){const re=t.get(N);if(re.color.copy(N.color).multiplyScalar(N.intensity*B),re.distance=N.distance,re.decay=N.decay,N.castShadow){const xe=N.shadow,Ce=i.get(N);Ce.shadowBias=xe.bias,Ce.shadowNormalBias=xe.normalBias,Ce.shadowRadius=xe.radius,Ce.shadowMapSize=xe.mapSize,Ce.shadowCameraNear=xe.camera.near,Ce.shadowCameraFar=xe.camera.far,n.pointShadow[f]=Ce,n.pointShadowMap[f]=ue,n.pointShadowMatrix[f]=N.shadow.matrix,S++}n.point[f]=re,f++}else if(N.isHemisphereLight){const re=t.get(N);re.skyColor.copy(N.color).multiplyScalar(K*B),re.groundColor.copy(N.groundColor).multiplyScalar(K*B),n.hemi[M]=re,M++}}C>0&&(e.isWebGL2?!0===s.has("OES_texture_float_linear")?(n.rectAreaLTC1=Rt.LTC_FLOAT_1,n.rectAreaLTC2=Rt.LTC_FLOAT_2):(n.rectAreaLTC1=Rt.LTC_HALF_1,n.rectAreaLTC2=Rt.LTC_HALF_2):!0===s.has("OES_texture_float_linear")?(n.rectAreaLTC1=Rt.LTC_FLOAT_1,n.rectAreaLTC2=Rt.LTC_FLOAT_2):!0===s.has("OES_texture_half_float_linear")?(n.rectAreaLTC1=Rt.LTC_HALF_1,n.rectAreaLTC2=Rt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=m,n.ambient[1]=p,n.ambient[2]=_;const Q=n.hash;(Q.directionalLength!==g||Q.pointLength!==f||Q.spotLength!==b||Q.rectAreaLength!==C||Q.hemiLength!==M||Q.numDirectionalShadows!==E||Q.numPointShadows!==S||Q.numSpotShadows!==P||Q.numSpotMaps!==I||Q.numLightProbes!==O)&&(n.directional.length=g,n.spot.length=b,n.rectArea.length=C,n.point.length=f,n.hemi.length=M,n.directionalShadow.length=E,n.directionalShadowMap.length=E,n.pointShadow.length=S,n.pointShadowMap.length=S,n.spotShadow.length=P,n.spotShadowMap.length=P,n.directionalShadowMatrix.length=E,n.pointShadowMatrix.length=S,n.spotLightMatrix.length=P+I-L,n.spotLightMap.length=I,n.numSpotLightShadowsWithMaps=L,n.numLightProbes=O,Q.directionalLength=g,Q.pointLength=f,Q.spotLength=b,Q.rectAreaLength=C,Q.hemiLength=M,Q.numDirectionalShadows=E,Q.numPointShadows=S,Q.numSpotShadows=P,Q.numSpotMaps=I,Q.numLightProbes=O,n.version=qL++)},setupView:function c(h,u){let m=0,p=0,_=0,g=0,f=0;const b=u.matrixWorldInverse;for(let C=0,M=h.length;C<M;C++){const E=h[C];if(E.isDirectionalLight){const S=n.directional[m];S.direction.setFromMatrixPosition(E.matrixWorld),r.setFromMatrixPosition(E.target.matrixWorld),S.direction.sub(r),S.direction.transformDirection(b),m++}else if(E.isSpotLight){const S=n.spot[_];S.position.setFromMatrixPosition(E.matrixWorld),S.position.applyMatrix4(b),S.direction.setFromMatrixPosition(E.matrixWorld),r.setFromMatrixPosition(E.target.matrixWorld),S.direction.sub(r),S.direction.transformDirection(b),_++}else if(E.isRectAreaLight){const S=n.rectArea[g];S.position.setFromMatrixPosition(E.matrixWorld),S.position.applyMatrix4(b),o.identity(),a.copy(E.matrixWorld),a.premultiply(b),o.extractRotation(a),S.halfWidth.set(.5*E.width,0,0),S.halfHeight.set(0,.5*E.height,0),S.halfWidth.applyMatrix4(o),S.halfHeight.applyMatrix4(o),g++}else if(E.isPointLight){const S=n.point[p];S.position.setFromMatrixPosition(E.matrixWorld),S.position.applyMatrix4(b),p++}else if(E.isHemisphereLight){const S=n.hemi[f];S.direction.setFromMatrixPosition(E.matrixWorld),S.direction.transformDirection(b),f++}}},state:n}}function aM(s,e){const t=new KL(s,e),i=[],n=[];return{init:function r(){i.length=0,n.length=0},state:{lightsArray:i,shadowsArray:n,lights:t},setupLights:function l(u){t.setup(i,u)},setupLightsView:function c(u){t.setupView(i,u)},pushLight:function a(u){i.push(u)},pushShadow:function o(u){n.push(u)}}}function JL(s,e){let t=new WeakMap;return{get:function i(r,a=0){const o=t.get(r);let l;return void 0===o?(l=new aM(s,e),t.set(r,[l])):a>=o.length?(l=new aM(s,e),o.push(l)):l=o[a],l},dispose:function n(){t=new WeakMap}}}class oM extends _a{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class lM extends _a{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function tF(s,e,t){let i=new Zf;const n=new Xe,r=new Xe,a=new yn,o=new oM({depthPacking:3201}),l=new lM,c={},h=t.maxTextureSize,u={0:1,1:0,2:2},m=new Gl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Xe},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=m.clone();p.defines.HORIZONTAL_PASS=1;const _=new Ui;_.setAttribute("position",new os(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const g=new Js(_,m),f=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=_w;let b=this.type;function C(P,I){const L=e.update(g);m.defines.VSM_SAMPLES!==P.blurSamples&&(m.defines.VSM_SAMPLES=P.blurSamples,p.defines.VSM_SAMPLES=P.blurSamples,m.needsUpdate=!0,p.needsUpdate=!0),null===P.mapPass&&(P.mapPass=new Zc(n.x,n.y)),m.uniforms.shadow_pass.value=P.map.texture,m.uniforms.resolution.value=P.mapSize,m.uniforms.radius.value=P.radius,s.setRenderTarget(P.mapPass),s.clear(),s.renderBufferDirect(I,null,L,m,g,null),p.uniforms.shadow_pass.value=P.mapPass.texture,p.uniforms.resolution.value=P.mapSize,p.uniforms.radius.value=P.radius,s.setRenderTarget(P.map),s.clear(),s.renderBufferDirect(I,null,L,p,g,null)}function M(P,I,L,O){let B=null;const Q=!0===L.isPointLight?P.customDistanceMaterial:P.customDepthMaterial;if(void 0!==Q)B=Q;else if(B=!0===L.isPointLight?l:o,s.localClippingEnabled&&!0===I.clipShadows&&Array.isArray(I.clippingPlanes)&&0!==I.clippingPlanes.length||I.displacementMap&&0!==I.displacementScale||I.alphaMap&&I.alphaTest>0||I.map&&I.alphaTest>0){const pe=B.uuid,ae=I.uuid;let N=c[pe];void 0===N&&(N={},c[pe]=N);let ee=N[ae];void 0===ee&&(ee=B.clone(),N[ae]=ee,I.addEventListener("dispose",S)),B=ee}return B.visible=I.visible,B.wireframe=I.wireframe,B.side=O===Jo?null!==I.shadowSide?I.shadowSide:I.side:null!==I.shadowSide?I.shadowSide:u[I.side],B.alphaMap=I.alphaMap,B.alphaTest=I.alphaTest,B.map=I.map,B.clipShadows=I.clipShadows,B.clippingPlanes=I.clippingPlanes,B.clipIntersection=I.clipIntersection,B.displacementMap=I.displacementMap,B.displacementScale=I.displacementScale,B.displacementBias=I.displacementBias,B.wireframeLinewidth=I.wireframeLinewidth,B.linewidth=I.linewidth,!0===L.isPointLight&&!0===B.isMeshDistanceMaterial&&(s.properties.get(B).light=L),B}function E(P,I,L,O,B){if(!1===P.visible)return;if(P.layers.test(I.layers)&&(P.isMesh||P.isLine||P.isPoints)&&(P.castShadow||P.receiveShadow&&B===Jo)&&(!P.frustumCulled||i.intersectsObject(P))){P.modelViewMatrix.multiplyMatrices(L.matrixWorldInverse,P.matrixWorld);const ae=e.update(P),N=P.material;if(Array.isArray(N)){const ee=ae.groups;for(let K=0,se=ee.length;K<se;K++){const ue=ee[K],re=N[ue.materialIndex];if(re&&re.visible){const xe=M(P,re,O,B);P.onBeforeShadow(s,P,I,L,ae,xe,ue),s.renderBufferDirect(L,null,ae,xe,P,ue),P.onAfterShadow(s,P,I,L,ae,xe,ue)}}}else if(N.visible){const ee=M(P,N,O,B);P.onBeforeShadow(s,P,I,L,ae,ee,null),s.renderBufferDirect(L,null,ae,ee,P,null),P.onAfterShadow(s,P,I,L,ae,ee,null)}}const pe=P.children;for(let ae=0,N=pe.length;ae<N;ae++)E(pe[ae],I,L,O,B)}function S(P){P.target.removeEventListener("dispose",S);for(const L in c){const O=c[L],B=P.target.uuid;B in O&&(O[B].dispose(),delete O[B])}}this.render=function(P,I,L){if(!1===f.enabled||!1===f.autoUpdate&&!1===f.needsUpdate||0===P.length)return;const O=s.getRenderTarget(),B=s.getActiveCubeFace(),Q=s.getActiveMipmapLevel(),pe=s.state;pe.setBlending(0),pe.buffers.color.setClear(1,1,1,1),pe.buffers.depth.setTest(!0),pe.setScissorTest(!1);const ae=b!==Jo&&this.type===Jo,N=b===Jo&&this.type!==Jo;for(let ee=0,K=P.length;ee<K;ee++){const se=P[ee],ue=se.shadow;if(void 0===ue){console.warn("THREE.WebGLShadowMap:",se,"has no shadow.");continue}if(!1===ue.autoUpdate&&!1===ue.needsUpdate)continue;n.copy(ue.mapSize);const re=ue.getFrameExtents();if(n.multiply(re),r.copy(ue.mapSize),(n.x>h||n.y>h)&&(n.x>h&&(r.x=Math.floor(h/re.x),n.x=r.x*re.x,ue.mapSize.x=r.x),n.y>h&&(r.y=Math.floor(h/re.y),n.y=r.y*re.y,ue.mapSize.y=r.y)),null===ue.map||!0===ae||!0===N){const Ce=this.type!==Jo?{minFilter:Ss,magFilter:Ss}:{};null!==ue.map&&ue.map.dispose(),ue.map=new Zc(n.x,n.y,Ce),ue.map.texture.name=se.name+".shadowMap",ue.camera.updateProjectionMatrix()}s.setRenderTarget(ue.map),s.clear();const xe=ue.getViewportCount();for(let Ce=0;Ce<xe;Ce++){const Fe=ue.getViewport(Ce);a.set(r.x*Fe.x,r.y*Fe.y,r.x*Fe.z,r.y*Fe.w),pe.viewport(a),ue.updateMatrices(se,Ce),i=ue.getFrustum(),E(I,L,ue.camera,se,this.type)}!0!==ue.isPointLightShadow&&this.type===Jo&&C(ue,L),ue.needsUpdate=!1}b=this.type,f.needsUpdate=!1,s.setRenderTarget(O,B,Q)}}function iF(s,e,t){const i=t.isWebGL2,o=new function n(){let ve=!1;const Dt=new yn;let Et=null;const Mi=new yn(0,0,0,0);return{setMask:function(hi){Et!==hi&&!ve&&(s.colorMask(hi,hi,hi,hi),Et=hi)},setLocked:function(hi){ve=hi},setClear:function(hi,xn,wn,dr,Fr){!0===Fr&&(hi*=dr,xn*=dr,wn*=dr),Dt.set(hi,xn,wn,dr),!1===Mi.equals(Dt)&&(s.clearColor(hi,xn,wn,dr),Mi.copy(Dt))},reset:function(){ve=!1,Et=null,Mi.set(-1,0,0,0)}}},l=new function r(){let ve=!1,Dt=null,Et=null,Mi=null;return{setTest:function(hi){hi?Jt(s.DEPTH_TEST):It(s.DEPTH_TEST)},setMask:function(hi){Dt!==hi&&!ve&&(s.depthMask(hi),Dt=hi)},setFunc:function(hi){if(Et!==hi){switch(hi){case 0:s.depthFunc(s.NEVER);break;case 1:s.depthFunc(s.ALWAYS);break;case 2:s.depthFunc(s.LESS);break;case 3:default:s.depthFunc(s.LEQUAL);break;case 4:s.depthFunc(s.EQUAL);break;case 5:s.depthFunc(s.GEQUAL);break;case 6:s.depthFunc(s.GREATER);break;case 7:s.depthFunc(s.NOTEQUAL)}Et=hi}},setLocked:function(hi){ve=hi},setClear:function(hi){Mi!==hi&&(s.clearDepth(hi),Mi=hi)},reset:function(){ve=!1,Dt=null,Et=null,Mi=null}}},c=new function a(){let ve=!1,Dt=null,Et=null,Mi=null,hi=null,xn=null,wn=null,dr=null,Fr=null;return{setTest:function(Yn){ve||(Yn?Jt(s.STENCIL_TEST):It(s.STENCIL_TEST))},setMask:function(Yn){Dt!==Yn&&!ve&&(s.stencilMask(Yn),Dt=Yn)},setFunc:function(Yn,Br,Oo){(Et!==Yn||Mi!==Br||hi!==Oo)&&(s.stencilFunc(Yn,Br,Oo),Et=Yn,Mi=Br,hi=Oo)},setOp:function(Yn,Br,Oo){(xn!==Yn||wn!==Br||dr!==Oo)&&(s.stencilOp(Yn,Br,Oo),xn=Yn,wn=Br,dr=Oo)},setLocked:function(Yn){ve=Yn},setClear:function(Yn){Fr!==Yn&&(s.clearStencil(Yn),Fr=Yn)},reset:function(){ve=!1,Dt=null,Et=null,Mi=null,hi=null,xn=null,wn=null,dr=null,Fr=null}}},h=new WeakMap,u=new WeakMap;let m={},p={},_=new WeakMap,g=[],f=null,b=!1,C=null,M=null,E=null,S=null,P=null,I=null,L=null,O=new xt(0,0,0),B=0,Q=!1,pe=null,ae=null,N=null,ee=null,K=null;const se=s.getParameter(s.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let ue=!1,re=0;const xe=s.getParameter(s.VERSION);-1!==xe.indexOf("WebGL")?(re=parseFloat(/^WebGL (\d)/.exec(xe)[1]),ue=re>=1):-1!==xe.indexOf("OpenGL ES")&&(re=parseFloat(/^OpenGL ES (\d)/.exec(xe)[1]),ue=re>=2);let Ce=null,Fe={};const Te=s.getParameter(s.SCISSOR_BOX),Le=s.getParameter(s.VIEWPORT),Ge=(new yn).fromArray(Te),$e=(new yn).fromArray(Le);function et(ve,Dt,Et,Mi){const hi=new Uint8Array(4),xn=s.createTexture();s.bindTexture(ve,xn),s.texParameteri(ve,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(ve,s.TEXTURE_MAG_FILTER,s.NEAREST);for(let wn=0;wn<Et;wn++)!i||ve!==s.TEXTURE_3D&&ve!==s.TEXTURE_2D_ARRAY?s.texImage2D(Dt+wn,0,s.RGBA,1,1,0,s.RGBA,s.UNSIGNED_BYTE,hi):s.texImage3D(Dt,0,s.RGBA,1,1,Mi,0,s.RGBA,s.UNSIGNED_BYTE,hi);return xn}const wt={};function Jt(ve){!0!==m[ve]&&(s.enable(ve),m[ve]=!0)}function It(ve){!1!==m[ve]&&(s.disable(ve),m[ve]=!1)}wt[s.TEXTURE_2D]=et(s.TEXTURE_2D,s.TEXTURE_2D,1),wt[s.TEXTURE_CUBE_MAP]=et(s.TEXTURE_CUBE_MAP,s.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(wt[s.TEXTURE_2D_ARRAY]=et(s.TEXTURE_2D_ARRAY,s.TEXTURE_2D_ARRAY,1,1),wt[s.TEXTURE_3D]=et(s.TEXTURE_3D,s.TEXTURE_3D,1,1)),o.setClear(0,0,0,1),l.setClear(1),c.setClear(0),Jt(s.DEPTH_TEST),l.setFunc(3),ft(!1),q(1),Jt(s.CULL_FACE),qe(0);const Ze={100:s.FUNC_ADD,101:s.FUNC_SUBTRACT,102:s.FUNC_REVERSE_SUBTRACT};if(i)Ze[103]=s.MIN,Ze[104]=s.MAX;else{const ve=e.get("EXT_blend_minmax");null!==ve&&(Ze[103]=ve.MIN_EXT,Ze[104]=ve.MAX_EXT)}const pt={200:s.ZERO,201:s.ONE,202:s.SRC_COLOR,204:s.SRC_ALPHA,210:s.SRC_ALPHA_SATURATE,208:s.DST_COLOR,206:s.DST_ALPHA,203:s.ONE_MINUS_SRC_COLOR,205:s.ONE_MINUS_SRC_ALPHA,209:s.ONE_MINUS_DST_COLOR,207:s.ONE_MINUS_DST_ALPHA,211:s.CONSTANT_COLOR,212:s.ONE_MINUS_CONSTANT_COLOR,213:s.CONSTANT_ALPHA,214:s.ONE_MINUS_CONSTANT_ALPHA};function qe(ve,Dt,Et,Mi,hi,xn,wn,dr,Fr,Yn){if(0!==ve){if(!1===b&&(Jt(s.BLEND),b=!0),5===ve)hi=hi||Dt,xn=xn||Et,wn=wn||Mi,(Dt!==M||hi!==P)&&(s.blendEquationSeparate(Ze[Dt],Ze[hi]),M=Dt,P=hi),(Et!==E||Mi!==S||xn!==I||wn!==L)&&(s.blendFuncSeparate(pt[Et],pt[Mi],pt[xn],pt[wn]),E=Et,S=Mi,I=xn,L=wn),(!1===dr.equals(O)||Fr!==B)&&(s.blendColor(dr.r,dr.g,dr.b,Fr),O.copy(dr),B=Fr),C=ve,Q=!1;else if(ve!==C||Yn!==Q){if((100!==M||100!==P)&&(s.blendEquation(s.FUNC_ADD),M=100,P=100),Yn)switch(ve){case 1:s.blendFuncSeparate(s.ONE,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case 2:s.blendFunc(s.ONE,s.ONE);break;case 3:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case 4:s.blendFuncSeparate(s.ZERO,s.SRC_COLOR,s.ZERO,s.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ve)}else switch(ve){case 1:s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case 2:s.blendFunc(s.SRC_ALPHA,s.ONE);break;case 3:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case 4:s.blendFunc(s.ZERO,s.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ve)}E=null,S=null,I=null,L=null,O.set(0,0,0),B=0,C=ve,Q=Yn}}else!0===b&&(It(s.BLEND),b=!1)}function ft(ve){pe!==ve&&(s.frontFace(ve?s.CW:s.CCW),pe=ve)}function q(ve){0!==ve?(Jt(s.CULL_FACE),ve!==ae&&s.cullFace(1===ve?s.BACK:2===ve?s.FRONT:s.FRONT_AND_BACK)):It(s.CULL_FACE),ae=ve}function Oe(ve,Dt,Et){ve?(Jt(s.POLYGON_OFFSET_FILL),(ee!==Dt||K!==Et)&&(s.polygonOffset(Dt,Et),ee=Dt,K=Et)):It(s.POLYGON_OFFSET_FILL)}return{buffers:{color:o,depth:l,stencil:c},enable:Jt,disable:It,bindFramebuffer:function oi(ve,Dt){return p[ve]!==Dt&&(s.bindFramebuffer(ve,Dt),p[ve]=Dt,i&&(ve===s.DRAW_FRAMEBUFFER&&(p[s.FRAMEBUFFER]=Dt),ve===s.FRAMEBUFFER&&(p[s.DRAW_FRAMEBUFFER]=Dt)),!0)},drawBuffers:function me(ve,Dt){let Et=g,Mi=!1;if(ve)if(Et=_.get(Dt),void 0===Et&&(Et=[],_.set(Dt,Et)),ve.isWebGLMultipleRenderTargets){const hi=ve.texture;if(Et.length!==hi.length||Et[0]!==s.COLOR_ATTACHMENT0){for(let xn=0,wn=hi.length;xn<wn;xn++)Et[xn]=s.COLOR_ATTACHMENT0+xn;Et.length=hi.length,Mi=!0}}else Et[0]!==s.COLOR_ATTACHMENT0&&(Et[0]=s.COLOR_ATTACHMENT0,Mi=!0);else Et[0]!==s.BACK&&(Et[0]=s.BACK,Mi=!0);Mi&&(t.isWebGL2?s.drawBuffers(Et):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Et))},useProgram:function gt(ve){return f!==ve&&(s.useProgram(ve),f=ve,!0)},setBlending:qe,setMaterial:function lt(ve,Dt){2===ve.side?It(s.CULL_FACE):Jt(s.CULL_FACE);let Et=1===ve.side;Dt&&(Et=!Et),ft(Et),1===ve.blending&&!1===ve.transparent?qe(0):qe(ve.blending,ve.blendEquation,ve.blendSrc,ve.blendDst,ve.blendEquationAlpha,ve.blendSrcAlpha,ve.blendDstAlpha,ve.blendColor,ve.blendAlpha,ve.premultipliedAlpha),l.setFunc(ve.depthFunc),l.setTest(ve.depthTest),l.setMask(ve.depthWrite),o.setMask(ve.colorWrite);const Mi=ve.stencilWrite;c.setTest(Mi),Mi&&(c.setMask(ve.stencilWriteMask),c.setFunc(ve.stencilFunc,ve.stencilRef,ve.stencilFuncMask),c.setOp(ve.stencilFail,ve.stencilZFail,ve.stencilZPass)),Oe(ve.polygonOffset,ve.polygonOffsetFactor,ve.polygonOffsetUnits),!0===ve.alphaToCoverage?Jt(s.SAMPLE_ALPHA_TO_COVERAGE):It(s.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:ft,setCullFace:q,setLineWidth:function G(ve){ve!==N&&(ue&&s.lineWidth(ve),N=ve)},setPolygonOffset:Oe,setScissorTest:function ct(ve){ve?Jt(s.SCISSOR_TEST):It(s.SCISSOR_TEST)},activeTexture:function st(ve){void 0===ve&&(ve=s.TEXTURE0+se-1),Ce!==ve&&(s.activeTexture(ve),Ce=ve)},bindTexture:function nt(ve,Dt,Et){void 0===Et&&(Et=null===Ce?s.TEXTURE0+se-1:Ce);let Mi=Fe[Et];void 0===Mi&&(Mi={type:void 0,texture:void 0},Fe[Et]=Mi),(Mi.type!==ve||Mi.texture!==Dt)&&(Ce!==Et&&(s.activeTexture(Et),Ce=Et),s.bindTexture(ve,Dt||wt[ve]),Mi.type=ve,Mi.texture=Dt)},unbindTexture:function ii(){const ve=Fe[Ce];void 0!==ve&&void 0!==ve.type&&(s.bindTexture(ve.type,null),ve.type=void 0,ve.texture=void 0)},compressedTexImage2D:function Ft(){try{s.compressedTexImage2D.apply(s,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}},compressedTexImage3D:function Gt(){try{s.compressedTexImage3D.apply(s,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}},texImage2D:function Pt(){try{s.texImage2D.apply(s,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}},texImage3D:function yt(){try{s.texImage3D.apply(s,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}},updateUBOMapping:function dn(ve,Dt){let Et=u.get(Dt);void 0===Et&&(Et=new WeakMap,u.set(Dt,Et));let Mi=Et.get(ve);void 0===Mi&&(Mi=s.getUniformBlockIndex(Dt,ve.name),Et.set(ve,Mi))},uniformBlockBinding:function Ki(ve,Dt){const Mi=u.get(Dt).get(ve);h.get(Dt)!==Mi&&(s.uniformBlockBinding(Dt,Mi,ve.__bindingPointIndex),h.set(Dt,Mi))},texStorage2D:function de(){try{s.texStorage2D.apply(s,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}},texStorage3D:function at(){try{s.texStorage3D.apply(s,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}},texSubImage2D:function vi(){try{s.texSubImage2D.apply(s,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}},texSubImage3D:function Ii(){try{s.texSubImage3D.apply(s,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}},compressedTexSubImage2D:function rt(){try{s.compressedTexSubImage2D.apply(s,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}},compressedTexSubImage3D:function tn(){try{s.compressedTexSubImage3D.apply(s,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}},scissor:function di(ve){!1===Ge.equals(ve)&&(s.scissor(ve.x,ve.y,ve.z,ve.w),Ge.copy(ve))},viewport:function nn(ve){!1===$e.equals(ve)&&(s.viewport(ve.x,ve.y,ve.z,ve.w),$e.copy(ve))},reset:function At(){s.disable(s.BLEND),s.disable(s.CULL_FACE),s.disable(s.DEPTH_TEST),s.disable(s.POLYGON_OFFSET_FILL),s.disable(s.SCISSOR_TEST),s.disable(s.STENCIL_TEST),s.disable(s.SAMPLE_ALPHA_TO_COVERAGE),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.ONE,s.ZERO),s.blendFuncSeparate(s.ONE,s.ZERO,s.ONE,s.ZERO),s.blendColor(0,0,0,0),s.colorMask(!0,!0,!0,!0),s.clearColor(0,0,0,0),s.depthMask(!0),s.depthFunc(s.LESS),s.clearDepth(1),s.stencilMask(4294967295),s.stencilFunc(s.ALWAYS,0,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.KEEP),s.clearStencil(0),s.cullFace(s.BACK),s.frontFace(s.CCW),s.polygonOffset(0,0),s.activeTexture(s.TEXTURE0),s.bindFramebuffer(s.FRAMEBUFFER,null),!0===i&&(s.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),s.bindFramebuffer(s.READ_FRAMEBUFFER,null)),s.useProgram(null),s.lineWidth(1),s.scissor(0,0,s.canvas.width,s.canvas.height),s.viewport(0,0,s.canvas.width,s.canvas.height),m={},Ce=null,Fe={},p={},_=new WeakMap,g=[],f=null,b=!1,C=null,M=null,E=null,S=null,P=null,I=null,L=null,O=new xt(0,0,0),B=0,Q=!1,pe=null,ae=null,N=null,ee=null,K=null,Ge.set(0,0,s.canvas.width,s.canvas.height),$e.set(0,0,s.canvas.width,s.canvas.height),o.reset(),l.reset(),c.reset()}}}function nF(s,e,t,i,n,r,a){const o=n.isWebGL2,l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),h=new WeakMap;let u;const m=new WeakMap;let p=!1;try{p=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function _(q,G){return p?new OffscreenCanvas(q,G):am("canvas")}function g(q,G,Oe,ct){let st=1;if((q.width>ct||q.height>ct)&&(st=ct/Math.max(q.width,q.height)),st<1||!0===G){if(typeof HTMLImageElement<"u"&&q instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&q instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&q instanceof ImageBitmap){const nt=G?Cf:Math.floor,ii=nt(st*q.width),Ft=nt(st*q.height);void 0===u&&(u=_(ii,Ft));const Gt=Oe?_(ii,Ft):u;return Gt.width=ii,Gt.height=Ft,Gt.getContext("2d").drawImage(q,0,0,ii,Ft),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+q.width+"x"+q.height+") to ("+ii+"x"+Ft+")."),Gt}return"data"in q&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+q.width+"x"+q.height+")."),q}return q}function f(q){return pv(q.width)&&pv(q.height)}function C(q,G){return q.generateMipmaps&&G&&q.minFilter!==Ss&&q.minFilter!==xs}function M(q){s.generateMipmap(q)}function E(q,G,Oe,ct,st=!1){if(!1===o)return G;if(null!==q){if(void 0!==s[q])return s[q];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+q+"'")}let nt=G;if(G===s.RED&&(Oe===s.FLOAT&&(nt=s.R32F),Oe===s.HALF_FLOAT&&(nt=s.R16F),Oe===s.UNSIGNED_BYTE&&(nt=s.R8)),G===s.RED_INTEGER&&(Oe===s.UNSIGNED_BYTE&&(nt=s.R8UI),Oe===s.UNSIGNED_SHORT&&(nt=s.R16UI),Oe===s.UNSIGNED_INT&&(nt=s.R32UI),Oe===s.BYTE&&(nt=s.R8I),Oe===s.SHORT&&(nt=s.R16I),Oe===s.INT&&(nt=s.R32I)),G===s.RG&&(Oe===s.FLOAT&&(nt=s.RG32F),Oe===s.HALF_FLOAT&&(nt=s.RG16F),Oe===s.UNSIGNED_BYTE&&(nt=s.RG8)),G===s.RGBA){const ii=st?xf:Dn.getTransfer(ct);Oe===s.FLOAT&&(nt=s.RGBA32F),Oe===s.HALF_FLOAT&&(nt=s.RGBA16F),Oe===s.UNSIGNED_BYTE&&(nt=ii===Kn?s.SRGB8_ALPHA8:s.RGBA8),Oe===s.UNSIGNED_SHORT_4_4_4_4&&(nt=s.RGBA4),Oe===s.UNSIGNED_SHORT_5_5_5_1&&(nt=s.RGB5_A1)}return(nt===s.R16F||nt===s.R32F||nt===s.RG16F||nt===s.RG32F||nt===s.RGBA16F||nt===s.RGBA32F)&&e.get("EXT_color_buffer_float"),nt}function S(q,G,Oe){return!0===C(q,Oe)||q.isFramebufferTexture&&q.minFilter!==Ss&&q.minFilter!==xs?Math.log2(Math.max(G.width,G.height))+1:void 0!==q.mipmaps&&q.mipmaps.length>0?q.mipmaps.length:q.isCompressedTexture&&Array.isArray(q.image)?G.mipmaps.length:1}function P(q){return q===Ss||1004===q||1005===q?s.NEAREST:s.LINEAR}function I(q){const G=q.target;G.removeEventListener("dispose",I),function O(q){const G=i.get(q);if(void 0===G.__webglInit)return;const Oe=q.source,ct=m.get(Oe);if(ct){const st=ct[G.__cacheKey];st.usedTimes--,0===st.usedTimes&&B(q),0===Object.keys(ct).length&&m.delete(Oe)}i.remove(q)}(G),G.isVideoTexture&&h.delete(G)}function L(q){const G=q.target;G.removeEventListener("dispose",L),function Q(q){const G=q.texture,Oe=i.get(q),ct=i.get(G);if(void 0!==ct.__webglTexture&&(s.deleteTexture(ct.__webglTexture),a.memory.textures--),q.depthTexture&&q.depthTexture.dispose(),q.isWebGLCubeRenderTarget)for(let st=0;st<6;st++){if(Array.isArray(Oe.__webglFramebuffer[st]))for(let nt=0;nt<Oe.__webglFramebuffer[st].length;nt++)s.deleteFramebuffer(Oe.__webglFramebuffer[st][nt]);else s.deleteFramebuffer(Oe.__webglFramebuffer[st]);Oe.__webglDepthbuffer&&s.deleteRenderbuffer(Oe.__webglDepthbuffer[st])}else{if(Array.isArray(Oe.__webglFramebuffer))for(let st=0;st<Oe.__webglFramebuffer.length;st++)s.deleteFramebuffer(Oe.__webglFramebuffer[st]);else s.deleteFramebuffer(Oe.__webglFramebuffer);if(Oe.__webglDepthbuffer&&s.deleteRenderbuffer(Oe.__webglDepthbuffer),Oe.__webglMultisampledFramebuffer&&s.deleteFramebuffer(Oe.__webglMultisampledFramebuffer),Oe.__webglColorRenderbuffer)for(let st=0;st<Oe.__webglColorRenderbuffer.length;st++)Oe.__webglColorRenderbuffer[st]&&s.deleteRenderbuffer(Oe.__webglColorRenderbuffer[st]);Oe.__webglDepthRenderbuffer&&s.deleteRenderbuffer(Oe.__webglDepthRenderbuffer)}if(q.isWebGLMultipleRenderTargets)for(let st=0,nt=G.length;st<nt;st++){const ii=i.get(G[st]);ii.__webglTexture&&(s.deleteTexture(ii.__webglTexture),a.memory.textures--),i.remove(G[st])}i.remove(G),i.remove(q)}(G)}function B(q){const G=i.get(q);s.deleteTexture(G.__webglTexture),delete m.get(q.source)[G.__cacheKey],a.memory.textures--}let pe=0;function K(q,G){const Oe=i.get(q);if(q.isVideoTexture&&function lt(q){const G=a.render.frame;h.get(q)!==G&&(h.set(q,G),q.update())}(q),!1===q.isRenderTargetTexture&&q.version>0&&Oe.__version!==q.version){const ct=q.image;if(null===ct)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==ct.complete)return void Ge(Oe,q,G);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(s.TEXTURE_2D,Oe.__webglTexture,s.TEXTURE0+G)}const xe={[el]:s.REPEAT,[ar]:s.CLAMP_TO_EDGE,1002:s.MIRRORED_REPEAT},Ce={[Ss]:s.NEAREST,1004:s.NEAREST_MIPMAP_NEAREST,1005:s.NEAREST_MIPMAP_LINEAR,[xs]:s.LINEAR,1007:s.LINEAR_MIPMAP_NEAREST,[tl]:s.LINEAR_MIPMAP_LINEAR},Fe={512:s.NEVER,519:s.ALWAYS,513:s.LESS,515:s.LEQUAL,514:s.EQUAL,518:s.GEQUAL,516:s.GREATER,517:s.NOTEQUAL};function Te(q,G,Oe){if(Oe?(s.texParameteri(q,s.TEXTURE_WRAP_S,xe[G.wrapS]),s.texParameteri(q,s.TEXTURE_WRAP_T,xe[G.wrapT]),(q===s.TEXTURE_3D||q===s.TEXTURE_2D_ARRAY)&&s.texParameteri(q,s.TEXTURE_WRAP_R,xe[G.wrapR]),s.texParameteri(q,s.TEXTURE_MAG_FILTER,Ce[G.magFilter]),s.texParameteri(q,s.TEXTURE_MIN_FILTER,Ce[G.minFilter])):(s.texParameteri(q,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(q,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),(q===s.TEXTURE_3D||q===s.TEXTURE_2D_ARRAY)&&s.texParameteri(q,s.TEXTURE_WRAP_R,s.CLAMP_TO_EDGE),(G.wrapS!==ar||G.wrapT!==ar)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),s.texParameteri(q,s.TEXTURE_MAG_FILTER,P(G.magFilter)),s.texParameteri(q,s.TEXTURE_MIN_FILTER,P(G.minFilter)),G.minFilter!==Ss&&G.minFilter!==xs&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),G.compareFunction&&(s.texParameteri(q,s.TEXTURE_COMPARE_MODE,s.COMPARE_REF_TO_TEXTURE),s.texParameteri(q,s.TEXTURE_COMPARE_FUNC,Fe[G.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){const ct=e.get("EXT_texture_filter_anisotropic");if(G.magFilter===Ss||1005!==G.minFilter&&G.minFilter!==tl||G.type===Mo&&!1===e.has("OES_texture_float_linear")||!1===o&&G.type===im&&!1===e.has("OES_texture_half_float_linear"))return;(G.anisotropy>1||i.get(G).__currentAnisotropy)&&(s.texParameterf(q,ct.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(G.anisotropy,n.getMaxAnisotropy())),i.get(G).__currentAnisotropy=G.anisotropy)}}function Le(q,G){let Oe=!1;void 0===q.__webglInit&&(q.__webglInit=!0,G.addEventListener("dispose",I));const ct=G.source;let st=m.get(ct);void 0===st&&(st={},m.set(ct,st));const nt=function ee(q){const G=[];return G.push(q.wrapS),G.push(q.wrapT),G.push(q.wrapR||0),G.push(q.magFilter),G.push(q.minFilter),G.push(q.anisotropy),G.push(q.internalFormat),G.push(q.format),G.push(q.type),G.push(q.generateMipmaps),G.push(q.premultiplyAlpha),G.push(q.flipY),G.push(q.unpackAlignment),G.push(q.colorSpace),G.join()}(G);if(nt!==q.__cacheKey){void 0===st[nt]&&(st[nt]={texture:s.createTexture(),usedTimes:0},a.memory.textures++,Oe=!0),st[nt].usedTimes++;const ii=st[q.__cacheKey];void 0!==ii&&(st[q.__cacheKey].usedTimes--,0===ii.usedTimes&&B(G)),q.__cacheKey=nt,q.__webglTexture=st[nt].texture}return Oe}function Ge(q,G,Oe){let ct=s.TEXTURE_2D;(G.isDataArrayTexture||G.isCompressedArrayTexture)&&(ct=s.TEXTURE_2D_ARRAY),G.isData3DTexture&&(ct=s.TEXTURE_3D);const st=Le(q,G),nt=G.source;t.bindTexture(ct,q.__webglTexture,s.TEXTURE0+Oe);const ii=i.get(nt);if(nt.version!==ii.__version||!0===st){t.activeTexture(s.TEXTURE0+Oe);const Ft=Dn.getPrimaries(Dn.workingColorSpace),Gt=""===G.colorSpace?null:Dn.getPrimaries(G.colorSpace),vi=""===G.colorSpace||Ft===Gt?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,G.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,G.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,G.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,vi);const Ii=function b(q){return!o&&(q.wrapS!==ar||q.wrapT!==ar||q.minFilter!==Ss&&q.minFilter!==xs)}(G)&&!1===f(G.image);let rt=g(G.image,Ii,!1,n.maxTextureSize);rt=ft(G,rt);const tn=f(rt)||o,de=r.convert(G.format,G.colorSpace);let yt,at=r.convert(G.type),Pt=E(G.internalFormat,de,at,G.colorSpace,G.isVideoTexture);Te(ct,G,tn);const di=G.mipmaps,nn=o&&!0!==G.isVideoTexture&&36196!==Pt,dn=void 0===ii.__version||!0===st,Ki=S(G,rt,tn);if(G.isDepthTexture)Pt=s.DEPTH_COMPONENT,o?Pt=G.type===Mo?s.DEPTH_COMPONENT32F:G.type===Nl?s.DEPTH_COMPONENT24:G.type===Hc?s.DEPTH24_STENCIL8:s.DEPTH_COMPONENT16:G.type===Mo&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),G.format===Vc&&Pt===s.DEPTH_COMPONENT&&1012!==G.type&&G.type!==Nl&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),G.type=Nl,at=r.convert(G.type)),G.format===rh&&Pt===s.DEPTH_COMPONENT&&(Pt=s.DEPTH_STENCIL,G.type!==Hc&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),G.type=Hc,at=r.convert(G.type))),dn&&(nn?t.texStorage2D(s.TEXTURE_2D,1,Pt,rt.width,rt.height):t.texImage2D(s.TEXTURE_2D,0,Pt,rt.width,rt.height,0,de,at,null));else if(G.isDataTexture)if(di.length>0&&tn){nn&&dn&&t.texStorage2D(s.TEXTURE_2D,Ki,Pt,di[0].width,di[0].height);for(let At=0,ve=di.length;At<ve;At++)yt=di[At],nn?t.texSubImage2D(s.TEXTURE_2D,At,0,0,yt.width,yt.height,de,at,yt.data):t.texImage2D(s.TEXTURE_2D,At,Pt,yt.width,yt.height,0,de,at,yt.data);G.generateMipmaps=!1}else nn?(dn&&t.texStorage2D(s.TEXTURE_2D,Ki,Pt,rt.width,rt.height),t.texSubImage2D(s.TEXTURE_2D,0,0,0,rt.width,rt.height,de,at,rt.data)):t.texImage2D(s.TEXTURE_2D,0,Pt,rt.width,rt.height,0,de,at,rt.data);else if(G.isCompressedTexture)if(G.isCompressedArrayTexture){nn&&dn&&t.texStorage3D(s.TEXTURE_2D_ARRAY,Ki,Pt,di[0].width,di[0].height,rt.depth);for(let At=0,ve=di.length;At<ve;At++)yt=di[At],G.format!==ma?null!==de?nn?t.compressedTexSubImage3D(s.TEXTURE_2D_ARRAY,At,0,0,0,yt.width,yt.height,rt.depth,de,yt.data,0,0):t.compressedTexImage3D(s.TEXTURE_2D_ARRAY,At,Pt,yt.width,yt.height,rt.depth,0,yt.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):nn?t.texSubImage3D(s.TEXTURE_2D_ARRAY,At,0,0,0,yt.width,yt.height,rt.depth,de,at,yt.data):t.texImage3D(s.TEXTURE_2D_ARRAY,At,Pt,yt.width,yt.height,rt.depth,0,de,at,yt.data)}else{nn&&dn&&t.texStorage2D(s.TEXTURE_2D,Ki,Pt,di[0].width,di[0].height);for(let At=0,ve=di.length;At<ve;At++)yt=di[At],G.format!==ma?null!==de?nn?t.compressedTexSubImage2D(s.TEXTURE_2D,At,0,0,yt.width,yt.height,de,yt.data):t.compressedTexImage2D(s.TEXTURE_2D,At,Pt,yt.width,yt.height,0,yt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):nn?t.texSubImage2D(s.TEXTURE_2D,At,0,0,yt.width,yt.height,de,at,yt.data):t.texImage2D(s.TEXTURE_2D,At,Pt,yt.width,yt.height,0,de,at,yt.data)}else if(G.isDataArrayTexture)nn?(dn&&t.texStorage3D(s.TEXTURE_2D_ARRAY,Ki,Pt,rt.width,rt.height,rt.depth),t.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,0,rt.width,rt.height,rt.depth,de,at,rt.data)):t.texImage3D(s.TEXTURE_2D_ARRAY,0,Pt,rt.width,rt.height,rt.depth,0,de,at,rt.data);else if(G.isData3DTexture)nn?(dn&&t.texStorage3D(s.TEXTURE_3D,Ki,Pt,rt.width,rt.height,rt.depth),t.texSubImage3D(s.TEXTURE_3D,0,0,0,0,rt.width,rt.height,rt.depth,de,at,rt.data)):t.texImage3D(s.TEXTURE_3D,0,Pt,rt.width,rt.height,rt.depth,0,de,at,rt.data);else if(G.isFramebufferTexture){if(dn)if(nn)t.texStorage2D(s.TEXTURE_2D,Ki,Pt,rt.width,rt.height);else{let At=rt.width,ve=rt.height;for(let Dt=0;Dt<Ki;Dt++)t.texImage2D(s.TEXTURE_2D,Dt,Pt,At,ve,0,de,at,null),At>>=1,ve>>=1}}else if(di.length>0&&tn){nn&&dn&&t.texStorage2D(s.TEXTURE_2D,Ki,Pt,di[0].width,di[0].height);for(let At=0,ve=di.length;At<ve;At++)yt=di[At],nn?t.texSubImage2D(s.TEXTURE_2D,At,0,0,de,at,yt):t.texImage2D(s.TEXTURE_2D,At,Pt,de,at,yt);G.generateMipmaps=!1}else nn?(dn&&t.texStorage2D(s.TEXTURE_2D,Ki,Pt,rt.width,rt.height),t.texSubImage2D(s.TEXTURE_2D,0,0,0,de,at,rt)):t.texImage2D(s.TEXTURE_2D,0,Pt,de,at,rt);C(G,tn)&&M(ct),ii.__version=nt.version,G.onUpdate&&G.onUpdate(G)}q.__version=G.version}function et(q,G,Oe,ct,st,nt){const ii=r.convert(Oe.format,Oe.colorSpace),Ft=r.convert(Oe.type),Gt=E(Oe.internalFormat,ii,Ft,Oe.colorSpace);if(!i.get(G).__hasExternalTextures){const Ii=Math.max(1,G.width>>nt),rt=Math.max(1,G.height>>nt);st===s.TEXTURE_3D||st===s.TEXTURE_2D_ARRAY?t.texImage3D(st,nt,Gt,Ii,rt,G.depth,0,ii,Ft,null):t.texImage2D(st,nt,Gt,Ii,rt,0,ii,Ft,null)}t.bindFramebuffer(s.FRAMEBUFFER,q),qe(G)?l.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,ct,st,i.get(Oe).__webglTexture,0,pt(G)):(st===s.TEXTURE_2D||st>=s.TEXTURE_CUBE_MAP_POSITIVE_X&&st<=s.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&s.framebufferTexture2D(s.FRAMEBUFFER,ct,st,i.get(Oe).__webglTexture,nt),t.bindFramebuffer(s.FRAMEBUFFER,null)}function wt(q,G,Oe){if(s.bindRenderbuffer(s.RENDERBUFFER,q),G.depthBuffer&&!G.stencilBuffer){let ct=!0===o?s.DEPTH_COMPONENT24:s.DEPTH_COMPONENT16;if(Oe||qe(G)){const st=G.depthTexture;st&&st.isDepthTexture&&(st.type===Mo?ct=s.DEPTH_COMPONENT32F:st.type===Nl&&(ct=s.DEPTH_COMPONENT24));const nt=pt(G);qe(G)?l.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,nt,ct,G.width,G.height):s.renderbufferStorageMultisample(s.RENDERBUFFER,nt,ct,G.width,G.height)}else s.renderbufferStorage(s.RENDERBUFFER,ct,G.width,G.height);s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,q)}else if(G.depthBuffer&&G.stencilBuffer){const ct=pt(G);Oe&&!1===qe(G)?s.renderbufferStorageMultisample(s.RENDERBUFFER,ct,s.DEPTH24_STENCIL8,G.width,G.height):qe(G)?l.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,ct,s.DEPTH24_STENCIL8,G.width,G.height):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,G.width,G.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,q)}else{const ct=!0===G.isWebGLMultipleRenderTargets?G.texture:[G.texture];for(let st=0;st<ct.length;st++){const nt=ct[st],ii=r.convert(nt.format,nt.colorSpace),Ft=r.convert(nt.type),Gt=E(nt.internalFormat,ii,Ft,nt.colorSpace),vi=pt(G);Oe&&!1===qe(G)?s.renderbufferStorageMultisample(s.RENDERBUFFER,vi,Gt,G.width,G.height):qe(G)?l.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,vi,Gt,G.width,G.height):s.renderbufferStorage(s.RENDERBUFFER,Gt,G.width,G.height)}}s.bindRenderbuffer(s.RENDERBUFFER,null)}function It(q){const G=i.get(q),Oe=!0===q.isWebGLCubeRenderTarget;if(q.depthTexture&&!G.__autoAllocateDepthBuffer){if(Oe)throw new Error("target.depthTexture not supported in Cube render targets");!function Jt(q,G){if(G&&G.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(s.FRAMEBUFFER,q),!G.depthTexture||!G.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(G.depthTexture).__webglTexture||G.depthTexture.image.width!==G.width||G.depthTexture.image.height!==G.height)&&(G.depthTexture.image.width=G.width,G.depthTexture.image.height=G.height,G.depthTexture.needsUpdate=!0),K(G.depthTexture,0);const ct=i.get(G.depthTexture).__webglTexture,st=pt(G);if(G.depthTexture.format===Vc)qe(G)?l.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,ct,0,st):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,ct,0);else{if(G.depthTexture.format!==rh)throw new Error("Unknown depthTexture format");qe(G)?l.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,ct,0,st):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,ct,0)}}(G.__webglFramebuffer,q)}else if(Oe){G.__webglDepthbuffer=[];for(let ct=0;ct<6;ct++)t.bindFramebuffer(s.FRAMEBUFFER,G.__webglFramebuffer[ct]),G.__webglDepthbuffer[ct]=s.createRenderbuffer(),wt(G.__webglDepthbuffer[ct],q,!1)}else t.bindFramebuffer(s.FRAMEBUFFER,G.__webglFramebuffer),G.__webglDepthbuffer=s.createRenderbuffer(),wt(G.__webglDepthbuffer,q,!1);t.bindFramebuffer(s.FRAMEBUFFER,null)}function pt(q){return Math.min(n.maxSamples,q.samples)}function qe(q){const G=i.get(q);return o&&q.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==G.__useRenderToTexture}function ft(q,G){const Oe=q.colorSpace,ct=q.format,st=q.type;return!0===q.isCompressedTexture||!0===q.isVideoTexture||1035===q.format||Oe!==or&&""!==Oe&&(Dn.getTransfer(Oe)===Kn?!1===o?!0===e.has("EXT_sRGB")&&ct===ma?(q.format=1035,q.minFilter=xs,q.generateMipmaps=!1):G=p1.sRGBToLinear(G):(ct!==ma||st!==Bl)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Oe)),G}this.allocateTextureUnit=function N(){const q=pe;return q>=n.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+q+" texture units while this GPU supports only "+n.maxTextures),pe+=1,q},this.resetTextureUnits=function ae(){pe=0},this.setTexture2D=K,this.setTexture2DArray=function se(q,G){const Oe=i.get(q);q.version>0&&Oe.__version!==q.version?Ge(Oe,q,G):t.bindTexture(s.TEXTURE_2D_ARRAY,Oe.__webglTexture,s.TEXTURE0+G)},this.setTexture3D=function ue(q,G){const Oe=i.get(q);q.version>0&&Oe.__version!==q.version?Ge(Oe,q,G):t.bindTexture(s.TEXTURE_3D,Oe.__webglTexture,s.TEXTURE0+G)},this.setTextureCube=function re(q,G){const Oe=i.get(q);q.version>0&&Oe.__version!==q.version?function $e(q,G,Oe){if(6!==G.image.length)return;const ct=Le(q,G),st=G.source;t.bindTexture(s.TEXTURE_CUBE_MAP,q.__webglTexture,s.TEXTURE0+Oe);const nt=i.get(st);if(st.version!==nt.__version||!0===ct){t.activeTexture(s.TEXTURE0+Oe);const ii=Dn.getPrimaries(Dn.workingColorSpace),Ft=""===G.colorSpace?null:Dn.getPrimaries(G.colorSpace),Gt=""===G.colorSpace||ii===Ft?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,G.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,G.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,G.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,Gt);const vi=G.isCompressedTexture||G.image[0].isCompressedTexture,Ii=G.image[0]&&G.image[0].isDataTexture,rt=[];for(let At=0;At<6;At++)rt[At]=vi||Ii?Ii?G.image[At].image:G.image[At]:g(G.image[At],!1,!0,n.maxCubemapSize),rt[At]=ft(G,rt[At]);const tn=rt[0],de=f(tn)||o,at=r.convert(G.format,G.colorSpace),Pt=r.convert(G.type),yt=E(G.internalFormat,at,Pt,G.colorSpace),di=o&&!0!==G.isVideoTexture,nn=void 0===nt.__version||!0===ct;let Ki,dn=S(G,tn,de);if(Te(s.TEXTURE_CUBE_MAP,G,de),vi){di&&nn&&t.texStorage2D(s.TEXTURE_CUBE_MAP,dn,yt,tn.width,tn.height);for(let At=0;At<6;At++){Ki=rt[At].mipmaps;for(let ve=0;ve<Ki.length;ve++){const Dt=Ki[ve];G.format!==ma?null!==at?di?t.compressedTexSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+At,ve,0,0,Dt.width,Dt.height,at,Dt.data):t.compressedTexImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+At,ve,yt,Dt.width,Dt.height,0,Dt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):di?t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+At,ve,0,0,Dt.width,Dt.height,at,Pt,Dt.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+At,ve,yt,Dt.width,Dt.height,0,at,Pt,Dt.data)}}}else{Ki=G.mipmaps,di&&nn&&(Ki.length>0&&dn++,t.texStorage2D(s.TEXTURE_CUBE_MAP,dn,yt,rt[0].width,rt[0].height));for(let At=0;At<6;At++)if(Ii){di?t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+At,0,0,0,rt[At].width,rt[At].height,at,Pt,rt[At].data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+At,0,yt,rt[At].width,rt[At].height,0,at,Pt,rt[At].data);for(let ve=0;ve<Ki.length;ve++){const Et=Ki[ve].image[At].image;di?t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+At,ve+1,0,0,Et.width,Et.height,at,Pt,Et.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+At,ve+1,yt,Et.width,Et.height,0,at,Pt,Et.data)}}else{di?t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+At,0,0,0,at,Pt,rt[At]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+At,0,yt,at,Pt,rt[At]);for(let ve=0;ve<Ki.length;ve++){const Dt=Ki[ve];di?t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+At,ve+1,0,0,at,Pt,Dt.image[At]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+At,ve+1,yt,at,Pt,Dt.image[At])}}}C(G,de)&&M(s.TEXTURE_CUBE_MAP),nt.__version=st.version,G.onUpdate&&G.onUpdate(G)}q.__version=G.version}(Oe,q,G):t.bindTexture(s.TEXTURE_CUBE_MAP,Oe.__webglTexture,s.TEXTURE0+G)},this.rebindTextures=function oi(q,G,Oe){const ct=i.get(q);void 0!==G&&et(ct.__webglFramebuffer,q,q.texture,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,0),void 0!==Oe&&It(q)},this.setupRenderTarget=function me(q){const G=q.texture,Oe=i.get(q),ct=i.get(G);q.addEventListener("dispose",L),!0!==q.isWebGLMultipleRenderTargets&&(void 0===ct.__webglTexture&&(ct.__webglTexture=s.createTexture()),ct.__version=G.version,a.memory.textures++);const st=!0===q.isWebGLCubeRenderTarget,nt=!0===q.isWebGLMultipleRenderTargets,ii=f(q)||o;if(st){Oe.__webglFramebuffer=[];for(let Ft=0;Ft<6;Ft++)if(o&&G.mipmaps&&G.mipmaps.length>0){Oe.__webglFramebuffer[Ft]=[];for(let Gt=0;Gt<G.mipmaps.length;Gt++)Oe.__webglFramebuffer[Ft][Gt]=s.createFramebuffer()}else Oe.__webglFramebuffer[Ft]=s.createFramebuffer()}else{if(o&&G.mipmaps&&G.mipmaps.length>0){Oe.__webglFramebuffer=[];for(let Ft=0;Ft<G.mipmaps.length;Ft++)Oe.__webglFramebuffer[Ft]=s.createFramebuffer()}else Oe.__webglFramebuffer=s.createFramebuffer();if(nt)if(n.drawBuffers){const Ft=q.texture;for(let Gt=0,vi=Ft.length;Gt<vi;Gt++){const Ii=i.get(Ft[Gt]);void 0===Ii.__webglTexture&&(Ii.__webglTexture=s.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(o&&q.samples>0&&!1===qe(q)){const Ft=nt?G:[G];Oe.__webglMultisampledFramebuffer=s.createFramebuffer(),Oe.__webglColorRenderbuffer=[],t.bindFramebuffer(s.FRAMEBUFFER,Oe.__webglMultisampledFramebuffer);for(let Gt=0;Gt<Ft.length;Gt++){const vi=Ft[Gt];Oe.__webglColorRenderbuffer[Gt]=s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,Oe.__webglColorRenderbuffer[Gt]);const Ii=r.convert(vi.format,vi.colorSpace),rt=r.convert(vi.type),tn=E(vi.internalFormat,Ii,rt,vi.colorSpace,!0===q.isXRRenderTarget),de=pt(q);s.renderbufferStorageMultisample(s.RENDERBUFFER,de,tn,q.width,q.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+Gt,s.RENDERBUFFER,Oe.__webglColorRenderbuffer[Gt])}s.bindRenderbuffer(s.RENDERBUFFER,null),q.depthBuffer&&(Oe.__webglDepthRenderbuffer=s.createRenderbuffer(),wt(Oe.__webglDepthRenderbuffer,q,!0)),t.bindFramebuffer(s.FRAMEBUFFER,null)}}if(st){t.bindTexture(s.TEXTURE_CUBE_MAP,ct.__webglTexture),Te(s.TEXTURE_CUBE_MAP,G,ii);for(let Ft=0;Ft<6;Ft++)if(o&&G.mipmaps&&G.mipmaps.length>0)for(let Gt=0;Gt<G.mipmaps.length;Gt++)et(Oe.__webglFramebuffer[Ft][Gt],q,G,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+Ft,Gt);else et(Oe.__webglFramebuffer[Ft],q,G,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+Ft,0);C(G,ii)&&M(s.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(nt){const Ft=q.texture;for(let Gt=0,vi=Ft.length;Gt<vi;Gt++){const Ii=Ft[Gt],rt=i.get(Ii);t.bindTexture(s.TEXTURE_2D,rt.__webglTexture),Te(s.TEXTURE_2D,Ii,ii),et(Oe.__webglFramebuffer,q,Ii,s.COLOR_ATTACHMENT0+Gt,s.TEXTURE_2D,0),C(Ii,ii)&&M(s.TEXTURE_2D)}t.unbindTexture()}else{let Ft=s.TEXTURE_2D;if((q.isWebGL3DRenderTarget||q.isWebGLArrayRenderTarget)&&(o?Ft=q.isWebGL3DRenderTarget?s.TEXTURE_3D:s.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Ft,ct.__webglTexture),Te(Ft,G,ii),o&&G.mipmaps&&G.mipmaps.length>0)for(let Gt=0;Gt<G.mipmaps.length;Gt++)et(Oe.__webglFramebuffer[Gt],q,G,s.COLOR_ATTACHMENT0,Ft,Gt);else et(Oe.__webglFramebuffer,q,G,s.COLOR_ATTACHMENT0,Ft,0);C(G,ii)&&M(Ft),t.unbindTexture()}q.depthBuffer&&It(q)},this.updateRenderTargetMipmap=function gt(q){const G=f(q)||o,Oe=!0===q.isWebGLMultipleRenderTargets?q.texture:[q.texture];for(let ct=0,st=Oe.length;ct<st;ct++){const nt=Oe[ct];if(C(nt,G)){const ii=q.isWebGLCubeRenderTarget?s.TEXTURE_CUBE_MAP:s.TEXTURE_2D,Ft=i.get(nt).__webglTexture;t.bindTexture(ii,Ft),M(ii),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Ze(q){if(o&&q.samples>0&&!1===qe(q)){const G=q.isWebGLMultipleRenderTargets?q.texture:[q.texture],Oe=q.width,ct=q.height;let st=s.COLOR_BUFFER_BIT;const nt=[],ii=q.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,Ft=i.get(q),Gt=!0===q.isWebGLMultipleRenderTargets;if(Gt)for(let vi=0;vi<G.length;vi++)t.bindFramebuffer(s.FRAMEBUFFER,Ft.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+vi,s.RENDERBUFFER,null),t.bindFramebuffer(s.FRAMEBUFFER,Ft.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+vi,s.TEXTURE_2D,null,0);t.bindFramebuffer(s.READ_FRAMEBUFFER,Ft.__webglMultisampledFramebuffer),t.bindFramebuffer(s.DRAW_FRAMEBUFFER,Ft.__webglFramebuffer);for(let vi=0;vi<G.length;vi++){nt.push(s.COLOR_ATTACHMENT0+vi),q.depthBuffer&&nt.push(ii);const Ii=void 0!==Ft.__ignoreDepthValues&&Ft.__ignoreDepthValues;if(!1===Ii&&(q.depthBuffer&&(st|=s.DEPTH_BUFFER_BIT),q.stencilBuffer&&(st|=s.STENCIL_BUFFER_BIT)),Gt&&s.framebufferRenderbuffer(s.READ_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,Ft.__webglColorRenderbuffer[vi]),!0===Ii&&(s.invalidateFramebuffer(s.READ_FRAMEBUFFER,[ii]),s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,[ii])),Gt){const rt=i.get(G[vi]).__webglTexture;s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,rt,0)}s.blitFramebuffer(0,0,Oe,ct,0,0,Oe,ct,st,s.NEAREST),c&&s.invalidateFramebuffer(s.READ_FRAMEBUFFER,nt)}if(t.bindFramebuffer(s.READ_FRAMEBUFFER,null),t.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),Gt)for(let vi=0;vi<G.length;vi++){t.bindFramebuffer(s.FRAMEBUFFER,Ft.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+vi,s.RENDERBUFFER,Ft.__webglColorRenderbuffer[vi]);const Ii=i.get(G[vi]).__webglTexture;t.bindFramebuffer(s.FRAMEBUFFER,Ft.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+vi,s.TEXTURE_2D,Ii,0)}t.bindFramebuffer(s.DRAW_FRAMEBUFFER,Ft.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=It,this.setupFrameBufferTexture=et,this.useMultisampledRTT=qe}function sF(s,e,t){const i=t.isWebGL2;return{convert:function n(r,a=""){let o;const l=Dn.getTransfer(a);if(r===Bl)return s.UNSIGNED_BYTE;if(1017===r)return s.UNSIGNED_SHORT_4_4_4_4;if(1018===r)return s.UNSIGNED_SHORT_5_5_5_1;if(1010===r)return s.BYTE;if(1011===r)return s.SHORT;if(1012===r)return s.UNSIGNED_SHORT;if(1013===r)return s.INT;if(r===Nl)return s.UNSIGNED_INT;if(r===Mo)return s.FLOAT;if(r===im)return i?s.HALF_FLOAT:(o=e.get("OES_texture_half_float"),null!==o?o.HALF_FLOAT_OES:null);if(1021===r)return s.ALPHA;if(r===ma)return s.RGBA;if(1024===r)return s.LUMINANCE;if(1025===r)return s.LUMINANCE_ALPHA;if(r===Vc)return s.DEPTH_COMPONENT;if(r===rh)return s.DEPTH_STENCIL;if(1035===r)return o=e.get("EXT_sRGB"),null!==o?o.SRGB_ALPHA_EXT:null;if(1028===r)return s.RED;if(1029===r)return s.RED_INTEGER;if(1030===r)return s.RG;if(1031===r)return s.RG_INTEGER;if(1033===r)return s.RGBA_INTEGER;if(33776===r||33777===r||33778===r||33779===r)if(l===Kn){if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===o)return null;if(33776===r)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===r)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===r)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===r)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(o=e.get("WEBGL_compressed_texture_s3tc"),null===o)return null;if(33776===r)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===r)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===r)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===r)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===r||35841===r||35842===r||35843===r){if(o=e.get("WEBGL_compressed_texture_pvrtc"),null===o)return null;if(35840===r)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===r)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===r)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===r)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===r)return o=e.get("WEBGL_compressed_texture_etc1"),null!==o?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===r||37496===r){if(o=e.get("WEBGL_compressed_texture_etc"),null===o)return null;if(37492===r)return l===Kn?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(37496===r)return l===Kn?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}if(37808===r||37809===r||37810===r||37811===r||37812===r||37813===r||37814===r||37815===r||37816===r||37817===r||37818===r||37819===r||37820===r||37821===r){if(o=e.get("WEBGL_compressed_texture_astc"),null===o)return null;if(37808===r)return l===Kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===r)return l===Kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===r)return l===Kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===r)return l===Kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===r)return l===Kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===r)return l===Kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===r)return l===Kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===r)return l===Kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===r)return l===Kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===r)return l===Kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===r)return l===Kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===r)return l===Kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===r)return l===Kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===r)return l===Kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===r||36494===r||36495===r){if(o=e.get("EXT_texture_compression_bptc"),null===o)return null;if(36492===r)return l===Kn?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===r)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===r)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===r||36284===r||36285===r||36286===r){if(o=e.get("EXT_texture_compression_rgtc"),null===o)return null;if(36492===r)return o.COMPRESSED_RED_RGTC1_EXT;if(36284===r)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===r)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===r)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return r===Hc?i?s.UNSIGNED_INT_24_8:(o=e.get("WEBGL_depth_texture"),null!==o?o.UNSIGNED_INT_24_8_WEBGL:null):void 0!==s[r]?s[r]:null}}}class rF extends Qs{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Do extends Qn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const aF={type:"move"};class Gv{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Do,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Do,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Z,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Z),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Do,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Z,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Z),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let n=null,r=null,a=null;const o=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(c&&e.hand){a=!0;for(const g of e.hand.values()){const f=t.getJointPose(g,i),b=this._getHandJoint(c,g);null!==f&&(b.matrix.fromArray(f.transform.matrix),b.matrix.decompose(b.position,b.rotation,b.scale),b.matrixWorldNeedsUpdate=!0,b.jointRadius=f.radius),b.visible=null!==f}const m=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),p=.02,_=.005;c.inputState.pinching&&m>p+_?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&m<=p-_&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(r=t.getPose(e.gripSpace,i),null!==r&&(l.matrix.fromArray(r.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,r.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(r.linearVelocity)):l.hasLinearVelocity=!1,r.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(r.angularVelocity)):l.hasAngularVelocity=!1));null!==o&&(n=t.getPose(e.targetRaySpace,i),null===n&&null!==r&&(n=r),null!==n&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(aF)))}return null!==o&&(o.visible=null!==n),null!==l&&(l.visible=null!==r),null!==c&&(c.visible=null!==a),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new Do;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class oF extends Yc{constructor(e,t){super();const i=this;let n=null,r=1,a=null,o="local-floor",l=1,c=null,h=null,u=null,m=null,p=null,_=null;const g=t.getContextAttributes();let f=null,b=null;const C=[],M=[],E=new Xe;let S=null;const P=new Qs;P.layers.enable(1),P.viewport=new yn;const I=new Qs;I.layers.enable(2),I.viewport=new yn;const L=[P,I],O=new rF;O.layers.enable(1),O.layers.enable(2);let B=null,Q=null;function pe(Te){const Le=M.indexOf(Te.inputSource);if(-1===Le)return;const Ge=C[Le];void 0!==Ge&&(Ge.update(Te.inputSource,Te.frame,c||a),Ge.dispatchEvent({type:Te.type,data:Te.inputSource}))}function ae(){n.removeEventListener("select",pe),n.removeEventListener("selectstart",pe),n.removeEventListener("selectend",pe),n.removeEventListener("squeeze",pe),n.removeEventListener("squeezestart",pe),n.removeEventListener("squeezeend",pe),n.removeEventListener("end",ae),n.removeEventListener("inputsourceschange",N);for(let Te=0;Te<C.length;Te++){const Le=M[Te];null!==Le&&(M[Te]=null,C[Te].disconnect(Le))}B=null,Q=null,e.setRenderTarget(f),p=null,m=null,u=null,n=null,b=null,Fe.stop(),i.isPresenting=!1,e.setPixelRatio(S),e.setSize(E.width,E.height,!1),i.dispatchEvent({type:"sessionend"})}function N(Te){for(let Le=0;Le<Te.removed.length;Le++){const Ge=Te.removed[Le],$e=M.indexOf(Ge);$e>=0&&(M[$e]=null,C[$e].disconnect(Ge))}for(let Le=0;Le<Te.added.length;Le++){const Ge=Te.added[Le];let $e=M.indexOf(Ge);if(-1===$e){for(let wt=0;wt<C.length;wt++){if(wt>=M.length){M.push(Ge),$e=wt;break}if(null===M[wt]){M[wt]=Ge,$e=wt;break}}if(-1===$e)break}const et=C[$e];et&&et.connect(Ge)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Te){let Le=C[Te];return void 0===Le&&(Le=new Gv,C[Te]=Le),Le.getTargetRaySpace()},this.getControllerGrip=function(Te){let Le=C[Te];return void 0===Le&&(Le=new Gv,C[Te]=Le),Le.getGripSpace()},this.getHand=function(Te){let Le=C[Te];return void 0===Le&&(Le=new Gv,C[Te]=Le),Le.getHandSpace()},this.setFramebufferScaleFactor=function(Te){r=Te,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Te){o=Te,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||a},this.setReferenceSpace=function(Te){c=Te},this.getBaseLayer=function(){return null!==m?m:p},this.getBinding=function(){return u},this.getFrame=function(){return _},this.getSession=function(){return n},this.setSession=function(){var Te=(0,On.Z)(function*(Le){if(n=Le,null!==n){if(f=e.getRenderTarget(),n.addEventListener("select",pe),n.addEventListener("selectstart",pe),n.addEventListener("selectend",pe),n.addEventListener("squeeze",pe),n.addEventListener("squeezestart",pe),n.addEventListener("squeezeend",pe),n.addEventListener("end",ae),n.addEventListener("inputsourceschange",N),!0!==g.xrCompatible&&(yield t.makeXRCompatible()),S=e.getPixelRatio(),e.getSize(E),void 0===n.renderState.layers||!1===e.capabilities.isWebGL2)p=new XRWebGLLayer(n,t,{antialias:void 0!==n.renderState.layers||g.antialias,alpha:!0,depth:g.depth,stencil:g.stencil,framebufferScaleFactor:r}),n.updateRenderState({baseLayer:p}),e.setPixelRatio(1),e.setSize(p.framebufferWidth,p.framebufferHeight,!1),b=new Zc(p.framebufferWidth,p.framebufferHeight,{format:ma,type:Bl,colorSpace:e.outputColorSpace,stencilBuffer:g.stencil});else{let Ge=null,$e=null,et=null;g.depth&&(et=g.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Ge=g.stencil?rh:Vc,$e=g.stencil?Hc:Nl);const wt={colorFormat:t.RGBA8,depthFormat:et,scaleFactor:r};u=new XRWebGLBinding(n,t),m=u.createProjectionLayer(wt),n.updateRenderState({layers:[m]}),e.setPixelRatio(1),e.setSize(m.textureWidth,m.textureHeight,!1),b=new Zc(m.textureWidth,m.textureHeight,{format:ma,type:Bl,depthTexture:new z1(m.textureWidth,m.textureHeight,$e,void 0,void 0,void 0,void 0,void 0,void 0,Ge),stencilBuffer:g.stencil,colorSpace:e.outputColorSpace,samples:g.antialias?4:0}),e.properties.get(b).__ignoreDepthValues=m.ignoreDepthValues}b.isXRRenderTarget=!0,this.setFoveation(l),c=null,a=yield n.requestReferenceSpace(o),Fe.setContext(n),Fe.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(Le){return Te.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==n)return n.environmentBlendMode};const ee=new Z,K=new Z;function ue(Te,Le){null===Le?Te.matrixWorld.copy(Te.matrix):Te.matrixWorld.multiplyMatrices(Le.matrixWorld,Te.matrix),Te.matrixWorldInverse.copy(Te.matrixWorld).invert()}this.updateCamera=function(Te){if(null===n)return;O.near=I.near=P.near=Te.near,O.far=I.far=P.far=Te.far,(B!==O.near||Q!==O.far)&&(n.updateRenderState({depthNear:O.near,depthFar:O.far}),B=O.near,Q=O.far);const Le=Te.parent,Ge=O.cameras;ue(O,Le);for(let $e=0;$e<Ge.length;$e++)ue(Ge[$e],Le);2===Ge.length?function se(Te,Le,Ge){ee.setFromMatrixPosition(Le.matrixWorld),K.setFromMatrixPosition(Ge.matrixWorld);const $e=ee.distanceTo(K),et=Le.projectionMatrix.elements,wt=Ge.projectionMatrix.elements,Jt=et[14]/(et[10]-1),It=et[14]/(et[10]+1),oi=(et[9]+1)/et[5],me=(et[9]-1)/et[5],gt=(et[8]-1)/et[0],Ze=(wt[8]+1)/wt[0],pt=Jt*gt,qe=Jt*Ze,lt=$e/(-gt+Ze),ft=lt*-gt;Le.matrixWorld.decompose(Te.position,Te.quaternion,Te.scale),Te.translateX(ft),Te.translateZ(lt),Te.matrixWorld.compose(Te.position,Te.quaternion,Te.scale),Te.matrixWorldInverse.copy(Te.matrixWorld).invert();const q=Jt+lt,G=It+lt;Te.projectionMatrix.makePerspective(pt-ft,qe+($e-ft),oi*It/G*q,me*It/G*q,q,G),Te.projectionMatrixInverse.copy(Te.projectionMatrix).invert()}(O,P,I):O.projectionMatrix.copy(P.projectionMatrix),function re(Te,Le,Ge){null===Ge?Te.matrix.copy(Le.matrixWorld):(Te.matrix.copy(Ge.matrixWorld),Te.matrix.invert(),Te.matrix.multiply(Le.matrixWorld)),Te.matrix.decompose(Te.position,Te.quaternion,Te.scale),Te.updateMatrixWorld(!0),Te.projectionMatrix.copy(Le.projectionMatrix),Te.projectionMatrixInverse.copy(Le.projectionMatrixInverse),Te.isPerspectiveCamera&&(Te.fov=2*dh*Math.atan(1/Te.projectionMatrix.elements[5]),Te.zoom=1)}(Te,O,Le)},this.getCamera=function(){return O},this.getFoveation=function(){if(null!==m||null!==p)return l},this.setFoveation=function(Te){l=Te,null!==m&&(m.fixedFoveation=Te),null!==p&&void 0!==p.fixedFoveation&&(p.fixedFoveation=Te)};let xe=null;const Fe=new O1;Fe.setAnimationLoop(function Ce(Te,Le){if(h=Le.getViewerPose(c||a),_=Le,null!==h){const Ge=h.views;null!==p&&(e.setRenderTargetFramebuffer(b,p.framebuffer),e.setRenderTarget(b));let $e=!1;Ge.length!==O.cameras.length&&(O.cameras.length=0,$e=!0);for(let et=0;et<Ge.length;et++){const wt=Ge[et];let Jt=null;if(null!==p)Jt=p.getViewport(wt);else{const oi=u.getViewSubImage(m,wt);Jt=oi.viewport,0===et&&(e.setRenderTargetTextures(b,oi.colorTexture,m.ignoreDepthValues?void 0:oi.depthStencilTexture),e.setRenderTarget(b))}let It=L[et];void 0===It&&(It=new Qs,It.layers.enable(et),It.viewport=new yn,L[et]=It),It.matrix.fromArray(wt.transform.matrix),It.matrix.decompose(It.position,It.quaternion,It.scale),It.projectionMatrix.fromArray(wt.projectionMatrix),It.projectionMatrixInverse.copy(It.projectionMatrix).invert(),It.viewport.set(Jt.x,Jt.y,Jt.width,Jt.height),0===et&&(O.matrix.copy(It.matrix),O.matrix.decompose(O.position,O.quaternion,O.scale)),!0===$e&&O.cameras.push(It)}}for(let Ge=0;Ge<C.length;Ge++){const $e=M[Ge],et=C[Ge];null!==$e&&void 0!==et&&et.update($e,Le,c||a)}xe&&xe(Te,Le),Le.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:Le}),_=null}),this.setAnimationLoop=function(Te){xe=Te},this.dispose=function(){}}}function lF(s,e){function t(f,b){!0===f.matrixAutoUpdate&&f.updateMatrix(),b.value.copy(f.matrix)}function r(f,b){f.opacity.value=b.opacity,b.color&&f.diffuse.value.copy(b.color),b.emissive&&f.emissive.value.copy(b.emissive).multiplyScalar(b.emissiveIntensity),b.map&&(f.map.value=b.map,t(b.map,f.mapTransform)),b.alphaMap&&(f.alphaMap.value=b.alphaMap,t(b.alphaMap,f.alphaMapTransform)),b.bumpMap&&(f.bumpMap.value=b.bumpMap,t(b.bumpMap,f.bumpMapTransform),f.bumpScale.value=b.bumpScale,1===b.side&&(f.bumpScale.value*=-1)),b.normalMap&&(f.normalMap.value=b.normalMap,t(b.normalMap,f.normalMapTransform),f.normalScale.value.copy(b.normalScale),1===b.side&&f.normalScale.value.negate()),b.displacementMap&&(f.displacementMap.value=b.displacementMap,t(b.displacementMap,f.displacementMapTransform),f.displacementScale.value=b.displacementScale,f.displacementBias.value=b.displacementBias),b.emissiveMap&&(f.emissiveMap.value=b.emissiveMap,t(b.emissiveMap,f.emissiveMapTransform)),b.specularMap&&(f.specularMap.value=b.specularMap,t(b.specularMap,f.specularMapTransform)),b.alphaTest>0&&(f.alphaTest.value=b.alphaTest);const C=e.get(b).envMap;if(C&&(f.envMap.value=C,f.flipEnvMap.value=C.isCubeTexture&&!1===C.isRenderTargetTexture?-1:1,f.reflectivity.value=b.reflectivity,f.ior.value=b.ior,f.refractionRatio.value=b.refractionRatio),b.lightMap){f.lightMap.value=b.lightMap;const M=!0===s._useLegacyLights?Math.PI:1;f.lightMapIntensity.value=b.lightMapIntensity*M,t(b.lightMap,f.lightMapTransform)}b.aoMap&&(f.aoMap.value=b.aoMap,f.aoMapIntensity.value=b.aoMapIntensity,t(b.aoMap,f.aoMapTransform))}return{refreshFogUniforms:function i(f,b){b.color.getRGB(f.fogColor.value,P1(s)),b.isFog?(f.fogNear.value=b.near,f.fogFar.value=b.far):b.isFogExp2&&(f.fogDensity.value=b.density)},refreshMaterialUniforms:function n(f,b,C,M,E){b.isMeshBasicMaterial||b.isMeshLambertMaterial?r(f,b):b.isMeshToonMaterial?(r(f,b),function u(f,b){b.gradientMap&&(f.gradientMap.value=b.gradientMap)}(f,b)):b.isMeshPhongMaterial?(r(f,b),function h(f,b){f.specular.value.copy(b.specular),f.shininess.value=Math.max(b.shininess,1e-4)}(f,b)):b.isMeshStandardMaterial?(r(f,b),function m(f,b){f.metalness.value=b.metalness,b.metalnessMap&&(f.metalnessMap.value=b.metalnessMap,t(b.metalnessMap,f.metalnessMapTransform)),f.roughness.value=b.roughness,b.roughnessMap&&(f.roughnessMap.value=b.roughnessMap,t(b.roughnessMap,f.roughnessMapTransform)),e.get(b).envMap&&(f.envMapIntensity.value=b.envMapIntensity)}(f,b),b.isMeshPhysicalMaterial&&function p(f,b,C){f.ior.value=b.ior,b.sheen>0&&(f.sheenColor.value.copy(b.sheenColor).multiplyScalar(b.sheen),f.sheenRoughness.value=b.sheenRoughness,b.sheenColorMap&&(f.sheenColorMap.value=b.sheenColorMap,t(b.sheenColorMap,f.sheenColorMapTransform)),b.sheenRoughnessMap&&(f.sheenRoughnessMap.value=b.sheenRoughnessMap,t(b.sheenRoughnessMap,f.sheenRoughnessMapTransform))),b.clearcoat>0&&(f.clearcoat.value=b.clearcoat,f.clearcoatRoughness.value=b.clearcoatRoughness,b.clearcoatMap&&(f.clearcoatMap.value=b.clearcoatMap,t(b.clearcoatMap,f.clearcoatMapTransform)),b.clearcoatRoughnessMap&&(f.clearcoatRoughnessMap.value=b.clearcoatRoughnessMap,t(b.clearcoatRoughnessMap,f.clearcoatRoughnessMapTransform)),b.clearcoatNormalMap&&(f.clearcoatNormalMap.value=b.clearcoatNormalMap,t(b.clearcoatNormalMap,f.clearcoatNormalMapTransform),f.clearcoatNormalScale.value.copy(b.clearcoatNormalScale),1===b.side&&f.clearcoatNormalScale.value.negate())),b.iridescence>0&&(f.iridescence.value=b.iridescence,f.iridescenceIOR.value=b.iridescenceIOR,f.iridescenceThicknessMinimum.value=b.iridescenceThicknessRange[0],f.iridescenceThicknessMaximum.value=b.iridescenceThicknessRange[1],b.iridescenceMap&&(f.iridescenceMap.value=b.iridescenceMap,t(b.iridescenceMap,f.iridescenceMapTransform)),b.iridescenceThicknessMap&&(f.iridescenceThicknessMap.value=b.iridescenceThicknessMap,t(b.iridescenceThicknessMap,f.iridescenceThicknessMapTransform))),b.transmission>0&&(f.transmission.value=b.transmission,f.transmissionSamplerMap.value=C.texture,f.transmissionSamplerSize.value.set(C.width,C.height),b.transmissionMap&&(f.transmissionMap.value=b.transmissionMap,t(b.transmissionMap,f.transmissionMapTransform)),f.thickness.value=b.thickness,b.thicknessMap&&(f.thicknessMap.value=b.thicknessMap,t(b.thicknessMap,f.thicknessMapTransform)),f.attenuationDistance.value=b.attenuationDistance,f.attenuationColor.value.copy(b.attenuationColor)),b.anisotropy>0&&(f.anisotropyVector.value.set(b.anisotropy*Math.cos(b.anisotropyRotation),b.anisotropy*Math.sin(b.anisotropyRotation)),b.anisotropyMap&&(f.anisotropyMap.value=b.anisotropyMap,t(b.anisotropyMap,f.anisotropyMapTransform))),f.specularIntensity.value=b.specularIntensity,f.specularColor.value.copy(b.specularColor),b.specularColorMap&&(f.specularColorMap.value=b.specularColorMap,t(b.specularColorMap,f.specularColorMapTransform)),b.specularIntensityMap&&(f.specularIntensityMap.value=b.specularIntensityMap,t(b.specularIntensityMap,f.specularIntensityMapTransform))}(f,b,E)):b.isMeshMatcapMaterial?(r(f,b),function _(f,b){b.matcap&&(f.matcap.value=b.matcap)}(f,b)):b.isMeshDepthMaterial?r(f,b):b.isMeshDistanceMaterial?(r(f,b),function g(f,b){const C=e.get(b).light;f.referencePosition.value.setFromMatrixPosition(C.matrixWorld),f.nearDistance.value=C.shadow.camera.near,f.farDistance.value=C.shadow.camera.far}(f,b)):b.isMeshNormalMaterial?r(f,b):b.isLineBasicMaterial?(function a(f,b){f.diffuse.value.copy(b.color),f.opacity.value=b.opacity,b.map&&(f.map.value=b.map,t(b.map,f.mapTransform))}(f,b),b.isLineDashedMaterial&&function o(f,b){f.dashSize.value=b.dashSize,f.totalSize.value=b.dashSize+b.gapSize,f.scale.value=b.scale}(f,b)):b.isPointsMaterial?function l(f,b,C,M){f.diffuse.value.copy(b.color),f.opacity.value=b.opacity,f.size.value=b.size*C,f.scale.value=.5*M,b.map&&(f.map.value=b.map,t(b.map,f.uvTransform)),b.alphaMap&&(f.alphaMap.value=b.alphaMap,t(b.alphaMap,f.alphaMapTransform)),b.alphaTest>0&&(f.alphaTest.value=b.alphaTest)}(f,b,C,M):b.isSpriteMaterial?function c(f,b){f.diffuse.value.copy(b.color),f.opacity.value=b.opacity,f.rotation.value=b.rotation,b.map&&(f.map.value=b.map,t(b.map,f.mapTransform)),b.alphaMap&&(f.alphaMap.value=b.alphaMap,t(b.alphaMap,f.alphaMapTransform)),b.alphaTest>0&&(f.alphaTest.value=b.alphaTest)}(f,b):b.isShadowMaterial?(f.color.value.copy(b.color),f.opacity.value=b.opacity):b.isShaderMaterial&&(b.uniformsNeedUpdate=!1)}}}function cF(s,e,t,i){let n={},r={},a=[];const o=t.isWebGL2?s.getParameter(s.MAX_UNIFORM_BUFFER_BINDINGS):0;function p(C,M,E,S){const P=C.value,I=M+"_"+E;if(void 0===S[I])return S[I]="number"==typeof P||"boolean"==typeof P?P:P.clone(),!0;{const L=S[I];if("number"==typeof P||"boolean"==typeof P){if(L!==P)return S[I]=P,!0}else if(!1===L.equals(P))return L.copy(P),!0}return!1}function g(C){const M={boundary:0,storage:0};return"number"==typeof C||"boolean"==typeof C?(M.boundary=4,M.storage=4):C.isVector2?(M.boundary=8,M.storage=8):C.isVector3||C.isColor?(M.boundary=16,M.storage=12):C.isVector4?(M.boundary=16,M.storage=16):C.isMatrix3?(M.boundary=48,M.storage=48):C.isMatrix4?(M.boundary=64,M.storage=64):C.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",C),M}function f(C){const M=C.target;M.removeEventListener("dispose",f);const E=a.indexOf(M.__bindingPointIndex);a.splice(E,1),s.deleteBuffer(n[M.id]),delete n[M.id],delete r[M.id]}return{bind:function l(C,M){i.uniformBlockBinding(C,M.program)},update:function c(C,M){let E=n[C.id];void 0===E&&(function _(C){const M=C.uniforms;let E=0;for(let I=0,L=M.length;I<L;I++){const O=Array.isArray(M[I])?M[I]:[M[I]];for(let B=0,Q=O.length;B<Q;B++){const pe=O[B],ae=Array.isArray(pe.value)?pe.value:[pe.value];for(let N=0,ee=ae.length;N<ee;N++){const se=g(ae[N]),ue=E%16;0!==ue&&16-ue<se.boundary&&(E+=16-ue),pe.__data=new Float32Array(se.storage/Float32Array.BYTES_PER_ELEMENT),pe.__offset=E,E+=se.storage}}}const P=E%16;P>0&&(E+=16-P),C.__size=E,C.__cache={}}(C),E=function h(C){const M=function u(){for(let C=0;C<o;C++)if(-1===a.indexOf(C))return a.push(C),C;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();C.__bindingPointIndex=M;const E=s.createBuffer(),S=C.__size,P=C.usage;return s.bindBuffer(s.UNIFORM_BUFFER,E),s.bufferData(s.UNIFORM_BUFFER,S,P),s.bindBuffer(s.UNIFORM_BUFFER,null),s.bindBufferBase(s.UNIFORM_BUFFER,M,E),E}(C),n[C.id]=E,C.addEventListener("dispose",f)),i.updateUBOMapping(C,M.program);const P=e.render.frame;r[C.id]!==P&&(function m(C){const E=C.uniforms,S=C.__cache;s.bindBuffer(s.UNIFORM_BUFFER,n[C.id]);for(let P=0,I=E.length;P<I;P++){const L=Array.isArray(E[P])?E[P]:[E[P]];for(let O=0,B=L.length;O<B;O++){const Q=L[O];if(!0===p(Q,P,O,S)){const pe=Q.__offset,ae=Array.isArray(Q.value)?Q.value:[Q.value];let N=0;for(let ee=0;ee<ae.length;ee++){const K=ae[ee],se=g(K);"number"==typeof K||"boolean"==typeof K?(Q.__data[0]=K,s.bufferSubData(s.UNIFORM_BUFFER,pe+N,Q.__data)):K.isMatrix3?(Q.__data[0]=K.elements[0],Q.__data[1]=K.elements[1],Q.__data[2]=K.elements[2],Q.__data[3]=0,Q.__data[4]=K.elements[3],Q.__data[5]=K.elements[4],Q.__data[6]=K.elements[5],Q.__data[7]=0,Q.__data[8]=K.elements[6],Q.__data[9]=K.elements[7],Q.__data[10]=K.elements[8],Q.__data[11]=0):(K.toArray(Q.__data,N),N+=se.storage/Float32Array.BYTES_PER_ELEMENT)}s.bufferSubData(s.UNIFORM_BUFFER,pe,Q.__data)}}}s.bindBuffer(s.UNIFORM_BUFFER,null)}(C),r[C.id]=P)},dispose:function b(){for(const C in n)s.deleteBuffer(n[C]);a=[],n={},r={}}}}class cM{constructor(e={}){const{canvas:t=zO(),context:i=null,depth:n=!0,stencil:r=!0,alpha:a=!1,antialias:o=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:h="default",failIfMajorPerformanceCaveat:u=!1}=e;let m;this.isWebGLRenderer=!0,m=null!==i?i.getContextAttributes().alpha:a;const p=new Uint32Array(4),_=new Int32Array(4);let g=null,f=null;const b=[],C=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Un,this._useLegacyLights=!1,this.toneMapping=Ll,this.toneMappingExposure=1;const M=this;let E=!1,S=0,P=0,I=null,L=-1,O=null;const B=new yn,Q=new yn;let pe=null;const ae=new xt(0);let N=0,ee=t.width,K=t.height,se=1,ue=null,re=null;const xe=new yn(0,0,ee,K),Ce=new yn(0,0,ee,K);let Fe=!1;const Te=new Zf;let Le=!1,Ge=!1,$e=null;const et=new Ut,wt=new Xe,Jt=new Z,It={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function oi(){return null===I?se:1}let Ze,pt,qe,lt,ft,q,G,Oe,ct,st,nt,ii,Ft,Gt,vi,Ii,rt,tn,de,at,Pt,yt,di,nn,me=i;function gt(te,Pe){for(let He=0;He<te.length;He++){const Ue=t.getContext(te[He],Pe);if(null!==Ue)return Ue}return null}try{const te={alpha:!0,depth:n,stencil:r,antialias:o,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:h,failIfMajorPerformanceCaveat:u};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r160"),t.addEventListener("webglcontextlost",At,!1),t.addEventListener("webglcontextrestored",ve,!1),t.addEventListener("webglcontextcreationerror",Dt,!1),null===me){const Pe=["webgl2","webgl","experimental-webgl"];if(!0===M.isWebGL1Renderer&&Pe.shift(),me=gt(Pe,te),null===me)throw gt(Pe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&me instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===me.getShaderPrecisionFormat&&(me.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(te){throw console.error("THREE.WebGLRenderer: "+te.message),te}function dn(){Ze=new x2(me),pt=new f2(me,Ze,e),Ze.init(pt),yt=new sF(me,Ze,pt),qe=new iF(me,Ze,pt),lt=new T2(me),ft=new GL,q=new nF(me,Ze,qe,ft,pt,yt,lt),G=new _2(M),Oe=new y2(M),ct=new hR(me,pt),di=new m2(me,Ze,ct,pt),st=new w2(me,ct,lt,di),nt=new S2(me,st,ct,lt),de=new E2(me,pt,q),Ii=new g2(ft),ii=new WL(M,G,Oe,Ze,pt,di,Ii),Ft=new lF(M,ft),Gt=new jL,vi=new JL(Ze,pt),tn=new u2(M,G,Oe,qe,nt,m,l),rt=new tF(M,nt,pt),nn=new cF(me,lt,pt,qe),at=new p2(me,Ze,lt,pt),Pt=new M2(me,Ze,lt,pt),lt.programs=ii.programs,M.capabilities=pt,M.extensions=Ze,M.properties=ft,M.renderLists=Gt,M.shadowMap=rt,M.state=qe,M.info=lt}dn();const Ki=new oF(M,me);function At(te){te.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),E=!0}function ve(){console.log("THREE.WebGLRenderer: Context Restored."),E=!1;const te=lt.autoReset,Pe=rt.enabled,He=rt.autoUpdate,We=rt.needsUpdate,Ue=rt.type;dn(),lt.autoReset=te,rt.enabled=Pe,rt.autoUpdate=He,rt.needsUpdate=We,rt.type=Ue}function Dt(te){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",te.statusMessage)}function Et(te){const Pe=te.target;Pe.removeEventListener("dispose",Et),function Mi(te){(function hi(te){const Pe=ft.get(te).programs;void 0!==Pe&&(Pe.forEach(function(He){ii.releaseProgram(He)}),te.isShaderMaterial&&ii.releaseShaderCache(te))})(te),ft.remove(te)}(Pe)}function xn(te,Pe,He){!0===te.transparent&&2===te.side&&!1===te.forceSinglePass?(te.side=1,te.needsUpdate=!0,l_(te,Pe,He),te.side=0,te.needsUpdate=!0,l_(te,Pe,He),te.side=2):l_(te,Pe,He)}this.xr=Ki,this.getContext=function(){return me},this.getContextAttributes=function(){return me.getContextAttributes()},this.forceContextLoss=function(){const te=Ze.get("WEBGL_lose_context");te&&te.loseContext()},this.forceContextRestore=function(){const te=Ze.get("WEBGL_lose_context");te&&te.restoreContext()},this.getPixelRatio=function(){return se},this.setPixelRatio=function(te){void 0!==te&&(se=te,this.setSize(ee,K,!1))},this.getSize=function(te){return te.set(ee,K)},this.setSize=function(te,Pe,He=!0){Ki.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(ee=te,K=Pe,t.width=Math.floor(te*se),t.height=Math.floor(Pe*se),!0===He&&(t.style.width=te+"px",t.style.height=Pe+"px"),this.setViewport(0,0,te,Pe))},this.getDrawingBufferSize=function(te){return te.set(ee*se,K*se).floor()},this.setDrawingBufferSize=function(te,Pe,He){ee=te,K=Pe,se=He,t.width=Math.floor(te*He),t.height=Math.floor(Pe*He),this.setViewport(0,0,te,Pe)},this.getCurrentViewport=function(te){return te.copy(B)},this.getViewport=function(te){return te.copy(xe)},this.setViewport=function(te,Pe,He,We){te.isVector4?xe.set(te.x,te.y,te.z,te.w):xe.set(te,Pe,He,We),qe.viewport(B.copy(xe).multiplyScalar(se).floor())},this.getScissor=function(te){return te.copy(Ce)},this.setScissor=function(te,Pe,He,We){te.isVector4?Ce.set(te.x,te.y,te.z,te.w):Ce.set(te,Pe,He,We),qe.scissor(Q.copy(Ce).multiplyScalar(se).floor())},this.getScissorTest=function(){return Fe},this.setScissorTest=function(te){qe.setScissorTest(Fe=te)},this.setOpaqueSort=function(te){ue=te},this.setTransparentSort=function(te){re=te},this.getClearColor=function(te){return te.copy(tn.getClearColor())},this.setClearColor=function(){tn.setClearColor.apply(tn,arguments)},this.getClearAlpha=function(){return tn.getClearAlpha()},this.setClearAlpha=function(){tn.setClearAlpha.apply(tn,arguments)},this.clear=function(te=!0,Pe=!0,He=!0){let We=0;if(te){let Ue=!1;if(null!==I){const Yt=I.texture.format;Ue=1033===Yt||1031===Yt||1029===Yt}if(Ue){const Yt=I.texture.type,ui=Yt===Bl||Yt===Nl||1012===Yt||Yt===Hc||1017===Yt||1018===Yt,Ci=tn.getClearColor(),Ai=tn.getClearAlpha(),Ji=Ci.r,zi=Ci.g,ji=Ci.b;ui?(p[0]=Ji,p[1]=zi,p[2]=ji,p[3]=Ai,me.clearBufferuiv(me.COLOR,0,p)):(_[0]=Ji,_[1]=zi,_[2]=ji,_[3]=Ai,me.clearBufferiv(me.COLOR,0,_))}else We|=me.COLOR_BUFFER_BIT}Pe&&(We|=me.DEPTH_BUFFER_BIT),He&&(We|=me.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),me.clear(We)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",At,!1),t.removeEventListener("webglcontextrestored",ve,!1),t.removeEventListener("webglcontextcreationerror",Dt,!1),Gt.dispose(),vi.dispose(),ft.dispose(),G.dispose(),Oe.dispose(),nt.dispose(),di.dispose(),nn.dispose(),ii.dispose(),Ki.dispose(),Ki.removeEventListener("sessionstart",Fr),Ki.removeEventListener("sessionend",Yn),$e&&($e.dispose(),$e=null),Br.stop()},this.renderBufferDirect=function(te,Pe,He,We,Ue,Yt){null===Pe&&(Pe=It);const ui=Ue.isMesh&&Ue.matrixWorld.determinant()<0,Ci=function LH(te,Pe,He,We,Ue){!0!==Pe.isScene&&(Pe=It),q.resetTextureUnits();const Yt=Pe.fog,Ci=null===I?M.outputColorSpace:!0===I.isXRRenderTarget?I.texture.colorSpace:or,Ai=(We.isMeshStandardMaterial?Oe:G).get(We.envMap||(We.isMeshStandardMaterial?Pe.environment:null)),Ji=!0===We.vertexColors&&!!He.attributes.color&&4===He.attributes.color.itemSize,zi=!!He.attributes.tangent&&(!!We.normalMap||We.anisotropy>0),ji=!!He.morphAttributes.position,Ps=!!He.morphAttributes.normal,va=!!He.morphAttributes.color;let hr=Ll;We.toneMapped&&(null===I||!0===I.isXRRenderTarget)&&(hr=M.toneMapping);const hl=He.morphAttributes.position||He.morphAttributes.normal||He.morphAttributes.color,ms=void 0!==hl?hl.length:0,sn=ft.get(We),py=f.state.lights;!0!==Le||!0!==Ge&&te===O||Ii.setState(We,te,te===O&&We.id===L);let Ts=!1;We.version===sn.__version?(sn.needsLights&&sn.lightsStateVersion!==py.state.version||sn.outputColorSpace!==Ci||Ue.isBatchedMesh&&!1===sn.batching||!Ue.isBatchedMesh&&!0===sn.batching||Ue.isInstancedMesh&&!1===sn.instancing||!Ue.isInstancedMesh&&!0===sn.instancing||Ue.isSkinnedMesh&&!1===sn.skinning||!Ue.isSkinnedMesh&&!0===sn.skinning||Ue.isInstancedMesh&&!0===sn.instancingColor&&null===Ue.instanceColor||Ue.isInstancedMesh&&!1===sn.instancingColor&&null!==Ue.instanceColor||sn.envMap!==Ai||!0===We.fog&&sn.fog!==Yt||void 0!==sn.numClippingPlanes&&(sn.numClippingPlanes!==Ii.numPlanes||sn.numIntersection!==Ii.numIntersection)||sn.vertexAlphas!==Ji||sn.vertexTangents!==zi||sn.morphTargets!==ji||sn.morphNormals!==Ps||sn.morphColors!==va||sn.toneMapping!==hr||!0===pt.isWebGL2&&sn.morphTargetsCount!==ms)&&(Ts=!0):(Ts=!0,sn.__version=We.version);let pd=sn.currentProgram;!0===Ts&&(pd=l_(We,Pe,Ue));let OC=!1,Vm=!1,fy=!1;const Er=pd.getUniforms(),fd=sn.uniforms;if(qe.useProgram(pd.program)&&(OC=!0,Vm=!0,fy=!0),We.id!==L&&(L=We.id,Vm=!0),OC||O!==te){Er.setValue(me,"projectionMatrix",te.projectionMatrix),Er.setValue(me,"viewMatrix",te.matrixWorldInverse);const Ra=Er.map.cameraPosition;void 0!==Ra&&Ra.setValue(me,Jt.setFromMatrixPosition(te.matrixWorld)),pt.logarithmicDepthBuffer&&Er.setValue(me,"logDepthBufFC",2/(Math.log(te.far+1)/Math.LN2)),(We.isMeshPhongMaterial||We.isMeshToonMaterial||We.isMeshLambertMaterial||We.isMeshBasicMaterial||We.isMeshStandardMaterial||We.isShaderMaterial)&&Er.setValue(me,"isOrthographic",!0===te.isOrthographicCamera),O!==te&&(O=te,Vm=!0,fy=!0)}if(Ue.isSkinnedMesh){Er.setOptional(me,Ue,"bindMatrix"),Er.setOptional(me,Ue,"bindMatrixInverse");const Ra=Ue.skeleton;Ra&&(pt.floatVertexTextures?(null===Ra.boneTexture&&Ra.computeBoneTexture(),Er.setValue(me,"boneTexture",Ra.boneTexture,q)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}Ue.isBatchedMesh&&(Er.setOptional(me,Ue,"batchingTexture"),Er.setValue(me,"batchingTexture",Ue._matricesTexture,q));const gy=He.morphAttributes;if((void 0!==gy.position||void 0!==gy.normal||void 0!==gy.color&&!0===pt.isWebGL2)&&de.update(Ue,He,pd),(Vm||sn.receiveShadow!==Ue.receiveShadow)&&(sn.receiveShadow=Ue.receiveShadow,Er.setValue(me,"receiveShadow",Ue.receiveShadow)),We.isMeshGouraudMaterial&&null!==We.envMap&&(fd.envMap.value=Ai,fd.flipEnvMap.value=Ai.isCubeTexture&&!1===Ai.isRenderTargetTexture?-1:1),Vm&&(Er.setValue(me,"toneMappingExposure",M.toneMappingExposure),sn.needsLights&&function FH(te,Pe){te.ambientLightColor.needsUpdate=Pe,te.lightProbe.needsUpdate=Pe,te.directionalLights.needsUpdate=Pe,te.directionalLightShadows.needsUpdate=Pe,te.pointLights.needsUpdate=Pe,te.pointLightShadows.needsUpdate=Pe,te.spotLights.needsUpdate=Pe,te.spotLightShadows.needsUpdate=Pe,te.rectAreaLights.needsUpdate=Pe,te.hemisphereLights.needsUpdate=Pe}(fd,fy),Yt&&!0===We.fog&&Ft.refreshFogUniforms(fd,Yt),Ft.refreshMaterialUniforms(fd,We,se,K,$e),Jf.upload(me,AC(sn),fd,q)),We.isShaderMaterial&&!0===We.uniformsNeedUpdate&&(Jf.upload(me,AC(sn),fd,q),We.uniformsNeedUpdate=!1),We.isSpriteMaterial&&Er.setValue(me,"center",Ue.center),Er.setValue(me,"modelViewMatrix",Ue.modelViewMatrix),Er.setValue(me,"normalMatrix",Ue.normalMatrix),Er.setValue(me,"modelMatrix",Ue.matrixWorld),We.isShaderMaterial||We.isRawShaderMaterial){const Ra=We.uniformsGroups;for(let _y=0,NH=Ra.length;_y<NH;_y++)if(pt.isWebGL2){const RC=Ra[_y];nn.update(RC,pd),nn.bind(RC,pd)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return pd}(te,Pe,He,We,Ue);qe.setMaterial(We,ui);let Ai=He.index,Ji=1;if(!0===We.wireframe){if(Ai=st.getWireframeAttribute(He),void 0===Ai)return;Ji=2}const zi=He.drawRange,ji=He.attributes.position;let Ps=zi.start*Ji,va=(zi.start+zi.count)*Ji;null!==Yt&&(Ps=Math.max(Ps,Yt.start*Ji),va=Math.min(va,(Yt.start+Yt.count)*Ji)),null!==Ai?(Ps=Math.max(Ps,0),va=Math.min(va,Ai.count)):null!=ji&&(Ps=Math.max(Ps,0),va=Math.min(va,ji.count));const hr=va-Ps;if(hr<0||hr===1/0)return;di.setup(Ue,We,Ci,He,Ai);let hl,ms=at;if(null!==Ai&&(hl=ct.get(Ai),ms=Pt,ms.setIndex(hl)),Ue.isMesh)!0===We.wireframe?(qe.setLineWidth(We.wireframeLinewidth*oi()),ms.setMode(me.LINES)):ms.setMode(me.TRIANGLES);else if(Ue.isLine){let sn=We.linewidth;void 0===sn&&(sn=1),qe.setLineWidth(sn*oi()),ms.setMode(Ue.isLineSegments?me.LINES:Ue.isLineLoop?me.LINE_LOOP:me.LINE_STRIP)}else Ue.isPoints?ms.setMode(me.POINTS):Ue.isSprite&&ms.setMode(me.TRIANGLES);if(Ue.isBatchedMesh)ms.renderMultiDraw(Ue._multiDrawStarts,Ue._multiDrawCounts,Ue._multiDrawCount);else if(Ue.isInstancedMesh)ms.renderInstances(Ps,hr,Ue.count);else if(He.isInstancedBufferGeometry){const py=Math.min(He.instanceCount,void 0!==He._maxInstanceCount?He._maxInstanceCount:1/0);ms.renderInstances(Ps,hr,py)}else ms.render(Ps,hr)},this.compile=function(te,Pe,He=null){null===He&&(He=te),f=vi.get(He),f.init(),C.push(f),He.traverseVisible(function(Ue){Ue.isLight&&Ue.layers.test(Pe.layers)&&(f.pushLight(Ue),Ue.castShadow&&f.pushShadow(Ue))}),te!==He&&te.traverseVisible(function(Ue){Ue.isLight&&Ue.layers.test(Pe.layers)&&(f.pushLight(Ue),Ue.castShadow&&f.pushShadow(Ue))}),f.setupLights(M._useLegacyLights);const We=new Set;return te.traverse(function(Ue){const Yt=Ue.material;if(Yt)if(Array.isArray(Yt))for(let ui=0;ui<Yt.length;ui++){const Ci=Yt[ui];xn(Ci,He,Ue),We.add(Ci)}else xn(Yt,He,Ue),We.add(Yt)}),C.pop(),f=null,We},this.compileAsync=function(te,Pe,He=null){const We=this.compile(te,Pe,He);return new Promise(Ue=>{function Yt(){We.forEach(function(ui){ft.get(ui).currentProgram.isReady()&&We.delete(ui)}),0!==We.size?setTimeout(Yt,10):Ue(te)}null!==Ze.get("KHR_parallel_shader_compile")?Yt():setTimeout(Yt,10)})};let wn=null;function Fr(){Br.stop()}function Yn(){Br.start()}const Br=new O1;function Oo(te,Pe,He,We){if(!1===te.visible)return;if(te.layers.test(Pe.layers))if(te.isGroup)He=te.renderOrder;else if(te.isLOD)!0===te.autoUpdate&&te.update(Pe);else if(te.isLight)f.pushLight(te),te.castShadow&&f.pushShadow(te);else if(te.isSprite){if(!te.frustumCulled||Te.intersectsSprite(te)){We&&Jt.setFromMatrixPosition(te.matrixWorld).applyMatrix4(et);const ui=nt.update(te),Ci=te.material;Ci.visible&&g.push(te,ui,Ci,He,Jt.z,null)}}else if((te.isMesh||te.isLine||te.isPoints)&&(!te.frustumCulled||Te.intersectsObject(te))){const ui=nt.update(te),Ci=te.material;if(We&&(void 0!==te.boundingSphere?(null===te.boundingSphere&&te.computeBoundingSphere(),Jt.copy(te.boundingSphere.center)):(null===ui.boundingSphere&&ui.computeBoundingSphere(),Jt.copy(ui.boundingSphere.center)),Jt.applyMatrix4(te.matrixWorld).applyMatrix4(et)),Array.isArray(Ci)){const Ai=ui.groups;for(let Ji=0,zi=Ai.length;Ji<zi;Ji++){const ji=Ai[Ji],Ps=Ci[ji.materialIndex];Ps&&Ps.visible&&g.push(te,ui,Ps,He,Jt.z,ji)}}else Ci.visible&&g.push(te,ui,Ci,He,Jt.z,null)}const Yt=te.children;for(let ui=0,Ci=Yt.length;ui<Ci;ui++)Oo(Yt[ui],Pe,He,We)}function SC(te,Pe,He,We){const Ue=te.opaque,Yt=te.transmissive,ui=te.transparent;f.setupLightsView(He),!0===Le&&Ii.setGlobalState(M.clippingPlanes,He),Yt.length>0&&function IH(te,Pe,He,We){if(null!==(!0===He.isScene?He.overrideMaterial:null))return;const Yt=pt.isWebGL2;null===$e&&($e=new Zc(1,1,{generateMipmaps:!0,type:Ze.has("EXT_color_buffer_half_float")?im:Bl,minFilter:tl,samples:Yt?4:0})),M.getDrawingBufferSize(wt),Yt?$e.setSize(wt.x,wt.y):$e.setSize(Cf(wt.x),Cf(wt.y));const ui=M.getRenderTarget();M.setRenderTarget($e),M.getClearColor(ae),N=M.getClearAlpha(),N<1&&M.setClearColor(16777215,.5),M.clear();const Ci=M.toneMapping;M.toneMapping=Ll,o_(te,He,We),q.updateMultisampleRenderTarget($e),q.updateRenderTargetMipmap($e);let Ai=!1;for(let Ji=0,zi=Pe.length;Ji<zi;Ji++){const ji=Pe[Ji],Ps=ji.object,va=ji.geometry,hr=ji.material,hl=ji.group;if(2===hr.side&&Ps.layers.test(We.layers)){const ms=hr.side;hr.side=1,hr.needsUpdate=!0,kC(Ps,He,We,va,hr,hl),hr.side=ms,hr.needsUpdate=!0,Ai=!0}}!0===Ai&&(q.updateMultisampleRenderTarget($e),q.updateRenderTargetMipmap($e)),M.setRenderTarget(ui),M.setClearColor(ae,N),M.toneMapping=Ci}(Ue,Yt,Pe,He),We&&qe.viewport(B.copy(We)),Ue.length>0&&o_(Ue,Pe,He),Yt.length>0&&o_(Yt,Pe,He),ui.length>0&&o_(ui,Pe,He),qe.buffers.depth.setTest(!0),qe.buffers.depth.setMask(!0),qe.buffers.color.setMask(!0),qe.setPolygonOffset(!1)}function o_(te,Pe,He){const We=!0===Pe.isScene?Pe.overrideMaterial:null;for(let Ue=0,Yt=te.length;Ue<Yt;Ue++){const ui=te[Ue],Ci=ui.object,Ai=ui.geometry,Ji=null===We?ui.material:We,zi=ui.group;Ci.layers.test(He.layers)&&kC(Ci,Pe,He,Ai,Ji,zi)}}function kC(te,Pe,He,We,Ue,Yt){te.onBeforeRender(M,Pe,He,We,Ue,Yt),te.modelViewMatrix.multiplyMatrices(He.matrixWorldInverse,te.matrixWorld),te.normalMatrix.getNormalMatrix(te.modelViewMatrix),Ue.onBeforeRender(M,Pe,He,We,te,Yt),!0===Ue.transparent&&2===Ue.side&&!1===Ue.forceSinglePass?(Ue.side=1,Ue.needsUpdate=!0,M.renderBufferDirect(He,Pe,We,Ue,te,Yt),Ue.side=0,Ue.needsUpdate=!0,M.renderBufferDirect(He,Pe,We,Ue,te,Yt),Ue.side=2):M.renderBufferDirect(He,Pe,We,Ue,te,Yt),te.onAfterRender(M,Pe,He,We,Ue,Yt)}function l_(te,Pe,He){!0!==Pe.isScene&&(Pe=It);const We=ft.get(te),Ue=f.state.lights,ui=Ue.state.version,Ci=ii.getParameters(te,Ue.state,f.state.shadowsArray,Pe,He),Ai=ii.getProgramCacheKey(Ci);let Ji=We.programs;We.environment=te.isMeshStandardMaterial?Pe.environment:null,We.fog=Pe.fog,We.envMap=(te.isMeshStandardMaterial?Oe:G).get(te.envMap||We.environment),void 0===Ji&&(te.addEventListener("dispose",Et),Ji=new Map,We.programs=Ji);let zi=Ji.get(Ai);if(void 0!==zi){if(We.currentProgram===zi&&We.lightsStateVersion===ui)return PC(te,Ci),zi}else Ci.uniforms=ii.getUniforms(te),te.onBuild(He,Ci,M),te.onBeforeCompile(Ci,M),zi=ii.acquireProgram(Ci,Ai),Ji.set(Ai,zi),We.uniforms=Ci.uniforms;const ji=We.uniforms;return(!te.isShaderMaterial&&!te.isRawShaderMaterial||!0===te.clipping)&&(ji.clippingPlanes=Ii.uniform),PC(te,Ci),We.needsLights=function BH(te){return te.isMeshLambertMaterial||te.isMeshToonMaterial||te.isMeshPhongMaterial||te.isMeshStandardMaterial||te.isShadowMaterial||te.isShaderMaterial&&!0===te.lights}(te),We.lightsStateVersion=ui,We.needsLights&&(ji.ambientLightColor.value=Ue.state.ambient,ji.lightProbe.value=Ue.state.probe,ji.directionalLights.value=Ue.state.directional,ji.directionalLightShadows.value=Ue.state.directionalShadow,ji.spotLights.value=Ue.state.spot,ji.spotLightShadows.value=Ue.state.spotShadow,ji.rectAreaLights.value=Ue.state.rectArea,ji.ltc_1.value=Ue.state.rectAreaLTC1,ji.ltc_2.value=Ue.state.rectAreaLTC2,ji.pointLights.value=Ue.state.point,ji.pointLightShadows.value=Ue.state.pointShadow,ji.hemisphereLights.value=Ue.state.hemi,ji.directionalShadowMap.value=Ue.state.directionalShadowMap,ji.directionalShadowMatrix.value=Ue.state.directionalShadowMatrix,ji.spotShadowMap.value=Ue.state.spotShadowMap,ji.spotLightMatrix.value=Ue.state.spotLightMatrix,ji.spotLightMap.value=Ue.state.spotLightMap,ji.pointShadowMap.value=Ue.state.pointShadowMap,ji.pointShadowMatrix.value=Ue.state.pointShadowMatrix),We.currentProgram=zi,We.uniformsList=null,zi}function AC(te){if(null===te.uniformsList){const Pe=te.currentProgram.getUniforms();te.uniformsList=Jf.seqWithValue(Pe.seq,te.uniforms)}return te.uniformsList}function PC(te,Pe){const He=ft.get(te);He.outputColorSpace=Pe.outputColorSpace,He.batching=Pe.batching,He.instancing=Pe.instancing,He.instancingColor=Pe.instancingColor,He.skinning=Pe.skinning,He.morphTargets=Pe.morphTargets,He.morphNormals=Pe.morphNormals,He.morphColors=Pe.morphColors,He.morphTargetsCount=Pe.morphTargetsCount,He.numClippingPlanes=Pe.numClippingPlanes,He.numIntersection=Pe.numClipIntersection,He.vertexAlphas=Pe.vertexAlphas,He.vertexTangents=Pe.vertexTangents,He.toneMapping=Pe.toneMapping}Br.setAnimationLoop(function dr(te){wn&&wn(te)}),typeof self<"u"&&Br.setContext(self),this.setAnimationLoop=function(te){wn=te,Ki.setAnimationLoop(te),null===te?Br.stop():Br.start()},Ki.addEventListener("sessionstart",Fr),Ki.addEventListener("sessionend",Yn),this.render=function(te,Pe){if(void 0===Pe||!0===Pe.isCamera){if(!0!==E){if(!0===te.matrixWorldAutoUpdate&&te.updateMatrixWorld(),null===Pe.parent&&!0===Pe.matrixWorldAutoUpdate&&Pe.updateMatrixWorld(),!0===Ki.enabled&&!0===Ki.isPresenting&&(!0===Ki.cameraAutoUpdate&&Ki.updateCamera(Pe),Pe=Ki.getCamera()),!0===te.isScene&&te.onBeforeRender(M,te,Pe,I),f=vi.get(te,C.length),f.init(),C.push(f),et.multiplyMatrices(Pe.projectionMatrix,Pe.matrixWorldInverse),Te.setFromProjectionMatrix(et),Ge=this.localClippingEnabled,Le=Ii.init(this.clippingPlanes,Ge),g=Gt.get(te,b.length),g.init(),b.push(g),Oo(te,Pe,0,M.sortObjects),g.finish(),!0===M.sortObjects&&g.sort(ue,re),this.info.render.frame++,!0===Le&&Ii.beginShadows(),rt.render(f.state.shadowsArray,te,Pe),!0===Le&&Ii.endShadows(),!0===this.info.autoReset&&this.info.reset(),tn.render(g,te),f.setupLights(M._useLegacyLights),Pe.isArrayCamera){const We=Pe.cameras;for(let Ue=0,Yt=We.length;Ue<Yt;Ue++){const ui=We[Ue];SC(g,te,ui,ui.viewport)}}else SC(g,te,Pe);null!==I&&(q.updateMultisampleRenderTarget(I),q.updateRenderTargetMipmap(I)),!0===te.isScene&&te.onAfterRender(M,te,Pe),di.resetDefaultState(),L=-1,O=null,C.pop(),f=C.length>0?C[C.length-1]:null,b.pop(),g=b.length>0?b[b.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return S},this.getActiveMipmapLevel=function(){return P},this.getRenderTarget=function(){return I},this.setRenderTargetTextures=function(te,Pe,He){ft.get(te.texture).__webglTexture=Pe,ft.get(te.depthTexture).__webglTexture=He;const We=ft.get(te);We.__hasExternalTextures=!0,We.__hasExternalTextures&&(We.__autoAllocateDepthBuffer=void 0===He,We.__autoAllocateDepthBuffer||!0===Ze.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),We.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(te,Pe){const He=ft.get(te);He.__webglFramebuffer=Pe,He.__useDefaultFramebuffer=void 0===Pe},this.setRenderTarget=function(te,Pe=0,He=0){I=te,S=Pe,P=He;let We=!0,Ue=null,Yt=!1,ui=!1;if(te){const Ai=ft.get(te);void 0!==Ai.__useDefaultFramebuffer?(qe.bindFramebuffer(me.FRAMEBUFFER,null),We=!1):void 0===Ai.__webglFramebuffer?q.setupRenderTarget(te):Ai.__hasExternalTextures&&q.rebindTextures(te,ft.get(te.texture).__webglTexture,ft.get(te.depthTexture).__webglTexture);const Ji=te.texture;(Ji.isData3DTexture||Ji.isDataArrayTexture||Ji.isCompressedArrayTexture)&&(ui=!0);const zi=ft.get(te).__webglFramebuffer;te.isWebGLCubeRenderTarget?(Ue=Array.isArray(zi[Pe])?zi[Pe][He]:zi[Pe],Yt=!0):Ue=pt.isWebGL2&&te.samples>0&&!1===q.useMultisampledRTT(te)?ft.get(te).__webglMultisampledFramebuffer:Array.isArray(zi)?zi[He]:zi,B.copy(te.viewport),Q.copy(te.scissor),pe=te.scissorTest}else B.copy(xe).multiplyScalar(se).floor(),Q.copy(Ce).multiplyScalar(se).floor(),pe=Fe;if(qe.bindFramebuffer(me.FRAMEBUFFER,Ue)&&pt.drawBuffers&&We&&qe.drawBuffers(te,Ue),qe.viewport(B),qe.scissor(Q),qe.setScissorTest(pe),Yt){const Ai=ft.get(te.texture);me.framebufferTexture2D(me.FRAMEBUFFER,me.COLOR_ATTACHMENT0,me.TEXTURE_CUBE_MAP_POSITIVE_X+Pe,Ai.__webglTexture,He)}else if(ui){const Ai=ft.get(te.texture);me.framebufferTextureLayer(me.FRAMEBUFFER,me.COLOR_ATTACHMENT0,Ai.__webglTexture,He||0,Pe||0)}L=-1},this.readRenderTargetPixels=function(te,Pe,He,We,Ue,Yt,ui){if(!te||!te.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Ci=ft.get(te).__webglFramebuffer;if(te.isWebGLCubeRenderTarget&&void 0!==ui&&(Ci=Ci[ui]),Ci){qe.bindFramebuffer(me.FRAMEBUFFER,Ci);try{const Ai=te.texture,Ji=Ai.format,zi=Ai.type;if(Ji!==ma&&yt.convert(Ji)!==me.getParameter(me.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ji=zi===im&&(Ze.has("EXT_color_buffer_half_float")||pt.isWebGL2&&Ze.has("EXT_color_buffer_float"));if(!(zi===Bl||yt.convert(zi)===me.getParameter(me.IMPLEMENTATION_COLOR_READ_TYPE)||zi===Mo&&(pt.isWebGL2||Ze.has("OES_texture_float")||Ze.has("WEBGL_color_buffer_float"))||ji))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Pe>=0&&Pe<=te.width-We&&He>=0&&He<=te.height-Ue&&me.readPixels(Pe,He,We,Ue,yt.convert(Ji),yt.convert(zi),Yt)}finally{const Ai=null!==I?ft.get(I).__webglFramebuffer:null;qe.bindFramebuffer(me.FRAMEBUFFER,Ai)}}},this.copyFramebufferToTexture=function(te,Pe,He=0){const We=Math.pow(2,-He),Ue=Math.floor(Pe.image.width*We),Yt=Math.floor(Pe.image.height*We);q.setTexture2D(Pe,0),me.copyTexSubImage2D(me.TEXTURE_2D,He,0,0,te.x,te.y,Ue,Yt),qe.unbindTexture()},this.copyTextureToTexture=function(te,Pe,He,We=0){const Ue=Pe.image.width,Yt=Pe.image.height,ui=yt.convert(He.format),Ci=yt.convert(He.type);q.setTexture2D(He,0),me.pixelStorei(me.UNPACK_FLIP_Y_WEBGL,He.flipY),me.pixelStorei(me.UNPACK_PREMULTIPLY_ALPHA_WEBGL,He.premultiplyAlpha),me.pixelStorei(me.UNPACK_ALIGNMENT,He.unpackAlignment),Pe.isDataTexture?me.texSubImage2D(me.TEXTURE_2D,We,te.x,te.y,Ue,Yt,ui,Ci,Pe.image.data):Pe.isCompressedTexture?me.compressedTexSubImage2D(me.TEXTURE_2D,We,te.x,te.y,Pe.mipmaps[0].width,Pe.mipmaps[0].height,ui,Pe.mipmaps[0].data):me.texSubImage2D(me.TEXTURE_2D,We,te.x,te.y,ui,Ci,Pe.image),0===We&&He.generateMipmaps&&me.generateMipmap(me.TEXTURE_2D),qe.unbindTexture()},this.copyTextureToTexture3D=function(te,Pe,He,We,Ue=0){if(M.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Yt=te.max.x-te.min.x+1,ui=te.max.y-te.min.y+1,Ci=te.max.z-te.min.z+1,Ai=yt.convert(We.format),Ji=yt.convert(We.type);let zi;if(We.isData3DTexture)q.setTexture3D(We,0),zi=me.TEXTURE_3D;else{if(!We.isDataArrayTexture&&!We.isCompressedArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");q.setTexture2DArray(We,0),zi=me.TEXTURE_2D_ARRAY}me.pixelStorei(me.UNPACK_FLIP_Y_WEBGL,We.flipY),me.pixelStorei(me.UNPACK_PREMULTIPLY_ALPHA_WEBGL,We.premultiplyAlpha),me.pixelStorei(me.UNPACK_ALIGNMENT,We.unpackAlignment);const ji=me.getParameter(me.UNPACK_ROW_LENGTH),Ps=me.getParameter(me.UNPACK_IMAGE_HEIGHT),va=me.getParameter(me.UNPACK_SKIP_PIXELS),hr=me.getParameter(me.UNPACK_SKIP_ROWS),hl=me.getParameter(me.UNPACK_SKIP_IMAGES),ms=He.isCompressedTexture?He.mipmaps[Ue]:He.image;me.pixelStorei(me.UNPACK_ROW_LENGTH,ms.width),me.pixelStorei(me.UNPACK_IMAGE_HEIGHT,ms.height),me.pixelStorei(me.UNPACK_SKIP_PIXELS,te.min.x),me.pixelStorei(me.UNPACK_SKIP_ROWS,te.min.y),me.pixelStorei(me.UNPACK_SKIP_IMAGES,te.min.z),He.isDataTexture||He.isData3DTexture?me.texSubImage3D(zi,Ue,Pe.x,Pe.y,Pe.z,Yt,ui,Ci,Ai,Ji,ms.data):He.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),me.compressedTexSubImage3D(zi,Ue,Pe.x,Pe.y,Pe.z,Yt,ui,Ci,Ai,ms.data)):me.texSubImage3D(zi,Ue,Pe.x,Pe.y,Pe.z,Yt,ui,Ci,Ai,Ji,ms),me.pixelStorei(me.UNPACK_ROW_LENGTH,ji),me.pixelStorei(me.UNPACK_IMAGE_HEIGHT,Ps),me.pixelStorei(me.UNPACK_SKIP_PIXELS,va),me.pixelStorei(me.UNPACK_SKIP_ROWS,hr),me.pixelStorei(me.UNPACK_SKIP_IMAGES,hl),0===Ue&&We.generateMipmaps&&me.generateMipmap(zi),qe.unbindTexture()},this.initTexture=function(te){te.isCubeTexture?q.setTextureCube(te,0):te.isData3DTexture?q.setTexture3D(te,0):te.isDataArrayTexture||te.isCompressedArrayTexture?q.setTexture2DArray(te,0):q.setTexture2D(te,0),qe.unbindTexture()},this.resetState=function(){S=0,P=0,I=null,qe.reset(),di.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return To}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===hv?"display-p3":"srgb",t.unpackColorSpace=Dn.workingColorSpace===yf?"display-p3":"srgb"}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Un?Wc:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Wc?Un:or}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}(class dF extends cM{}).prototype.isWebGL1Renderer=!0;class dM extends Qn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class Zv{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=pa()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return console.warn("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let n=0,r=this.stride;n<r;n++)this.array[e+n]=t.array[i+n];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=pa()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=pa()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Rr=new Z;class ed{constructor(e,t,i,n=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=n}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Rr.fromBufferAttribute(this,t),Rr.applyMatrix4(e),this.setXYZ(t,Rr.x,Rr.y,Rr.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Rr.fromBufferAttribute(this,t),Rr.applyNormalMatrix(e),this.setXYZ(t,Rr.x,Rr.y,Rr.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Rr.fromBufferAttribute(this,t),Rr.transformDirection(e),this.setXYZ(t,Rr.x,Rr.y,Rr.z);return this}setX(e,t){return this.normalized&&(t=Yi(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Yi(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Yi(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Yi(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=$r(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=$r(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=$r(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=$r(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Yi(t,this.array),i=Yi(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Yi(t,this.array),i=Yi(i,this.array),n=Yi(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this}setXYZW(e,t,i,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Yi(t,this.array),i=Yi(i,this.array),n=Yi(n,this.array),r=Yi(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this.data.array[e+3]=r,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const n=i*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[n+r])}return new os(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new ed(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const n=i*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[n+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const gM=new Z,_M=new yn,bM=new yn,mF=new Z,vM=new Ut,ng=new Z,qv=new Tr,yM=new Ut,$v=new bh;class Kv extends Js{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=Mw,this.bindMatrix=new Ut,this.bindMatrixInverse=new Ut,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new Vs),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,ng),this.boundingBox.expandByPoint(ng)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new Tr),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,ng),this.boundingSphere.expandByPoint(ng)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.matrixWorld;void 0!==this.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),qv.copy(this.boundingSphere),qv.applyMatrix4(n),!1!==e.ray.intersectsSphere(qv)&&(yM.copy(n).invert(),$v.copy(e.ray).applyMatrix4(yM),(null===this.boundingBox||!1!==$v.intersectsBox(this.boundingBox))&&this._computeIntersections(e,t,$v)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new yn,t=this.geometry.attributes.skinWeight;for(let i=0,n=t.count;i<n;i++){e.fromBufferAttribute(t,i);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===Mw?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,n=this.geometry;_M.fromBufferAttribute(n.attributes.skinIndex,e),bM.fromBufferAttribute(n.attributes.skinWeight,e),gM.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){const a=bM.getComponent(r);if(0!==a){const o=_M.getComponent(r);vM.multiplyMatrices(i.bones[o].matrixWorld,i.boneInverses[o]),t.addScaledVector(mF.copy(gM).applyMatrix4(vM),a)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class _m extends Qn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Uh extends Kr{constructor(e=null,t=1,i=1,n,r,a,o,l,c=Ss,h=Ss,u,m){super(null,a,o,l,c,h,n,r,u,m),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const xM=new Ut,pF=new Ut;class bm{constructor(e=[],t=[]){this.uuid=pa(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,n=this.bones.length;i<n;i++)this.boneInverses.push(new Ut)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new Ut;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,n=this.boneTexture;for(let r=0,a=e.length;r<a;r++)xM.multiplyMatrices(e[r]?e[r].matrixWorld:pF,t[r]),xM.toArray(i,16*r);null!==n&&(n.needsUpdate=!0)}clone(){return new bm(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new Uh(t,e,e,ma,Mo);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const n=this.bones[t];if(n.name===e)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,n=e.bones.length;i<n;i++){const r=e.bones[i];let a=t[r];void 0===a&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),a=new _m),this.bones.push(a),this.boneInverses.push((new Ut).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let n=0,r=t.length;n<r;n++)e.bones.push(t[n].uuid),e.boneInverses.push(i[n].toArray());return e}}class zh extends os{constructor(e,t,i,n=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Hh=new Ut,wM=new Ut,sg=[],MM=new Vs,fF=new Ut,vm=new Js,ym=new Tr;class TM extends Js{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new zh(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let n=0;n<i;n++)this.setMatrixAt(n,fF)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new Vs),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,Hh),MM.copy(e.boundingBox).applyMatrix4(Hh),this.boundingBox.union(MM)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new Tr),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,Hh),ym.copy(e.boundingSphere).applyMatrix4(Hh),this.boundingSphere.union(ym)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const i=this.matrixWorld,n=this.count;if(vm.geometry=this.geometry,vm.material=this.material,void 0!==vm.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),ym.copy(this.boundingSphere),ym.applyMatrix4(i),!1!==e.ray.intersectsSphere(ym)))for(let r=0;r<n;r++){this.getMatrixAt(r,Hh),wM.multiplyMatrices(i,Hh),vm.matrixWorld=wM,vm.raycast(e,sg);for(let a=0,o=sg.length;a<o;a++){const l=sg[a];l.instanceId=r,l.object=this,t.push(l)}sg.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new zh(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Ir extends _a{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new xt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const EM=new Z,SM=new Z,kM=new Ut,e0=new bh,og=new Tr;class Zl extends Qn{constructor(e=new Ui,t=new Ir){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[0];for(let n=1,r=t.count;n<r;n++)EM.fromBufferAttribute(t,n-1),SM.fromBufferAttribute(t,n),i[n]=i[n-1],i[n]+=EM.distanceTo(SM);e.setAttribute("lineDistance",new Xt(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,n=this.matrixWorld,r=e.params.Line.threshold,a=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),og.copy(i.boundingSphere),og.applyMatrix4(n),og.radius+=r,!1===e.ray.intersectsSphere(og))return;kM.copy(n).invert(),e0.copy(e.ray).applyMatrix4(kM);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,c=new Z,h=new Z,u=new Z,m=new Z,p=this.isLineSegments?2:1,_=i.index,f=i.attributes.position;if(null!==_)for(let M=Math.max(0,a.start),E=Math.min(_.count,a.start+a.count)-1;M<E;M+=p){const S=_.getX(M),P=_.getX(M+1);if(c.fromBufferAttribute(f,S),h.fromBufferAttribute(f,P),e0.distanceSqToSegment(c,h,m,u)>l)continue;m.applyMatrix4(this.matrixWorld);const L=e.ray.origin.distanceTo(m);L<e.near||L>e.far||t.push({distance:L,point:u.clone().applyMatrix4(this.matrixWorld),index:M,face:null,faceIndex:null,object:this})}else for(let M=Math.max(0,a.start),E=Math.min(f.count,a.start+a.count)-1;M<E;M+=p){if(c.fromBufferAttribute(f,M),h.fromBufferAttribute(f,M+1),e0.distanceSqToSegment(c,h,m,u)>l)continue;m.applyMatrix4(this.matrixWorld);const P=e.ray.origin.distanceTo(m);P<e.near||P>e.far||t.push({distance:P,point:u.clone().applyMatrix4(this.matrixWorld),index:M,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const n=t[i[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,a=n.length;r<a;r++){const o=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=r}}}}}const AM=new Z,PM=new Z;class t0 extends Zl{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[];for(let n=0,r=t.count;n<r;n+=2)AM.fromBufferAttribute(t,n),PM.fromBufferAttribute(t,n+1),i[n]=0===n?0:i[n-1],i[n+1]=i[n]+AM.distanceTo(PM);e.setAttribute("lineDistance",new Xt(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class OM extends Zl{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class n0 extends _a{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new xt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const RM=new Ut,s0=new bh,lg=new Tr,cg=new Z;class IM extends Qn{constructor(e=new Ui,t=new n0){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,n=this.matrixWorld,r=e.params.Points.threshold,a=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),lg.copy(i.boundingSphere),lg.applyMatrix4(n),lg.radius+=r,!1===e.ray.intersectsSphere(lg))return;RM.copy(n).invert(),s0.copy(e.ray).applyMatrix4(RM);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,c=i.index,u=i.attributes.position;if(null!==c)for(let _=Math.max(0,a.start),g=Math.min(c.count,a.start+a.count);_<g;_++){const f=c.getX(_);cg.fromBufferAttribute(u,f),LM(cg,f,l,n,e,t,this)}else for(let _=Math.max(0,a.start),g=Math.min(u.count,a.start+a.count);_<g;_++)cg.fromBufferAttribute(u,_),LM(cg,_,l,n,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const n=t[i[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,a=n.length;r<a;r++){const o=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=r}}}}}function LM(s,e,t,i,n,r,a){const o=s0.distanceSqToPoint(s);if(o<t){const l=new Z;s0.closestPointToPoint(s,l),l.applyMatrix4(i);const c=n.ray.origin.distanceTo(l);if(c<n.near||c>n.far)return;r.push({distance:c,distanceToRay:Math.sqrt(o),point:l,index:e,face:null,object:a})}}class to{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,n=this.getPoint(0),r=0;t.push(0);for(let a=1;a<=e;a++)i=this.getPoint(a/e),r+=i.distanceTo(n),t.push(r),n=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let n=0;const r=i.length;let a;a=t||e*i[r-1];let c,o=0,l=r-1;for(;o<=l;)if(n=Math.floor(o+(l-o)/2),c=i[n]-a,c<0)o=n+1;else{if(!(c>0)){l=n;break}l=n-1}if(n=l,i[n]===a)return n/(r-1);const h=i[n];return(n+(a-h)/(i[n+1]-h))/(r-1)}getTangent(e,t){let n=e-1e-4,r=e+1e-4;n<0&&(n=0),r>1&&(r=1);const a=this.getPoint(n),o=this.getPoint(r),l=t||(a.isVector2?new Xe:new Z);return l.copy(o).sub(a).normalize(),l}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new Z,n=[],r=[],a=[],o=new Z,l=new Ut;for(let p=0;p<=e;p++)n[p]=this.getTangentAt(p/e,new Z);r[0]=new Z,a[0]=new Z;let c=Number.MAX_VALUE;const h=Math.abs(n[0].x),u=Math.abs(n[0].y),m=Math.abs(n[0].z);h<=c&&(c=h,i.set(1,0,0)),u<=c&&(c=u,i.set(0,1,0)),m<=c&&i.set(0,0,1),o.crossVectors(n[0],i).normalize(),r[0].crossVectors(n[0],o),a[0].crossVectors(n[0],r[0]);for(let p=1;p<=e;p++){if(r[p]=r[p-1].clone(),a[p]=a[p-1].clone(),o.crossVectors(n[p-1],n[p]),o.length()>Number.EPSILON){o.normalize();const _=Math.acos(ws(n[p-1].dot(n[p]),-1,1));r[p].applyMatrix4(l.makeRotationAxis(o,_))}a[p].crossVectors(n[p],r[p])}if(!0===t){let p=Math.acos(ws(r[0].dot(r[e]),-1,1));p/=e,n[0].dot(o.crossVectors(r[0],r[e]))>0&&(p=-p);for(let _=1;_<=e;_++)r[_].applyMatrix4(l.makeRotationAxis(n[_],p*_)),a[_].crossVectors(n[_],r[_])}return{tangents:n,normals:r,binormals:a}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}function VM(s,e,t,i,n){let r,a;if(n===function JF(s,e,t,i){let n=0;for(let r=e,a=t-i;r<t;r+=i)n+=(s[a]-s[r])*(s[r+1]+s[a+1]),a=r;return n}(s,e,t,i)>0)for(r=e;r<t;r+=i)a=YM(r,s[r],s[r+1],a);else for(r=t-i;r>=e;r-=i)a=YM(r,s[r],s[r+1],a);return a&&_g(a,a.next)&&(Em(a),a=a.next),a}function sd(s,e){if(!s)return s;e||(e=s);let i,t=s;do{if(i=!1,t.steiner||!_g(t,t.next)&&0!==hs(t.prev,t,t.next))t=t.next;else{if(Em(t),t=e=t.prev,t===t.next)break;i=!0}}while(i||t!==e);return e}function Cm(s,e,t,i,n,r,a){if(!s)return;!a&&r&&function jF(s,e,t,i){let n=s;do{0===n.z&&(n.z=f0(n.x,n.y,e,t,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==s);n.prevZ.nextZ=null,n.prevZ=null,function ZF(s){let e,t,i,n,r,a,o,l,c=1;do{for(t=s,s=null,r=null,a=0;t;){for(a++,i=t,o=0,e=0;e<c&&(o++,i=i.nextZ,i);e++);for(l=c;o>0||l>0&&i;)0!==o&&(0===l||!i||t.z<=i.z)?(n=t,t=t.nextZ,o--):(n=i,i=i.nextZ,l--),r?r.nextZ=n:s=n,n.prevZ=r,r=n;t=i}r.nextZ=null,c*=2}while(a>1)}(n)}(s,i,n,r);let l,c,o=s;for(;s.prev!==s.next;)if(l=s.prev,c=s.next,r?NF(s,i,n,r):BF(s))e.push(l.i/t|0),e.push(s.i/t|0),e.push(c.i/t|0),Em(s),s=c.next,o=c.next;else if((s=c)===o){a?1===a?Cm(s=UF(sd(s),e,t),e,t,i,n,r,2):2===a&&zF(s,e,t,i,n,r):Cm(sd(s),e,t,i,n,r,1);break}}function BF(s){const e=s.prev,t=s,i=s.next;if(hs(e,t,i)>=0)return!1;const n=e.x,r=t.x,a=i.x,o=e.y,l=t.y,c=i.y,h=n<r?n<a?n:a:r<a?r:a,u=o<l?o<c?o:c:l<c?l:c,m=n>r?n>a?n:a:r>a?r:a,p=o>l?o>c?o:c:l>c?l:c;let _=i.next;for(;_!==e;){if(_.x>=h&&_.x<=m&&_.y>=u&&_.y<=p&&Gh(n,o,r,l,a,c,_.x,_.y)&&hs(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function NF(s,e,t,i){const n=s.prev,r=s,a=s.next;if(hs(n,r,a)>=0)return!1;const o=n.x,l=r.x,c=a.x,h=n.y,u=r.y,m=a.y,p=o<l?o<c?o:c:l<c?l:c,_=h<u?h<m?h:m:u<m?u:m,g=o>l?o>c?o:c:l>c?l:c,f=h>u?h>m?h:m:u>m?u:m,b=f0(p,_,e,t,i),C=f0(g,f,e,t,i);let M=s.prevZ,E=s.nextZ;for(;M&&M.z>=b&&E&&E.z<=C;){if(M.x>=p&&M.x<=g&&M.y>=_&&M.y<=f&&M!==n&&M!==a&&Gh(o,h,l,u,c,m,M.x,M.y)&&hs(M.prev,M,M.next)>=0||(M=M.prevZ,E.x>=p&&E.x<=g&&E.y>=_&&E.y<=f&&E!==n&&E!==a&&Gh(o,h,l,u,c,m,E.x,E.y)&&hs(E.prev,E,E.next)>=0))return!1;E=E.nextZ}for(;M&&M.z>=b;){if(M.x>=p&&M.x<=g&&M.y>=_&&M.y<=f&&M!==n&&M!==a&&Gh(o,h,l,u,c,m,M.x,M.y)&&hs(M.prev,M,M.next)>=0)return!1;M=M.prevZ}for(;E&&E.z<=C;){if(E.x>=p&&E.x<=g&&E.y>=_&&E.y<=f&&E!==n&&E!==a&&Gh(o,h,l,u,c,m,E.x,E.y)&&hs(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function UF(s,e,t){let i=s;do{const n=i.prev,r=i.next.next;!_g(n,r)&&WM(n,i,i.next,r)&&Dm(n,r)&&Dm(r,n)&&(e.push(n.i/t|0),e.push(i.i/t|0),e.push(r.i/t|0),Em(i),Em(i.next),i=s=r),i=i.next}while(i!==s);return sd(i)}function zF(s,e,t,i,n,r){let a=s;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&qF(a,o)){let l=GM(a,o);return a=sd(a,a.next),l=sd(l,l.next),Cm(a,e,t,i,n,r,0),void Cm(l,e,t,i,n,r,0)}o=o.next}a=a.next}while(a!==s)}function VF(s,e){return s.x-e.x}function WF(s,e){const t=function GF(s,e){let n,t=e,i=-1/0;const r=s.x,a=s.y;do{if(a<=t.y&&a>=t.next.y&&t.next.y!==t.y){const m=t.x+(a-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(m<=r&&m>i&&(i=m,n=t.x<t.next.x?t:t.next,m===r))return n}t=t.next}while(t!==e);if(!n)return null;const o=n,l=n.x,c=n.y;let u,h=1/0;t=n;do{r>=t.x&&t.x>=l&&r!==t.x&&Gh(a<c?r:i,a,l,c,a<c?i:r,a,t.x,t.y)&&(u=Math.abs(a-t.y)/(r-t.x),Dm(t,s)&&(u<h||u===h&&(t.x>n.x||t.x===n.x&&YF(n,t)))&&(n=t,h=u)),t=t.next}while(t!==o);return n}(s,e);if(!t)return e;const i=GM(t,s);return sd(i,i.next),sd(t,t.next)}function YF(s,e){return hs(s.prev,s,e.prev)<0&&hs(e.next,s,s.next)<0}function f0(s,e,t,i,n){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-t)*n|0)|s<<8))|s<<4))|s<<2))|s<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*n|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function XF(s){let e=s,t=s;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==s);return t}function Gh(s,e,t,i,n,r,a,o){return(n-a)*(e-o)>=(s-a)*(r-o)&&(s-a)*(i-o)>=(t-a)*(e-o)&&(t-a)*(r-o)>=(n-a)*(i-o)}function qF(s,e){return s.next.i!==e.i&&s.prev.i!==e.i&&!function $F(s,e){let t=s;do{if(t.i!==s.i&&t.next.i!==s.i&&t.i!==e.i&&t.next.i!==e.i&&WM(t,t.next,s,e))return!0;t=t.next}while(t!==s);return!1}(s,e)&&(Dm(s,e)&&Dm(e,s)&&function KF(s,e){let t=s,i=!1;const n=(s.x+e.x)/2,r=(s.y+e.y)/2;do{t.y>r!=t.next.y>r&&t.next.y!==t.y&&n<(t.next.x-t.x)*(r-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next}while(t!==s);return i}(s,e)&&(hs(s.prev,s,e.prev)||hs(s,e.prev,e))||_g(s,e)&&hs(s.prev,s,s.next)>0&&hs(e.prev,e,e.next)>0)}function hs(s,e,t){return(e.y-s.y)*(t.x-e.x)-(e.x-s.x)*(t.y-e.y)}function _g(s,e){return s.x===e.x&&s.y===e.y}function WM(s,e,t,i){const n=vg(hs(s,e,t)),r=vg(hs(s,e,i)),a=vg(hs(t,i,s)),o=vg(hs(t,i,e));return!!(n!==r&&a!==o||0===n&&bg(s,t,e)||0===r&&bg(s,i,e)||0===a&&bg(t,s,i)||0===o&&bg(t,e,i))}function bg(s,e,t){return e.x<=Math.max(s.x,t.x)&&e.x>=Math.min(s.x,t.x)&&e.y<=Math.max(s.y,t.y)&&e.y>=Math.min(s.y,t.y)}function vg(s){return s>0?1:s<0?-1:0}function Dm(s,e){return hs(s.prev,s,s.next)<0?hs(s,e,s.next)>=0&&hs(s,s.prev,e)>=0:hs(s,e,s.prev)<0||hs(s,s.next,e)<0}function GM(s,e){const t=new g0(s.i,s.x,s.y),i=new g0(e.i,e.x,e.y),n=s.next,r=e.prev;return s.next=e,e.prev=s,t.next=n,n.prev=t,i.next=t,t.prev=i,r.next=i,i.prev=r,i}function YM(s,e,t,i){const n=new g0(s,e,t);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function Em(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function g0(s,e,t){this.i=s,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Eo{static area(e){const t=e.length;let i=0;for(let n=t-1,r=0;r<t;n=r++)i+=e[n].x*e[r].y-e[r].x*e[n].y;return.5*i}static isClockWise(e){return Eo.area(e)<0}static triangulateShape(e,t){const i=[],n=[],r=[];jM(e),ZM(i,e);let a=e.length;t.forEach(jM);for(let l=0;l<t.length;l++)n.push(a),a+=t[l].length,ZM(i,t[l]);const o=function(s,e,t=2){const i=e&&e.length,n=i?e[0]*t:s.length;let r=VM(s,0,n,t,!0);const a=[];if(!r||r.next===r.prev)return a;let o,l,c,h,u,m,p;if(i&&(r=function HF(s,e,t,i){const n=[];let r,a,o,l,c;for(r=0,a=e.length;r<a;r++)o=e[r]*i,l=r<a-1?e[r+1]*i:s.length,c=VM(s,o,l,i,!1),c===c.next&&(c.steiner=!0),n.push(XF(c));for(n.sort(VF),r=0;r<n.length;r++)t=WF(n[r],t);return t}(s,e,r,t)),s.length>80*t){o=c=s[0],l=h=s[1];for(let _=t;_<n;_+=t)u=s[_],m=s[_+1],u<o&&(o=u),m<l&&(l=m),u>c&&(c=u),m>h&&(h=m);p=Math.max(c-o,h-l),p=0!==p?32767/p:0}return Cm(r,a,t,o,l,p,0),a}(i,n);for(let l=0;l<o.length;l+=3)r.push(o.slice(l,l+3));return r}}function jM(s){const e=s.length;e>2&&s[e-1].equals(s[0])&&s.pop()}function ZM(s,e){for(let t=0;t<e.length;t++)s.push(e[t].x),s.push(e[t].y)}class xg extends Ui{constructor(e=1,t=32,i=16,n=0,r=2*Math.PI,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:n,phiLength:r,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(a+o,Math.PI);let c=0;const h=[],u=new Z,m=new Z,p=[],_=[],g=[],f=[];for(let b=0;b<=i;b++){const C=[],M=b/i;let E=0;0===b&&0===a?E=.5/t:b===i&&l===Math.PI&&(E=-.5/t);for(let S=0;S<=t;S++){const P=S/t;u.x=-e*Math.cos(n+P*r)*Math.sin(a+M*o),u.y=e*Math.cos(a+M*o),u.z=e*Math.sin(n+P*r)*Math.sin(a+M*o),_.push(u.x,u.y,u.z),m.copy(u).normalize(),g.push(m.x,m.y,m.z),f.push(P+E,1-M),C.push(c++)}h.push(C)}for(let b=0;b<i;b++)for(let C=0;C<t;C++){const E=h[b][C],S=h[b+1][C],P=h[b+1][C+1];(0!==b||a>0)&&p.push(h[b][C+1],E,P),(b!==i-1||l<Math.PI)&&p.push(E,S,P)}this.setIndex(p),this.setAttribute("position",new Xt(_,3)),this.setAttribute("normal",new Xt(g,3)),this.setAttribute("uv",new Xt(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new xg(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class wg extends _a{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new xt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class So extends wg{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Xe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return ws(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new xt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new xt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new xt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Mg extends _a{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new xt(16777215),this.specular=new xt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=gf,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class $M extends _a{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new xt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=gf,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}function rd(s,e,t){return!s||!t&&s.constructor===e?s:"number"==typeof e.BYTES_PER_ELEMENT?new e(s):Array.prototype.slice.call(s)}function JM(s){const t=s.length,i=new Array(t);for(let n=0;n!==t;++n)i[n]=n;return i.sort(function e(n,r){return s[n]-s[r]}),i}function C0(s,e,t){const i=s.length,n=new s.constructor(i);for(let r=0,a=0;a!==i;++r){const o=t[r]*e;for(let l=0;l!==e;++l)n[a++]=s[o+l]}return n}function D0(s,e,t,i){let n=1,r=s[0];for(;void 0!==r&&void 0===r[i];)r=s[n++];if(void 0===r)return;let a=r[i];if(void 0!==a)if(Array.isArray(a))do{a=r[i],void 0!==a&&(e.push(r.time),t.push.apply(t,a)),r=s[n++]}while(void 0!==r);else if(void 0!==a.toArray)do{a=r[i],void 0!==a&&(e.push(r.time),a.toArray(t,t.length)),r=s[n++]}while(void 0!==r);else do{a=r[i],void 0!==a&&(e.push(r.time),t.push(a)),r=s[n++]}while(void 0!==r)}class Sm{constructor(e,t,i,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,n=t[i],r=t[i-1];e:{t:{let a;i:{n:if(!(e<n)){for(let o=i+2;;){if(void 0===n){if(e<r)break n;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===o)break;if(r=n,n=t[++i],e<n)break t}a=t.length;break i}if(e>=r)break e;{const o=t[1];e<o&&(i=2,r=o);for(let l=i-2;;){if(void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(n=r,r=t[--i-1],e>=r)break t}a=i,i=0}}for(;i<a;){const o=i+a>>>1;e<t[o]?a=o:i=o+1}if(n=t[i],r=t[i-1],void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===n)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,e,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=e*n;for(let a=0;a!==n;++a)t[a]=i[r+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class hB extends Sm{constructor(e,t,i,n){super(e,t,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const n=this.parameterPositions;let r=e-2,a=e+1,o=n[r],l=n[a];if(void 0===o)switch(this.getSettings_().endingStart){case 2401:r=e,o=2*t-i;break;case 2402:r=n.length-2,o=t+n[r]-n[r+1];break;default:r=e,o=i}if(void 0===l)switch(this.getSettings_().endingEnd){case 2401:a=e,l=2*i-t;break;case 2402:a=1,l=i+n[1]-n[0];break;default:a=e-1,l=t}const c=.5*(i-t),h=this.valueSize;this._weightPrev=c/(t-o),this._weightNext=c/(l-i),this._offsetPrev=r*h,this._offsetNext=a*h}interpolate_(e,t,i,n){const r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=e*o,c=l-o,h=this._offsetPrev,u=this._offsetNext,m=this._weightPrev,p=this._weightNext,_=(i-t)/(n-t),g=_*_,f=g*_,b=-m*f+2*m*g-m*_,C=(1+m)*f+(-1.5-2*m)*g+(-.5+m)*_+1,M=(-1-p)*f+(1.5+p)*g+.5*_,E=p*f-p*g;for(let S=0;S!==o;++S)r[S]=b*a[h+S]+C*a[c+S]+M*a[l+S]+E*a[u+S];return r}}class QM extends Sm{constructor(e,t,i,n){super(e,t,i,n)}interpolate_(e,t,i,n){const r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=e*o,c=l-o,h=(i-t)/(n-t),u=1-h;for(let m=0;m!==o;++m)r[m]=a[c+m]*u+a[l+m]*h;return r}}class uB extends Sm{constructor(e,t,i,n){super(e,t,i,n)}interpolate_(e){return this.copySampleValue_(e-1)}}class ko{constructor(e,t,i,n){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=rd(t,this.TimeBufferType),this.values=rd(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:rd(e.times,Array),values:rd(e.values,Array)};const n=e.getInterpolation();n!==e.DefaultInterpolation&&(i.interpolation=n)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new uB(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new QM(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new hB(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case nm:t=this.InterpolantFactoryMethodDiscrete;break;case ah:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return nm;case this.InterpolantFactoryMethodLinear:return ah;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,n=t.length;i!==n;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,n=t.length;i!==n;++i)t[i]*=e}return this}trim(e,t){const i=this.times,n=i.length;let r=0,a=n-1;for(;r!==n&&i[r]<e;)++r;for(;-1!==a&&i[a]>t;)--a;if(++a,0!==r||a!==n){r>=a&&(a=Math.max(a,1),r=a-1);const o=this.getValueSize();this.times=i.slice(r,a),this.values=this.values.slice(r*o,a*o)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,n=this.values,r=i.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let o=0;o!==r;o++){const l=i[o];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,l),e=!1;break}if(null!==a&&a>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,l,a),e=!1;break}a=l}if(void 0!==n&&function KM(s){return ArrayBuffer.isView(s)&&!(s instanceof DataView)}(n))for(let o=0,l=n.length;o!==l;++o){const c=n[o];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),n=2302===this.getInterpolation(),r=e.length-1;let a=1;for(let o=1;o<r;++o){let l=!1;const c=e[o];if(c!==e[o+1]&&(1!==o||c!==e[0]))if(n)l=!0;else{const u=o*i,m=u-i,p=u+i;for(let _=0;_!==i;++_){const g=t[u+_];if(g!==t[m+_]||g!==t[p+_]){l=!0;break}}}if(l){if(o!==a){e[a]=e[o];const u=o*i,m=a*i;for(let p=0;p!==i;++p)t[m+p]=t[u+p]}++a}}if(r>0){e[a]=e[r];for(let o=r*i,l=a*i,c=0;c!==i;++c)t[l+c]=t[o+c];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}ko.prototype.TimeBufferType=Float32Array,ko.prototype.ValueBufferType=Float32Array,ko.prototype.DefaultInterpolation=ah;class Yh extends ko{}Yh.prototype.ValueTypeName="bool",Yh.prototype.ValueBufferType=Array,Yh.prototype.DefaultInterpolation=nm,Yh.prototype.InterpolantFactoryMethodLinear=void 0,Yh.prototype.InterpolantFactoryMethodSmooth=void 0;class eT extends ko{}eT.prototype.ValueTypeName="color";class ad extends ko{}ad.prototype.ValueTypeName="number";class mB extends Sm{constructor(e,t,i,n){super(e,t,i,n)}interpolate_(e,t,i,n){const r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=(i-t)/(n-t);let c=e*o;for(let h=c+o;c!==h;c+=4)Jn.slerpFlat(r,0,a,c-o,a,c,l);return r}}class ll extends ko{InterpolantFactoryMethodLinear(e){return new mB(this.times,this.values,this.getValueSize(),e)}}ll.prototype.ValueTypeName="quaternion",ll.prototype.DefaultInterpolation=ah,ll.prototype.InterpolantFactoryMethodSmooth=void 0;class jh extends ko{}jh.prototype.ValueTypeName="string",jh.prototype.ValueBufferType=Array,jh.prototype.DefaultInterpolation=nm,jh.prototype.InterpolantFactoryMethodLinear=void 0,jh.prototype.InterpolantFactoryMethodSmooth=void 0;class od extends ko{}od.prototype.ValueTypeName="vector";class Zh{constructor(e,t=-1,i,n=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=n,this.uuid=pa(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,n=1/(e.fps||1);for(let a=0,o=i.length;a!==o;++a)t.push(fB(i[a]).scale(n));const r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r}static toJSON(e){const t=[],i=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let r=0,a=i.length;r!==a;++r)t.push(ko.toJSON(i[r]));return n}static CreateFromMorphTargetSequence(e,t,i,n){const r=t.length,a=[];for(let o=0;o<r;o++){let l=[],c=[];l.push((o+r-1)%r,o,(o+1)%r),c.push(0,1,0);const h=JM(l);l=C0(l,1,h),c=C0(c,1,h),!n&&0===l[0]&&(l.push(r),c.push(c[0])),a.push(new ad(".morphTargetInfluences["+t[o].name+"]",l,c).scale(1/i))}return new this(e,-1,a)}static findByName(e,t){let i=e;Array.isArray(e)||(i=e.geometry&&e.geometry.animations||e.animations);for(let n=0;n<i.length;n++)if(i[n].name===t)return i[n];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const n={},r=/^([\w-]*?)([\d]+)$/;for(let o=0,l=e.length;o<l;o++){const c=e[o],h=c.name.match(r);if(h&&h.length>1){const u=h[1];let m=n[u];m||(n[u]=m=[]),m.push(c)}}const a=[];for(const o in n)a.push(this.CreateFromMorphTargetSequence(o,n[o],t,i));return a}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(u,m,p,_,g){if(0!==p.length){const f=[],b=[];D0(p,f,b,_),0!==f.length&&g.push(new u(m,f,b))}},n=[],r=e.name||"default",a=e.fps||30,o=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let u=0;u<c.length;u++){const m=c[u].keys;if(m&&0!==m.length)if(m[0].morphTargets){const p={};let _;for(_=0;_<m.length;_++)if(m[_].morphTargets)for(let g=0;g<m[_].morphTargets.length;g++)p[m[_].morphTargets[g]]=-1;for(const g in p){const f=[],b=[];for(let C=0;C!==m[_].morphTargets.length;++C){const M=m[_];f.push(M.time),b.push(M.morphTarget===g?1:0)}n.push(new ad(".morphTargetInfluence["+g+"]",f,b))}l=p.length*a}else{const p=".bones["+t[u].name+"]";i(od,p+".position",m,"pos",n),i(ll,p+".quaternion",m,"rot",n),i(od,p+".scale",m,"scl",n)}}return 0===n.length?null:new this(r,l,n,o)}resetDuration(){let t=0;for(let i=0,n=this.tracks.length;i!==n;++i){const r=this.tracks[i];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function fB(s){if(void 0===s.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function pB(s){switch(s.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ad;case"vector":case"vector2":case"vector3":case"vector4":return od;case"color":return eT;case"quaternion":return ll;case"bool":case"boolean":return Yh;case"string":return jh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+s)}(s.type);if(void 0===s.times){const t=[],i=[];D0(s.keys,t,i,"value"),s.times=t,s.values=i}return void 0!==e.parse?e.parse(s):new e(s.name,s.times,s.values,s.interpolation)}const Xl={enabled:!1,files:{},add:function(s,e){!1!==this.enabled&&(this.files[s]=e)},get:function(s){if(!1!==this.enabled)return this.files[s]},remove:function(s){delete this.files[s]},clear:function(){this.files={}}};class tT{constructor(e,t,i){const n=this;let l,r=!1,a=0,o=0;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(h){o++,!1===r&&void 0!==n.onStart&&n.onStart(h,a,o),r=!0},this.itemEnd=function(h){a++,void 0!==n.onProgress&&n.onProgress(h,a,o),a===o&&(r=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(h){void 0!==n.onError&&n.onError(h)},this.resolveURL=function(h){return l?l(h):h},this.setURLModifier=function(h){return l=h,this},this.addHandler=function(h,u){return c.push(h,u),this},this.removeHandler=function(h){const u=c.indexOf(h);return-1!==u&&c.splice(u,2),this},this.getHandler=function(h){for(let u=0,m=c.length;u<m;u+=2){const p=c[u],_=c[u+1];if(p.global&&(p.lastIndex=0),p.test(h))return _}return null}}}const gB=new tT;let ql=(()=>{class s{constructor(t){this.manager=void 0!==t?t:gB,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){const n=this;return new Promise(function(r,a){n.load(t,r,i,a)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return s.DEFAULT_MATERIAL_NAME="__DEFAULT",s})();const cl={};class _B extends Error{constructor(e,t){super(e),this.response=t}}class io extends ql{constructor(e){super(e)}load(e,t,i,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=Xl.get(e);if(void 0!==r)return this.manager.itemStart(e),setTimeout(()=>{t&&t(r),this.manager.itemEnd(e)},0),r;if(void 0!==cl[e])return void cl[e].push({onLoad:t,onProgress:i,onError:n});cl[e]=[],cl[e].push({onLoad:t,onProgress:i,onError:n});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,l=this.responseType;fetch(a).then(c=>{if(200===c.status||0===c.status){if(0===c.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===c.body||void 0===c.body.getReader)return c;const h=cl[e],u=c.body.getReader(),m=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),p=m?parseInt(m):0,_=0!==p;let g=0;const f=new ReadableStream({start(b){!function C(){u.read().then(({done:M,value:E})=>{if(M)b.close();else{g+=E.byteLength;const S=new ProgressEvent("progress",{lengthComputable:_,loaded:g,total:p});for(let P=0,I=h.length;P<I;P++){const L=h[P];L.onProgress&&L.onProgress(S)}b.enqueue(E),C()}})}()}});return new Response(f)}throw new _B(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(h=>(new DOMParser).parseFromString(h,o));case"json":return c.json();default:if(void 0===o)return c.text();{const u=/charset="?([^;"\s]*)"?/i.exec(o),m=u&&u[1]?u[1].toLowerCase():void 0,p=new TextDecoder(m);return c.arrayBuffer().then(_=>p.decode(_))}}}).then(c=>{Xl.add(e,c);const h=cl[e];delete cl[e];for(let u=0,m=h.length;u<m;u++){const p=h[u];p.onLoad&&p.onLoad(c)}}).catch(c=>{const h=cl[e];if(void 0===h)throw this.manager.itemError(e),c;delete cl[e];for(let u=0,m=h.length;u<m;u++){const p=h[u];p.onError&&p.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Tg extends ql{constructor(e){super(e)}load(e,t,i,n){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,a=Xl.get(e);if(void 0!==a)return r.manager.itemStart(e),setTimeout(function(){t&&t(a),r.manager.itemEnd(e)},0),a;const o=am("img");function l(){h(),Xl.add(e,this),t&&t(this),r.manager.itemEnd(e)}function c(u){h(),n&&n(u),r.manager.itemError(e),r.manager.itemEnd(e)}function h(){o.removeEventListener("load",l,!1),o.removeEventListener("error",c,!1)}return o.addEventListener("load",l,!1),o.addEventListener("error",c,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(e),o.src=e,o}}class iT extends ql{constructor(e){super(e)}load(e,t,i,n){const r=new Kr,a=new Tg(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(o){r.image=o,r.needsUpdate=!0,void 0!==t&&t(r)},i,n),r}}class Cg extends Qn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new xt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const E0=new Ut,nT=new Z,sT=new Z;class S0{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Xe(512,512),this.map=null,this.mapPass=null,this.matrix=new Ut,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Zf,this._frameExtents=new Xe(1,1),this._viewportCount=1,this._viewports=[new yn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;nT.setFromMatrixPosition(e.matrixWorld),t.position.copy(nT),sT.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(sT),t.updateMatrixWorld(),E0.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(E0),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(E0)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class vB extends S0{constructor(){super(new Qs(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=2*dh*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;(i!==t.fov||n!==t.aspect||r!==t.far)&&(t.fov=i,t.aspect=n,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Dg extends Cg{constructor(e,t,i=0,n=Math.PI/3,r=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Qn.DEFAULT_UP),this.updateMatrix(),this.target=new Qn,this.distance=i,this.angle=n,this.penumbra=r,this.decay=a,this.map=null,this.shadow=new vB}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const rT=new Ut,km=new Z,k0=new Z;class yB extends S0{constructor(){super(new Qs(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Xe(4,2),this._viewportCount=6,this._viewports=[new yn(2,1,1,1),new yn(0,1,1,1),new yn(3,1,1,1),new yn(1,1,1,1),new yn(3,0,1,1),new yn(1,0,1,1)],this._cubeDirections=[new Z(1,0,0),new Z(-1,0,0),new Z(0,0,1),new Z(0,0,-1),new Z(0,1,0),new Z(0,-1,0)],this._cubeUps=[new Z(0,1,0),new Z(0,1,0),new Z(0,1,0),new Z(0,1,0),new Z(0,0,1),new Z(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,n=this.matrix,r=e.distance||i.far;r!==i.far&&(i.far=r,i.updateProjectionMatrix()),km.setFromMatrixPosition(e.matrixWorld),i.position.copy(km),k0.copy(i.position),k0.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(k0),i.updateMatrixWorld(),n.makeTranslation(-km.x,-km.y,-km.z),rT.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(rT)}}class Am extends Cg{constructor(e,t,i=0,n=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=n,this.shadow=new yB}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class xB extends S0{constructor(){super(new mm(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Eg extends Cg{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Qn.DEFAULT_UP),this.updateMatrix(),this.target=new Qn,this.shadow=new xB}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class A0 extends Cg{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class $l{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let i=0,n=e.length;i<n;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class SB extends ql{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,a=Xl.get(e);if(void 0!==a)return r.manager.itemStart(e),a.then?void a.then(c=>{t&&t(c),r.manager.itemEnd(e)}).catch(c=>{n&&n(c)}):(setTimeout(function(){t&&t(a),r.manager.itemEnd(e)},0),a);const o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader;const l=fetch(e,o).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(c){return Xl.add(e,c),t&&t(c),r.manager.itemEnd(e),c}).catch(function(c){n&&n(c),Xl.remove(e),r.manager.itemError(e),r.manager.itemEnd(e)});Xl.add(e,l),r.manager.itemStart(e)}}const O0="\\[\\]\\.:\\/",RB=new RegExp("["+O0+"]","g"),R0="[^"+O0+"]",IB="[^"+O0.replace("\\.","")+"]",UB=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",R0)+/(WCOD+)?/.source.replace("WCOD",IB)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",R0)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",R0)+"$"),zB=["material","materials","bones","map"];class HB{constructor(e,t,i){const n=i||En.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}getValue(e,t){this.bind();const n=this._bindings[this._targetGroup.nCachedObjects_];void 0!==n&&n.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let En=(()=>{class s{constructor(t,i,n){this.path=i,this.parsedPath=n||s.parseTrackName(i),this.node=s.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,n){return t&&t.isAnimationObjectGroup?new s.Composite(t,i,n):new s(t,i,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(RB,"")}static parseTrackName(t){const i=UB.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const a=n.nodeName.substring(r+1);-1!==zB.indexOf(a)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=a)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(i);if(void 0!==n)return n}if(t.children){const n=function(a){for(let o=0;o<a.length;o++){const l=a[o];if(l.name===i||l.uuid===i)return l;const c=n(l.children);if(c)return c}return null},r=n(t.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const n=this.resolvedProperty;for(let r=0,a=n.length;r!==a;++r)t[i++]=n[r]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const n=this.resolvedProperty;for(let r=0,a=n.length;r!==a;++r)n[r]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const n=this.resolvedProperty;for(let r=0,a=n.length;r!==a;++r)n[r]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const n=this.resolvedProperty;for(let r=0,a=n.length;r!==a;++r)n[r]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,n=i.objectName,r=i.propertyName;let a=i.propertyIndex;if(t||(t=s.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(n){let h=i.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let u=0;u<t.length;u++)if(t[u].name===h){h=u;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==h){if(void 0===t[h])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[h]}}const o=t[r];if(void 0===o)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+r+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==a){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[a]&&(a=t.morphTargetDictionary[a])}c=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=a}else void 0!==o.fromArray&&void 0!==o.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(c=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return s.Composite=HB,s})();En.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},En.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},En.prototype.GetterByBindingType=[En.prototype._getValue_direct,En.prototype._getValue_array,En.prototype._getValue_arrayElement,En.prototype._getValue_toArray],En.prototype.SetterByBindingTypeAndVersioning=[[En.prototype._setValue_direct,En.prototype._setValue_direct_setNeedsUpdate,En.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[En.prototype._setValue_array,En.prototype._setValue_array_setNeedsUpdate,En.prototype._setValue_array_setMatrixWorldNeedsUpdate],[En.prototype._setValue_arrayElement,En.prototype._setValue_arrayElement_setNeedsUpdate,En.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[En.prototype._setValue_fromArray,En.prototype._setValue_fromArray_setNeedsUpdate,En.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class fT{constructor(e,t,i=0,n=1/0){this.ray=new bh(e,t),this.near=i,this.far=n,this.camera=null,this.layers=new Dv,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return I0(e,this,i,t),i.sort(gT),i}intersectObjects(e,t=!0,i=[]){for(let n=0,r=e.length;n<r;n++)I0(e[n],this,i,t);return i.sort(gT),i}}function gT(s,e){return s.distance-e.distance}function I0(s,e,t,i){if(s.layers.test(e.layers)&&s.raycast(e,t),!0===i){const n=s.children;for(let r=0,a=n.length;r<a;r++)I0(n[r],e,t,!0)}}class _T{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(ws(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const yT=new Z;class YB extends Qn{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const i=new Ui,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,o=1,l=32;a<l;a++,o++){const c=a/l*Math.PI*2,h=o/l*Math.PI*2;n.push(Math.cos(c),Math.sin(c),1,Math.cos(h),Math.sin(h),1)}i.setAttribute("position",new Xt(n,3));const r=new Ir({fog:!1,toneMapped:!1});this.cone=new t0(i,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),yT.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(yT),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}class jB extends Js{constructor(e,t,i){super(new xg(t,4,2),new ka({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const TT=new Z,Pg=new Z,CT=new Z;class XB extends Qn{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",void 0===t&&(t=1);let n=new Ui;n.setAttribute("position",new Xt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const r=new Ir({fog:!1,toneMapped:!1});this.lightPlane=new Zl(n,r),this.add(this.lightPlane),n=new Ui,n.setAttribute("position",new Xt([0,0,0,0,0,1],3)),this.targetLine=new Zl(n,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),TT.setFromMatrixPosition(this.light.matrixWorld),Pg.setFromMatrixPosition(this.light.target.matrixWorld),CT.subVectors(Pg,TT),this.lightPlane.lookAt(Pg),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Pg),this.targetLine.scale.z=CT.length()}}function ET(s,e){if(0===e)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),s;if(2===e||1===e){let t=s.getIndex();if(null===t){const a=[],o=s.getAttribute("position");if(void 0===o)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),s;for(let l=0;l<o.count;l++)a.push(l);s.setIndex(a),t=s.getIndex()}const i=t.count-2,n=[];if(2===e)for(let a=1;a<=i;a++)n.push(t.getX(0)),n.push(t.getX(a)),n.push(t.getX(a+1));else for(let a=0;a<i;a++)a%2==0?(n.push(t.getX(a)),n.push(t.getX(a+1)),n.push(t.getX(a+2))):(n.push(t.getX(a+2)),n.push(t.getX(a+1)),n.push(t.getX(a)));n.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const r=s.clone();return r.setIndex(n),r.clearGroups(),r}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),s}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"160"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="160");class $B extends ql{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new t3(t)}),this.register(function(t){return new h3(t)}),this.register(function(t){return new u3(t)}),this.register(function(t){return new m3(t)}),this.register(function(t){return new s3(t)}),this.register(function(t){return new r3(t)}),this.register(function(t){return new a3(t)}),this.register(function(t){return new o3(t)}),this.register(function(t){return new e3(t)}),this.register(function(t){return new l3(t)}),this.register(function(t){return new n3(t)}),this.register(function(t){return new d3(t)}),this.register(function(t){return new c3(t)}),this.register(function(t){return new JB(t)}),this.register(function(t){return new p3(t)}),this.register(function(t){return new f3(t)})}load(e,t,i,n){const r=this;let a;if(""!==this.resourcePath)a=this.resourcePath;else if(""!==this.path){const c=$l.extractUrlBase(e);a=$l.resolveURL(c,this.path)}else a=$l.extractUrlBase(e);this.manager.itemStart(e);const o=function(c){n?n(c):console.error(c),r.manager.itemError(e),r.manager.itemEnd(e)},l=new io(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{r.parse(c,a,function(h){t(h),r.manager.itemEnd(e)},o)}catch(h){o(h)}},i,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,n){let r;const a={},o={},l=new TextDecoder;if("string"==typeof e)r=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===ST){try{a[cn.KHR_BINARY_GLTF]=new g3(e)}catch(u){return void(n&&n(u))}r=JSON.parse(a[cn.KHR_BINARY_GLTF].content)}else r=JSON.parse(l.decode(e));else r=e;if(void 0===r.asset||r.asset.version[0]<2)return void(n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const c=new k3(r,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let h=0;h<this.pluginCallbacks.length;h++){const u=this.pluginCallbacks[h](c);u.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),o[u.name]=u,a[u.name]=!0}if(r.extensionsUsed)for(let h=0;h<r.extensionsUsed.length;++h){const u=r.extensionsUsed[h],m=r.extensionsRequired||[];switch(u){case cn.KHR_MATERIALS_UNLIT:a[u]=new QB;break;case cn.KHR_DRACO_MESH_COMPRESSION:a[u]=new _3(r,this.dracoLoader);break;case cn.KHR_TEXTURE_TRANSFORM:a[u]=new b3;break;case cn.KHR_MESH_QUANTIZATION:a[u]=new v3;break;default:m.indexOf(u)>=0&&void 0===o[u]&&console.warn('THREE.GLTFLoader: Unknown extension "'+u+'".')}}c.setExtensions(a),c.setPlugins(o),c.parse(i,n)}parseAsync(e,t){const i=this;return new Promise(function(n,r){i.parse(e,t,n,r)})}}function KB(){let s={};return{get:function(e){return s[e]},add:function(e,t){s[e]=t},remove:function(e){delete s[e]},removeAll:function(){s={}}}}const cn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class JB{constructor(e){this.parser=e,this.name=cn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,n=t.length;i<n;i++){const r=t[i];r.extensions&&r.extensions[this.name]&&void 0!==r.extensions[this.name].light&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let n=t.cache.get(i);if(n)return n;const r=t.json,l=((r.extensions&&r.extensions[this.name]||{}).lights||[])[e];let c;const h=new xt(16777215);void 0!==l.color&&h.setRGB(l.color[0],l.color[1],l.color[2],or);const u=void 0!==l.range?l.range:0;switch(l.type){case"directional":c=new Eg(h),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new Am(h),c.distance=u;break;case"spot":c=new Dg(h),c.distance=u,l.spot=l.spot||{},l.spot.innerConeAngle=void 0!==l.spot.innerConeAngle?l.spot.innerConeAngle:0,l.spot.outerConeAngle=void 0!==l.spot.outerConeAngle?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,Ql(c,l),void 0!==l.intensity&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),n=Promise.resolve(c),t.cache.add(i,n),n}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,r=i.json.nodes[e],o=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===o?null:this._loadLight(o).then(function(l){return i._getNodeRef(t.cache,o,l)})}}class QB{constructor(){this.name=cn.KHR_MATERIALS_UNLIT}getMaterialType(){return ka}extendParams(e,t,i){const n=[];e.color=new xt(1,1,1),e.opacity=1;const r=t.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const a=r.baseColorFactor;e.color.setRGB(a[0],a[1],a[2],or),e.opacity=a[3]}void 0!==r.baseColorTexture&&n.push(i.assignTexture(e,"map",r.baseColorTexture,Un))}return Promise.all(n)}}class e3{constructor(e){this.parser=e,this.name=cn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name].emissiveStrength;return void 0!==r&&(t.emissiveIntensity=r),Promise.resolve()}}class t3{constructor(e){this.parser=e,this.name=cn.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?So:null}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=[],a=n.extensions[this.name];if(void 0!==a.clearcoatFactor&&(t.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&r.push(i.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&r.push(i.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(r.push(i.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){const o=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Xe(o,o)}return Promise.all(r)}}class n3{constructor(e){this.parser=e,this.name=cn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?So:null}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=[],a=n.extensions[this.name];return void 0!==a.iridescenceFactor&&(t.iridescence=a.iridescenceFactor),void 0!==a.iridescenceTexture&&r.push(i.assignTexture(t,"iridescenceMap",a.iridescenceTexture)),void 0!==a.iridescenceIor&&(t.iridescenceIOR=a.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==a.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),void 0!==a.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),void 0!==a.iridescenceThicknessTexture&&r.push(i.assignTexture(t,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(r)}}class s3{constructor(e){this.parser=e,this.name=cn.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?So:null}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=[];t.sheenColor=new xt(0,0,0),t.sheenRoughness=0,t.sheen=1;const a=n.extensions[this.name];if(void 0!==a.sheenColorFactor){const o=a.sheenColorFactor;t.sheenColor.setRGB(o[0],o[1],o[2],or)}return void 0!==a.sheenRoughnessFactor&&(t.sheenRoughness=a.sheenRoughnessFactor),void 0!==a.sheenColorTexture&&r.push(i.assignTexture(t,"sheenColorMap",a.sheenColorTexture,Un)),void 0!==a.sheenRoughnessTexture&&r.push(i.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(r)}}class r3{constructor(e){this.parser=e,this.name=cn.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?So:null}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=[],a=n.extensions[this.name];return void 0!==a.transmissionFactor&&(t.transmission=a.transmissionFactor),void 0!==a.transmissionTexture&&r.push(i.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(r)}}class a3{constructor(e){this.parser=e,this.name=cn.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?So:null}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=[],a=n.extensions[this.name];t.thickness=void 0!==a.thicknessFactor?a.thicknessFactor:0,void 0!==a.thicknessTexture&&r.push(i.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;const o=a.attenuationColor||[1,1,1];return t.attenuationColor=(new xt).setRGB(o[0],o[1],o[2],or),Promise.all(r)}}class o3{constructor(e){this.parser=e,this.name=cn.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?So:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name];return t.ior=void 0!==r.ior?r.ior:1.5,Promise.resolve()}}class l3{constructor(e){this.parser=e,this.name=cn.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?So:null}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=[],a=n.extensions[this.name];t.specularIntensity=void 0!==a.specularFactor?a.specularFactor:1,void 0!==a.specularTexture&&r.push(i.assignTexture(t,"specularIntensityMap",a.specularTexture));const o=a.specularColorFactor||[1,1,1];return t.specularColor=(new xt).setRGB(o[0],o[1],o[2],or),void 0!==a.specularColorTexture&&r.push(i.assignTexture(t,"specularColorMap",a.specularColorTexture,Un)),Promise.all(r)}}class c3{constructor(e){this.parser=e,this.name=cn.EXT_MATERIALS_BUMP}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?So:null}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=[],a=n.extensions[this.name];return t.bumpScale=void 0!==a.bumpFactor?a.bumpFactor:1,void 0!==a.bumpTexture&&r.push(i.assignTexture(t,"bumpMap",a.bumpTexture)),Promise.all(r)}}class d3{constructor(e){this.parser=e,this.name=cn.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?So:null}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=[],a=n.extensions[this.name];return void 0!==a.anisotropyStrength&&(t.anisotropy=a.anisotropyStrength),void 0!==a.anisotropyRotation&&(t.anisotropyRotation=a.anisotropyRotation),void 0!==a.anisotropyTexture&&r.push(i.assignTexture(t,"anisotropyMap",a.anisotropyTexture)),Promise.all(r)}}class h3{constructor(e){this.parser=e,this.name=cn.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,n=i.textures[e];if(!n.extensions||!n.extensions[this.name])return null;const r=n.extensions[this.name],a=t.options.ktx2Loader;if(!a){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,r.source,a)}}class u3{constructor(e){this.parser=e,this.name=cn.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,n=i.json,r=n.textures[e];if(!r.extensions||!r.extensions[t])return null;const a=r.extensions[t],o=n.images[a.source];let l=i.textureLoader;if(o.uri){const c=i.options.manager.getHandler(o.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,a.source,l);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class m3{constructor(e){this.parser=e,this.name=cn.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,n=i.json,r=n.textures[e];if(!r.extensions||!r.extensions[t])return null;const a=r.extensions[t],o=n.images[a.source];let l=i.textureLoader;if(o.uri){const c=i.options.manager.getHandler(o.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,a.source,l);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class p3{constructor(e){this.name=cn.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const n=i.extensions[this.name],r=this.parser.getDependency("buffer",n.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then(function(o){const h=n.count,u=n.byteStride,m=new Uint8Array(o,n.byteOffset||0,n.byteLength||0);return a.decodeGltfBufferAsync?a.decodeGltfBufferAsync(h,u,m,n.mode,n.filter).then(function(p){return p.buffer}):a.ready.then(function(){const p=new ArrayBuffer(h*u);return a.decodeGltfBuffer(new Uint8Array(p),h,u,m,n.mode,n.filter),p})})}return null}}class f3{constructor(e){this.name=cn.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||void 0===i.mesh)return null;const n=t.meshes[i.mesh];for(const c of n.primitives)if(c.mode!==Pa.TRIANGLES&&c.mode!==Pa.TRIANGLE_STRIP&&c.mode!==Pa.TRIANGLE_FAN&&void 0!==c.mode)return null;const a=i.extensions[this.name].attributes,o=[],l={};for(const c in a)o.push(this.parser.getDependency("accessor",a[c]).then(h=>(l[c]=h,l[c])));return o.length<1?null:(o.push(this.parser.createNodeMesh(e)),Promise.all(o).then(c=>{const h=c.pop(),u=h.isGroup?h.children:[h],m=c[0].count,p=[];for(const _ of u){const g=new Ut,f=new Z,b=new Jn,C=new Z(1,1,1),M=new TM(_.geometry,_.material,m);for(let E=0;E<m;E++)l.TRANSLATION&&f.fromBufferAttribute(l.TRANSLATION,E),l.ROTATION&&b.fromBufferAttribute(l.ROTATION,E),l.SCALE&&C.fromBufferAttribute(l.SCALE,E),M.setMatrixAt(E,g.compose(f,b,C));for(const E in l)if("_COLOR_0"===E){const S=l[E];M.instanceColor=new zh(S.array,S.itemSize,S.normalized)}else"TRANSLATION"!==E&&"ROTATION"!==E&&"SCALE"!==E&&_.geometry.setAttribute(E,l[E]);Qn.prototype.copy.call(M,_),this.parser.assignFinalMaterial(M),p.push(M)}return h.isGroup?(h.clear(),h.add(...p),h):p[0]}))}}const ST="glTF";class g3{constructor(e){this.name=cn.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==ST)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-12,r=new DataView(e,12);let a=0;for(;a<n;){const o=r.getUint32(a,!0);a+=4;const l=r.getUint32(a,!0);if(a+=4,1313821514===l){const c=new Uint8Array(e,12+a,o);this.content=i.decode(c)}else if(5130562===l){const c=12+a;this.body=e.slice(c,c+o)}a+=o}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class _3{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=cn.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,n=this.dracoLoader,r=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,o={},l={},c={};for(const h in a){const u=z0[h]||h.toLowerCase();o[u]=a[h]}for(const h in e.attributes){const u=z0[h]||h.toLowerCase();if(void 0!==a[h]){const m=i.accessors[e.attributes[h]];c[u]=Xh[m.componentType].name,l[u]=!0===m.normalized}}return t.getDependency("bufferView",r).then(function(h){return new Promise(function(u,m){n.decodeDracoFile(h,function(p){for(const _ in p.attributes){const f=l[_];void 0!==f&&(p.attributes[_].normalized=f)}u(p)},o,c,or,m)})})}}class b3{constructor(){this.name=cn.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class v3{constructor(){this.name=cn.KHR_MESH_QUANTIZATION}}class AT extends Sm{constructor(e,t,i,n){super(e,t,i,n)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=e*n*3+n;for(let a=0;a!==n;a++)t[a]=i[r+a];return t}interpolate_(e,t,i,n){const r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=2*o,c=3*o,h=n-t,u=(i-t)/h,m=u*u,p=m*u,_=e*c,g=_-c,f=-2*p+3*m,b=p-m,C=1-f,M=b-m+u;for(let E=0;E!==o;E++)r[E]=C*a[g+E+o]+M*(a[g+E+l]*h)+f*a[_+E+o]+b*(a[_+E]*h);return r}}const y3=new Jn;class x3 extends AT{interpolate_(e,t,i,n){const r=super.interpolate_(e,t,i,n);return y3.fromArray(r).normalize().toArray(r),r}}const Pa={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Xh={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},PT={9728:Ss,9729:xs,9984:1004,9985:1007,9986:1005,9987:tl},OT={33071:ar,33648:1002,10497:el},U0={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},z0={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Jl={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},w3={CUBICSPLINE:void 0,LINEAR:ah,STEP:nm};function md(s,e,t){for(const i in t.extensions)void 0===s[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function Ql(s,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(s.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function C3(s,e){if(s.updateMorphTargets(),void 0!==e.weights)for(let t=0,i=e.weights.length;t<i;t++)s.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(s.morphTargetInfluences.length===t.length){s.morphTargetDictionary={};for(let i=0,n=t.length;i<n;i++)s.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function D3(s){let e;const t=s.extensions&&s.extensions[cn.KHR_DRACO_MESH_COMPRESSION];if(e=t?"draco:"+t.bufferView+":"+t.indices+":"+V0(t.attributes):s.indices+":"+V0(s.attributes)+":"+s.mode,void 0!==s.targets)for(let i=0,n=s.targets.length;i<n;i++)e+=":"+V0(s.targets[i]);return e}function V0(s){let e="";const t=Object.keys(s).sort();for(let i=0,n=t.length;i<n;i++)e+=t[i]+":"+s[t[i]]+";";return e}function W0(s){switch(s){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const S3=new Ut;class k3{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new KB,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,n=!1,r=-1;typeof navigator<"u"&&(i=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),n=navigator.userAgent.indexOf("Firefox")>-1,r=n?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),this.textureLoader=typeof createImageBitmap>"u"||i||n&&r<98?new iT(this.options.manager):new SB(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new io(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,n=this.json,r=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(a){return a._markDefs&&a._markDefs()}),Promise.all(this._invokeAll(function(a){return a.beforeRoot&&a.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(a){const o={scene:a[0][n.scene||0],scenes:a[0],animations:a[1],cameras:a[2],asset:n.asset,parser:i,userData:{}};return md(r,o,n),Ql(o,n),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(o)})).then(function(){e(o)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let n=0,r=t.length;n<r;n++){const a=t[n].joints;for(let o=0,l=a.length;o<l;o++)e[a[o]].isBone=!0}for(let n=0,r=e.length;n<r;n++){const a=e[n];void 0!==a.mesh&&(this._addNodeRef(this.meshCache,a.mesh),void 0!==a.skin&&(i[a.mesh].isSkinnedMesh=!0)),void 0!==a.camera&&this._addNodeRef(this.cameraCache,a.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const n=i.clone(),r=(a,o)=>{const l=this.associations.get(a);null!=l&&this.associations.set(o,l);for(const[c,h]of a.children.entries())r(h,o.children[c])};return r(i,n),n.name+="_instance_"+e.uses[t]++,n}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const n=e(t[i]);if(n)return n}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let n=0;n<t.length;n++){const r=e(t[n]);r&&i.push(r)}return i}getDependency(e,t){const i=e+":"+t;let n=this.cache.get(i);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this._invokeOne(function(r){return r.loadNode&&r.loadNode(t)});break;case"mesh":n=this._invokeOne(function(r){return r.loadMesh&&r.loadMesh(t)});break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne(function(r){return r.loadBufferView&&r.loadBufferView(t)});break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne(function(r){return r.loadMaterial&&r.loadMaterial(t)});break;case"texture":n=this._invokeOne(function(r){return r.loadTexture&&r.loadTexture(t)});break;case"skin":n=this.loadSkin(t);break;case"animation":n=this._invokeOne(function(r){return r.loadAnimation&&r.loadAnimation(t)});break;case"camera":n=this.loadCamera(t);break;default:if(n=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,t)}),!n)throw new Error("Unknown type: "+e)}this.cache.add(i,n)}return n}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(r,a){return i.getDependency(e,a)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[cn.KHR_BINARY_GLTF].body);const n=this.options;return new Promise(function(r,a){i.load($l.resolveURL(t.uri,n.path),r,void 0,function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const r=t.byteOffset||0;return i.slice(r,r+(t.byteLength||0))})}loadAccessor(e){const t=this,i=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse){const a=U0[n.type],l=!0===n.normalized,c=new(0,Xh[n.componentType])(n.count*a);return Promise.resolve(new os(c,a,l))}const r=[];return r.push(void 0!==n.bufferView?this.getDependency("bufferView",n.bufferView):null),void 0!==n.sparse&&(r.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(r).then(function(a){const o=a[0],l=U0[n.type],c=Xh[n.componentType],h=c.BYTES_PER_ELEMENT,m=n.byteOffset||0,p=void 0!==n.bufferView?i.bufferViews[n.bufferView].byteStride:void 0,_=!0===n.normalized;let g,f;if(p&&p!==h*l){const b=Math.floor(m/p),C="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+b+":"+n.count;let M=t.cache.get(C);M||(g=new c(o,b*p,n.count*p/h),M=new Zv(g,p/h),t.cache.add(C,M)),f=new ed(M,l,m%p/h,_)}else g=null===o?new c(n.count*l):new c(o,m,n.count*l),f=new os(g,l,_);if(void 0!==n.sparse){const E=n.sparse.values.byteOffset||0,S=new(0,Xh[n.sparse.indices.componentType])(a[1],n.sparse.indices.byteOffset||0,n.sparse.count*U0.SCALAR),P=new c(a[2],E,n.sparse.count*l);null!==o&&(f=new os(f.array.slice(),f.itemSize,f.normalized));for(let I=0,L=S.length;I<L;I++){const O=S[I];if(f.setX(O,P[I*l]),l>=2&&f.setY(O,P[I*l+1]),l>=3&&f.setZ(O,P[I*l+2]),l>=4&&f.setW(O,P[I*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return f})}loadTexture(e){const t=this.json,r=t.textures[e].source,a=t.images[r];let o=this.textureLoader;if(a.uri){const l=this.options.manager.getHandler(a.uri);null!==l&&(o=l)}return this.loadTextureImage(e,r,o)}loadTextureImage(e,t,i){const n=this,r=this.json,a=r.textures[e],o=r.images[t],l=(o.uri||o.bufferView)+":"+a.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,i).then(function(h){h.flipY=!1,h.name=a.name||o.name||"",""===h.name&&"string"==typeof o.uri&&!1===o.uri.startsWith("data:image/")&&(h.name=o.uri);const m=(r.samplers||{})[a.sampler]||{};return h.magFilter=PT[m.magFilter]||xs,h.minFilter=PT[m.minFilter]||tl,h.wrapS=OT[m.wrapS]||el,h.wrapT=OT[m.wrapT]||el,n.associations.set(h,{textures:e}),h}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const n=this.json,r=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(u=>u.clone());const a=n.images[e],o=self.URL||self.webkitURL;let l=a.uri||"",c=!1;if(void 0!==a.bufferView)l=this.getDependency("bufferView",a.bufferView).then(function(u){c=!0;const m=new Blob([u],{type:a.mimeType});return l=o.createObjectURL(m),l});else if(void 0===a.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(l).then(function(u){return new Promise(function(m,p){let _=m;!0===t.isImageBitmapLoader&&(_=function(g){const f=new Kr(g);f.needsUpdate=!0,m(f)}),t.load($l.resolveURL(u,r.path),_,void 0,p)})}).then(function(u){return!0===c&&o.revokeObjectURL(l),u.userData.mimeType=a.mimeType||function E3(s){return s.search(/\.jpe?g($|\?)/i)>0||0===s.search(/^data\:image\/jpeg/)?"image/jpeg":s.search(/\.webp($|\?)/i)>0||0===s.search(/^data\:image\/webp/)?"image/webp":"image/png"}(a.uri),u}).catch(function(u){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),u});return this.sourceCache[e]=h,h}assignTexture(e,t,i,n){const r=this;return this.getDependency("texture",i.index).then(function(a){if(!a)return null;if(void 0!==i.texCoord&&i.texCoord>0&&((a=a.clone()).channel=i.texCoord),r.extensions[cn.KHR_TEXTURE_TRANSFORM]){const o=void 0!==i.extensions?i.extensions[cn.KHR_TEXTURE_TRANSFORM]:void 0;if(o){const l=r.associations.get(a);a=r.extensions[cn.KHR_TEXTURE_TRANSFORM].extendTexture(a,o),r.associations.set(a,l)}}return void 0!==n&&(a.colorSpace=n),e[t]=a,a})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const n=void 0===t.attributes.tangent,r=void 0!==t.attributes.color,a=void 0===t.attributes.normal;if(e.isPoints){const o="PointsMaterial:"+i.uuid;let l=this.cache.get(o);l||(l=new n0,_a.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(o,l)),i=l}else if(e.isLine){const o="LineBasicMaterial:"+i.uuid;let l=this.cache.get(o);l||(l=new Ir,_a.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,this.cache.add(o,l)),i=l}if(n||r||a){let o="ClonedMaterial:"+i.uuid+":";n&&(o+="derivative-tangents:"),r&&(o+="vertex-colors:"),a&&(o+="flat-shading:");let l=this.cache.get(o);l||(l=i.clone(),r&&(l.vertexColors=!0),a&&(l.flatShading=!0),n&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(o,l),this.associations.set(l,this.associations.get(i))),i=l}e.material=i}getMaterialType(){return wg}loadMaterial(e){const t=this,n=this.extensions,r=this.json.materials[e];let a;const o={},c=[];if((r.extensions||{})[cn.KHR_MATERIALS_UNLIT]){const u=n[cn.KHR_MATERIALS_UNLIT];a=u.getMaterialType(),c.push(u.extendParams(o,r,t))}else{const u=r.pbrMetallicRoughness||{};if(o.color=new xt(1,1,1),o.opacity=1,Array.isArray(u.baseColorFactor)){const m=u.baseColorFactor;o.color.setRGB(m[0],m[1],m[2],or),o.opacity=m[3]}void 0!==u.baseColorTexture&&c.push(t.assignTexture(o,"map",u.baseColorTexture,Un)),o.metalness=void 0!==u.metallicFactor?u.metallicFactor:1,o.roughness=void 0!==u.roughnessFactor?u.roughnessFactor:1,void 0!==u.metallicRoughnessTexture&&(c.push(t.assignTexture(o,"metalnessMap",u.metallicRoughnessTexture)),c.push(t.assignTexture(o,"roughnessMap",u.metallicRoughnessTexture))),a=this._invokeOne(function(m){return m.getMaterialType&&m.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(m){return m.extendMaterialParams&&m.extendMaterialParams(e,o)})))}!0===r.doubleSided&&(o.side=2);const h=r.alphaMode||"OPAQUE";if("BLEND"===h?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,"MASK"===h&&(o.alphaTest=void 0!==r.alphaCutoff?r.alphaCutoff:.5)),void 0!==r.normalTexture&&a!==ka&&(c.push(t.assignTexture(o,"normalMap",r.normalTexture)),o.normalScale=new Xe(1,1),void 0!==r.normalTexture.scale)){const u=r.normalTexture.scale;o.normalScale.set(u,u)}if(void 0!==r.occlusionTexture&&a!==ka&&(c.push(t.assignTexture(o,"aoMap",r.occlusionTexture)),void 0!==r.occlusionTexture.strength&&(o.aoMapIntensity=r.occlusionTexture.strength)),void 0!==r.emissiveFactor&&a!==ka){const u=r.emissiveFactor;o.emissive=(new xt).setRGB(u[0],u[1],u[2],or)}return void 0!==r.emissiveTexture&&a!==ka&&c.push(t.assignTexture(o,"emissiveMap",r.emissiveTexture,Un)),Promise.all(c).then(function(){const u=new a(o);return r.name&&(u.name=r.name),Ql(u,r),t.associations.set(u,{materials:e}),r.extensions&&md(n,u,r),u})}createUniqueName(e){const t=En.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,n=this.primitiveCache;function r(o){return i[cn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(o,t).then(function(l){return RT(l,o,t)})}const a=[];for(let o=0,l=e.length;o<l;o++){const c=e[o],h=D3(c),u=n[h];if(u)a.push(u.promise);else{let m;m=c.extensions&&c.extensions[cn.KHR_DRACO_MESH_COMPRESSION]?r(c):RT(new Ui,c,t),n[h]={primitive:c,promise:m},a.push(m)}}return Promise.all(a)}loadMesh(e){const t=this,n=this.extensions,r=this.json.meshes[e],a=r.primitives,o=[];for(let l=0,c=a.length;l<c;l++){const h=void 0===a[l].material?(void 0===(s=this.cache).DefaultMaterial&&(s.DefaultMaterial=new wg({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),s.DefaultMaterial):this.getDependency("material",a[l].material);o.push(h)}var s;return o.push(t.loadGeometries(a)),Promise.all(o).then(function(l){const c=l.slice(0,l.length-1),h=l[l.length-1],u=[];for(let p=0,_=h.length;p<_;p++){const g=h[p],f=a[p];let b;const C=c[p];if(f.mode===Pa.TRIANGLES||f.mode===Pa.TRIANGLE_STRIP||f.mode===Pa.TRIANGLE_FAN||void 0===f.mode)b=!0===r.isSkinnedMesh?new Kv(g,C):new Js(g,C),!0===b.isSkinnedMesh&&b.normalizeSkinWeights(),f.mode===Pa.TRIANGLE_STRIP?b.geometry=ET(b.geometry,1):f.mode===Pa.TRIANGLE_FAN&&(b.geometry=ET(b.geometry,2));else if(f.mode===Pa.LINES)b=new t0(g,C);else if(f.mode===Pa.LINE_STRIP)b=new Zl(g,C);else if(f.mode===Pa.LINE_LOOP)b=new OM(g,C);else{if(f.mode!==Pa.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+f.mode);b=new IM(g,C)}Object.keys(b.geometry.morphAttributes).length>0&&C3(b,r),b.name=t.createUniqueName(r.name||"mesh_"+e),Ql(b,r),f.extensions&&md(n,b,f),t.assignFinalMaterial(b),u.push(b)}for(let p=0,_=u.length;p<_;p++)t.associations.set(u[p],{meshes:e,primitives:p});if(1===u.length)return r.extensions&&md(n,u[0],r),u[0];const m=new Do;r.extensions&&md(n,m,r),t.associations.set(m,{meshes:e});for(let p=0,_=u.length;p<_;p++)m.add(u[p]);return m})}loadCamera(e){let t;const i=this.json.cameras[e],n=i[i.type];if(n)return"perspective"===i.type?t=new Qs(br_radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===i.type&&(t=new mm(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),Ql(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i=[];for(let n=0,r=t.joints.length;n<r;n++)i.push(this._loadNodeShallow(t.joints[n]));return i.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(i).then(function(n){const r=n.pop(),a=n,o=[],l=[];for(let c=0,h=a.length;c<h;c++){const u=a[c];if(u){o.push(u);const m=new Ut;null!==r&&m.fromArray(r.array,16*c),l.push(m)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new bm(o,l)})}loadAnimation(e){const i=this,n=this.json.animations[e],r=n.name?n.name:"animation_"+e,a=[],o=[],l=[],c=[],h=[];for(let u=0,m=n.channels.length;u<m;u++){const p=n.channels[u],_=n.samplers[p.sampler],g=p.target,b=void 0!==n.parameters?n.parameters[_.input]:_.input,C=void 0!==n.parameters?n.parameters[_.output]:_.output;void 0!==g.node&&(a.push(this.getDependency("node",g.node)),o.push(this.getDependency("accessor",b)),l.push(this.getDependency("accessor",C)),c.push(_),h.push(g))}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(l),Promise.all(c),Promise.all(h)]).then(function(u){const m=u[0],p=u[1],_=u[2],g=u[3],f=u[4],b=[];for(let C=0,M=m.length;C<M;C++){const E=m[C],S=p[C],P=_[C],I=g[C],L=f[C];if(void 0===E)continue;E.updateMatrix&&E.updateMatrix();const O=i._createAnimationTracks(E,S,P,I,L);if(O)for(let B=0;B<O.length;B++)b.push(O[B])}return new Zh(r,void 0,b)})}createNodeMesh(e){const i=this,n=this.json.nodes[e];return void 0===n.mesh?null:i.getDependency("mesh",n.mesh).then(function(r){const a=i._getNodeRef(i.meshCache,n.mesh,r);return void 0!==n.weights&&a.traverse(function(o){if(o.isMesh)for(let l=0,c=n.weights.length;l<c;l++)o.morphTargetInfluences[l]=n.weights[l]}),a})}loadNode(e){const i=this,n=this.json.nodes[e],r=i._loadNodeShallow(e),a=[],o=n.children||[];for(let c=0,h=o.length;c<h;c++)a.push(i.getDependency("node",o[c]));const l=void 0===n.skin?Promise.resolve(null):i.getDependency("skin",n.skin);return Promise.all([r,Promise.all(a),l]).then(function(c){const h=c[0],u=c[1],m=c[2];null!==m&&h.traverse(function(p){p.isSkinnedMesh&&p.bind(m,S3)});for(let p=0,_=u.length;p<_;p++)h.add(u[p]);return h})}_loadNodeShallow(e){const i=this.extensions,n=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const r=this.json.nodes[e],a=r.name?n.createUniqueName(r.name):"",o=[],l=n._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&o.push(l),void 0!==r.camera&&o.push(n.getDependency("camera",r.camera).then(function(c){return n._getNodeRef(n.cameraCache,r.camera,c)})),n._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){o.push(c)}),this.nodeCache[e]=Promise.all(o).then(function(c){let h;if(h=!0===r.isBone?new _m:c.length>1?new Do:1===c.length?c[0]:new Qn,h!==c[0])for(let u=0,m=c.length;u<m;u++)h.add(c[u]);if(r.name&&(h.userData.name=r.name,h.name=a),Ql(h,r),r.extensions&&md(i,h,r),void 0!==r.matrix){const u=new Ut;u.fromArray(r.matrix),h.applyMatrix4(u)}else void 0!==r.translation&&h.position.fromArray(r.translation),void 0!==r.rotation&&h.quaternion.fromArray(r.rotation),void 0!==r.scale&&h.scale.fromArray(r.scale);return n.associations.has(h)||n.associations.set(h,{}),n.associations.get(h).nodes=e,h}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],n=this,r=new Do;i.name&&(r.name=n.createUniqueName(i.name)),Ql(r,i),i.extensions&&md(t,r,i);const a=i.nodes||[],o=[];for(let l=0,c=a.length;l<c;l++)o.push(n.getDependency("node",a[l]));return Promise.all(o).then(function(l){for(let h=0,u=l.length;h<u;h++)r.add(l[h]);return n.associations=(h=>{const u=new Map;for(const[m,p]of n.associations)(m instanceof _a||m instanceof Kr)&&u.set(m,p);return h.traverse(m=>{const p=n.associations.get(m);null!=p&&u.set(m,p)}),u})(r),r})}_createAnimationTracks(e,t,i,n,r){const a=[],o=e.name?e.name:e.uuid,l=[];let c;switch(Jl[r.path]===Jl.weights?e.traverse(function(m){m.morphTargetInfluences&&l.push(m.name?m.name:m.uuid)}):l.push(o),Jl[r.path]){case Jl.weights:c=ad;break;case Jl.rotation:c=ll;break;case Jl.position:case Jl.scale:c=od;break;default:c=1===i.itemSize?ad:od}const h=void 0!==n.interpolation?w3[n.interpolation]:ah,u=this._getArrayFromAccessor(i);for(let m=0,p=l.length;m<p;m++){const _=new c(l[m]+"."+Jl[r.path],t.array,u,h);"CUBICSPLINE"===n.interpolation&&this._createCubicSplineTrackInterpolant(_),a.push(_)}return a}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=W0(t.constructor),n=new Float32Array(t.length);for(let r=0,a=t.length;r<a;r++)n[r]=t[r]*i;t=n}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){return new(this instanceof ll?x3:AT)(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function RT(s,e,t){const i=e.attributes,n=[];function r(a,o){return t.getDependency("accessor",a).then(function(l){s.setAttribute(o,l)})}for(const a in i){const o=z0[a]||a.toLowerCase();o in s.attributes||n.push(r(i[a],o))}if(void 0!==e.indices&&!s.index){const a=t.getDependency("accessor",e.indices).then(function(o){s.setIndex(o)});n.push(a)}return Dn.workingColorSpace!==or&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${Dn.workingColorSpace}" not supported.`),Ql(s,e),function A3(s,e,t){const i=e.attributes,n=new Vs;if(void 0===i.POSITION)return;{const o=t.json.accessors[i.POSITION],l=o.min,c=o.max;if(void 0===l||void 0===c)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(n.set(new Z(l[0],l[1],l[2]),new Z(c[0],c[1],c[2])),o.normalized){const h=W0(Xh[o.componentType]);n.min.multiplyScalar(h),n.max.multiplyScalar(h)}}const r=e.targets;if(void 0!==r){const o=new Z,l=new Z;for(let c=0,h=r.length;c<h;c++){const u=r[c];if(void 0!==u.POSITION){const m=t.json.accessors[u.POSITION],p=m.min,_=m.max;if(void 0!==p&&void 0!==_){if(l.setX(Math.max(Math.abs(p[0]),Math.abs(_[0]))),l.setY(Math.max(Math.abs(p[1]),Math.abs(_[1]))),l.setZ(Math.max(Math.abs(p[2]),Math.abs(_[2]))),m.normalized){const g=W0(Xh[m.componentType]);l.multiplyScalar(g)}o.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}n.expandByVector(o)}s.boundingBox=n;const a=new Tr;n.getCenter(a.center),a.radius=n.min.distanceTo(n.max)/2,s.boundingSphere=a}(s,e,t),Promise.all(n).then(function(){return void 0!==e.targets?function T3(s,e,t){let i=!1,n=!1,r=!1;for(let c=0,h=e.length;c<h;c++){const u=e[c];if(void 0!==u.POSITION&&(i=!0),void 0!==u.NORMAL&&(n=!0),void 0!==u.COLOR_0&&(r=!0),i&&n&&r)break}if(!i&&!n&&!r)return Promise.resolve(s);const a=[],o=[],l=[];for(let c=0,h=e.length;c<h;c++){const u=e[c];if(i){const m=void 0!==u.POSITION?t.getDependency("accessor",u.POSITION):s.attributes.position;a.push(m)}if(n){const m=void 0!==u.NORMAL?t.getDependency("accessor",u.NORMAL):s.attributes.normal;o.push(m)}if(r){const m=void 0!==u.COLOR_0?t.getDependency("accessor",u.COLOR_0):s.attributes.color;l.push(m)}}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(l)]).then(function(c){const u=c[1],m=c[2];return i&&(s.morphAttributes.position=c[0]),n&&(s.morphAttributes.normal=u),r&&(s.morphAttributes.color=m),s.morphTargetsRelative=!0,s})}(s,e.targets,t):s})}var G0=function(s){return URL.createObjectURL(new Blob([s],{type:"text/javascript"}))};try{URL.revokeObjectURL(G0(""))}catch{G0=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)}}var In=Uint8Array,cr=Uint16Array,ec=Uint32Array,qh=new In([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),$h=new In([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Om=new In([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),FT=function(s,e){for(var t=new cr(31),i=0;i<31;++i)t[i]=e+=1<<s[i-1];var n=new ec(t[30]);for(i=1;i<30;++i)for(var r=t[i];r<t[i+1];++r)n[r]=r-t[i]<<5|i;return[t,n]},BT=FT(qh,2),Y0=BT[0],Lg=BT[1];Y0[28]=258,Lg[258]=28;for(var UT=FT($h,0)[0],Rm=new cr(32768),es=0;es<32768;++es){var tc=(43690&es)>>>1|(21845&es)<<1;Rm[es]=((65280&(tc=(61680&(tc=(52428&tc)>>>2|(13107&tc)<<2))>>>4|(3855&tc)<<4))>>>8|(255&tc)<<8)>>>1}var Ao=function(s,e,t){for(var i=s.length,n=0,r=new cr(e);n<i;++n)++r[s[n]-1];var o,a=new cr(e);for(n=0;n<e;++n)a[n]=a[n-1]+r[n-1]<<1;if(t){o=new cr(1<<e);var l=15-e;for(n=0;n<i;++n)if(s[n])for(var c=n<<4|s[n],h=e-s[n],u=a[s[n]-1]++<<h,m=u|(1<<h)-1;u<=m;++u)o[Rm[u]>>>l]=c}else for(o=new cr(i),n=0;n<i;++n)s[n]&&(o[n]=Rm[a[s[n]-1]++]>>>15-s[n]);return o},ic=new In(288);for(es=0;es<144;++es)ic[es]=8;for(es=144;es<256;++es)ic[es]=9;for(es=256;es<280;++es)ic[es]=7;for(es=280;es<288;++es)ic[es]=8;var Im=new In(32);for(es=0;es<32;++es)Im[es]=5;var HT=Ao(ic,9,1),WT=Ao(Im,5,1),Fg=function(s){for(var e=s[0],t=1;t<s.length;++t)s[t]>e&&(e=s[t]);return e},Oa=function(s,e,t){var i=e/8|0;return(s[i]|s[i+1]<<8)>>(7&e)&t},Bg=function(s,e){var t=e/8|0;return(s[t]|s[t+1]<<8|s[t+2]<<16)>>(7&e)},Lm=function(s){return(s/8|0)+(7&s&&1)},Ng=function(s,e,t){var i=s.length;if(!i||t&&!t.l&&i<5)return e||new In(0);var n=!e||t,r=!t||t.i;t||(t={}),e||(e=new In(3*i));var a=function($e){var et=e.length;if($e>et){var wt=new In(Math.max(2*et,$e));wt.set(e),e=wt}},o=t.f||0,l=t.p||0,c=t.b||0,h=t.l,u=t.d,m=t.m,p=t.n,_=8*i;do{if(!h){t.f=o=Oa(s,l,1);var g=Oa(s,l+1,3);if(l+=3,!g){var b=s[(f=Lm(l)+4)-4]|s[f-3]<<8,C=f+b;if(C>i){if(r)throw"unexpected EOF";break}n&&a(c+b),e.set(s.subarray(f,C),c),t.b=c+=b,t.p=l=8*C;continue}if(1==g)h=HT,u=WT,m=9,p=5;else{if(2!=g)throw"invalid block type";var M=Oa(s,l,31)+257,E=Oa(s,l+10,15)+4,S=M+Oa(s,l+5,31)+1;l+=14;for(var P=new In(S),I=new In(19),L=0;L<E;++L)I[Om[L]]=Oa(s,l+3*L,7);l+=3*E;var O=Fg(I),B=(1<<O)-1,Q=Ao(I,O,1);for(L=0;L<S;){var f,pe=Q[Oa(s,l,B)];if(l+=15&pe,(f=pe>>>4)<16)P[L++]=f;else{var ae=0,N=0;for(16==f?(N=3+Oa(s,l,3),l+=2,ae=P[L-1]):17==f?(N=3+Oa(s,l,7),l+=3):18==f&&(N=11+Oa(s,l,127),l+=7);N--;)P[L++]=ae}}var ee=P.subarray(0,M),K=P.subarray(M);m=Fg(ee),p=Fg(K),h=Ao(ee,m,1),u=Ao(K,p,1)}if(l>_){if(r)throw"unexpected EOF";break}}n&&a(c+131072);for(var se=(1<<m)-1,ue=(1<<p)-1,re=l;;re=l){var xe=(ae=h[Bg(s,l)&se])>>>4;if((l+=15&ae)>_){if(r)throw"unexpected EOF";break}if(!ae)throw"invalid length/literal";if(xe<256)e[c++]=xe;else{if(256==xe){re=l,h=null;break}var Ce=xe-254;xe>264&&(Ce=Oa(s,l,(1<<(Fe=qh[L=xe-257]))-1)+Y0[L],l+=Fe);var Te=u[Bg(s,l)&ue],Le=Te>>>4;if(!Te)throw"invalid distance";if(l+=15&Te,K=UT[Le],Le>3){var Fe=$h[Le];K+=Bg(s,l)&(1<<Fe)-1,l+=Fe}if(l>_){if(r)throw"unexpected EOF";break}n&&a(c+131072);for(var Ge=c+Ce;c<Ge;c+=4)e[c]=e[c-K],e[c+1]=e[c+1-K],e[c+2]=e[c+2-K],e[c+3]=e[c+3-K];c=Ge}}t.l=h,t.p=re,t.b=c,h&&(o=1,t.m=m,t.d=u,t.n=p)}while(!o);return c==e.length?e:function(s,e,t){(null==e||e<0)&&(e=0),(null==t||t>s.length)&&(t=s.length);var i=new(s instanceof cr?cr:s instanceof ec?ec:In)(t-e);return i.set(s.subarray(e,t)),i}(e,0,c)},Hg=new In(0);var ty=typeof TextDecoder<"u"&&new TextDecoder;try{ty.decode(Hg,{stream:!0})}catch{}function $g(s,e,t){const i=t.length-s-1;if(e>=t[i])return i-1;if(e<=t[s])return s;let n=s,r=i,a=Math.floor((n+r)/2);for(;e<t[a]||e>=t[a+1];)e<t[a]?r=a:n=a,a=Math.floor((n+r)/2);return a}function Z3(s,e){let t=1;for(let n=2;n<=s;++n)t*=n;let i=1;for(let n=2;n<=e;++n)i*=n;for(let n=2;n<=s-e;++n)i*=n;return t/i}class $3 extends to{constructor(e,t,i,n,r){super(),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=n||0,this.endKnot=r||this.knots.length-1;for(let a=0;a<i.length;++a){const o=i[a];this.controlPoints[a]=new yn(o.x,o.y,o.z,o.w)}}getPoint(e,t=new Z){const i=t,r=function G3(s,e,t,i){const n=$g(s,i,e),r=function iy(s,e,t,i){const n=[],r=[],a=[];n[0]=1;for(let o=1;o<=t;++o){r[o]=e-i[s+1-o],a[o]=i[s+o]-e;let l=0;for(let c=0;c<o;++c){const h=a[c+1],u=r[o-c],m=n[c]/(h+u);n[c]=l+h*m,l=u*m}n[o]=l}return n}(n,i,s,e),a=new yn(0,0,0,0);for(let o=0;o<=s;++o){const l=t[n-s+o],c=r[o],h=l.w*c;a.x+=l.x*h,a.y+=l.y*h,a.z+=l.z*h,a.w+=l.w*c}return a}(this.degree,this.knots,this.controlPoints,this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]));return 1!==r.w&&r.divideScalar(r.w),i.set(r.x,r.y,r.z)}getTangent(e,t=new Z){const i=t,r=function q3(s,e,t,i,n){const r=function j3(s,e,t,i,n){const r=n<s?n:s,a=[],o=$g(s,i,e),l=function Y3(s,e,t,i,n){const r=[];for(let u=0;u<=t;++u)r[u]=0;const a=[];for(let u=0;u<=i;++u)a[u]=r.slice(0);const o=[];for(let u=0;u<=t;++u)o[u]=r.slice(0);o[0][0]=1;const l=r.slice(0),c=r.slice(0);for(let u=1;u<=t;++u){l[u]=e-n[s+1-u],c[u]=n[s+u]-e;let m=0;for(let p=0;p<u;++p){const _=c[p+1],g=l[u-p];o[u][p]=_+g;const f=o[p][u-1]/o[u][p];o[p][u]=m+_*f,m=g*f}o[u][u]=m}for(let u=0;u<=t;++u)a[0][u]=o[u][t];for(let u=0;u<=t;++u){let m=0,p=1;const _=[];for(let g=0;g<=t;++g)_[g]=r.slice(0);_[0][0]=1;for(let g=1;g<=i;++g){let f=0;const b=u-g,C=t-g;u>=g&&(_[p][0]=_[m][0]/o[C+1][b],f=_[p][0]*o[b][C]);const E=u-1<=C?g-1:t-u;for(let P=b>=-1?1:-b;P<=E;++P)_[p][P]=(_[m][P]-_[m][P-1])/o[C+1][b+P],f+=_[p][P]*o[b+P][C];u<=C&&(_[p][g]=-_[m][g-1]/o[C+1][u],f+=_[p][g]*o[u][C]),a[g][u]=f;const S=m;m=p,p=S}}let h=t;for(let u=1;u<=i;++u){for(let m=0;m<=t;++m)a[u][m]*=h;h*=t-u}return a}(o,i,s,r,e),c=[];for(let h=0;h<t.length;++h){const u=t[h].clone(),m=u.w;u.x*=m,u.y*=m,u.z*=m,c[h]=u}for(let h=0;h<=r;++h){const u=c[o-s].clone().multiplyScalar(l[h][0]);for(let m=1;m<=s;++m)u.add(c[o-s+m].clone().multiplyScalar(l[h][m]));a[h]=u}for(let h=r+1;h<=n+1;++h)a[h]=new yn(0,0,0);return a}(s,e,t,i,n);return function X3(s){const e=s.length,t=[],i=[];for(let r=0;r<e;++r){const a=s[r];t[r]=new Z(a.x,a.y,a.z),i[r]=a.w}const n=[];for(let r=0;r<e;++r){const a=t[r].clone();for(let o=1;o<=r;++o)a.sub(n[r-o].clone().multiplyScalar(Z3(r,o)*i[o]));n[r]=a.divideScalar(i[0])}return n}(r)}(this.degree,this.knots,this.controlPoints,this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),1);return i.copy(r[1]).normalize(),i}}let $i,As,Lr;class K3 extends ql{constructor(e){super(e)}load(e,t,i,n){const r=this,a=""===r.path?$l.extractUrlBase(e):r.path,o=new io(this.manager);o.setPath(r.path),o.setResponseType("arraybuffer"),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,function(l){try{t(r.parse(l,a))}catch(c){n?n(c):console.error(c),r.manager.itemError(e)}},i,n)}parse(e,t){if(function nN(s){const e="Kaydara FBX Binary  \0";return s.byteLength>=21&&e===pC(s,0,21)}(e))$i=(new iN).parse(e);else{const n=pC(e);if(!function sN(s){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let t=0;function i(n){const r=s[n-1];return s=s.slice(t+n),t++,r}for(let n=0;n<e.length;++n)if(i(1)===e[n])return!1;return!0}(n))throw new Error("THREE.FBXLoader: Unknown format.");if(hC(n)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+hC(n));$i=(new tN).parse(n)}const i=new iT(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new J3(i,this.manager).parse($i)}}class J3{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){As=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),i=this.parseMaterials(t),n=this.parseDeformers(),r=(new Q3).parse(n);return this.parseScene(n,r,i),Lr}parseConnections(){const e=new Map;return"Connections"in $i&&$i.Connections.connections.forEach(function(i){const n=i[0],r=i[1],a=i[2];e.has(n)||e.set(n,{parents:[],children:[]});const o={ID:r,relationship:a};e.get(n).parents.push(o),e.has(r)||e.set(r,{parents:[],children:[]});const l={ID:n,relationship:a};e.get(r).children.push(l)}),e}parseImages(){const e={},t={};if("Video"in $i.Objects){const i=$i.Objects.Video;for(const n in i){const r=i[n];if(e[parseInt(n)]=r.RelativeFilename||r.Filename,"Content"in r&&(r.Content instanceof ArrayBuffer&&r.Content.byteLength>0||"string"==typeof r.Content&&""!==r.Content)){const c=this.parseImage(i[n]);t[r.RelativeFilename||r.Filename]=c}}}for(const i in e){const n=e[i];e[i]=void 0!==t[n]?t[n]:e[i].split("\\").pop()}return e}parseImage(e){const t=e.Content,i=e.RelativeFilename||e.Filename,n=i.slice(i.lastIndexOf(".")+1).toLowerCase();let r;switch(n){case"bmp":r="image/bmp";break;case"jpg":case"jpeg":r="image/jpeg";break;case"png":r="image/png";break;case"tif":r="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",i),r="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+n+'" is not supported.')}if("string"==typeof t)return"data:"+r+";base64,"+t;{const a=new Uint8Array(t);return window.URL.createObjectURL(new Blob([a],{type:r}))}}parseTextures(e){const t=new Map;if("Texture"in $i.Objects){const i=$i.Objects.Texture;for(const n in i){const r=this.parseTexture(i[n],e);t.set(parseInt(n),r)}}return t}parseTexture(e,t){const i=this.loadTexture(e,t);i.ID=e.id,i.name=e.attrName;const n=e.WrapModeU,r=e.WrapModeV,o=void 0!==r?r.value:0;if(i.wrapS=0===(void 0!==n?n.value:0)?el:ar,i.wrapT=0===o?el:ar,"Scaling"in e){const l=e.Scaling.value;i.repeat.x=l[0],i.repeat.y=l[1]}if("Translation"in e){const l=e.Translation.value;i.offset.x=l[0],i.offset.y=l[1]}return i}loadTexture(e,t){let i;const n=this.textureLoader.path,r=As.get(e.id).children;let a;void 0!==r&&r.length>0&&void 0!==t[r[0].ID]&&(i=t[r[0].ID],(0===i.indexOf("blob:")||0===i.indexOf("data:"))&&this.textureLoader.setPath(void 0));const o=e.FileName.slice(-3).toLowerCase();if("tga"===o){const l=this.manager.getHandler(".tga");null===l?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),a=new Kr):(l.setPath(this.textureLoader.path),a=l.load(i))}else if("dds"===o){const l=this.manager.getHandler(".dds");null===l?(console.warn("FBXLoader: DDS loader not found, creating placeholder texture for",e.RelativeFilename),a=new Kr):(l.setPath(this.textureLoader.path),a=l.load(i))}else"psd"===o?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),a=new Kr):a=this.textureLoader.load(i);return this.textureLoader.setPath(n),a}parseMaterials(e){const t=new Map;if("Material"in $i.Objects){const i=$i.Objects.Material;for(const n in i){const r=this.parseMaterial(i[n],e);null!==r&&t.set(parseInt(n),r)}}return t}parseMaterial(e,t){const i=e.id,n=e.attrName;let r=e.ShadingModel;if("object"==typeof r&&(r=r.value),!As.has(i))return null;const a=this.parseParameters(e,t,i);let o;switch(r.toLowerCase()){case"phong":o=new Mg;break;case"lambert":o=new $M;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',r),o=new Mg}return o.setValues(a),o.name=n,o}parseParameters(e,t,i){const n={};e.BumpFactor&&(n.bumpScale=e.BumpFactor.value),e.Diffuse?n.color=(new xt).fromArray(e.Diffuse.value).convertSRGBToLinear():e.DiffuseColor&&("Color"===e.DiffuseColor.type||"ColorRGB"===e.DiffuseColor.type)&&(n.color=(new xt).fromArray(e.DiffuseColor.value).convertSRGBToLinear()),e.DisplacementFactor&&(n.displacementScale=e.DisplacementFactor.value),e.Emissive?n.emissive=(new xt).fromArray(e.Emissive.value).convertSRGBToLinear():e.EmissiveColor&&("Color"===e.EmissiveColor.type||"ColorRGB"===e.EmissiveColor.type)&&(n.emissive=(new xt).fromArray(e.EmissiveColor.value).convertSRGBToLinear()),e.EmissiveFactor&&(n.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(n.opacity=parseFloat(e.Opacity.value)),n.opacity<1&&(n.transparent=!0),e.ReflectionFactor&&(n.reflectivity=e.ReflectionFactor.value),e.Shininess&&(n.shininess=e.Shininess.value),e.Specular?n.specular=(new xt).fromArray(e.Specular.value).convertSRGBToLinear():e.SpecularColor&&"Color"===e.SpecularColor.type&&(n.specular=(new xt).fromArray(e.SpecularColor.value).convertSRGBToLinear());const r=this;return As.get(i).children.forEach(function(a){const o=a.relationship;switch(o){case"Bump":n.bumpMap=r.getTexture(t,a.ID);break;case"Maya|TEX_ao_map":n.aoMap=r.getTexture(t,a.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":n.map=r.getTexture(t,a.ID),void 0!==n.map&&(n.map.colorSpace=Un);break;case"DisplacementColor":n.displacementMap=r.getTexture(t,a.ID);break;case"EmissiveColor":n.emissiveMap=r.getTexture(t,a.ID),void 0!==n.emissiveMap&&(n.emissiveMap.colorSpace=Un);break;case"NormalMap":case"Maya|TEX_normal_map":n.normalMap=r.getTexture(t,a.ID);break;case"ReflectionColor":n.envMap=r.getTexture(t,a.ID),void 0!==n.envMap&&(n.envMap.mapping=303,n.envMap.colorSpace=Un);break;case"SpecularColor":n.specularMap=r.getTexture(t,a.ID),void 0!==n.specularMap&&(n.specularMap.colorSpace=Un);break;case"TransparentColor":case"TransparencyFactor":n.alphaMap=r.getTexture(t,a.ID),n.transparent=!0;break;default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",o)}}),n}getTexture(e,t){return"LayeredTexture"in $i.Objects&&t in $i.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=As.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in $i.Objects){const i=$i.Objects.Deformer;for(const n in i){const r=i[n],a=As.get(parseInt(n));if("Skin"===r.attrType){const o=this.parseSkeleton(a,i);o.ID=n,a.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),o.geometryID=a.parents[0].ID,e[n]=o}else if("BlendShape"===r.attrType){const o={id:n};o.rawTargets=this.parseMorphTargets(a,i),o.id=n,a.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[n]=o}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const i=[];return e.children.forEach(function(n){const r=t[n.ID];if("Cluster"!==r.attrType)return;const a={ID:n.ID,indices:[],weights:[],transformLink:(new Ut).fromArray(r.TransformLink.a)};"Indexes"in r&&(a.indices=r.Indexes.a,a.weights=r.Weights.a),i.push(a)}),{rawBones:i,bones:[]}}parseMorphTargets(e,t){const i=[];for(let n=0;n<e.children.length;n++){const r=e.children[n],a=t[r.ID],o={name:a.attrName,initialWeight:a.DeformPercent,id:a.id,fullWeights:a.FullWeights.a};if("BlendShapeChannel"!==a.attrType)return;o.geoID=As.get(parseInt(r.ID)).children.filter(function(l){return void 0===l.relationship})[0].ID,i.push(o)}return i}parseScene(e,t,i){Lr=new Do;const n=this.parseModels(e.skeletons,t,i),r=$i.Objects.Model,a=this;n.forEach(function(l){a.setLookAtProperties(l,r[l.ID]),As.get(l.ID).parents.forEach(function(u){const m=n.get(u.ID);void 0!==m&&m.add(l)}),null===l.parent&&Lr.add(l)}),this.bindSkeleton(e.skeletons,t,n),this.addGlobalSceneSettings(),Lr.traverse(function(l){if(l.userData.transformData){l.parent&&(l.userData.transformData.parentMatrix=l.parent.matrix,l.userData.transformData.parentMatrixWorld=l.parent.matrixWorld);const c=uC(l.userData.transformData);l.applyMatrix4(c),l.updateWorldMatrix()}});const o=(new eN).parse();1===Lr.children.length&&Lr.children[0].isGroup&&(Lr.children[0].animations=o,Lr=Lr.children[0]),Lr.animations=o}parseModels(e,t,i){const n=new Map,r=$i.Objects.Model;for(const a in r){const o=parseInt(a),l=r[a],c=As.get(o);let h=this.buildSkeleton(c,e,o,l.attrName);if(!h){switch(l.attrType){case"Camera":h=this.createCamera(c);break;case"Light":h=this.createLight(c);break;case"Mesh":h=this.createMesh(c,t,i);break;case"NurbsCurve":h=this.createCurve(c,t);break;case"LimbNode":case"Root":h=new _m;break;default:h=new Do}h.name=l.attrName?En.sanitizeNodeName(l.attrName):"",h.userData.originalName=l.attrName,h.ID=o}this.getTransformData(h,l),n.set(o,h)}return n}buildSkeleton(e,t,i,n){let r=null;return e.parents.forEach(function(a){for(const o in t){const l=t[o];l.rawBones.forEach(function(c,h){if(c.ID===a.ID){const u=r;r=new _m,r.matrixWorld.copy(c.transformLink),r.name=n?En.sanitizeNodeName(n):"",r.userData.originalName=n,r.ID=i,l.bones[h]=r,null!==u&&r.add(u)}})}}),r}createCamera(e){let t,i;if(e.children.forEach(function(n){const r=$i.Objects.NodeAttribute[n.ID];void 0!==r&&(i=r)}),void 0===i)t=new Qn;else{let n=0;void 0!==i.CameraProjectionType&&1===i.CameraProjectionType.value&&(n=1);let r=1;void 0!==i.NearPlane&&(r=i.NearPlane.value/1e3);let a=1e3;void 0!==i.FarPlane&&(a=i.FarPlane.value/1e3);let o=window.innerWidth,l=window.innerHeight;void 0!==i.AspectWidth&&void 0!==i.AspectHeight&&(o=i.AspectWidth.value,l=i.AspectHeight.value);const c=o/l;let h=45;void 0!==i.FieldOfView&&(h=i.FieldOfView.value);const u=i.FocalLength?i.FocalLength.value:null;switch(n){case 0:t=new Qs(h,c,r,a),null!==u&&t.setFocalLength(u);break;case 1:t=new mm(-o/2,o/2,l/2,-l/2,r,a);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+n+"."),t=new Qn}}return t}createLight(e){let t,i;if(e.children.forEach(function(n){const r=$i.Objects.NodeAttribute[n.ID];void 0!==r&&(i=r)}),void 0===i)t=new Qn;else{let n;n=void 0===i.LightType?0:i.LightType.value;let r=16777215;void 0!==i.Color&&(r=(new xt).fromArray(i.Color.value).convertSRGBToLinear());let a=void 0===i.Intensity?1:i.Intensity.value/100;void 0!==i.CastLightOnObject&&0===i.CastLightOnObject.value&&(a=0);let o=0;void 0!==i.FarAttenuationEnd&&(o=void 0!==i.EnableFarAttenuation&&0===i.EnableFarAttenuation.value?0:i.FarAttenuationEnd.value);const l=1;switch(n){case 0:t=new Am(r,a,o,l);break;case 1:t=new Eg(r,a);break;case 2:let c=Math.PI/3;void 0!==i.InnerAngle&&(c=br_degToRad(i.InnerAngle.value));let h=0;void 0!==i.OuterAngle&&(h=br_degToRad(i.OuterAngle.value),h=Math.max(h,1)),t=new Dg(r,a,o,c,h,l);break;default:console.warn("THREE.FBXLoader: Unknown light type "+i.LightType.value+", defaulting to a PointLight."),t=new Am(r,a)}void 0!==i.CastShadows&&1===i.CastShadows.value&&(t.castShadow=!0)}return t}createMesh(e,t,i){let n,r=null,a=null;const o=[];return e.children.forEach(function(l){t.has(l.ID)&&(r=t.get(l.ID)),i.has(l.ID)&&o.push(i.get(l.ID))}),o.length>1?a=o:o.length>0?a=o[0]:(a=new Mg({name:ql.DEFAULT_MATERIAL_NAME,color:13421772}),o.push(a)),"color"in r.attributes&&o.forEach(function(l){l.vertexColors=!0}),r.FBX_Deformer?(n=new Kv(r,a),n.normalizeSkinWeights()):n=new Js(r,a),n}createCurve(e,t){const i=e.children.reduce(function(r,a){return t.has(a.ID)&&(r=t.get(a.ID)),r},null),n=new Ir({name:ql.DEFAULT_MATERIAL_NAME,color:3342591,linewidth:1});return new Zl(i,n)}getTransformData(e,t){const i={};"InheritType"in t&&(i.inheritType=parseInt(t.InheritType.value)),i.eulerOrder="RotationOrder"in t?mC(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(i.translation=t.Lcl_Translation.value),"PreRotation"in t&&(i.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(i.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(i.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(i.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(i.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(i.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(i.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(i.rotationPivot=t.RotationPivot.value),e.userData.transformData=i}setLookAtProperties(e,t){"LookAtProperty"in t&&As.get(e.ID).children.forEach(function(n){if("LookAtProperty"===n.relationship){const r=$i.Objects.Model[n.ID];if("Lcl_Translation"in r){const a=r.Lcl_Translation.value;void 0!==e.target?(e.target.position.fromArray(a),Lr.add(e.target)):e.lookAt((new Z).fromArray(a))}}})}bindSkeleton(e,t,i){const n=this.parsePoseNodes();for(const r in e){const a=e[r];As.get(parseInt(a.ID)).parents.forEach(function(l){t.has(l.ID)&&As.get(l.ID).parents.forEach(function(u){i.has(u.ID)&&i.get(u.ID).bind(new bm(a.bones),n[u.ID])})})}}parsePoseNodes(){const e={};if("Pose"in $i.Objects){const t=$i.Objects.Pose;for(const i in t)if("BindPose"===t[i].attrType&&t[i].NbPoseNodes>0){const n=t[i].PoseNode;Array.isArray(n)?n.forEach(function(r){e[r.Node]=(new Ut).fromArray(r.Matrix.a)}):e[n.Node]=(new Ut).fromArray(n.Matrix.a)}}return e}addGlobalSceneSettings(){if("GlobalSettings"in $i){if("AmbientColor"in $i.GlobalSettings){const e=$i.GlobalSettings.AmbientColor.value,t=e[0],i=e[1],n=e[2];if(0!==t||0!==i||0!==n){const r=new xt(t,i,n).convertSRGBToLinear();Lr.add(new A0(r,1))}}"UnitScaleFactor"in $i.GlobalSettings&&(Lr.userData.unitScaleFactor=$i.GlobalSettings.UnitScaleFactor.value)}}}class Q3{constructor(){this.negativeMaterialIndices=!1}parse(e){const t=new Map;if("Geometry"in $i.Objects){const i=$i.Objects.Geometry;for(const n in i){const r=As.get(parseInt(n)),a=this.parseGeometry(r,i[n],e);t.set(parseInt(n),a)}}return!0===this.negativeMaterialIndices&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),t}parseGeometry(e,t,i){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,i);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,i){const n=i.skeletons,r=[],a=e.parents.map(function(u){return $i.Objects.Model[u.ID]});if(0===a.length)return;const o=e.children.reduce(function(u,m){return void 0!==n[m.ID]&&(u=n[m.ID]),u},null);e.children.forEach(function(u){void 0!==i.morphTargets[u.ID]&&r.push(i.morphTargets[u.ID])});const l=a[0],c={};"RotationOrder"in l&&(c.eulerOrder=mC(l.RotationOrder.value)),"InheritType"in l&&(c.inheritType=parseInt(l.InheritType.value)),"GeometricTranslation"in l&&(c.translation=l.GeometricTranslation.value),"GeometricRotation"in l&&(c.rotation=l.GeometricRotation.value),"GeometricScaling"in l&&(c.scale=l.GeometricScaling.value);const h=uC(c);return this.genGeometry(t,o,r,h)}genGeometry(e,t,i,n){const r=new Ui;e.attrName&&(r.name=e.attrName);const a=this.parseGeoNode(e,t),o=this.genBuffers(a),l=new Xt(o.vertex,3);if(l.applyMatrix4(n),r.setAttribute("position",l),o.colors.length>0&&r.setAttribute("color",new Xt(o.colors,3)),t&&(r.setAttribute("skinIndex",new Ov(o.weightsIndices,4)),r.setAttribute("skinWeight",new Xt(o.vertexWeights,4)),r.FBX_Deformer=t),o.normal.length>0){const c=(new Xi).getNormalMatrix(n),h=new Xt(o.normal,3);h.applyNormalMatrix(c),r.setAttribute("normal",h)}if(o.uvs.forEach(function(c,h){r.setAttribute(0===h?"uv":`uv${h}`,new Xt(o.uvs[h],2))}),a.material&&"AllSame"!==a.material.mappingType){let c=o.materialIndex[0],h=0;if(o.materialIndex.forEach(function(u,m){u!==c&&(r.addGroup(h,m-h,c),c=u,h=m)}),r.groups.length>0){const u=r.groups[r.groups.length-1],m=u.start+u.count;m!==o.materialIndex.length&&r.addGroup(m,o.materialIndex.length-m,c)}0===r.groups.length&&r.addGroup(0,o.materialIndex.length,o.materialIndex[0])}return this.addMorphTargets(r,e,i,n),r}parseGeoNode(e,t){const i={};if(i.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],i.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(i.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(i.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(i.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){i.uv=[];let n=0;for(;e.LayerElementUV[n];)e.LayerElementUV[n].UV&&i.uv.push(this.parseUVs(e.LayerElementUV[n])),n++}return i.weightTable={},null!==t&&(i.skeleton=t,t.rawBones.forEach(function(n,r){n.indices.forEach(function(a,o){void 0===i.weightTable[a]&&(i.weightTable[a]=[]),i.weightTable[a].push({id:r,weight:n.weights[o]})})})),i}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let i=0,n=0,r=!1,a=[],o=[],l=[],c=[],h=[],u=[];const m=this;return e.vertexIndices.forEach(function(p,_){let g,f=!1;p<0&&(p^=-1,f=!0);let b=[],C=[];if(a.push(3*p,3*p+1,3*p+2),e.color){const M=Kg(_,i,p,e.color);l.push(M[0],M[1],M[2])}if(e.skeleton){if(void 0!==e.weightTable[p]&&e.weightTable[p].forEach(function(M){C.push(M.weight),b.push(M.id)}),C.length>4){r||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),r=!0);const M=[0,0,0,0],E=[0,0,0,0];C.forEach(function(S,P){let I=S,L=b[P];E.forEach(function(O,B,Q){if(I>O){Q[B]=I,I=O;const pe=M[B];M[B]=L,L=pe}})}),b=M,C=E}for(;C.length<4;)C.push(0),b.push(0);for(let M=0;M<4;++M)h.push(C[M]),u.push(b[M])}if(e.normal){const M=Kg(_,i,p,e.normal);o.push(M[0],M[1],M[2])}e.material&&"AllSame"!==e.material.mappingType&&(g=Kg(_,i,p,e.material)[0],g<0&&(m.negativeMaterialIndices=!0,g=0)),e.uv&&e.uv.forEach(function(M,E){const S=Kg(_,i,p,M);void 0===c[E]&&(c[E]=[]),c[E].push(S[0]),c[E].push(S[1])}),n++,f&&(m.genFace(t,e,a,g,o,l,c,h,u,n),i++,n=0,a=[],o=[],l=[],c=[],h=[],u=[])}),t}getNormalNewell(e){const t=new Z(0,0,0);for(let i=0;i<e.length;i++){const n=e[i],r=e[(i+1)%e.length];t.x+=(n.y-r.y)*(n.z+r.z),t.y+=(n.z-r.z)*(n.x+r.x),t.z+=(n.x-r.x)*(n.y+r.y)}return t.normalize(),t}getNormalTangentAndBitangent(e){const t=this.getNormalNewell(e),n=(Math.abs(t.z)>.5?new Z(0,1,0):new Z(0,0,1)).cross(t).normalize(),r=t.clone().cross(n).normalize();return{normal:t,tangent:n,bitangent:r}}flattenVertex(e,t,i){return new Xe(e.dot(t),e.dot(i))}genFace(e,t,i,n,r,a,o,l,c,h){let u;if(h>3){const m=[];for(let f=0;f<i.length;f+=3)m.push(new Z(t.vertexPositions[i[f]],t.vertexPositions[i[f+1]],t.vertexPositions[i[f+2]]));const{tangent:p,bitangent:_}=this.getNormalTangentAndBitangent(m),g=[];for(const f of m)g.push(this.flattenVertex(f,p,_));u=Eo.triangulateShape(g,[])}else u=[[0,1,2]];for(const[m,p,_]of u)e.vertex.push(t.vertexPositions[i[3*m]]),e.vertex.push(t.vertexPositions[i[3*m+1]]),e.vertex.push(t.vertexPositions[i[3*m+2]]),e.vertex.push(t.vertexPositions[i[3*p]]),e.vertex.push(t.vertexPositions[i[3*p+1]]),e.vertex.push(t.vertexPositions[i[3*p+2]]),e.vertex.push(t.vertexPositions[i[3*_]]),e.vertex.push(t.vertexPositions[i[3*_+1]]),e.vertex.push(t.vertexPositions[i[3*_+2]]),t.skeleton&&(e.vertexWeights.push(l[4*m]),e.vertexWeights.push(l[4*m+1]),e.vertexWeights.push(l[4*m+2]),e.vertexWeights.push(l[4*m+3]),e.vertexWeights.push(l[4*p]),e.vertexWeights.push(l[4*p+1]),e.vertexWeights.push(l[4*p+2]),e.vertexWeights.push(l[4*p+3]),e.vertexWeights.push(l[4*_]),e.vertexWeights.push(l[4*_+1]),e.vertexWeights.push(l[4*_+2]),e.vertexWeights.push(l[4*_+3]),e.weightsIndices.push(c[4*m]),e.weightsIndices.push(c[4*m+1]),e.weightsIndices.push(c[4*m+2]),e.weightsIndices.push(c[4*m+3]),e.weightsIndices.push(c[4*p]),e.weightsIndices.push(c[4*p+1]),e.weightsIndices.push(c[4*p+2]),e.weightsIndices.push(c[4*p+3]),e.weightsIndices.push(c[4*_]),e.weightsIndices.push(c[4*_+1]),e.weightsIndices.push(c[4*_+2]),e.weightsIndices.push(c[4*_+3])),t.color&&(e.colors.push(a[3*m]),e.colors.push(a[3*m+1]),e.colors.push(a[3*m+2]),e.colors.push(a[3*p]),e.colors.push(a[3*p+1]),e.colors.push(a[3*p+2]),e.colors.push(a[3*_]),e.colors.push(a[3*_+1]),e.colors.push(a[3*_+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(n),e.materialIndex.push(n),e.materialIndex.push(n)),t.normal&&(e.normal.push(r[3*m]),e.normal.push(r[3*m+1]),e.normal.push(r[3*m+2]),e.normal.push(r[3*p]),e.normal.push(r[3*p+1]),e.normal.push(r[3*p+2]),e.normal.push(r[3*_]),e.normal.push(r[3*_+1]),e.normal.push(r[3*_+2])),t.uv&&t.uv.forEach(function(g,f){void 0===e.uvs[f]&&(e.uvs[f]=[]),e.uvs[f].push(o[f][2*m]),e.uvs[f].push(o[f][2*m+1]),e.uvs[f].push(o[f][2*p]),e.uvs[f].push(o[f][2*p+1]),e.uvs[f].push(o[f][2*_]),e.uvs[f].push(o[f][2*_+1])})}addMorphTargets(e,t,i,n){if(0===i.length)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const r=this;i.forEach(function(a){a.rawTargets.forEach(function(o){const l=$i.Objects.Geometry[o.geoID];void 0!==l&&r.genMorphGeometry(e,t,l,n,o.name)})})}genMorphGeometry(e,t,i,n,r){const a=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],o=void 0!==i.Vertices?i.Vertices.a:[],l=void 0!==i.Indexes?i.Indexes.a:[],h=new Float32Array(3*e.attributes.position.count);for(let _=0;_<l.length;_++){const g=3*l[_];h[g]=o[3*_],h[g+1]=o[3*_+1],h[g+2]=o[3*_+2]}const m=this.genBuffers({vertexIndices:a,vertexPositions:h}),p=new Xt(m.vertex,3);p.name=r||i.attrName,p.applyMatrix4(n),e.morphAttributes.position.push(p)}parseNormals(e){const i=e.ReferenceInformationType;let r=[];return"IndexToDirect"===i&&("NormalIndex"in e?r=e.NormalIndex.a:"NormalsIndex"in e&&(r=e.NormalsIndex.a)),{dataSize:3,buffer:e.Normals.a,indices:r,mappingType:e.MappingInformationType,referenceType:i}}parseUVs(e){const i=e.ReferenceInformationType;let r=[];return"IndexToDirect"===i&&(r=e.UVIndex.a),{dataSize:2,buffer:e.UV.a,indices:r,mappingType:e.MappingInformationType,referenceType:i}}parseVertexColors(e){const t=e.MappingInformationType,i=e.ReferenceInformationType,n=e.Colors.a;let r=[];"IndexToDirect"===i&&(r=e.ColorIndex.a);for(let a=0,o=new xt;a<n.length;a+=4)o.fromArray(n,a).convertSRGBToLinear().toArray(n,a);return{dataSize:4,buffer:n,indices:r,mappingType:t,referenceType:i}}parseMaterialIndices(e){const t=e.MappingInformationType,i=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:i};const n=e.Materials.a,r=[];for(let a=0;a<n.length;++a)r.push(a);return{dataSize:1,buffer:n,indices:r,mappingType:t,referenceType:i}}parseNurbsGeometry(e){const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new Ui;const i=t-1,n=e.KnotVector.a,r=[],a=e.Points.a;for(let u=0,m=a.length;u<m;u+=4)r.push((new yn).fromArray(a,u));let o,l;if("Closed"===e.Form)r.push(r[0]);else if("Periodic"===e.Form){o=i,l=n.length-1-o;for(let u=0;u<i;++u)r.push(r[u])}const h=new $3(i,n,r,o,l).getPoints(12*r.length);return(new Ui).setFromPoints(h)}}class eN{parse(){const e=[],t=this.parseClips();if(void 0!==t)for(const i in t){const r=this.addClip(t[i]);e.push(r)}return e}parseClips(){if(void 0===$i.Objects.AnimationCurve)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=$i.Objects.AnimationCurveNode,t=new Map;for(const i in e){const n=e[i];if(null!==n.attrName.match(/S|R|T|DeformPercent/)){const r={id:n.id,attr:n.attrName,curves:{}};t.set(r.id,r)}}return t}parseAnimationCurves(e){const t=$i.Objects.AnimationCurve;for(const i in t){const n={id:t[i].id,times:t[i].KeyTime.a.map(rN),values:t[i].KeyValueFloat.a},r=As.get(n.id);if(void 0!==r){const a=r.parents[0].ID,o=r.parents[0].relationship;o.match(/X/)?e.get(a).curves.x=n:o.match(/Y/)?e.get(a).curves.y=n:o.match(/Z/)?e.get(a).curves.z=n:o.match(/DeformPercent/)&&e.has(a)&&(e.get(a).curves.morph=n)}}}parseAnimationLayers(e){const t=$i.Objects.AnimationLayer,i=new Map;for(const n in t){const r=[],a=As.get(parseInt(n));void 0!==a&&(a.children.forEach(function(l,c){if(e.has(l.ID)){const h=e.get(l.ID);if(void 0!==h.curves.x||void 0!==h.curves.y||void 0!==h.curves.z){if(void 0===r[c]){const u=As.get(l.ID).parents.filter(function(m){return void 0!==m.relationship})[0].ID;if(void 0!==u){const m=$i.Objects.Model[u.toString()];if(void 0===m)return void console.warn("THREE.FBXLoader: Encountered a unused curve.",l);const p={modelName:m.attrName?En.sanitizeNodeName(m.attrName):"",ID:m.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};Lr.traverse(function(_){_.ID===m.id&&(p.transform=_.matrix,_.userData.transformData&&(p.eulerOrder=_.userData.transformData.eulerOrder))}),p.transform||(p.transform=new Ut),"PreRotation"in m&&(p.preRotation=m.PreRotation.value),"PostRotation"in m&&(p.postRotation=m.PostRotation.value),r[c]=p}}r[c]&&(r[c][h.attr]=h)}else if(void 0!==h.curves.morph){if(void 0===r[c]){const u=As.get(l.ID).parents.filter(function(b){return void 0!==b.relationship})[0].ID,m=As.get(u).parents[0].ID,p=As.get(m).parents[0].ID,_=As.get(p).parents[0].ID,g=$i.Objects.Model[_],f={modelName:g.attrName?En.sanitizeNodeName(g.attrName):"",morphName:$i.Objects.Deformer[u].attrName};r[c]=f}r[c][h.attr]=h}}}),i.set(parseInt(n),r))}return i}parseAnimStacks(e){const t=$i.Objects.AnimationStack,i={};for(const n in t){const r=As.get(parseInt(n)).children;r.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const a=e.get(r[0].ID);i[n]={name:t[n].attrName,layer:a}}return i}addClip(e){let t=[];const i=this;return e.layer.forEach(function(n){t=t.concat(i.generateTracks(n))}),new Zh(e.name,-1,t)}generateTracks(e){const t=[];let i=new Z,n=new Z;if(e.transform&&e.transform.decompose(i,new Jn,n),i=i.toArray(),n=n.toArray(),void 0!==e.T&&Object.keys(e.T.curves).length>0){const r=this.generateVectorTrack(e.modelName,e.T.curves,i,"position");void 0!==r&&t.push(r)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){const r=this.generateRotationTrack(e.modelName,e.R.curves,e.preRotation,e.postRotation,e.eulerOrder);void 0!==r&&t.push(r)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){const r=this.generateVectorTrack(e.modelName,e.S.curves,n,"scale");void 0!==r&&t.push(r)}if(void 0!==e.DeformPercent){const r=this.generateMorphTrack(e);void 0!==r&&t.push(r)}return t}generateVectorTrack(e,t,i,n){const r=this.getTimesForAllAxes(t),a=this.getKeyframeTrackValues(r,t,i);return new od(e+"."+n,r,a)}generateRotationTrack(e,t,i,n,r){let a,o;if(void 0!==t.x&&void 0!==t.y&&void 0!==t.z){const u=this.interpolateRotations(t.x,t.y,t.z,r);a=u[0],o=u[1]}void 0!==i&&((i=i.map(br_degToRad)).push(r),i=(new Qa).fromArray(i),i=(new Jn).setFromEuler(i)),void 0!==n&&((n=n.map(br_degToRad)).push(r),n=(new Qa).fromArray(n),n=(new Jn).setFromEuler(n).invert());const l=new Jn,c=new Qa,h=[];if(!o||!a)return new ll(e+".quaternion",[],[]);for(let u=0;u<o.length;u+=3)c.set(o[u],o[u+1],o[u+2],r),l.setFromEuler(c),void 0!==i&&l.premultiply(i),void 0!==n&&l.multiply(n),u>2&&(new Jn).fromArray(h,(u-3)/3*4).dot(l)<0&&l.set(-l.x,-l.y,-l.z,-l.w),l.toArray(h,u/3*4);return new ll(e+".quaternion",a,h)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,i=t.values.map(function(r){return r/100}),n=Lr.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new ad(e.modelName+".morphTargetInfluences["+n+"]",t.times,i)}getTimesForAllAxes(e){let t=[];if(void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort(function(i,n){return i-n}),t.length>1){let i=1,n=t[0];for(let r=1;r<t.length;r++){const a=t[r];a!==n&&(t[i]=a,n=a,i++)}t=t.slice(0,i)}return t}getKeyframeTrackValues(e,t,i){const n=i,r=[];let a=-1,o=-1,l=-1;return e.forEach(function(c){if(t.x&&(a=t.x.times.indexOf(c)),t.y&&(o=t.y.times.indexOf(c)),t.z&&(l=t.z.times.indexOf(c)),-1!==a){const h=t.x.values[a];r.push(h),n[0]=h}else r.push(n[0]);if(-1!==o){const h=t.y.values[o];r.push(h),n[1]=h}else r.push(n[1]);if(-1!==l){const h=t.z.values[l];r.push(h),n[2]=h}else r.push(n[2])}),r}interpolateRotations(e,t,i,n){const r=[],a=[];r.push(e.times[0]),a.push(br_degToRad(e.values[0])),a.push(br_degToRad(t.values[0])),a.push(br_degToRad(i.values[0]));for(let o=1;o<e.values.length;o++){const l=[e.values[o-1],t.values[o-1],i.values[o-1]];if(isNaN(l[0])||isNaN(l[1])||isNaN(l[2]))continue;const c=l.map(br_degToRad),h=[e.values[o],t.values[o],i.values[o]];if(isNaN(h[0])||isNaN(h[1])||isNaN(h[2]))continue;const u=h.map(br_degToRad),m=[h[0]-l[0],h[1]-l[1],h[2]-l[2]],p=[Math.abs(m[0]),Math.abs(m[1]),Math.abs(m[2])];if(p[0]>=180||p[1]>=180||p[2]>=180){const g=Math.max(...p)/180,f=new Qa(...c,n),b=new Qa(...u,n),C=(new Jn).setFromEuler(f),M=(new Jn).setFromEuler(b);C.dot(M)&&M.set(-M.x,-M.y,-M.z,-M.w);const E=e.times[o-1],S=e.times[o]-E,P=new Jn,I=new Qa;for(let L=0;L<1;L+=1/g)P.copy(C.clone().slerp(M.clone(),L)),r.push(E+L*S),I.setFromQuaternion(P,n),a.push(I.x),a.push(I.y),a.push(I.z)}else r.push(e.times[o]),a.push(br_degToRad(e.values[o])),a.push(br_degToRad(t.values[o])),a.push(br_degToRad(i.values[o]))}return[r,a]}}class tN{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new dC,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,i=e.split(/[\r\n]+/);return i.forEach(function(n,r){const a=n.match(/^[\s\t]*;/),o=n.match(/^[\s\t]*$/);if(a||o)return;const l=n.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),c=n.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),h=n.match("^\\t{"+(t.currentIndent-1)+"}}");l?t.parseNodeBegin(n,l):c?t.parseNodeProperty(n,c,i[++r]):h?t.popStack():n.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(n)}),this.allNodes}parseNodeBegin(e,t){const i=t[1].trim().replace(/^"/,"").replace(/"$/,""),n=t[2].split(",").map(function(l){return l.trim().replace(/^"/,"").replace(/"$/,"")}),r={name:i},a=this.parseNodeAttr(n),o=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(i,r):i in o?("PoseNode"===i?o.PoseNode.push(r):void 0!==o[i].id&&(o[i]={},o[i][o[i].id]=o[i]),""!==a.id&&(o[i][a.id]=r)):"number"==typeof a.id?(o[i]={},o[i][a.id]=r):"Properties70"!==i&&(o[i]="PoseNode"===i?[r]:r),"number"==typeof a.id&&(r.id=a.id),""!==a.name&&(r.attrName=a.name),""!==a.type&&(r.attrType=a.type),this.pushStack(r)}parseNodeAttr(e){let t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let i="",n="";return e.length>1&&(i=e[1].replace(/^(\w+)::/,""),n=e[2]),{id:t,name:i,type:n}}parseNodeProperty(e,t,i){let n=t[1].replace(/^"/,"").replace(/"$/,"").trim(),r=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===n&&","===r&&(r=i.replace(/"/g,"").replace(/,$/,"").trim());const a=this.getCurrentNode();if("Properties70"!==a.name){if("C"===n){const l=r.split(",").slice(1),c=parseInt(l[0]),h=parseInt(l[1]);let u=r.split(",").slice(3);u=u.map(function(m){return m.trim().replace(/^"/,"")}),n="connections",r=[c,h],function oN(s,e){for(let t=0,i=s.length,n=e.length;t<n;t++,i++)s[i]=e[t]}(r,u),void 0===a[n]&&(a[n]=[])}"Node"===n&&(a.id=r),n in a&&Array.isArray(a[n])?a[n].push(r):"a"!==n?a[n]=r:a.a=r,this.setCurrentProp(a,n),"a"===n&&","!==r.slice(-1)&&(a.a=sy(r))}else this.parseNodeSpecialProperty(e,n,r)}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=sy(t.a))}parseNodeSpecialProperty(e,t,i){const n=i.split('",').map(function(h){return h.trim().replace(/^\"/,"").replace(/\s/,"_")}),r=n[0],a=n[1],o=n[2],l=n[3];let c=n[4];switch(a){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":c=parseFloat(c);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":c=sy(c)}this.getPrevNode()[r]={type:a,type2:o,flag:l,value:c},this.setCurrentProp(this.getPrevNode(),r)}}class iN{parse(e){const t=new cC(e);t.skip(23);const i=t.getUint32();if(i<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+i);const n=new dC;for(;!this.endOfContent(t);){const r=this.parseNode(t,i);null!==r&&n.add(r.name,r)}return n}endOfContent(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const i={},n=t>=7500?e.getUint64():e.getUint32(),r=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const a=e.getUint8(),o=e.getString(a);if(0===n)return null;const l=[];for(let m=0;m<r;m++)l.push(this.parseProperty(e));const c=l.length>0?l[0]:"",h=l.length>1?l[1]:"",u=l.length>2?l[2]:"";for(i.singleProperty=1===r&&e.getOffset()===n;n>e.getOffset();){const m=this.parseNode(e,t);null!==m&&this.parseSubNode(o,i,m)}return i.propertyList=l,"number"==typeof c&&(i.id=c),""!==h&&(i.attrName=h),""!==u&&(i.attrType=u),""!==o&&(i.name=o),i}parseSubNode(e,t,i){if(!0===i.singleProperty){const n=i.propertyList[0];Array.isArray(n)?(t[i.name]=i,i.a=n):t[i.name]=n}else if("Connections"===e&&"C"===i.name){const n=[];i.propertyList.forEach(function(r,a){0!==a&&n.push(r)}),void 0===t.connections&&(t.connections=[]),t.connections.push(n)}else if("Properties70"===i.name)Object.keys(i).forEach(function(r){t[r]=i[r]});else if("Properties70"===e&&"P"===i.name){let n=i.propertyList[0],r=i.propertyList[1];const a=i.propertyList[2],o=i.propertyList[3];let l;0===n.indexOf("Lcl ")&&(n=n.replace("Lcl ","Lcl_")),0===r.indexOf("Lcl ")&&(r=r.replace("Lcl ","Lcl_")),l="Color"===r||"ColorRGB"===r||"Vector"===r||"Vector3D"===r||0===r.indexOf("Lcl_")?[i.propertyList[4],i.propertyList[5],i.propertyList[6]]:i.propertyList[4],t[n]={type:r,type2:a,flag:o,value:l}}else void 0===t[i.name]?"number"==typeof i.id?(t[i.name]={},t[i.name][i.id]=i):t[i.name]=i:"PoseNode"===i.name?(Array.isArray(t[i.name])||(t[i.name]=[t[i.name]]),t[i.name].push(i)):void 0===t[i.name][i.id]&&(t[i.name][i.id]=i)}parseProperty(e){const t=e.getString(1);let i;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return i=e.getUint32(),e.getArrayBuffer(i);case"S":return i=e.getUint32(),e.getString(i);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const n=e.getUint32(),r=e.getUint32(),a=e.getUint32();if(0===r)switch(t){case"b":case"c":return e.getBooleanArray(n);case"d":return e.getFloat64Array(n);case"f":return e.getFloat32Array(n);case"i":return e.getInt32Array(n);case"l":return e.getInt64Array(n)}const o=function Zg(s,e){return Ng((function(s){if(8!=(15&s[0])||s[0]>>>4>7||(s[0]<<8|s[1])%31)throw"invalid zlib data";if(32&s[1])throw"invalid zlib data: preset dictionaries not supported"}(s),s.subarray(2,-4)),e)}(new Uint8Array(e.getArrayBuffer(a))),l=new cC(o.buffer);switch(t){case"b":case"c":return l.getBooleanArray(n);case"d":return l.getFloat64Array(n);case"f":return l.getFloat32Array(n);case"i":return l.getInt32Array(n);case"l":return l.getInt64Array(n)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class cC{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return 1==(1&this.getUint8())}getBooleanArray(e){const t=[];for(let i=0;i<e;i++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,e=4294967295&~e,4294967295===e&&(t=t+1&4294967295),e=e+1&4294967295,-(4294967296*t+e)):4294967296*t+e}getInt64Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){const t=this.offset;let i=new Uint8Array(this.dv.buffer,t,e);this.skip(e);const n=i.indexOf(0);return n>=0&&(i=new Uint8Array(this.dv.buffer,t,n)),this._textDecoder.decode(i)}}class dC{add(e,t){this[e]=t}}function hC(s){const t=s.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function rN(s){return s/46186158e3}const aN=[];function Kg(s,e,t,i){let n;switch(i.mappingType){case"ByPolygonVertex":n=s;break;case"ByPolygon":n=e;break;case"ByVertice":n=t;break;case"AllSame":n=i.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+i.mappingType)}"IndexToDirect"===i.referenceType&&(n=i.indices[n]);const r=n*i.dataSize;return function lN(s,e,t,i){for(let n=t,r=0;n<i;n++,r++)s[r]=e[n];return s}(aN,i.buffer,r,r+i.dataSize)}const ny=new Qa,eu=new Z;function uC(s){const e=new Ut,t=new Ut,i=new Ut,n=new Ut,r=new Ut,a=new Ut,o=new Ut,l=new Ut,c=new Ut,h=new Ut,u=new Ut,m=new Ut,p=s.inheritType?s.inheritType:0;if(s.translation&&e.setPosition(eu.fromArray(s.translation)),s.preRotation){const B=s.preRotation.map(br_degToRad);B.push(s.eulerOrder||Qa.DEFAULT_ORDER),t.makeRotationFromEuler(ny.fromArray(B))}if(s.rotation){const B=s.rotation.map(br_degToRad);B.push(s.eulerOrder||Qa.DEFAULT_ORDER),i.makeRotationFromEuler(ny.fromArray(B))}if(s.postRotation){const B=s.postRotation.map(br_degToRad);B.push(s.eulerOrder||Qa.DEFAULT_ORDER),n.makeRotationFromEuler(ny.fromArray(B)),n.invert()}s.scale&&r.scale(eu.fromArray(s.scale)),s.scalingOffset&&o.setPosition(eu.fromArray(s.scalingOffset)),s.scalingPivot&&a.setPosition(eu.fromArray(s.scalingPivot)),s.rotationOffset&&l.setPosition(eu.fromArray(s.rotationOffset)),s.rotationPivot&&c.setPosition(eu.fromArray(s.rotationPivot)),s.parentMatrixWorld&&(u.copy(s.parentMatrix),h.copy(s.parentMatrixWorld));const _=t.clone().multiply(i).multiply(n),g=new Ut;g.extractRotation(h);const f=new Ut;f.copyPosition(h);const b=f.clone().invert().multiply(h),C=g.clone().invert().multiply(b),M=r,E=new Ut;if(0===p)E.copy(g).multiply(_).multiply(C).multiply(M);else if(1===p)E.copy(g).multiply(C).multiply(_).multiply(M);else{const Q=(new Ut).scale((new Z).setFromMatrixScale(u)).clone().invert(),pe=C.clone().multiply(Q);E.copy(g).multiply(_).multiply(pe).multiply(M)}const S=c.clone().invert(),P=a.clone().invert();let I=e.clone().multiply(l).multiply(c).multiply(t).multiply(i).multiply(n).multiply(S).multiply(o).multiply(a).multiply(r).multiply(P);const L=(new Ut).copyPosition(I),O=h.clone().multiply(L);return m.copyPosition(O),I=m.clone().multiply(E),I.premultiply(h.invert()),I}function mC(s){const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(s=s||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[s]}function sy(s){return s.split(",").map(function(t){return parseFloat(t)})}function pC(s,e,t){return void 0===e&&(e=0),void 0===t&&(t=s.byteLength),(new TextDecoder).decode(new Uint8Array(s,e,t))}class cN{constructor(e){e&&(this.transmit=e)}load3DFile(e,t,i,n,r,a,o,l){this.transmit?.emit("page-loading",!0),".gltf"===t?(new $B).load(e,h=>{n.add(h),o&&o(h,l);const u=(new Vs).setFromObject(h),m=new Z;u.getSize(m),this.fixScale(h,m.x,m.y,m.z),r({width:m.x,height:m.y,length:m.z},{x:h.scale.x,y:h.scale.y,z:h.scale.z},{x:h.position.x,y:h.position.y,z:h.position.z},{x:h.rotation.x,y:h.rotation.y,z:h.rotation.z},h.id,l),this.transmit?.emit("page-loading",!1)},void 0,h=>{this.transmit?.emit("page-loading",!1),a(h,l)}):".fbx"===t?(new K3).load(e,h=>{n.add(h),o&&o(h,l);const u=(new Vs).setFromObject(h),m=new Z;u.getSize(m),this.fixScale(h,m.x,m.y,m.z),r({width:m.x,height:m.y,length:m.z},{x:h.scale.x,y:h.scale.y,z:h.scale.z},{x:h.position.x,y:h.position.y,z:h.position.z},{x:h.rotation.x,y:h.rotation.y,z:h.rotation.z},h.id,l),this.transmit?.emit("page-loading",!1)},void 0,h=>{this.transmit?.emit("page-loading",!1),a(h,l)}):(console.error(`Unsupported file format: ${t}`),this.transmit?.emit("page-loading",!1))}fixScale(e,t,i,n){const r=Math.max(t,i,n);if(r>1e3){const a=r/1e3;e.scale.divide(new Z(a,a,a))}}setModelConfig(e,t){return{id:e.id,file:t,position:{x:e.position.x,y:e.position.y,z:e.position.z},rotation:{x:e.rotation.x,y:e.rotation.y,z:e.rotation.z},scale:{x:e.scale.x,y:e.scale.y,z:e.scale.z}}}}class dN{constructor(e){this._lights=[],this._lightSettings=[],this._lightHelpers=[],this._scene=e}get scene(){return this._scene}addOrUpdateLight(e,t=!1){this.removeLight(e.id),e.id||(e.id="light_"+(new Date).getTime());const i=this.updateConfigs(e,t);i&&this._scene.add(i)}removeLight(e,t=!1){const i=this._lightSettings?.findIndex(n=>n.id===e)??-1;i<0||(this._lights[i]&&(this._lights[i].dispose(),this._scene.remove(this._lights[i])),this._lightHelpers[i]&&(this._lightHelpers[i].dispose(),this._scene.remove(this._lightHelpers[i])),t&&(this._lights.splice(i,1),this._lightSettings.splice(i,1),this._lightHelpers.splice(i,1)))}updateAllLights(e,t=!1){if(this._lights){for(let i=0;i<this._lights.length;i++)this.removeLight(this._lightSettings[i].id);this._lights=[]}for(const i of e){const n=this.updateConfigs(i,t);n&&this.scene.add(n)}}get lightsSettings(){return this._lightSettings}updateConfigs(e,t=!1){let i;const n=new xt("rgb(255, 0, 0)"),r=this._lightSettings?.findIndex(l=>l.id===e.id)??-1;let a;const o=new xt(e.color);switch(e.type){case"AmbientLight":a=new A0(o,e.intensity);break;case"DirectionalLight":if(a=new Eg(o,e.intensity),e.position&&a.position.set(e.position.x,e.position.y,e.position.z),e.target){const l=new Qn;l.position.set(e.target.x,e.target.y,e.target.z),this.scene.add(l),a.target=l}a.castShadow=!!e.castShadow,t&&(i=new XB(a,50,n),this.scene.add(i));break;case"PointLight":a=new Am(o,e.intensity),e.position&&a.position.set(e.position.x,e.position.y,e.position.z),t&&(i=new jB(a,50,n),this.scene.add(i)),a.castShadow=!!e.castShadow;break;case"SpotLight":if(a=new Dg(o,e.intensity),e.position&&a.position.set(e.position.x,e.position.y,e.position.z),e.target){const l=new Qn;l.position.set(e.target.x,e.target.y,e.target.z),this.scene.add(l),a.target=l}t&&(i=new YB(a,n),this.scene.add(i)),a.castShadow=!!e.castShadow;break;default:return void console.warn(`Unsupported light type: ${e.type}`)}return r>-1?(this._lights[r]=a,this._lightSettings[r]=e,this._lightHelpers[r]=i):(this._lights.push(a),this._lightSettings.push(e),this._lightHelpers.push(i)),a}}const fC={type:"change"},ry={type:"start"},gC={type:"end"},Jg=new bh,_C=new Yl,hN=Math.cos(70*br_DEG2RAD);class uN extends Yc{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new Z,this.cursor=new Z,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return o.phi},this.getAzimuthalAngle=function(){return o.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(de){de.addEventListener("keydown",nt),this._domElementKeyEvents=de},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",nt),this._domElementKeyEvents=null},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(fC),i.update(),r=n.NONE},this.update=function(){const de=new Z,at=(new Jn).setFromUnitVectors(e.up,new Z(0,1,0)),Pt=at.clone().invert(),yt=new Z,di=new Jn,nn=new Z,dn=2*Math.PI;return function(At=null){const ve=i.object.position;de.copy(ve).sub(i.target),de.applyQuaternion(at),o.setFromVector3(de),i.autoRotate&&r===n.NONE&&Q(function O(de){return null!==de?2*Math.PI/60*i.autoRotateSpeed*de:2*Math.PI/60/60*i.autoRotateSpeed}(At)),i.enableDamping?(o.theta+=l.theta*i.dampingFactor,o.phi+=l.phi*i.dampingFactor):(o.theta+=l.theta,o.phi+=l.phi);let Dt=i.minAzimuthAngle,Et=i.maxAzimuthAngle;isFinite(Dt)&&isFinite(Et)&&(Dt<-Math.PI?Dt+=dn:Dt>Math.PI&&(Dt-=dn),Et<-Math.PI?Et+=dn:Et>Math.PI&&(Et-=dn),o.theta=Dt<=Et?Math.max(Dt,Math.min(Et,o.theta)):o.theta>(Dt+Et)/2?Math.max(Dt,o.theta):Math.min(Et,o.theta)),o.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,o.phi)),o.makeSafe(),!0===i.enableDamping?i.target.addScaledVector(h,i.dampingFactor):i.target.add(h),i.target.sub(i.cursor),i.target.clampLength(i.minTargetRadius,i.maxTargetRadius),i.target.add(i.cursor),o.radius=re(i.zoomToCursor&&P||i.object.isOrthographicCamera?o.radius:o.radius*c),de.setFromSpherical(o),de.applyQuaternion(Pt),ve.copy(i.target).add(de),i.object.lookAt(i.target),!0===i.enableDamping?(l.theta*=1-i.dampingFactor,l.phi*=1-i.dampingFactor,h.multiplyScalar(1-i.dampingFactor)):(l.set(0,0,0),h.set(0,0,0));let Mi=!1;if(i.zoomToCursor&&P){let hi=null;if(i.object.isPerspectiveCamera){const xn=de.length();hi=re(xn*c),i.object.position.addScaledVector(E,xn-hi),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const xn=new Z(S.x,S.y,0);xn.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/c)),i.object.updateProjectionMatrix(),Mi=!0;const wn=new Z(S.x,S.y,0);wn.unproject(i.object),i.object.position.sub(wn).add(xn),i.object.updateMatrixWorld(),hi=de.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;null!==hi&&(this.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(hi).add(i.object.position):(Jg.origin.copy(i.object.position),Jg.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(Jg.direction))<hN?e.lookAt(i.target):(_C.setFromNormalAndCoplanarPoint(i.object.up,i.target),Jg.intersectPlane(_C,i.target))))}else i.object.isOrthographicCamera&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/c)),i.object.updateProjectionMatrix(),Mi=!0);return c=1,P=!1,!!(Mi||yt.distanceToSquared(i.object.position)>a||8*(1-di.dot(i.object.quaternion))>a||nn.distanceToSquared(i.target)>0)&&(i.dispatchEvent(fC),yt.copy(i.object.position),di.copy(i.object.quaternion),nn.copy(i.target),!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",Gt),i.domElement.removeEventListener("pointerdown",ft),i.domElement.removeEventListener("pointercancel",G),i.domElement.removeEventListener("wheel",st),i.domElement.removeEventListener("pointermove",q),i.domElement.removeEventListener("pointerup",G),null!==i._domElementKeyEvents&&(i._domElementKeyEvents.removeEventListener("keydown",nt),i._domElementKeyEvents=null)};const i=this,n={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let r=n.NONE;const a=1e-6,o=new _T,l=new _T;let c=1;const h=new Z,u=new Xe,m=new Xe,p=new Xe,_=new Xe,g=new Xe,f=new Xe,b=new Xe,C=new Xe,M=new Xe,E=new Z,S=new Xe;let P=!1;const I=[],L={};function B(de){const at=Math.abs(de)/(100*(0|window.devicePixelRatio));return Math.pow(.95,i.zoomSpeed*at)}function Q(de){l.theta-=de}function pe(de){l.phi-=de}const ae=function(){const de=new Z;return function(Pt,yt){de.setFromMatrixColumn(yt,0),de.multiplyScalar(-Pt),h.add(de)}}(),N=function(){const de=new Z;return function(Pt,yt){!0===i.screenSpacePanning?de.setFromMatrixColumn(yt,1):(de.setFromMatrixColumn(yt,0),de.crossVectors(i.object.up,de)),de.multiplyScalar(Pt),h.add(de)}}(),ee=function(){const de=new Z;return function(Pt,yt){const di=i.domElement;if(i.object.isPerspectiveCamera){de.copy(i.object.position).sub(i.target);let dn=de.length();dn*=Math.tan(i.object.fov/2*Math.PI/180),ae(2*Pt*dn/di.clientHeight,i.object.matrix),N(2*yt*dn/di.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(ae(Pt*(i.object.right-i.object.left)/i.object.zoom/di.clientWidth,i.object.matrix),N(yt*(i.object.top-i.object.bottom)/i.object.zoom/di.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function K(de){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?c/=de:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function se(de){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?c*=de:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function ue(de,at){if(!i.zoomToCursor)return;P=!0;const Pt=i.domElement.getBoundingClientRect(),di=at-Pt.top,dn=Pt.height;S.x=(de-Pt.left)/Pt.width*2-1,S.y=-di/dn*2+1,E.set(S.x,S.y,1).unproject(i.object).sub(i.object.position).normalize()}function re(de){return Math.max(i.minDistance,Math.min(i.maxDistance,de))}function xe(de){u.set(de.clientX,de.clientY)}function Fe(de){_.set(de.clientX,de.clientY)}function wt(de){if(1===I.length)u.set(de.pageX,de.pageY);else{const at=tn(de);u.set(.5*(de.pageX+at.x),.5*(de.pageY+at.y))}}function Jt(de){if(1===I.length)_.set(de.pageX,de.pageY);else{const at=tn(de);_.set(.5*(de.pageX+at.x),.5*(de.pageY+at.y))}}function It(de){const at=tn(de),Pt=de.pageX-at.x,yt=de.pageY-at.y,di=Math.sqrt(Pt*Pt+yt*yt);b.set(0,di)}function gt(de){if(1==I.length)m.set(de.pageX,de.pageY);else{const Pt=tn(de);m.set(.5*(de.pageX+Pt.x),.5*(de.pageY+Pt.y))}p.subVectors(m,u).multiplyScalar(i.rotateSpeed);const at=i.domElement;Q(2*Math.PI*p.x/at.clientHeight),pe(2*Math.PI*p.y/at.clientHeight),u.copy(m)}function Ze(de){if(1===I.length)g.set(de.pageX,de.pageY);else{const at=tn(de);g.set(.5*(de.pageX+at.x),.5*(de.pageY+at.y))}f.subVectors(g,_).multiplyScalar(i.panSpeed),ee(f.x,f.y),_.copy(g)}function pt(de){const at=tn(de),Pt=de.pageX-at.x,yt=de.pageY-at.y,di=Math.sqrt(Pt*Pt+yt*yt);C.set(0,di),M.set(0,Math.pow(C.y/b.y,i.zoomSpeed)),K(M.y),b.copy(C),ue(.5*(de.pageX+at.x),.5*(de.pageY+at.y))}function ft(de){!1!==i.enabled&&(0===I.length&&(i.domElement.setPointerCapture(de.pointerId),i.domElement.addEventListener("pointermove",q),i.domElement.addEventListener("pointerup",G)),function vi(de){I.push(de.pointerId)}(de),"touch"===de.pointerType?function ii(de){switch(rt(de),I.length){case 1:switch(i.touches.ONE){case 0:if(!1===i.enableRotate)return;wt(de),r=n.TOUCH_ROTATE;break;case 1:if(!1===i.enablePan)return;Jt(de),r=n.TOUCH_PAN;break;default:r=n.NONE}break;case 2:switch(i.touches.TWO){case 2:if(!1===i.enableZoom&&!1===i.enablePan)return;(function oi(de){i.enableZoom&&It(de),i.enablePan&&Jt(de)})(de),r=n.TOUCH_DOLLY_PAN;break;case 3:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function me(de){i.enableZoom&&It(de),i.enableRotate&&wt(de)})(de),r=n.TOUCH_DOLLY_ROTATE;break;default:r=n.NONE}break;default:r=n.NONE}r!==n.NONE&&i.dispatchEvent(ry)}(de):function Oe(de){let at;switch(de.button){case 0:at=i.mouseButtons.LEFT;break;case 1:at=i.mouseButtons.MIDDLE;break;case 2:at=i.mouseButtons.RIGHT;break;default:at=-1}switch(at){case 1:if(!1===i.enableZoom)return;(function Ce(de){ue(de.clientX,de.clientX),b.set(de.clientX,de.clientY)})(de),r=n.DOLLY;break;case 0:if(de.ctrlKey||de.metaKey||de.shiftKey){if(!1===i.enablePan)return;Fe(de),r=n.PAN}else{if(!1===i.enableRotate)return;xe(de),r=n.ROTATE}break;case 2:if(de.ctrlKey||de.metaKey||de.shiftKey){if(!1===i.enableRotate)return;xe(de),r=n.ROTATE}else{if(!1===i.enablePan)return;Fe(de),r=n.PAN}break;default:r=n.NONE}r!==n.NONE&&i.dispatchEvent(ry)}(de))}function q(de){!1!==i.enabled&&("touch"===de.pointerType?function Ft(de){switch(rt(de),r){case n.TOUCH_ROTATE:if(!1===i.enableRotate)return;gt(de),i.update();break;case n.TOUCH_PAN:if(!1===i.enablePan)return;Ze(de),i.update();break;case n.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function qe(de){i.enableZoom&&pt(de),i.enablePan&&Ze(de)})(de),i.update();break;case n.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function lt(de){i.enableZoom&&pt(de),i.enableRotate&&gt(de)})(de),i.update();break;default:r=n.NONE}}(de):function ct(de){switch(r){case n.ROTATE:if(!1===i.enableRotate)return;!function Te(de){m.set(de.clientX,de.clientY),p.subVectors(m,u).multiplyScalar(i.rotateSpeed);const at=i.domElement;Q(2*Math.PI*p.x/at.clientHeight),pe(2*Math.PI*p.y/at.clientHeight),u.copy(m),i.update()}(de);break;case n.DOLLY:if(!1===i.enableZoom)return;!function Le(de){C.set(de.clientX,de.clientY),M.subVectors(C,b),M.y>0?K(B(M.y)):M.y<0&&se(B(M.y)),b.copy(C),i.update()}(de);break;case n.PAN:if(!1===i.enablePan)return;!function Ge(de){g.set(de.clientX,de.clientY),f.subVectors(g,_).multiplyScalar(i.panSpeed),ee(f.x,f.y),_.copy(g),i.update()}(de)}}(de))}function G(de){(function Ii(de){delete L[de.pointerId];for(let at=0;at<I.length;at++)if(I[at]==de.pointerId)return void I.splice(at,1)})(de),0===I.length&&(i.domElement.releasePointerCapture(de.pointerId),i.domElement.removeEventListener("pointermove",q),i.domElement.removeEventListener("pointerup",G)),i.dispatchEvent(gC),r=n.NONE}function st(de){!1===i.enabled||!1===i.enableZoom||r!==n.NONE||(de.preventDefault(),i.dispatchEvent(ry),function $e(de){ue(de.clientX,de.clientY),de.deltaY<0?se(B(de.deltaY)):de.deltaY>0&&K(B(de.deltaY)),i.update()}(de),i.dispatchEvent(gC))}function nt(de){!1===i.enabled||!1===i.enablePan||function et(de){let at=!1;switch(de.code){case i.keys.UP:de.ctrlKey||de.metaKey||de.shiftKey?pe(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):ee(0,i.keyPanSpeed),at=!0;break;case i.keys.BOTTOM:de.ctrlKey||de.metaKey||de.shiftKey?pe(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):ee(0,-i.keyPanSpeed),at=!0;break;case i.keys.LEFT:de.ctrlKey||de.metaKey||de.shiftKey?Q(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):ee(i.keyPanSpeed,0),at=!0;break;case i.keys.RIGHT:de.ctrlKey||de.metaKey||de.shiftKey?Q(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):ee(-i.keyPanSpeed,0),at=!0}at&&(de.preventDefault(),i.update())}(de)}function Gt(de){!1!==i.enabled&&de.preventDefault()}function rt(de){let at=L[de.pointerId];void 0===at&&(at=new Xe,L[de.pointerId]=at),at.set(de.pageX,de.pageY)}function tn(de){return L[de.pointerId===I[0]?I[1]:I[0]]}i.domElement.addEventListener("contextmenu",Gt),i.domElement.addEventListener("pointerdown",ft),i.domElement.addEventListener("pointercancel",G),i.domElement.addEventListener("wheel",st,{passive:!1}),this.update()}}class mN{constructor(){}get camera(){return this._camera}get orbitControl(){return this._orbitControl}resetOrbitControl(){this.orbitControl&&(this.orbitControl.enablePan=!0,this.orbitControl.enableDamping=!0,this.orbitControl.enableRotate=!0,this.orbitControl.enableZoom=!0,this.orbitControl.minPolarAngle=0,this.orbitControl.maxPolarAngle=Math.PI/2)}initOrbitControl(e,t){this._orbitControl=new uN(this._camera,e),this.updateOrbitControlConfigs(t)}updateOrbitControlConfigs(e){this._orbitControl.enabled=e.enable,this._orbitControl.enableDamping=e.damping,this._orbitControl.enablePan=e.pan,this._orbitControl.enableRotate=e.rotate,this._orbitControl.enableZoom=e.zoom,this._orbitControl.maxPolarAngle=e.maxPolarAngle,this._orbitControl.minPolarAngle=e.minPolarAngle,this._orbitControl.maxDistance=e.maxDistance??1/0,this._orbitControl.minDistance=e.minDistance??0,this._orbitControl.target.set(e.target.x,e.target.y,e.target.z)}updateAspect(e,t){this._camera&&(this._camera.aspect=e/t,this._camera.updateProjectionMatrix())}addCameraToScene(e,t){const i=new Qs;return this._camera=i,e.add(i),t&&this.updateCameraConfigs(t),i}updateCameraConfigs(e){this.camera.position.set(e.position.x,e.position.y,e.position.z),this.camera.lookAt(new Z(e.target.x,e.target.y,e.target.z)),this.camera.far=e.far,this.camera.near=e.near,this.camera.fov=e.fov,this.camera.updateProjectionMatrix(),e.aspect&&(this.camera.aspect=e.aspect)}fitCameraToObject(e,t=1.25,i){const n=new Vs;n.setFromObject(e);var r=new Z;const a=n.getCenter(r),o=n.getSize(r),l=Math.max(o.x,o.y,o.z),c=this._camera.fov*(Math.PI/180);let h=Math.abs(l/4*Math.tan(2*c));h*=t,this._camera.position.z=h;const u=n.min.z;this._camera.far=3*(u<0?-u+h:h-u),this._camera.updateProjectionMatrix(),this._camera.lookAt(a)}fitCameraToObjectGroup(e){const t=(new Vs).setFromObject(e),i=t.getSize(new Z),n=t.getCenter(new Z),o=Math.max(i.x,i.y)/(2*Math.atan(Math.PI*this._camera.fov/360)),c=1.2*Math.max(o,o/this._camera.aspect),u=((new Z).copy(this._camera.position),n.clone().sub(this._camera.position).normalize().multiplyScalar(c)),m=(new Z).copy(n).sub(u),p=(new Z).copy(n);this._camera.position.copy(m),this._camera.updateProjectionMatrix(),this._camera.lookAt(p)}setBackgroundCenter(e){this.orbitControl.reset();const t=(new Vs).setFromObject(e),i=t.getSize(new Z),n=i.length(),r=t.getCenter(new Z);this.camera.near=n/100,this.camera.far=100*n,this.camera.focus=.5,this.camera.fov=80,this.camera.updateProjectionMatrix(),this.camera.position.copy(r);const a=Number((n/i.x).toFixed(2));this.camera.position.x+=n/a,this.camera.position.y+=n/5;const o=Number((n/i.z).toFixed(2));this.camera.position.z+=n/o,this.camera.lookAt(r),this.orbitControl.maxDistance=10*n,this.orbitControl.update()}}const pN=["determinateSpinner"];function fN(s,e){if(1&s&&(d.O4$(),d.TgZ(0,"svg",11),d._UZ(1,"circle",12),d.qZA()),2&s){const t=d.oxw();d.uIk("viewBox",t._viewBox()),d.xp6(1),d.Udp("stroke-dasharray",t._strokeCircumference(),"px")("stroke-dashoffset",t._strokeCircumference()/2,"px")("stroke-width",t._circleStrokeWidth(),"%"),d.uIk("r",t._circleRadius())}}const gN=(0,R.pj)(class{constructor(s){this._elementRef=s}},"primary"),_N=new d.OlP("mat-progress-spinner-default-options",{providedIn:"root",factory:function bN(){return{diameter:bC}}}),bC=100;let yN=(()=>{class s extends gN{constructor(t,i,n){super(t),this.mode="mat-spinner"===this._elementRef.nativeElement.nodeName.toLowerCase()?"indeterminate":"determinate",this._value=0,this._diameter=bC,this._noopAnimations="NoopAnimations"===i&&!!n&&!n._forceAnimations,n&&(n.color&&(this.color=this.defaultColor=n.color),n.diameter&&(this.diameter=n.diameter),n.strokeWidth&&(this.strokeWidth=n.strokeWidth))}get value(){return"determinate"===this.mode?this._value:0}set value(t){this._value=Math.max(0,Math.min(100,(0,Vi.su)(t)))}get diameter(){return this._diameter}set diameter(t){this._diameter=(0,Vi.su)(t)}get strokeWidth(){return this._strokeWidth??this.diameter/10}set strokeWidth(t){this._strokeWidth=(0,Vi.su)(t)}_circleRadius(){return(this.diameter-10)/2}_viewBox(){const t=2*this._circleRadius()+this.strokeWidth;return`0 0 ${t} ${t}`}_strokeCircumference(){return 2*Math.PI*this._circleRadius()}_strokeDashOffset(){return"determinate"===this.mode?this._strokeCircumference()*(100-this._value)/100:null}_circleStrokeWidth(){return this.strokeWidth/this.diameter*100}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(d.SBq),d.Y36(d.QbO,8),d.Y36(_N))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["mat-progress-spinner"],["mat-spinner"]],viewQuery:function(i,n){if(1&i&&d.Gf(pN,5),2&i){let r;d.iGM(r=d.CRH())&&(n._determinateCircle=r.first)}},hostAttrs:["role","progressbar","tabindex","-1",1,"mat-mdc-progress-spinner","mdc-circular-progress"],hostVars:16,hostBindings:function(i,n){2&i&&(d.uIk("aria-valuemin",0)("aria-valuemax",100)("aria-valuenow","determinate"===n.mode?n.value:null)("mode",n.mode),d.Udp("width",n.diameter,"px")("height",n.diameter,"px")("--mdc-circular-progress-size",n.diameter+"px")("--mdc-circular-progress-active-indicator-width",n.diameter+"px"),d.ekj("_mat-animation-noopable",n._noopAnimations)("mdc-circular-progress--indeterminate","indeterminate"===n.mode))},inputs:{color:"color",mode:"mode",value:"value",diameter:"diameter",strokeWidth:"strokeWidth"},exportAs:["matProgressSpinner"],features:[d.qOj],decls:14,vars:11,consts:[["circle",""],["aria-hidden","true",1,"mdc-circular-progress__determinate-container"],["determinateSpinner",""],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__determinate-circle-graphic"],["cx","50%","cy","50%",1,"mdc-circular-progress__determinate-circle"],["aria-hidden","true",1,"mdc-circular-progress__indeterminate-container"],[1,"mdc-circular-progress__spinner-layer"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-left"],[3,"ngTemplateOutlet"],[1,"mdc-circular-progress__gap-patch"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-right"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__indeterminate-circle-graphic"],["cx","50%","cy","50%"]],template:function(i,n){if(1&i&&(d.YNc(0,fN,2,8,"ng-template",null,0,d.W1O),d.TgZ(2,"div",1,2),d.O4$(),d.TgZ(4,"svg",3),d._UZ(5,"circle",4),d.qZA()(),d.kcU(),d.TgZ(6,"div",5)(7,"div",6)(8,"div",7),d.GkF(9,8),d.qZA(),d.TgZ(10,"div",9),d.GkF(11,8),d.qZA(),d.TgZ(12,"div",10),d.GkF(13,8),d.qZA()()()),2&i){const r=d.MAs(1);d.xp6(4),d.uIk("viewBox",n._viewBox()),d.xp6(1),d.Udp("stroke-dasharray",n._strokeCircumference(),"px")("stroke-dashoffset",n._strokeDashOffset(),"px")("stroke-width",n._circleStrokeWidth(),"%"),d.uIk("r",n._circleRadius()),d.xp6(4),d.Q6J("ngTemplateOutlet",r),d.xp6(2),d.Q6J("ngTemplateOutlet",r),d.xp6(2),d.Q6J("ngTemplateOutlet",r)}},dependencies:[x.tP],styles:["@keyframes mdc-circular-progress-container-rotate{to{transform:rotate(360deg)}}@keyframes mdc-circular-progress-spinner-layer-rotate{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}100%{transform:rotate(1080deg)}}@keyframes mdc-circular-progress-color-1-fade-in-out{from{opacity:.99}25%{opacity:.99}26%{opacity:0}89%{opacity:0}90%{opacity:.99}to{opacity:.99}}@keyframes mdc-circular-progress-color-2-fade-in-out{from{opacity:0}15%{opacity:0}25%{opacity:.99}50%{opacity:.99}51%{opacity:0}to{opacity:0}}@keyframes mdc-circular-progress-color-3-fade-in-out{from{opacity:0}40%{opacity:0}50%{opacity:.99}75%{opacity:.99}76%{opacity:0}to{opacity:0}}@keyframes mdc-circular-progress-color-4-fade-in-out{from{opacity:0}65%{opacity:0}75%{opacity:.99}90%{opacity:.99}to{opacity:0}}@keyframes mdc-circular-progress-left-spin{from{transform:rotate(265deg)}50%{transform:rotate(130deg)}to{transform:rotate(265deg)}}@keyframes mdc-circular-progress-right-spin{from{transform:rotate(-265deg)}50%{transform:rotate(-130deg)}to{transform:rotate(-265deg)}}.mdc-circular-progress{display:inline-flex;position:relative;direction:ltr;line-height:0;transition:opacity 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-circular-progress__determinate-container,.mdc-circular-progress__indeterminate-circle-graphic,.mdc-circular-progress__indeterminate-container,.mdc-circular-progress__spinner-layer{position:absolute;width:100%;height:100%}.mdc-circular-progress__determinate-container{transform:rotate(-90deg)}.mdc-circular-progress__indeterminate-container{font-size:0;letter-spacing:0;white-space:nowrap;opacity:0}.mdc-circular-progress__determinate-circle-graphic,.mdc-circular-progress__indeterminate-circle-graphic{fill:rgba(0,0,0,0)}.mdc-circular-progress__determinate-circle{transition:stroke-dashoffset 500ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-circular-progress__gap-patch{position:absolute;top:0;left:47.5%;box-sizing:border-box;width:5%;height:100%;overflow:hidden}.mdc-circular-progress__gap-patch .mdc-circular-progress__indeterminate-circle-graphic{left:-900%;width:2000%;transform:rotate(180deg)}.mdc-circular-progress__circle-clipper{display:inline-flex;position:relative;width:50%;height:100%;overflow:hidden}.mdc-circular-progress__circle-clipper .mdc-circular-progress__indeterminate-circle-graphic{width:200%}.mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{left:-100%}.mdc-circular-progress--indeterminate .mdc-circular-progress__determinate-container{opacity:0}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{opacity:1}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{animation:mdc-circular-progress-container-rotate 1568.2352941176ms linear infinite}.mdc-circular-progress--indeterminate .mdc-circular-progress__spinner-layer{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-1{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-1-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-2{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-2-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-3{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-3-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-4{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-4-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-left .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-left-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-right-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--closed{opacity:0}.mat-mdc-progress-spinner{--mdc-circular-progress-active-indicator-width:4px;--mdc-circular-progress-size:48px}.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:var(--mdc-circular-progress-active-indicator-color)}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}.mat-mdc-progress-spinner circle{stroke-width:var(--mdc-circular-progress-active-indicator-width)}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-1 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-2 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-3 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-4 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}.mat-mdc-progress-spinner .mdc-circular-progress{width:var(--mdc-circular-progress-size) !important;height:var(--mdc-circular-progress-size) !important}.mat-mdc-progress-spinner{display:block;overflow:hidden;line-height:0}.mat-mdc-progress-spinner._mat-animation-noopable,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__determinate-circle{transition:none}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__spinner-layer,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container{animation:none}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container circle{stroke-dasharray:0 !important}.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic,.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle{stroke:currentColor;stroke:CanvasText}"],encapsulation:2,changeDetection:0})}return s})(),xN=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275mod=d.oAB({type:s});static#i=this.\u0275inj=d.cJS({imports:[x.ez,R.BQ]})}return s})();const wN=["canvas"],MN=["container"];function TN(s,e){1&s&&(d.TgZ(0,"div",6)(1,"div"),d._uU(2,"Loading..."),d.qZA(),d._UZ(3,"mat-spinner"),d.qZA())}function CN(s,e){if(1&s&&(d.ynx(0),d._UZ(1,"img",12),d.BQk()),2&s){const t=d.oxw().$implicit;d.xp6(1),d.Q6J("src",t.view._imageIcon,d.LSH)("alt",t.title)}}function DN(s,e){if(1&s&&(d.TgZ(0,"label"),d._uU(1),d.qZA()),2&s){const t=d.oxw().$implicit;d.xp6(1),d.Oqu(t.title)}}function EN(s,e){if(1&s&&(d.TgZ(0,"div",13),d._uU(1),d.qZA()),2&s){const t=d.oxw().$implicit;d.xp6(1),d.Oqu((null==t||null==t.action?null:t.action.description)||"")}}function SN(s,e){if(1&s&&(d.TgZ(0,"div",7)(1,"div",8),d.YNc(2,CN,2,2,"ng-container",9),d.YNc(3,DN,2,1,"ng-template",null,10,d.W1O),d.qZA(),d.YNc(5,EN,2,1,"div",11),d.qZA()),2&s){const t=e.$implicit,i=d.MAs(4),n=d.oxw();d.Q6J("ngClass",t.class),d.xp6(1),d.ekj("has-image",null==t||null==t.view?null:t.view._imageIcon),d.xp6(1),d.Q6J("ngIf",null==t||null==t.view?null:t.view._imageIcon)("ngIfElse",i),d.xp6(3),d.Q6J("ngIf",t.action.type===n.Action.hover)}}let kN=(()=>{class s extends uu.H{get canvas(){return this.canvasRef.nativeElement}constructor(t,i,n,r,a,o,l){super(),this.uploadService=t,this.store=i,this.socketService=n,this.render2=r,this.document=a,this.dialog=o,this.sharedStore=l,this.Action=xo,this.Animation=Animation,this.size={height:0,width:0},this.loading=!0,this.scene=new dM,this.details=[],this.action=xo,this.details$=new ss.X([]),this.points=[],this.Model=new cN,this.Light=new dN(this.scene),this.Camera=new mN,this.raycasterCamera=new fT}init(t){var i=this;return(0,On.Z)(function*(){let n;if(t?.content?.config)n=t?.content?.config;else{if(!t.config)return void console.error("bad config");n=t.config}i.config=n,n.labels&&i.applyLabelsConfig(n.labels),i.points=[];for(const l of i.details){const c={position:new Z(l.point.x,l.point.y,l.point.z),element:document.querySelector("."+l.class)};i.points.push(c)}n.background&&i.applyBackgroundConfig(n.background),i.applySceneConfig(n.scene),i.Camera.addCameraToScene(i.scene,n.scene.camera),i.Camera.updateAspect(i.size.width,i.size.height),i.Camera.initOrbitControl(i.canvas,n.scene.control),n.scene.light&&(n.scene.lights=[n.scene.light]),i.Light.updateAllLights(n.scene.lights);const r=(l,c,h,u,m)=>{i.config.background?(i.applyBackgroundConfig(i.config.background),i.loading=!1):console.error("no background!")},a=(l,c,h,u,m,p)=>{i.applyComponentConfig(p,m)},o=l=>{console.error("Error loading file:",l)};if(i.config.background){const l=i.config.background,c=yield i.uploadService.getFileUrlV2(l.file),h=c.url.url;if(!h)return void console.error(c.url.error??"can not load background");let u=".fbx";l.file.split(".").length>1&&(u="."+l.file.split(".").pop()),i.Model.load3DFile(h,u,l.file,i.scene,r,o)}if(i.config.components)for(const l of i.config.components){const c=yield i.uploadService.getFileUrlV2(l.file),h=c.url.url;if(!h){console.error(c.url.error??"can not load component");continue}let u=".fbx";l.file.split(".").length>1&&(u="."+l.file.split(".").pop()),i.Model.load3DFile(h,u,l.file,i.scene,a,o,void 0,l)}i.onResize(),i.animate()})()}ngAfterViewInit(){var t=this;return(0,On.Z)(function*(){t.setCanvasSize(),t.setRenderer(),t.safeObservable(t.store.select((0,ze.rM)(t.id))).pipe((0,Zn.b)(i=>{i&&t.init(i)})).subscribe()})()}animate(){this.Camera.orbitControl?.update(),this.points=[],this.details||(this.details=[]),this.details.forEach(t=>{const i=t.point,n=document.querySelector("."+t.class);if(!n)return;const r={element:n,position:new Z(i.x,i.y,i.z)};this.points.push(r)}),this.points.forEach((t,i)=>{const n=t.position.clone();n.project(this.Camera.camera),this.raycasterCamera.setFromCamera(n,this.Camera.camera);const r=this.raycasterCamera.intersectObjects(this.scene.children,!0);0===r.length?t.element.classList.add("visible"):r[0].distance<t.position.distanceTo(this.Camera.camera.position)?t.element.classList.remove("visible"):t.element.classList.add("visible"),t.element.style.transform=`translate(${n.x*this.size.width/2}px, ${-n.y*this.size.height/2}px)`}),this.renderer.render(this.scene,this.Camera.camera),window.requestAnimationFrame(this.animate.bind(this))}applySceneConfig(t){this.scene.background=new xt(t.backgroundColor)}applyLabelsConfig(t){this.details=t.map(i=>{let n=this.render2.createElement("div"),r=this.render2.createElement("div"),a=this.render2.createElement("label"),o=this.render2.createElement("div");return this.render2.setAttribute(a,"id","label_"+i.id),this.render2.setProperty(o,"innerHTML",i.action.description||""),this.render2.addClass(r,"point1"),this.render2.addClass(r,i.class),this.render2.addClass(n,"label"),this.render2.addClass(o,"text"),i.action&&this.render2.setStyle(a,"cursor","pointer"),this.render2.appendChild(n,a),this.render2.appendChild(r,n),this.render2.appendChild(r,o),this.render2.appendChild(this.containerRef.nativeElement,r),this.applyAction(i.action,i.id,i.point),i.view.icon&&this.uploadService.getFileUrl(i.view.icon).pipe((0,Di.q)(1),(0,Eb.z)(l=>this.uploadService.getFile(l.url.url).pipe((0,$b.K)(c=>(0,D.of)(200===c.status?c.url:c)))),(0,ri.U)(l=>({...i,view:{icon:l}}))),this.render2.setProperty(a,"innerHTML",i.content.dynamic.output?.name||i.title),i.content.dynamic.output?.name&&i.content.dynamic.topic?.id&&this.safeObservable(this.socketService.fetchDeviceData(i.content.dynamic.topic.id,i.content.dynamic.output.name)).pipe((0,ri.U)(l=>{this.render2.setProperty(a,"innerHTML",l)})).subscribe(),i})}applyAction(t,i,n){const r=this.document.getElementById("label_"+i);t.type===xo.dialog?this.render2.listen(r,"click",a=>{this.dialog.open(cw,{width:"60%",height:"60%",panelClass:"3D-Dialog",data:{componentName:t.component,config:t.config}})}):t.type===xo.url?this.render2.listen(r,"click",a=>{this.dialog.open(dw,{width:"60%",height:"60%",panelClass:"3D-Dialog",data:{url:t.url}})}):t.type===xo.redirect&&this.render2.listen(r,"click",a=>{t.dashboard&&this.store.select((0,ze.Et)(t.dashboard)).pipe((0,Di.q)(1),(0,Ei.w)(o=>this.sharedStore.select(ce.K8).pipe((0,Di.q)(1),(0,ri.U)(l=>{t.dashboard&&this.store.dispatch(o?(0,Gi.Fi)({dashboard:o}):(0,Gi.bu)({dashboardId:t.dashboard,isPreview:l}))})))).subscribe()})}applyBackgroundConfig(t){this.background=this.scene.getObjectById(t.id),this.background&&(this.background.position.set(t.position.x,t.position.y,t.position.z),this.background.rotation.set(t.rotation.x,t.rotation.y,t.rotation.z),this.background.scale.set(t.scale.x,t.scale.y,t.scale.z),console.log("after assing position",this.background,t))}applyComponentConfig(t,i){const n=this.scene.getObjectById(i);n&&(n.position.set(t.position.x,t.position.y,t.position.z),n.rotation.set(t.rotation.x,t.rotation.y,t.rotation.z),n.scale.set(t.scale.x,t.scale.y,t.scale.z))}setCanvasSize(){this.size={width:this.canvas.clientWidth,height:this.canvas.clientHeight}}onResize(){this.size.width=this.canvas.clientWidth,this.size.height=this.canvas.clientHeight,this.Camera&&this.Camera.updateAspect(this.size.width,this.size.height),this.renderer&&(this.renderer.setSize(this.size.width,this.size.height),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)))}setRenderer(){this.renderer=new cM({canvas:this.canvas,antialias:!0}),this.renderer.setSize(this.size.width,this.size.height),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2))}getIntersects(t){const i=new fT;let n=this.canvas,r=new Xe(0,0);const a=t.clientX,o=t.clientY,l=this.canvas.getBoundingClientRect();let c=l.top,h=l.left;h+=n.offsetLeft,c+=n.offsetTop,n=n.offsetParent,document.documentElement&&(document.documentElement.scrollTop||document.documentElement.scrollLeft)?(h-=document.documentElement.scrollLeft,c-=document.documentElement.scrollTop):document.body&&(document.body.scrollTop||document.body.scrollLeft)?(h-=document.body.scrollLeft,c-=document.body.scrollTop):(window.pageXOffset||window.pageYOffset)&&(h-=window.pageXOffset,c-=window.pageYOffset);const m=c+this.canvas.clientHeight/2;return r.x=(a-(h+this.canvas.clientWidth/2))/(this.canvas.clientWidth/2),r.y=-(o-m)/(this.canvas.clientHeight/2),i.setFromCamera(r,this.Camera.camera),i.intersectObjects(this.scene.children)}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(hw),d.Y36(Ie.yh),d.Y36(Yr.l),d.Y36(d.Qsj),d.Y36(x.K0),d.Y36($a.uw),d.Y36(Ie.yh))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-three-d"]],viewQuery:function(i,n){if(1&i&&(d.Gf(wN,7),d.Gf(MN,7)),2&i){let r;d.iGM(r=d.CRH())&&(n.canvasRef=r.first),d.iGM(r=d.CRH())&&(n.containerRef=r.first)}},inputs:{config:"config",id:"id"},features:[d.qOj],decls:6,vars:2,consts:[[1,"modelContainer"],["container",""],["class","loading",4,"ngIf"],[1,"wbgl"],["canvas",""],["class","point1",3,"ngClass",4,"ngFor","ngForOf"],[1,"loading"],[1,"point1",3,"ngClass"],[1,"label"],[4,"ngIf","ngIfElse"],["labelText",""],["class","text",4,"ngIf"],[3,"src","alt"],[1,"text"]],template:function(i,n){1&i&&(d.TgZ(0,"main",0,1),d.YNc(2,TN,4,0,"div",2),d._UZ(3,"canvas",3,4),d.YNc(5,SN,6,6,"div",5),d.qZA()),2&i&&(d.xp6(2),d.Q6J("ngIf",n.loading),d.xp6(3),d.Q6J("ngForOf",n.details))},dependencies:[x.mk,x.sg,x.O5,yN],styles:["main[_ngcontent-%COMP%]{position:relative;width:100%;height:100%}main[_ngcontent-%COMP%]   .wbgl[_ngcontent-%COMP%]{position:absolute;left:0;overflow:hidden;width:100%!important;height:100%!important}.loading[_ngcontent-%COMP%]{position:absolute;inset:0;background:rgba(0,0,0,.6);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999}.loading[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{width:50px!important;height:50px!important;margin-top:.8em}.point[_ngcontent-%COMP%]{position:absolute;display:flex;flex-direction:column;left:50%;top:50%;background-color:#fff;transform:scale(0);transition:transform .3s}.point[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.5rem;border-radius:.5rem;background:rgba(0,0,0,.6666666667);border:1px solid rgba(255,255,255,.4666666667);color:#fff;font-family:Helvetica,Arial,sans-serif;font-weight:100;font-size:1em;opacity:0;transition:opacity .3s;opacity:1}.point[_ngcontent-%COMP%]   button.show[_ngcontent-%COMP%]{opacity:1}.point.visible[_ngcontent-%COMP%]{transform:scale(1)}.point1[_ngcontent-%COMP%]{position:absolute;left:50%;top:50%;background-color:#fff}.point1[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{position:absolute;width:30px;height:30px;padding:1rem;background:rgba(0,0,0,.4666666667);border-radius:100%;border:1px solid #ffffff;color:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer;transform:scale(0);transition:transform .3s}.point1[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{position:absolute;top:40px;width:200px;padding:20px;border-radius:4px;background:rgba(0,0,0,.6666666667);border:1px solid rgba(255,255,255,.4666666667);color:#fff;line-height:1.3em;font-family:Helvetica,Arial,sans-serif;font-weight:100;font-size:14px;opacity:0;transition:opacity .3s;pointer-events:none}.point1.visible[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{transform:scale(1)}.point1[_ngcontent-%COMP%]:hover   .text[_ngcontent-%COMP%]{opacity:1}"]})}return s})(),AN=(()=>{class s{constructor(t){this.store=t,this.color="#DC143C",this.unsubscribe$=new gi.x}ngOnInit(){this.color=this.config.view.Button.color||"#DC143C"}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}applyContent(t){this.store.dispatch((0,Gi.jv)({config:t}))}onClick(){this.config.content&&this.applyContent(this.config.content)}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(Ie.yh))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-change-source"]],inputs:{id:"id",config:"config"},decls:3,vars:2,consts:[[1,"container"],["Card","",3,"backgroundColor","click"]],template:function(i,n){1&i&&(d.TgZ(0,"div",0)(1,"button",1),d.NdJ("click",function(){return n.onClick()}),d._uU(2),d.qZA()()),2&i&&(d.xp6(1),d.Q6J("backgroundColor",n.color),d.xp6(1),d.Oqu(n.config.view.Labels.title))},dependencies:[dx],styles:[".container[_ngcontent-%COMP%]{width:100%;height:100%}.container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;height:100%;border:none;border-radius:.25rem;color:#fff}"]})}return s})();class Um extends Zo{constructor(){super(...arguments),Object.defineProperty(this,"itemContainers",{enumerable:!0,configurable:!0,writable:!0,value:new bs(An.new({}),()=>ai._new(this._root,{themeTags:ki(this.itemContainers.template.get("themeTags",[]),["legend","item"]),themeTagsSelf:ki(this.itemContainers.template.get("themeTagsSelf",[]),["itemcontainer"]),background:po.new(this._root,{themeTags:ki(this.itemContainers.template.get("themeTags",[]),["legend","item","background"]),themeTagsSelf:ki(this.itemContainers.template.get("themeTagsSelf",[]),["itemcontainer"])})},[this.itemContainers.template]))}),Object.defineProperty(this,"markers",{enumerable:!0,configurable:!0,writable:!0,value:new bs(An.new({}),()=>ai._new(this._root,{themeTags:ki(this.markers.template.get("themeTags",[]),["legend","marker"])},[this.markers.template]))}),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:new bs(An.new({}),()=>_r._new(this._root,{themeTags:ki(this.labels.template.get("themeTags",[]),["legend","label"])},[this.labels.template]))}),Object.defineProperty(this,"valueLabels",{enumerable:!0,configurable:!0,writable:!0,value:new bs(An.new({}),()=>_r._new(this._root,{themeTags:ki(this.valueLabels.template.get("themeTags",[]),["legend","label","value"])},[this.valueLabels.template]))}),Object.defineProperty(this,"markerRectangles",{enumerable:!0,configurable:!0,writable:!0,value:new bs(An.new({}),()=>po._new(this._root,{themeTags:ki(this.markerRectangles.template.get("themeTags",[]),["legend","marker","rectangle"])},[this.markerRectangles.template]))})}_afterNew(){this._settings.themeTags=ki(this._settings.themeTags,["legend"]),this.fields.push("name","stroke","fill"),super._afterNew()}makeItemContainer(e){const t=this.children.push(this.itemContainers.make());return t._setDataItem(e),this.itemContainers.push(t),t.states.create("disabled",{}),t}makeMarker(){const e=this.markers.make();return this.markers.push(e),e.states.create("disabled",{}),e}makeLabel(){const e=this.labels.make();return e.states.create("disabled",{}),e}makeValueLabel(){const e=this.valueLabels.make();return e.states.create("disabled",{}),e}makeMarkerRectangle(){const e=this.markerRectangles.make();return e.states.create("disabled",{}),e}processDataItem(e){super.processDataItem(e);const t=this.makeItemContainer(e),i=this.get("nameField"),n=this.get("fillField"),r=this.get("strokeField");if(t){const a=this.get("clickTarget","itemContainer"),o=e.dataContext;o&&o.set&&o.set("legendDataItem",e),t._setDataItem(e),e.set("itemContainer",t);const l=this.makeMarker();if(l){t.children.push(l),l._setDataItem(e),e.set("marker",l);const u=this.get("useDefaultMarker"),m=l.children.push(this.makeMarkerRectangle());let p=e.get("fill"),_=e.get("stroke");e.set("markerRectangle",m),o&&o.get&&(p=o.get(n,p),_=o.get(r,_)),_||(_=p),u?o.on&&(o.on(n,()=>{m.set("fill",o.get(n))}),o.on(r,()=>{m.set("stroke",o.get(r))})):o&&o.createLegendMarker&&o.createLegendMarker(),m.setAll({fill:p,stroke:_});const g=o.component;g&&g.updateLegendMarker&&g.updateLegendMarker(o)}const c=this.makeLabel();if(c){t.children.push(c),c._setDataItem(e),e.set("label",c),c.text.on("text",()=>{t.setRaw("ariaLabel",c.text._getText()+("none"!==this.get("clickTarget")?"; "+this._t("Press ENTER to toggle"):"")),t.markDirtyAccessibility()}),o&&o.get&&e.set("name",o.get(i));let u=e.get("name");u&&c.set("text",u)}const h=this.makeValueLabel();if(h&&(t.children.push(h),h._setDataItem(e),e.set("valueLabel",h)),o&&o.show&&(o.on("visible",u=>{t.set("disabled",!u)}),o.get("visible")||t.set("disabled",!0),"none"!=a)){let u=t;"marker"==a&&(u=l),this._addClickEvents(u,o,e)}this.children.values.sort((u,m)=>{const p=u.dataItem.dataContext,_=m.dataItem.dataContext;if(p&&_){const g=this.data.indexOf(p),f=this.data.indexOf(_);if(g>f)return 1;if(g<f)return-1}return 0}),o&&o.updateLegendValue&&o.updateLegendValue()}}_addClickEvents(e,t,i){e.set("cursorOverStyle","pointer"),e.events.on("pointerover",()=>{const n=t.component;n&&n.hoverDataItem&&n.hoverDataItem(t)}),e.events.on("pointerout",()=>{const n=t.component;n&&n.hoverDataItem&&n.unhoverDataItem(t)}),e.events.on("click",()=>{const n=i.get("label").text._getText();t.show&&t.isHidden&&(t.isHidden()||!1===t.get("visible"))?(t.show(),e.set("disabled",!1),this._root.readerAlert(this._t("%1 shown",this._root.locale,n))):t.hide&&(t.hide(),e.set("disabled",!0),this._root.readerAlert(this._t("%1 hidden",this._root.locale,n)))})}disposeDataItem(e){super.disposeDataItem(e);const t=e.dataContext;t&&t.get&&t.get("legendDataItem")==e&&t.set("legendDataItem",void 0);let i=e.get("itemContainer");i&&(this.itemContainers.removeValue(i),i.dispose());let n=e.get("marker");n&&(this.markers.removeValue(n),n.dispose());let r=e.get("markerRectangle");r&&(this.markerRectangles.removeValue(r),r.dispose());let a=e.get("label");a&&(this.labels.removeValue(a),a.dispose());let o=e.get("valueLabel");o&&(this.valueLabels.removeValue(o),o.dispose())}}Object.defineProperty(Um,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Legend"}),Object.defineProperty(Um,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Zo.classNames.concat([Um.className])});class PN extends Pu{setupDefaultRules(){super.setupDefaultRules();const e=this._root.interfaceColors,t=this.rule.bind(this);t("PercentSeries").setAll({legendLabelText:"{category}",legendValueText:"{valuePercentTotal.formatNumber('0.00p')}",colors:Ud.new(this._root,{}),width:vt,height:vt}),t("PieChart").setAll({radius:ln(80),startAngle:-90,endAngle:270}),t("PieSeries").setAll({alignLabels:!0,startAngle:-90,endAngle:270}),t("PieSeries").states.create("hidden",{endAngle:-90,opacity:0}),t("Slice",["pie"]).setAll({position:"absolute",isMeasured:!1,x:0,y:0,toggleKey:"active",tooltipText:"{category}: {valuePercentTotal.formatNumber('0.00p')}",strokeWidth:1,strokeOpacity:1,role:"figure",lineJoin:"round"}),t("Slice",["pie"]).states.create("active",{shiftRadius:20,scale:1}),t("Slice",["pie"]).states.create("hoverActive",{scale:1.04}),t("Slice",["pie"]).states.create("hover",{scale:1.04}),t("RadialLabel",["pie"]).setAll({textType:"aligned",radius:10,text:"{category}: {valuePercentTotal.formatNumber('0.00p')}",paddingTop:5,paddingBottom:5,populateText:!0}),t("Tick",["pie"]).setAll({location:1}),t("SlicedChart").setAll({paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10}),t("FunnelSeries").setAll({startLocation:0,endLocation:1,orientation:"vertical",alignLabels:!0,sequencedInterpolation:!0}),t("FunnelSlice").setAll({interactive:!0,expandDistance:0}),t("FunnelSlice").states.create("hover",{expandDistance:.15}),t("Label",["funnel"]).setAll({populateText:!0,text:"{category}: {valuePercentTotal.formatNumber('0.00p')}",centerY:wi}),t("Label",["funnel","horizontal"]).setAll({centerX:0,centerY:wi,rotation:-90}),t("Label",["funnel","vertical"]).setAll({centerY:wi,centerX:0}),t("Tick",["funnel"]).setAll({location:1}),t("FunnelSlice",["funnel","link"]).setAll({fillOpacity:.5,strokeOpacity:0,expandDistance:-.1}),t("FunnelSlice",["funnel","link","vertical"]).setAll({height:10}),t("FunnelSlice",["funnel","link","horizontal"]).setAll({width:10}),t("PyramidSeries").setAll({valueIs:"area"}),t("FunnelSlice",["pyramid","link"]).setAll({fillOpacity:.5}),t("FunnelSlice",["pyramid","link","vertical"]).setAll({height:0}),t("FunnelSlice",["pyramid","link","horizontal"]).setAll({width:0}),t("FunnelSlice",["pyramid"]).setAll({interactive:!0,expandDistance:0}),t("FunnelSlice",["pyramid"]).states.create("hover",{expandDistance:.15}),t("Label",["pyramid"]).setAll({populateText:!0,text:"{category}: {valuePercentTotal.formatNumber('0.00p')}",centerY:wi}),t("Label",["pyramid","horizontal"]).setAll({centerX:0,centerY:wi,rotation:-90}),t("Label",["pyramid","vertical"]).setAll({centerY:wi,centerX:0}),t("Tick",["pyramid"]).setAll({location:1}),t("FunnelSlice",["pictorial"]).setAll({interactive:!0,tooltipText:"{category}: {valuePercentTotal.formatNumber('0.00p')}"}),t("Label",["pictorial"]).setAll({populateText:!0,text:"{category}: {valuePercentTotal.formatNumber('0.00p')}",centerY:wi}),t("Label",["pictorial","horizontal"]).setAll({centerX:0,centerY:wi,rotation:-90}),t("Label",["pictorial","vertical"]).setAll({centerY:wi,centerX:0}),t("FunnelSlice",["pictorial","link"]).setAll({fillOpacity:.5,width:0,height:0}),t("Tick",["pictorial"]).setAll({location:.5});{const i=t("Graphics",["pictorial","background"]);i.setAll({fillOpacity:.2}),ti(i,"fill",e,"alternativeBackground")}}}class zm extends Cc{_afterNew(){this._defaultThemes.push(PN.new(this._root)),super._afterNew(),this.chartContainer.children.push(this.seriesContainer),this.seriesContainer.children.push(this.bulletsContainer)}_processSeries(e){super._processSeries(e),this.seriesContainer.children.moveValue(this.bulletsContainer,this.seriesContainer.children.length-1)}}Object.defineProperty(zm,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PercentChart"}),Object.defineProperty(zm,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Cc.classNames.concat([zm.className])});class Qg extends zm{constructor(){super(...arguments),Object.defineProperty(this,"_maxRadius",{enumerable:!0,configurable:!0,writable:!0,value:1})}_afterNew(){super._afterNew(),this.seriesContainer.setAll({x:wi,y:wi})}_prepareChildren(){super._prepareChildren();const e=this.chartContainer,t=e.innerWidth(),i=e.innerHeight(),n=this.get("startAngle",0),r=this.get("endAngle",0),a=this.get("innerRadius");let o=Eu(0,0,n,r,1);const l=t/(o.right-o.left),c=i/(o.bottom-o.top);let h={left:0,right:0,top:0,bottom:0};if(a instanceof Ti){let p=a.value,_=Math.min(l,c);p=Math.max(_*p,_-Math.min(i,t))/_,h=Eu(0,0,n,r,p),this.setPrivateRaw("irModifyer",p/a.value)}o=Hy([o,h]);const u=this._maxRadius;this._maxRadius=Math.min(l,c);const m=Oi(this.get("radius",0),this._maxRadius);this.seriesContainer.setAll({dy:-m*(o.bottom+o.top)/2,dx:-m*(o.right+o.left)/2}),(this.isDirty("startAngle")||this.isDirty("endAngle")||u!=this._maxRadius)&&this.series.each(p=>{p._markDirtyKey("startAngle")}),(this.isDirty("innerRadius")||this.isDirty("radius"))&&this.series.each(p=>{p._markDirtyKey("innerRadius")})}radius(e){let t=Oi(this.get("radius",0),this._maxRadius),i=Oi(this.get("innerRadius",0),t);if(e){let n=this.series.indexOf(e),r=this.series.length,a=e.get("radius");return null!=a?i+Oi(a,t-i):i+(t-i)/r*(n+1)}return t}innerRadius(e){const t=this.radius();let i=Oi(this.get("innerRadius",0),t);if(i<0&&(i=t+i),e){let n=this.series.indexOf(e),r=this.series.length,a=e.get("innerRadius");return null!=a?i+Oi(a,t-i):i+(t-i)/r*n}return i}}Object.defineProperty(Qg,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PieChart"}),Object.defineProperty(Qg,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:zm.classNames.concat([Qg.className])});class Hm extends Zo{constructor(){super(...arguments),Object.defineProperty(this,"slicesContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(ai.new(this._root,{position:"absolute",isMeasured:!1}))}),Object.defineProperty(this,"labelsContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(ai.new(this._root,{position:"absolute",isMeasured:!1}))}),Object.defineProperty(this,"ticksContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(ai.new(this._root,{position:"absolute",isMeasured:!1}))}),Object.defineProperty(this,"_lLabels",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_rLabels",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_hLabels",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"slices",{enumerable:!0,configurable:!0,writable:!0,value:this._makeSlices()}),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:this._makeLabels()}),Object.defineProperty(this,"ticks",{enumerable:!0,configurable:!0,writable:!0,value:this._makeTicks()})}makeSlice(e){const t=this.slicesContainer.children.push(this.slices.make());return t.on("fill",()=>{this.updateLegendMarker(e)}),t.on("stroke",()=>{this.updateLegendMarker(e)}),t._setDataItem(e),e.set("slice",t),this.slices.push(t),t}makeLabel(e){const t=this.labelsContainer.children.push(this.labels.make());return t._setDataItem(e),e.set("label",t),this.labels.push(t),t}_shouldMakeBullet(e){return null!=e.get("value")}makeTick(e){const t=this.ticksContainer.children.push(this.ticks.make());return t._setDataItem(e),e.set("tick",t),this.ticks.push(t),t}_afterNew(){this.fields.push("category","fill"),super._afterNew()}_onDataClear(){const e=this.get("colors");e&&e.reset()}_prepareChildren(){if(super._prepareChildren(),this._lLabels=[],this._rLabels=[],this._hLabels=[],this._valuesDirty){let e=0,t=0,i=0,n=1/0,r=0;ye(this._dataItems,a=>{let o=a.get("valueWorking",0);e+=o,t+=Math.abs(o)}),ye(this._dataItems,a=>{let o=a.get("valueWorking",0);o>i&&(i=o),o<n&&(n=o),r++;let l=o/t;0==t&&(l=0),a.setRaw("valuePercentTotal",100*l)}),this.setPrivateRaw("valueLow",n),this.setPrivateRaw("valueHigh",i),this.setPrivateRaw("valueSum",e),this.setPrivateRaw("valueAverage",e/r),this.setPrivateRaw("valueAbsoluteSum",t)}}show(e){const t=Object.create(null,{show:{get:()=>super.show}});return(0,vs.mG)(this,void 0,void 0,function*(){let i=[];i.push(t.show.call(this,e)),i.push(this._sequencedShowHide(!0,e)),yield Promise.all(i)})}hide(e){const t=Object.create(null,{hide:{get:()=>super.hide}});return(0,vs.mG)(this,void 0,void 0,function*(){let i=[];i.push(t.hide.call(this,e)),i.push(this._sequencedShowHide(!1,e)),yield Promise.all(i)})}_updateChildren(){super._updateChildren(),this._valuesDirty&&ye(this._dataItems,e=>{e.get("label").text.markDirtyText()}),(this.isDirty("legendLabelText")||this.isDirty("legendValueText"))&&ye(this._dataItems,e=>{this.updateLegendValue(e)}),this._arrange()}_arrange(){this._arrangeDown(this._lLabels),this._arrangeUp(this._lLabels),this._arrangeDown(this._rLabels),this._arrangeUp(this._rLabels),this._arrangeLeft(this._hLabels),this._arrangeRight(this._hLabels),ye(this.dataItems,e=>{this._updateTick(e)})}_afterChanged(){super._afterChanged(),this._arrange()}processDataItem(e){if(super.processDataItem(e),null==e.get("fill")){let t=this.get("colors");t&&e.setRaw("fill",t.next())}}showDataItem(e,t){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return(0,vs.mG)(this,void 0,void 0,function*(){const n=[i.showDataItem.call(this,e,t)];Se(t)||(t=this.get("stateAnimationDuration",0));const r=this.get("stateAnimationEasing");let a=e.get("value");const o=e.animate({key:"valueWorking",to:a,duration:t,easing:r});o&&n.push(o.waitForStop());const l=e.get("tick");l&&n.push(l.show(t));const c=e.get("label");c&&n.push(c.show(t));const h=e.get("slice");h&&n.push(h.show(t)),h.get("active")&&h.states.applyAnimate("active"),yield Promise.all(n)})}hideDataItem(e,t){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return(0,vs.mG)(this,void 0,void 0,function*(){const n=[i.hideDataItem.call(this,e,t)],r=this.states.create("hidden",{});Se(t)||(t=r.get("stateAnimationDuration",this.get("stateAnimationDuration",0)));const a=r.get("stateAnimationEasing",this.get("stateAnimationEasing")),o=e.animate({key:"valueWorking",to:0,duration:t,easing:a});o&&n.push(o.waitForStop());const l=e.get("tick");l&&n.push(l.hide(t));const c=e.get("label");c&&n.push(c.hide(t));const h=e.get("slice");h.hideTooltip(),h&&n.push(h.hide(t)),yield Promise.all(n)})}disposeDataItem(e){super.disposeDataItem(e);let t=e.get("label");t&&(this.labels.removeValue(t),t.dispose());let i=e.get("tick");i&&(this.ticks.removeValue(i),i.dispose());let n=e.get("slice");n&&(this.slices.removeValue(n),n.dispose())}hoverDataItem(e){const t=e.get("slice");t&&!t.isHidden()&&t.hover()}unhoverDataItem(e){const t=e.get("slice");t&&t.unhover()}updateLegendMarker(e){if(e){const t=e.get("slice");if(t){const i=e.get("legendDataItem");if(i){const n=i.get("markerRectangle");ye(fb,r=>{null!=t.get(r)&&n.set(r,t.get(r))})}}}}_arrangeDown(e){if(e){let t=this._getNextDown();e.sort((i,n)=>i.y>n.y?1:i.y<n.y?-1:0),ye(e,i=>{const n=i.label.adjustedLocalBounds();let r=n.top;i.y+r<t&&(i.y=t-r),i.label.set("y",i.y),t=i.y+n.bottom})}}_getNextUp(){return this.labelsContainer.maxHeight()}_getNextDown(){return 0}_arrangeUp(e){if(e){let t=this._getNextUp();e.sort((i,n)=>i.y<n.y?1:i.y>n.y?-1:0),ye(e,i=>{const n=i.label.adjustedLocalBounds();let r=n.bottom;i.y+r>t&&(i.y=t-r),i.label.set("y",i.y),t=i.y+n.top})}}_arrangeRight(e){if(e){let t=0;e.sort((i,n)=>i.y>n.y?1:i.y<n.y?-1:0),ye(e,i=>{const n=i.label.adjustedLocalBounds();let r=n.left;i.y+r<t&&(i.y=t-r),i.label.set("x",i.y),t=i.y+n.right})}}_arrangeLeft(e){if(e){let t=this.labelsContainer.maxWidth();e.sort((i,n)=>i.y<n.y?1:i.y>n.y?-1:0),ye(e,i=>{const n=i.label.adjustedLocalBounds();let r=n.right;i.y+r>t&&(i.y=t-r),i.label.set("x",i.y),t=i.y+n.left})}}_updateSize(){super._updateSize(),this.markDirty()}_updateTick(e){}_dispose(){super._dispose();const e=this.chart;e&&e.series.removeValue(this)}}Object.defineProperty(Hm,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PercentSeries"}),Object.defineProperty(Hm,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Zo.classNames.concat([Hm.className])});class e_ extends Hm{_makeSlices(){return new bs(An.new({}),()=>zu._new(this._root,{themeTags:ki(this.slices.template.get("themeTags",[]),["pie","series"])},[this.slices.template]))}_makeLabels(){return new bs(An.new({}),()=>jd._new(this._root,{themeTags:ki(this.labels.template.get("themeTags",[]),["pie","series"])},[this.labels.template]))}_makeTicks(){return new bs(An.new({}),()=>Vd._new(this._root,{themeTags:ki(this.ticks.template.get("themeTags",[]),["pie","series"])},[this.ticks.template]))}processDataItem(e){super.processDataItem(e);const t=this.makeSlice(e);t.on("scale",()=>{this._updateTick(e)}),t.on("shiftRadius",()=>{this._updateTick(e)}),t.events.on("positionchanged",()=>{this._updateTick(e)});const i=this.makeLabel(e);i.events.on("positionchanged",()=>{this._updateTick(e)}),this.makeTick(e),t.events.on("positionchanged",()=>{i.markDirty()})}_getNextUp(){const e=this.chart;return e?e._maxRadius:this.labelsContainer.maxHeight()/2}_getNextDown(){const e=this.chart;return e?-e._maxRadius:-this.labelsContainer.maxHeight()/2}_prepareChildren(){super._prepareChildren();const e=this.chart;if(e){if(this.isDirty("alignLabels")){let t=this.labels.template;if(this.get("alignLabels"))t.set("textType","aligned");else{let i=t.get("textType");(null==i||"aligned"==i)&&t.set("textType","adjusted")}}if(this._valuesDirty||this.isDirty("radius")||this.isDirty("innerRadius")||this.isDirty("startAngle")||this.isDirty("endAngle")||this.isDirty("alignLabels")){this.markDirtyBounds();const t=this.get("startAngle",e.get("startAngle",-90)),n=this.get("endAngle",e.get("endAngle",270))-t;let r=t;const a=e.radius(this);this.setPrivateRaw("radius",a);let o=e.innerRadius(this)*e.getPrivate("irModifyer",1);o<0&&(o=a+o),ye(this._dataItems,l=>{this.updateLegendValue(l);let c=n*l.get("valuePercentTotal")/100;const h=l.get("slice");if(h){h.set("radius",a),h.set("innerRadius",o),h.set("startAngle",r),h.set("arc",c);const p=l.get("fill");h._setDefault("fill",p),h._setDefault("stroke",p)}let u=Vo(r+c/2);const m=l.get("label");if(m&&(m.setPrivate("radius",a),m.setPrivate("innerRadius",o),m.set("labelAngle",u),"aligned"==m.get("textType"))){let p=a+m.get("radius",0),_=a*$s(u);u>90&&u<=270?(!m.isHidden()&&!m.isHiding()&&this._lLabels.push({label:m,y:_}),p*=-1,p-=this.labelsContainer.get("paddingLeft",0),m.set("centerX",vt),m.setPrivateRaw("left",!0)):(!m.isHidden()&&!m.isHiding()&&this._rLabels.push({label:m,y:_}),p+=this.labelsContainer.get("paddingRight",0),m.set("centerX",0),m.setPrivateRaw("left",!1)),m.set("x",p),m.set("y",a*$s(u))}r+=c,this._updateTick(l)})}}}_updateTick(e){const t=e.get("tick"),i=e.get("label"),n=e.get("slice"),r=t.get("location",1);if(t&&i&&n){const a=(n.get("shiftRadius",0)+n.get("radius",0))*n.get("scale",1)*r,o=i.get("labelAngle",0),l=gr(o),c=$s(o),h=this.labelsContainer,u=h.get("paddingLeft",0),m=h.get("paddingRight",0);let p=0,_=0;p=i.x(),_=i.y();let g=[];if(0!=p&&0!=_){if("circular"==i.get("textType")){const b=i.radius()-i.get("paddingBottom",0),C=i.get("labelAngle",0);p=b*gr(C),_=b*$s(C)}let f=-m;i.getPrivate("left")&&(f=u),g=[{x:n.x()+a*l,y:n.y()+a*c},{x:p+f,y:_},{x:p,y:_}]}t.set("points",g)}}_positionBullet(e){const t=e.get("sprite");if(t){const n=t.dataItem.get("slice");if(n){const r=n.get("innerRadius",0),a=n.get("radius",0),u=n.get("startAngle",0)+n.get("arc",0)*e.get("locationX",.5),m=r+(a-r)*e.get("locationY",.5);t.setAll({x:gr(u)*m,y:$s(u)*m})}}}}function ON(s,e){if(1&s&&(d.TgZ(0,"h6"),d._uU(1),d.qZA()),2&s){const t=d.oxw();d.xp6(1),d.Oqu(t.config.view.labels.title||"")}}Object.defineProperty(e_,"className",{enumerable:!0,configurable:!0,writable:!0,value:"PieSeries"}),Object.defineProperty(e_,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Hm.classNames.concat([e_.className])});let RN=(()=>{class s{constructor(t,i,n){this.socketService=t,this.historicalService=i,this.store=n,this.unsubscribe$=new gi.x,this.unsubscribeInterval$=new gi.x,this.backgroundColor="transparent"}ngAfterViewInit(){let i=[],n=this.config;this._root&&this._root.dispose(),this._root=Yo.new("pie_chart_"+this.id),this._root.setThemes([Rc.new(this._root)]),n.view.chart.BackgroundColor&&(this.backgroundColor=n.view.chart.BackgroundColor);const r=this._root.container.children.push(Qg.new(this._root,{...n.view.chart}));let a=r.series.push(e_.new(this._root,{valueField:"value",categoryField:"label",...n.view.chart}));n.content.length>0&&(i=n.content.map(o=>({topic:o.topic.id,color:kn(o.color??"#000000"),label:o.outputs?.read.name||"undefined",value:10}))),a.data.setAll(i),n.view.legend?.hasLegend&&r.children.push(Um.new(this._root,{...n.view.legend,x:ln(Number(n.view.legend.x)),y:ln(Number(n.view.legend.y)),layout:this._root[n.view.legend.layoutSetting]})).data.setAll(a.dataItems),a.appear(1e3),r.appear(1e3,100),n.content.length>0&&(i=n.content.map((o,l)=>(this.socketService.fetchDeviceData(o.topic.id,o.outputs?.read.name).pipe((0,ri.U)(c=>{a.data.setIndex(l,{topic:o.topic.id,label:o.outputs?.read.name,value:c,color:kn(o.color??"#000000")}),this._root?.resize()})).subscribe(),{label:o.outputs?.read.name||"undefined",value:0,color:kn(o.color??"#000000")})))}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete(),this.unsubscribeInterval$.next(),this.unsubscribeInterval$.complete(),this._root&&this._root.dispose()}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(Yr.l),d.Y36(Gd.O),d.Y36(Ie.yh))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-pie-chart"]],inputs:{id:"id",config:"config"},decls:3,vars:4,consts:[[1,"container"],[4,"ngIf"],[1,"chart-container",3,"id"]],template:function(i,n){1&i&&(d.TgZ(0,"div",0),d.YNc(1,ON,2,1,"h6",1),d._UZ(2,"div",2),d.qZA()),2&i&&(d.Udp("background-color",n.backgroundColor),d.xp6(1),d.Q6J("ngIf",n.config.view.labels.title),d.xp6(1),d.Q6J("id","pie_chart_"+n.id))},dependencies:[x.O5],styles:[".container[_ngcontent-%COMP%]{width:100%;height:100%;padding:0;display:flex;flex-direction:column;border:1px solid #FFFFFF;border-radius:.5rem}.chart-container[_ngcontent-%COMP%]{padding:0;width:100%;flex:1 1 0}h6[_ngcontent-%COMP%]{text-align:center;color:#fff}"]})}return s})();function IN(s,e){if(1&s&&(d.TgZ(0,"h6"),d._uU(1),d.qZA()),2&s){const t=d.oxw();d.xp6(1),d.Oqu(t.config.view.labels.title||"")}}const vC={ColumnChart:bE,ClusterColumnChart:(()=>{class s{constructor(t,i,n){this.socketService=t,this.historicalService=i,this.store=n,this._series=[],this._rawData=[],this.needToUpdateChart=!1,this.unsubscribe$=new gi.x,this.unsubscribeInterval$=new gi.x,this.backgroundColor="transparent"}ngAfterViewInit(){let i=[],n=this.config;this._root&&this._root.dispose(),this._root=Yo.new("column_chart_"+this.id),this._root.setThemes([Rc.new(this._root)]),n.view.chart.BackgroundColor&&(this.backgroundColor=n.view.chart.BackgroundColor),this._chart=this._root.container.children.push(ja.new(this._root,{panX:!1,panY:!1,wheelX:"none",wheelY:"none",pinchZoomX:!1}));const r=fo.new(this._root,{minGridDistance:10}),a=n.view.xRenderer;r.labels.template.setAll({rotation:n.view.xRenderer.rotation||0,centerY:("100"===a.centerY?vt:"50"===a.centerY?wi:El)||wi,centerX:("100"===a.centerX?vt:"50"===a.centerX?wi:El)||vt,breakWords:n.view.xRenderer.breakWords||!0,textAlign:n.view.xRenderer.textAlign||"center",fontSize:n.view.xRenderer.fontSize||"10",visible:n.view.xRenderer.visible||!1}),r.grid.template.setAll({location:1}),this._xAxis=this._chart.xAxes.push(Xo.new(this._root,{categoryField:"label",renderer:r,maxDeviation:.3,tooltip:Vr.new(this._root,{})})),this._yAxis=this._chart.yAxes.push(ha.new(this._root,{maxDeviation:.3,max:n.view.chart.max||100,min:n.view.chart.min||0,strictMinMax:!0,renderer:go.new(this._root,{minGridDistance:20,strokeOpacity:.1})})),this._chart.set("cursor",Dc.new(this._root,{})).lineY.set("visible",!1),n.content.length>0&&(i=n.content.map(m=>({label:m.label,columns:m.columns.map(p=>({outputs:{read:p.outputs_read},Equivalent:p.Equivalent,topic:p.topic,color:p.color}))}))),this._series=[];let h=i[0].columns.map(m=>m.Equivalent||m.outputs?.read?.name),u=n.view.chart.clusterCount;for(let m=0;m<u;m++)this.addSeries("Series_"+m,"label",n,h[m]);if(this._chart.zoomOutButton.set("forceHidden",!0),this._chart.appear(1e3,100),!n.content[0]?.columns[0]?.isApi&&n.content.length>0){const m=JSON.parse(JSON.stringify(n.content));m.map((p,_)=>{p.columns.map((f,b)=>(this.socketService.fetchDeviceData(f.topic.id,f.outputs?.read?.name).pipe((0,ri.U)(C=>{void 0!==C&&(f.value=Number(C),this.updateChartItem(f,_))})).subscribe(),f))}),this._rawData=m.map(p=>{const _=p.columns.map(f=>(f.value=0,f));let g={};for(const f of _)f.Equivalent?g[f.Equivalent]=f.value:f.outputs_read?g[f.outputs_read.name]=f.value:f.outputs?.read&&(g[f.outputs.read.name]=f.value);return g.label=p.label,g})}this.reRenderChart(),this._updateChartInterval=setInterval(()=>{this.needToUpdateChart&&(this.reRenderChart(),this.needToUpdateChart=!1)},1500)}updateChartItem(t,i){if(t.Equivalent){if(this._rawData[i][t.Equivalent]===t.value)return;this._rawData[i][t.Equivalent]=t.value}else if(t.outputs?.read){if(this._rawData[i][t.outputs?.read.name]===t.value)return;this._rawData[i][t.outputs?.read.name]=t.value}this.needToUpdateChart=!0}reRenderChart(){this._xAxis.data.setAll(this._rawData);for(let t=0;t<this._series.length;t++){const i=this._series[t];i.data.setAll(this._rawData),i.appear(500).then(()=>{})}}getItemOutputsText(t){return t.Equivalent||t.outputs?.read.name||"undefined"}addSeries(t,i,n,r){const a=Zd.new(this._root,{name:t,xAxis:this._xAxis,yAxis:this._yAxis,valueYField:r,sequencedInterpolation:!0,categoryXField:i,tooltip:Vr.new(this._root,{labelText:"{valueY}"})});return this._series.push(a),this._chart.series.push(a),a.columns.template.setAll({cornerRadiusTL:5,cornerRadiusTR:5,strokeOpacity:0}),a}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete(),this.unsubscribeInterval$.next(),this.unsubscribeInterval$.complete(),this._root&&this._root.dispose(),this._updateChartInterval&&clearInterval(this._updateChartInterval)}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(Yr.l),d.Y36(Gd.O),d.Y36(Ie.yh))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-cluster-column-chart"]],inputs:{id:"id",config:"config"},decls:3,vars:4,consts:[[1,"container"],[4,"ngIf"],[1,"chat-container",3,"id"]],template:function(i,n){1&i&&(d.TgZ(0,"div",0),d.YNc(1,IN,2,1,"h6",1),d._UZ(2,"div",2),d.qZA()),2&i&&(d.Udp("background-color",n.backgroundColor),d.xp6(1),d.Q6J("ngIf",n.config),d.xp6(1),d.Q6J("id","column_chart_"+n.id))},dependencies:[x.O5],styles:[".container[_ngcontent-%COMP%]{width:100%;height:100%;padding:0;display:flex;flex-direction:column;border:1px solid #FFFFFF;border-radius:.5rem}.chat-container[_ngcontent-%COMP%]{padding:0;width:100%;height:100%}h6[_ngcontent-%COMP%]{text-align:center;color:#fff}"]})}return s})(),PieChart:RN,DynamicChart:JD,Gauge:dE,Card:pE,Map:fE,Table:void 0,LineChart:gE,LinkedTable:oP,Slider:uP,Button:pP,Hmi:tP,Form:yP,Submit:xP,"3D":kN,ChangeSource:AN,ProgressChart:(()=>{class s{constructor(t){this.socketService=t,this.unsubscribe$=new gi.x,this.backgroundColor="transparent",this.rawData=[]}ngAfterViewInit(){const t=this.config;this.applyContent(t.content),this._root&&this._root.dispose(),this._root=Yo.new("progress_"+this.id),this._root.setThemes([Rc.new(this._root)]),t.view.chart.BackgroundColor&&(this.backgroundColor=t.view.chart.BackgroundColor);let i=this._root.container.children.push(ja.new(this._root,{...t.view.chart,layout:this._root.verticalLayout})),r=(i.children.push(Um.new(this._root,{centerX:wi,x:wi})),i.xAxes.push(Xo.new(this._root,{categoryField:"category",renderer:fo.new(this._root,{}),tooltip:Vr.new(this._root,{})}))),a=r.get("renderer");a.grid.template.set("forceHidden",!0),a.labels.template.set("forceHidden",!0);const o=t.view.rangeColor.slice().sort((C,M)=>C.start<M.start?-1:1);let l=[];o?.forEach(C=>{l[C.start]=C.color});const c=o[o.length-1].end,h=[];let u=0,m="";for(let C=o[0].start;C<c;C++)o[u]&&(o[u+1]&&C>o[u+1].start&&u++,m=o[u].color,h.push({category:C,columnSettings:{fill:m},value:100,currentBullet:t.view.bullet.bullet==C}));r.data.setAll(h.reverse());let p=i.yAxes.push(ha.new(this._root,{...t.view.valueAxisSetting,renderer:go.new(this._root,{})})),_=p.get("renderer");_.grid.template.set("forceHidden",!0),_.labels.template.set("forceHidden",!0);const g={width:vt,tooltipY:0,strokeOpacity:1,strokeWidth:2,stroke:kn(16777215),templateField:"columnSettings"};let b=i.series.push(Zd.new(this._root,{xAxis:r,yAxis:p,valueYField:"value",categoryXField:"category",maskBullets:!1}));b.columns.template.setAll(g),b.bullets.push((C,M,E)=>{let S=E.dataContext;if(S?.currentBullet){let P=ai.new(C,{});return P.children.push(rn.new(C,{fill:S.columnSettings?.fill,dy:-5,centerY:vt,centerX:wi,svgPath:"M66.9 41.8c0-11.3-9.1-20.4-20.4-20.4-11.3 0-20.4 9.1-20.4 20.4 0 11.3 20.4 32.4 20.4 32.4s20.4-21.1 20.4-32.4zM37 41.4c0-5.2 4.3-9.5 9.5-9.5s9.5 4.2 9.5 9.5c0 5.2-4.2 9.5-9.5 9.5-5.2 0-9.5-4.3-9.5-9.5z"})),Tc.new(C,{locationY:1,sprite:P})}if(S.targetBullet){let P=ai.new(C,{dx:15});return P.children.push(Nd.new(C,{...t.view.targetCircle})),P.children.push(_r.new(C,{...t.view.targetSettings})),Tc.new(C,{locationY:.5,sprite:P})}}),b.data.setAll(h),t.view.axisLabels.forEach(C=>this.addAxisLabel(r,C.category,C.text)),b.appear(1e3,100),i.appear(1e3,100)}addAxisLabel(t,i,n,r=0){let a=t.makeDataItem({category:i}),o=t.createAxisRange(a);o&&(o.get("label")?.setAll({fill:kn(r??0),text:n,forceHidden:!1}),o.get("grid")?.setAll({strokeOpacity:1,location:1}))}applyContent(t){const i={};t.forEach(n=>{i[n.outputs.read.name]=!1,this.socketService.fetchDeviceData(n.topic.id,n.outputs.read.name).pipe((0,ri.U)(r=>{if("string"==typeof r&&(r=JSON.parse(r)),r&&i[n.outputs.read.name]!==r){const a=new Date((new Date).toLocaleString("fa-IR-u-nu-latn"));this.rawData.push({...r,id:a.getTime(),name:n.outputs.read.name,topic:n.topic.name,date:a})}else"kn6r4fpx8yr"===n.topic.id&&(this.rawData=this.rawData.filter(a=>a.name!==n.outputs.read.name));i[n.outputs.read.name]=r}),(0,he.R)(this.unsubscribe$)).subscribe()})}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(Yr.l))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-progress-bar"]],inputs:{id:"id",config:"config"},decls:1,vars:3,consts:[[1,"container",3,"id"]],template:function(i,n){1&i&&d._UZ(0,"div",0),2&i&&(d.Udp("background-color",n.backgroundColor),d.Q6J("id","progress_"+n.id))},styles:[".container[_ngcontent-%COMP%]{width:100%;height:100%}"]})}return s})()},LN=["Host"];function FN(s,e){if(1&s){const t=d.EpF();d.TgZ(0,"button",5),d.NdJ("click",function(){d.CHM(t);const n=d.oxw();return d.KtG(n.dockManager.addFloatingWindow(n.panel))}),d.TgZ(1,"mat-icon"),d._uU(2,"branding_watermark"),d.qZA()()}}function BN(s,e){}const NN=function(s){return{backgroundColor:s}};let t_=(()=>{class s extends uu.H{constructor(t,i){super(),this.dockManager=t,this.dashboardStore=i,this.colorGrid="transparent"}ngAfterViewInit(){this.drawComponent()}get item(){return this.panel.gridSterConfig}drawComponent(){this.item.localId&&this.dashboardStore.select((0,ze.rM)(this.item.localId)).pipe((0,Di.q)(1),(0,ri.U)(t=>{if(Na.N.LOGGER&&console.log(t),t&&t.config){this.data=t.config;const n=vC[t.type],r=this.host;r.clear();const a=r.createComponent(n);a.instance.id=t.localId,a.instance.config=t.config,"Form"===this.item.type&&("Flow"===this.item.config.content.Name||"SetpointFlow"===this.item.config.content.Name?(a.instance.min=0,a.instance.max=28):"Level"===this.item.config.content.Name||"SetpointLevel"===this.item.config.content.Name?(a.instance.min=0,a.instance.max=100):"Temp"===this.item.config.content.Name?(a.instance.min=0,a.instance.max=50):"SetpointTemp"===this.item.config.content.Name?(a.instance.min=0,a.instance.max=45):"Hystersis"===this.item.config.content.Name&&(a.instance.min=0,a.instance.max=2)),"Submit"===this.item.type&&(a.instance.form=this.Form)}})).subscribe()}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(cy),d.Y36(Ie.yh))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["panel-container"]],viewQuery:function(i,n){if(1&i&&d.Gf(LN,7,d.s_b),2&i){let r;d.iGM(r=d.CRH())&&(n.host=r.first)}},inputs:{panel:"panel",Form:"Form",colorGrid:"colorGrid"},features:[d.qOj],decls:6,vars:4,consts:[[1,"panel-container"],["color","primary","mat-icon-button","","class","floating-window-icon",3,"click",4,"ngIf"],[1,"grid-item-container",3,"ngStyle"],[1,"grid-item-content"],["Host",""],["color","primary","mat-icon-button","",1,"floating-window-icon",3,"click"]],template:function(i,n){1&i&&(d.TgZ(0,"div",0),d.YNc(1,FN,3,0,"button",1),d.TgZ(2,"div",2)(3,"div",3),d.YNc(4,BN,0,0,"ng-template",null,4,d.W1O),d.qZA()()()),2&i&&(d.xp6(1),d.Q6J("ngIf",!n.dockManager.lockActiveDashboardLayout&&n.panel.isGridSter),d.xp6(1),d.Q6J("ngStyle",d.VKq(2,NN,n.colorGrid)))},dependencies:[x.O5,x.PC,pn.RK,jn.Hw],styles:[".panel-container[_ngcontent-%COMP%]{position:relative;width:100%;height:100%}.floating-window-icon[_ngcontent-%COMP%]{position:absolute;top:10px;left:10px;opacity:.7;z-index:2}.grid-item-content[_ngcontent-%COMP%]{width:100%;height:100%}.grid-item-content[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;height:100%}.grid-item-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;margin:0;padding:0;width:100%;height:100%;overflow-y:hidden;position:relative}.grid-item-content[_ngcontent-%COMP%]{width:100%;height:100%;padding:.1rem}"]})}return s})();class UN{constructor(e,t){this.wheel=e,this.id=t;let i=t.replace("-s","");this.element=document.createElement("div"),this.element.classList.add("dock-wheel-item"),this.element.classList.add("disable-selection"),this.element.classList.add("dock-wheel-"+i),this.element.classList.add("dock-wheel-"+i+"-icon"),this.hoverIconClass="dock-wheel-"+i+"-icon-hover",this.mouseOverHandler=new li(this.element,"pointerover",this.onMouseMoved.bind(this)),this.mouseOutHandler=new li(this.element,"pointerout",this.onMouseOut.bind(this)),this.active=!1}onMouseMoved(){this.active=!0,this.element.classList.add(this.hoverIconClass),this.wheel.onMouseOver(this)}onMouseOut(){this.active=!1,this.element.classList.remove(this.hoverIconClass),this.wheel.onMouseOut()}}var Gs=function(s){return s.left="left",s.right="right",s.top="top",s.down="down",s.fill="fill",s["left-s"]="left-s",s["right-s"]="right-s",s["top-s"]="top-s",s["down-s"]="down-s",s}(Gs||{});class zN{constructor(e){this.dockManager=e,this.elementMainWheel=document.createElement("div"),this.elementSideWheel=document.createElement("div"),this.wheelItems={};for(let i in Gs)this.wheelItems[i]=new UN(this,i),"-s"===i.substr(-2,2)?this.elementSideWheel.appendChild(this.wheelItems[i].element):this.elementMainWheel.appendChild(this.wheelItems[i].element);let t=9e6;this.elementMainWheel.classList.add("dock-wheel-base"),this.elementSideWheel.classList.add("dock-wheel-base"),this.elementMainWheel.style.zIndex=String(t+1),this.elementSideWheel.style.zIndex=String(t),this.elementPanelPreview=document.createElement("div"),this.elementPanelPreview.classList.add("dock-wheel-panel-preview"),this.elementPanelPreview.style.zIndex=String(t-1),this.activeDialog=void 0,this._activeNode=void 0,this._visible=!1}get activeNode(){return this._activeNode}set activeNode(e){let t=this._activeNode;this._activeNode=e,t!==this._activeNode&&this._visible&&this.showWheel()}showWheel(){if(this._visible=!0,!this.activeNode)return fi.removeNode(this.elementMainWheel),void fi.removeNode(this.elementSideWheel);let e=this.activeNode.container.containerElement,i=e.clientHeight,n=Math.floor(e.clientWidth/2),r=Math.floor(i/2),a=e.getBoundingClientRect(),o=this.dockManager.element.getBoundingClientRect();this.elementMainWheel.style.left=a.left-o.left+n+"px",this.elementMainWheel.style.top=a.top-o.top+r+"px",fi.removeNode(this.elementMainWheel),this.dockManager.element.appendChild(this.elementMainWheel)}_setWheelButtonPosition(e,t,i){let n=this.wheelItems[e],a=n.element.clientHeight/2,o=Math.floor(t-n.element.clientWidth/2),l=Math.floor(i-a);n.element.style.marginLeft=o+"px",n.element.style.marginTop=l+"px"}hideWheel(){this._visible=!1,this.activeNode=void 0,fi.removeNode(this.elementMainWheel),fi.removeNode(this.elementSideWheel),fi.removeNode(this.elementPanelPreview);for(let e in this.wheelItems)this.wheelItems[e].active=!1}onMouseOver(e){if(!this.activeDialog)return;let i,t=this.dockManager.context.model.rootNode;e.id===Gs.top?i=this.dockManager.layoutEngine.getDockBounds(this.activeNode,this.activeDialog.panel,"vertical",!0):e.id===Gs.down?i=this.dockManager.layoutEngine.getDockBounds(this.activeNode,this.activeDialog.panel,"vertical",!1):e.id===Gs.left?i=this.dockManager.layoutEngine.getDockBounds(this.activeNode,this.activeDialog.panel,"horizontal",!0):e.id===Gs.right?i=this.dockManager.layoutEngine.getDockBounds(this.activeNode,this.activeDialog.panel,"horizontal",!1):e.id===Gs.fill?i=this.dockManager.layoutEngine.getDockBounds(this.activeNode,this.activeDialog.panel,"fill",!1):e.id===Gs["top-s"]?i=this.dockManager.layoutEngine.getDockBounds(t,this.activeDialog.panel,"vertical",!0):e.id===Gs["down-s"]?i=this.dockManager.layoutEngine.getDockBounds(t,this.activeDialog.panel,"vertical",!1):e.id===Gs["left-s"]?i=this.dockManager.layoutEngine.getDockBounds(t,this.activeDialog.panel,"horizontal",!0):e.id===Gs["right-s"]&&(i=this.dockManager.layoutEngine.getDockBounds(t,this.activeDialog.panel,"horizontal",!1)),i&&(this.dockManager.element.appendChild(this.elementPanelPreview),this.elementPanelPreview.style.left=Math.round(i.x)+"px",this.elementPanelPreview.style.top=Math.round(i.y)+"px",this.elementPanelPreview.style.width=Math.round(i.width)+"px",this.elementPanelPreview.style.height=Math.round(i.height)+"px")}onMouseOut(){fi.removeNode(this.elementPanelPreview)}onDialogDropped(e){let t=this._getActiveWheelItem();t&&this._handleDockRequest(t,e)}_getActiveWheelItem(){for(let e in this.wheelItems){let t=this.wheelItems[e];if(t.active)return t}}_handleDockRequest(e,t){e.active=!1,e.element.classList.remove(e.hoverIconClass),this.activeNode&&(e.id===Gs.left?this.dockManager.dockDialogLeft(this.activeNode,t):e.id===Gs.right?this.dockManager.dockDialogRight(this.activeNode,t):e.id===Gs.top?this.dockManager.dockDialogUp(this.activeNode,t):e.id===Gs.down?this.dockManager.dockDialogDown(this.activeNode,t):e.id===Gs.fill?this.dockManager.dockDialogFill(this.activeNode,t):e.id===Gs["left-s"]?this.dockManager.dockDialogLeft(this.dockManager.context.model.rootNode,t):e.id===Gs["right-s"]?this.dockManager.dockDialogRight(this.dockManager.context.model.rootNode,t):e.id===Gs["top-s"]?this.dockManager.dockDialogUp(this.dockManager.context.model.rootNode,t):e.id===Gs["down-s"]&&this.dockManager.dockDialogDown(this.dockManager.context.model.rootNode,t))}}class ay{constructor(){this.rootNode=this.documentManagerNode=void 0}}let HN=(()=>{class s{constructor(t){this.parent=t;let i=this._performUndock.bind(this);this.elementBase=document.createElement("div"),this.elementText=document.createElement("div"),this.elementCloseButton=document.createElement("div"),this.elementBase.classList.add("dockspan-tab-handle"),this.elementBase.classList.add("disable-selection"),this.elementText.classList.add("dockspan-tab-handle-text"),this.elementCloseButton.classList.add("dockspan-tab-handle-close-button"),this.elementBase.appendChild(this.elementText),this.parent.host.displayCloseButton&&this.elementBase.appendChild(this.elementCloseButton),(this.parent.container._hideCloseButton||this.parent.container._grayOut)&&(this.elementCloseButton.style.display="none"),this.parent.host.tabListElement.appendChild(this.elementBase);let n=t.container,r=n.getRawTitle();this.undockListener={onDockEnabled:a=>{this.undockEnabled(a.state)},onHideCloseButton:a=>{this.hideCloseButton(a.state)}},this.eventListeners=[],n.addListener(this.undockListener),this.elementText.innerHTML=r,this.elementText.title=this.elementText.innerText,this.undockInitiator=new Xm(this.elementBase,i),this.undockInitiator.enabled=!0,this.mouseDownHandler=new li(this.elementBase,"mousedown",this.onMouseDown.bind(this)),this.touchDownHandler=new li(this.elementBase,"touchstart",this.onMouseDown.bind(this),{passive:!1}),this.closeButtonHandler=new li(this.elementCloseButton,"click",this.onCloseButtonClicked.bind(this)),this.closeButtonTouchHandler=new li(this.elementCloseButton,"touchstart",this.onCloseButtonClicked.bind(this)),this.auxClickHandler=new li(this.elementBase,"auxclick",this.onCloseButtonClicked.bind(this)),n.panelType==ur.document&&(this.contextMenuHandler=new li(this.elementBase,"contextmenu",this.oncontextMenuClicked.bind(this)))}addListener(t){this.eventListeners.push(t)}removeListener(t){this.eventListeners.splice(this.eventListeners.indexOf(t),1)}undockEnabled(t){this.undockInitiator.enabled=t}static#e=this.createContextMenuContentCallback=(t,i,n)=>{let r=document.createElement("div");r.innerText=Ua.getString("CloseAll"),i.append(r),r.onclick=()=>{for(let c=n.length-1;c>=0;c--){let h=n[c].container;h.panelType==ur.document&&h.close()}t.closeContextMenu()};let a=document.createElement("div");a.innerText=Ua.getString("CloseAllButThis"),i.append(a),a.onclick=()=>{for(let c=n.length-1;c>=0;c--){let h=n[c].container;t.parent.container!=h&&h.panelType==ur.document&&h.close()}t.closeContextMenu()};let o=document.createElement("div");o.innerText=Ua.getString("NewBrowserWindow"),i.append(o),o.onclick=()=>{t.parent.container.undockToBrowserDialog(),t.closeContextMenu()}};oncontextMenuClicked(t){t.preventDefault(),!this._ctxMenu&&s.createContextMenuContentCallback?(this._ctxMenu=document.createElement("div"),this._ctxMenu.className="dockspab-tab-handle-context-menu",s.createContextMenuContentCallback(this,this._ctxMenu,this.parent.container.dockManager.context.model.documentManagerNode.children),this._ctxMenu.style.left=t.pageX+"px",this._ctxMenu.style.top=t.pageY+"px",document.body.appendChild(this._ctxMenu),this._windowsContextMenuCloseBound=this.windowsContextMenuClose.bind(this),window.addEventListener("mouseup",this._windowsContextMenuCloseBound)):this.closeContextMenu()}closeContextMenu(){this._ctxMenu&&(document.body.removeChild(this._ctxMenu),delete this._ctxMenu,window.removeEventListener("mouseup",this._windowsContextMenuCloseBound))}windowsContextMenuClose(t){let i=t.composedPath();for(let n in i)if(i[n]==this._ctxMenu)return;this.closeContextMenu()}onMouseDown(t){t.preventDefault(),this.parent.onSelected(),this.mouseMoveHandler&&(this.mouseMoveHandler.cancel(),delete this.mouseMoveHandler),this.touchMoveHandler&&(this.touchMoveHandler.cancel(),delete this.touchMoveHandler),this.mouseUpHandler&&(this.mouseUpHandler.cancel(),delete this.mouseUpHandler),this.touchUpHandler&&(this.touchUpHandler.cancel(),delete this.touchUpHandler),this.stargDragPosition=t.clientX,this.mouseMoveHandler=new li(window,"mousemove",this.onMouseMove.bind(this)),this.touchMoveHandler=new li(window,"touchmove",this.onMouseMove.bind(this),{passive:!1}),this.mouseUpHandler=new li(window,"mouseup",this.onMouseUp.bind(this)),this.touchUpHandler=new li(window,"touchend",this.onMouseUp.bind(this))}onMouseUp(t){this.elementBase&&this.elementBase.classList.remove("dockspan-tab-handle-dragged"),this.dragged=!1,this.mouseMoveHandler&&this.mouseMoveHandler.cancel(),this.touchMoveHandler&&this.touchMoveHandler.cancel(),this.mouseUpHandler&&this.mouseUpHandler.cancel(),this.touchUpHandler&&this.touchUpHandler.cancel(),delete this.mouseMoveHandler,delete this.touchMoveHandler,delete this.mouseUpHandler,delete this.touchUpHandler}moveTabEvent(t,i){t.eventListeners.forEach(n=>{n.onMoveTab&&n.onMoveTab({self:t,state:i})})}onMouseMove(t){if(t.preventDefault(),!(Math.abs(this.stargDragPosition-t.clientX)<10)&&null!=this.elementBase){this.elementBase.classList.add("dockspan-tab-handle-dragged"),this.dragged=!0,this.prev=this.current,this.current=t.clientX,this.direction=this.current-this.prev;let i=this.elementBase.getBoundingClientRect();(t.clientX<i.left&&this.direction<0||t.clientX>i.left+i.width&&this.direction>0)&&this.moveTabEvent(this,(this.direction<0?{state:"left",bound:i.left,rect:i}:{state:"right",bound:i.right,rect:i}).state)}}hideCloseButton(t){this.elementCloseButton.style.display=t?"none":"block"}updateTitle(){if(this.parent.container instanceof Xs){let i=this.parent.container.getRawTitle();this.elementText.innerHTML=i}}destroy(){this.parent.container.removeListener(this.undockListener),this.mouseDownHandler.cancel(),this.touchDownHandler.cancel(),this.closeButtonHandler.cancel(),this.closeButtonTouchHandler.cancel(),this.auxClickHandler.cancel(),this.mouseMoveHandler&&this.mouseMoveHandler.cancel(),this.touchMoveHandler&&this.touchMoveHandler.cancel(),this.mouseUpHandler&&this.mouseUpHandler.cancel(),this.touchUpHandler&&this.touchUpHandler.cancel(),this.contextMenuHandler&&this.contextMenuHandler.cancel(),this.elementBase&&(fi.removeNode(this.elementBase),delete this.elementBase),this.elementCloseButton&&(fi.removeNode(this.elementCloseButton),delete this.elementCloseButton)}_performUndock(t,i){return"panel"===this.parent.container.containerType?(this.undockInitiator.enabled=!1,this.parent.container.performUndockToDialog(t,i)):null}onCloseButtonClicked(t){"none"!==this.elementCloseButton.style.display&&2!==t.button&&"panel"===this.parent.container.containerType&&this.parent.container.close()}setSelected(t){t?this.elementBase.classList.add("dockspan-tab-handle-selected"):(this.elementBase.classList.remove("dockspan-tab-handle-selected"),this.elementBase.classList.remove("dockspan-tab-handle-active"))}setActive(t){this.elementBase&&(t?this.elementBase.classList.add("dockspan-tab-handle-active"):this.elementBase.classList.remove("dockspan-tab-handle-active"))}}return s})();class yC{constructor(e,t){0!==arguments.length&&(this.selected=!1,this.host=e,this.container=t,this.handle=new HN(this),this.containerElement=t.containerElement,t instanceof Xs&&(this.panel=t,this.panel.onTitleChanged=this.onTitleChanged.bind(this),this.onTitleChanged()),t.tabPage=this)}onTitleChanged(){this.handle.updateTitle(),this.panel&&(this.panel.hasChanges?this.handle.elementText.classList.add("panel-has-changes"):this.handle.elementText.classList.remove("panel-has-changes"))}destroy(){this.handle.destroy(),this.container instanceof Xs&&delete this.container.onTitleChanged,this.host.dockManager.activePanel==this.panel&&(this.host.dockManager.activePanel=null),this.container.tabPage=null,fi.removeNode(this.containerElement)}onSelected(){this.host.onTabPageSelected(this,!0),this.container instanceof Xs&&this.container.dockManager.notifyOnTabChange(this)}setSelected(e,t){this.selected=e,this.handle.setSelected(e),this._initContent||this.host.contentElement.appendChild(this.containerElement),this._initContent=!0,this.selected?(this.containerElement.style.display="block",this.panel.setVisible(!0),this.container.resize(this.host.contentElement.clientWidth,this.host.contentElement.clientHeight),t&&(this.host.dockManager.activePanel=this.container)):(this.containerElement.style.display="none",this.panel.setVisible(!1))}resize(e,t){this.container.resize(e,t)}}var tu=function(s){return s[s.TOP=0]="TOP",s[s.BOTTOM=1]="BOTTOM",s[s.LEFT=2]="LEFT",s[s.RIGHT=3]="RIGHT",s}(tu||{});class VN{constructor(e,t,i){if(void 0===t&&(t=tu.BOTTOM),void 0===i&&(i=!1),this.dockManager=e,this.tabStripDirection=t,this.displayCloseButton=i,this.pages=[],this.eventListeners=[],this.tabHandleListener={onMoveTab:n=>{this.onMoveTab(n)}},this.hostElement=document.createElement("div"),this.tabListElement=document.createElement("div"),this.separatorElement=document.createElement("div"),this.contentElement=document.createElement("div"),this.contentElement.tabIndex=0,this.createTabPage=this._createDefaultTabPage,this.tabStripDirection===tu.BOTTOM)this.hostElement.appendChild(this.contentElement),this.hostElement.appendChild(this.separatorElement),this.hostElement.appendChild(this.tabListElement);else{if(this.tabStripDirection!==tu.TOP)throw new Error("Only top and bottom tab strip orientations are supported");this.hostElement.appendChild(this.tabListElement),this.hostElement.appendChild(this.separatorElement),this.hostElement.appendChild(this.contentElement)}this.hostElement.classList.add("dockspan-tab-host"),this.tabListElement.classList.add("dockspan-tab-handle-list-container"),this.separatorElement.classList.add("dockspan-tab-handle-content-seperator"),this.contentElement.classList.add("dockspan-tab-content"),this.contentElement.tabIndex=0,this.focusHandler=new li(this.contentElement,"focus",this.onFocus.bind(this),!0),this.mouseDownHandler=new li(this.contentElement,"mousedown",this.onMousedown.bind(this),!0)}onFocus(){this.activeTab&&this.dockManager.activePanel!=this.activeTab.panel&&(this.dockManager.activePanel=this.activeTab.panel)}setActive(e){e?this.separatorElement.classList.add("dockspan-tab-handle-content-seperator-active"):this.separatorElement.classList.remove("dockspan-tab-handle-content-seperator-active"),this.activeTab&&this.activeTab.handle.setActive(e)}onMousedown(){this.activeTab&&this.dockManager.activePanel!=this.activeTab.panel&&(this.dockManager.activePanel=this.activeTab.panel)}onMoveTab(e){let t=Array.prototype.slice.call(this.tabListElement.childNodes).indexOf(e.self.elementBase);this.change(this,e.self,e.state,t)}performTabsLayout(e){this.pages=fi.orderByIndexes(this.pages,e);let t=this.tabListElement.childNodes,i=[];for(let n in t)1===t[n].nodeType&&i.push(t[n]);i=fi.orderByIndexes(i,e);for(let n=0;n<i.length;++n)this.tabListElement.appendChild(i[n]);this.activeTab&&this.onTabPageSelected(this.activeTab,!1)}getActiveTab(){return this.activeTab}addListener(e){this.eventListeners.push(e)}removeListener(e){this.eventListeners.splice(this.eventListeners.indexOf(e),1)}change(e,t,i,n){this.eventListeners.forEach(r=>{r.onChange&&r.onChange({host:e,handle:t,state:i,index:n})})}_createDefaultTabPage(e,t){return new yC(e,t)}setActiveTab(e){let t;this.pages.forEach(i=>{i.container===e&&(t=i)}),this.pages.length>0&&t&&(this.onTabPageSelected(t,!0),this.dockManager.activePanel=e)}resize(e,t){this.hostElement.style.width=e+"px",this.hostElement.style.height=t+"px";let i=this.tabListElement.clientHeight;this._resizeRequested||requestAnimationFrame(()=>this.resizeTabListElement(e,t)),this._resizeRequested=!0;let r=t-i-this.separatorElement.clientHeight;this.contentElement.style.height=r+"px",this.activeTab&&this.activeTab.resize(e,r)}resizeTabListElement(e,t){if(this._resizeRequested=!1,0===this.pages.length)return;let i=0;this.pages.forEach(r=>{let a=r.handle;null!=a.elementBase&&(a.elementBase.style.width="",i+=a.elementBase.clientWidth)});let n=e/i;n>1.2||this.pages.forEach((r,a)=>{let o=r.handle,l=n*o.elementBase.clientWidth;a===this.pages.length-1&&(l-=5),o.elementBase.style.width=l+"px"})}performLayout(e){this.pages.forEach(n=>{if(!e.some(r=>r==n.container)){n.handle.removeListener(this.tabHandleListener),n.destroy();let r=this.pages.indexOf(n);r>-1&&this.pages.splice(r,1)}});let t=this.activeTab;delete this.activeTab;let i=e.filter(n=>"panel"===n.containerType);i.length>0?(i.forEach(n=>{let r=null;this.pages.some(a=>a.container==n&&(r=a,!0))||(r=this.createTabPage(this,n),r.handle.addListener(this.tabHandleListener),this.pages.push(r)),t&&r.container===t.container&&(this.activeTab=r)}),this._setTabHandlesVisible(!0)):this._setTabHandlesVisible(!1),this.activeTab&&this.onTabPageSelected(this.activeTab,!1)}_setTabHandlesVisible(e){e?(this.tabListElement.classList.add("dockspan-tab-handle-list-container-visible"),this.separatorElement.classList.add("dockspan-tab-handle-content-seperator-visible")):(this.tabListElement.classList.remove("dockspan-tab-handle-list-container-visible"),this.separatorElement.classList.remove("dockspan-tab-handle-content-seperator-visible"))}onTabPageSelected(e,t){this.activeTab=e,this.pages.forEach(i=>{i.setSelected(i===e,t)})}}class i_{constructor(e,t){void 0===t&&(t=tu.BOTTOM),this.dockManager=e,this.tabOrientation=t,this.name=fi.getNextId("fill_"),this.element=document.createElement("div"),this.containerElement=this.element,this.containerType=Ta.fill,this.minimumAllowedChildNodes=2,this.element.classList.add("dock-container"),this.element.classList.add("dock-container-fill"),this.tabHost=new VN(e,this.tabOrientation),this.tabHostListener={onChange:i=>{this.dockManager._requestTabReorder(this,i)}},this.tabHost.addListener(this.tabHostListener),this.element.appendChild(this.tabHost.hostElement)}setActiveChild(e){this.tabHost.setActiveTab(e)}resize(e,t){this.element.style.width=e+"px",this.element.style.height=t+"px",this.tabHost.resize(e,t)}performLayout(e){this.tabHost.performLayout(e)}destroy(){this.tabHost.pages.forEach(e=>e.destroy()),fi.removeNode(this.element)&&delete this.element}saveState(e){e.width=this.width,e.height=this.height,e.name=this.name}loadState(e){this.state={width:e.width,height:e.height},this.name=e.name}get width(){return this.element.clientWidth}set width(e){this.element.style.width=e+"px"}get height(){return this.element.clientHeight}set height(e){this.element.style.height=e+"px"}}class WN extends yC{constructor(e,t){super(e,t),"panel"===this.container.containerType&&(this.panel=t,this.containerElement=this.panel.elementContentWrapper,fi.removeNode(this.containerElement))}destroy(){super.destroy(),this.panel.elementContentHost.appendChild(this.containerElement)}}class n_ extends i_{constructor(e){super(e,tu.TOP),this.minimumAllowedChildNodes=0,this.element.classList.add("document-manager"),this.tabHost.createTabPage=this._createDocumentTabPage,this.tabHost.displayCloseButton=!0}_createDocumentTabPage(e,t){return new WN(e,t)}saveState(e){super.saveState(e),e.documentManager=!0}selectedTab(){return this.tabHost.activeTab}}class GN{constructor(e){this.dockManager=e,this.model=new ay,this.documentManagerView=new n_(this.dockManager)}}class rc{constructor(e){this.container=e,this.children=[]}detachFromParent(){this.parent&&(this.parent.removeChild(this),delete this.parent)}removeChild(e){let t=this.children.indexOf(e);t>=0&&this.children.splice(t,1)}addChild(e){e.detachFromParent(),e.parent=this,this.children.push(e)}addChildBefore(e,t){this._addChildWithDirection(e,t,!0)}addChildAfter(e,t){this._addChildWithDirection(e,t,!1)}_addChildWithDirection(e,t,i){t.detachFromParent(),t.parent=this;let n=this.children.indexOf(e),r=this.children.slice(0,n),a=this.children.slice(n+1,this.children.length);this.children=r.slice(0),i?(this.children.push(t),this.children.push(e)):(this.children.push(e),this.children.push(t)),Array.prototype.push.apply(this.children,a)}performLayout(e){let t=this.children.map(i=>i.container);0!==t.length&&this.container.performLayout(t,e)}debugDumpTree(e){void 0===e&&(e=0);let t=this.container.name;for(let n=0;n<e;n++)t="\t"+t;console.log(">>"+t+" ["+(void 0===this.parent?"null":this.parent.container.containerType)+"]"),this.children.forEach(n=>{n.debugDumpTree(e+1)})}}class YN{constructor(e,t,i){this.previousContainer=e,this.nextContainer=t,this.stackedVertical=i,this.barElement=document.createElement("div"),this.barElement.classList.add(i?"splitbar-horizontal":"splitbar-vertical"),this.pointerDownHandler=new li(this.barElement,"pointerdown",this.onPointerDown.bind(this)),this.minPanelSize=50,this.readyToProcessNextDrag=!0,this.dockSpawnResizedEvent=new CustomEvent("DockSpawnResizedEvent",{composed:!0,bubbles:!0}),this.iframeEventHandlers=[]}onPointerDown(e){this.barElement.setPointerCapture(e.pointerId),this._startDragging(e)}onPointerUp(e){this.barElement.releasePointerCapture(e.pointerId),this._stopDragging()}onPointerMovedIframe(e,t){null!=e.changedTouches&&(e=e.changedTouches[0]);let i=t.getBoundingClientRect();this.handleMoveEvent({x:parseInt(""+e.clientX+i.x),y:parseInt(""+e.clientY+i.y)})}onPointerMoved(e){null!=e.changedTouches&&(e=e.changedTouches[0]),this.handleMoveEvent({x:parseInt(""+e.clientX),y:parseInt(""+e.clientY)})}handleMoveEvent(e){if(!this.readyToProcessNextDrag)return;this.readyToProcessNextDrag=!1;let t=this.previousContainer.dockManager;t.suspendLayout(this.previousContainer),t.suspendLayout(this.nextContainer),this._performDrag(e.x-this.previousMouseEvent.x,e.y-this.previousMouseEvent.y),this.previousMouseEvent=e,this.readyToProcessNextDrag=!0,t.resumeLayout(this.previousContainer),t.resumeLayout(this.nextContainer)}_performDrag(e,t){let i=this.previousContainer.containerElement.clientWidth,n=this.previousContainer.containerElement.clientHeight,r=this.nextContainer.containerElement.clientWidth,a=this.nextContainer.containerElement.clientHeight,o=this.stackedVertical?n:i,l=this.stackedVertical?a:r,c=this.stackedVertical?t:e,h=o+c,u=l-c;(h<this.minPanelSize||u<this.minPanelSize)&&!(h<this.minPanelSize&&h>o||u<this.minPanelSize&&u>l)||(this.stackedVertical?(this.previousContainer.resize(i,h),this.nextContainer.resize(r,u)):c<0?(this.previousContainer.resize(h,n),this.nextContainer.resize(u,a)):(this.nextContainer.resize(u,a),this.previousContainer.resize(h,n),this.nextContainer.resize(u,a)),document.dispatchEvent(this.dockSpawnResizedEvent))}_startDragging(e){if(fi.disableGlobalTextSelection(this.previousContainer.dockManager.config.dialogRootElement),this.pointerMovedHandler&&(this.pointerMovedHandler.cancel(),delete this.pointerMovedHandler),this.pointerUpHandler&&(this.pointerUpHandler.cancel(),delete this.pointerUpHandler),this.pointerMovedHandler=new li(window,"pointermove",this.onPointerMoved.bind(this)),this.pointerUpHandler=new li(window,"pointerup",this.onPointerUp.bind(this)),this.previousContainer.dockManager.iframes)for(let t of this.previousContainer.dockManager.iframes){let i=this.onPointerMovedIframe.bind(this);this.iframeEventHandlers.push(new li(t.contentWindow,"pointermove",n=>i(n,t))),this.iframeEventHandlers.push(new li(t.contentWindow,"pointerup",this.onPointerUp.bind(this)))}this.previousMouseEvent={x:e.clientX,y:e.clientY}}_stopDragging(){fi.enableGlobalTextSelection(this.previousContainer.dockManager.config.dialogRootElement),this.pointerMovedHandler&&(this.pointerMovedHandler.cancel(),delete this.pointerMovedHandler),this.pointerUpHandler&&(this.pointerUpHandler.cancel(),delete this.pointerUpHandler);for(let e of this.iframeEventHandlers)e.cancel();this.iframeEventHandlers=[]}}class jN{constructor(e,t){this.childContainers=e,this.stackedVertical=t,this.panelElement=document.createElement("div"),this.spiltterBars=[],this._buildSplitterDOMAndAddElements()}_buildSplitterDOMAndAddElements(){if(this.childContainers.length<=1)throw new Error("Splitter panel should contain atleast 2 panels");this.spiltterBars=[];let e=null;for(let i=0;i<this.childContainers.length-1;i++){let n=this.childContainers[i],a=new YN(n,this.childContainers[i+1],this.stackedVertical);this.spiltterBars.push(a),Array.from(this.panelElement.children).includes(n.containerElement)||this._insertContainerIntoPanel(n,e),this.panelElement.insertBefore(a.barElement,n.containerElement.nextSibling),e=a.barElement}let t=this.childContainers.slice(-1)[0];Array.from(this.panelElement.children).includes(t.containerElement)||this._insertContainerIntoPanel(t,e)}performLayout(e,t){(!fi.arrayEqual(this.childContainers,e)||t)&&(this.childContainers.forEach(n=>{e.some(r=>r==n)||n.containerElement&&(n.containerElement.classList.remove("splitter-container-vertical"),n.containerElement.classList.remove("splitter-container-horizontal"),fi.removeNode(n.containerElement))}),this.spiltterBars.forEach(n=>{fi.removeNode(n.barElement)}),this.childContainers=e,this._buildSplitterDOMAndAddElements())}removeFromDOM(){this.childContainers.forEach(e=>{e.containerElement&&(e.containerElement.classList.remove("splitter-container-vertical"),e.containerElement.classList.remove("splitter-container-horizontal"),fi.removeNode(e.containerElement))}),this.spiltterBars.forEach(e=>{fi.removeNode(e.barElement)})}destroy(){this.removeFromDOM(),this.panelElement.parentNode.removeChild(this.panelElement)}_insertContainerIntoPanel(e,t){e?(e.containerElement.parentNode!=this.panelElement&&(fi.removeNode(e.containerElement),t?this.panelElement.insertBefore(e.containerElement,t.nextSibling):this.panelElement.children.length>0?this.panelElement.insertBefore(e.containerElement,this.panelElement.children[0]):this.panelElement.appendChild(e.containerElement)),e.containerElement.classList.add(this.stackedVertical?"splitter-container-vertical":"splitter-container-horizontal")):console.error("container is undefined")}setContainerRatio(e,t){let i=this.stackedVertical?this.panelElement.clientHeight:this.panelElement.clientWidth,n=i*t,o=(i-n-(this.stackedVertical?this.spiltterBars[0].barElement.clientHeight:this.spiltterBars[0].barElement.clientWidth)*this.spiltterBars.length)/i;for(let l=0;l<this.childContainers.length;l++){let h,c=this.childContainers[l];c!==e?(h=this.stackedVertical?c.containerElement.parentElement.clientHeight:c.containerElement.parentElement.clientWidth,h*=o):h=n,this.stackedVertical?c.resize(c.width,Math.floor(h)):c.resize(Math.floor(h),c.height)}}getRatios(){let t=(this.stackedVertical?this.panelElement.clientHeight:this.panelElement.clientWidth)-(this.stackedVertical?this.spiltterBars[0].barElement.clientHeight:this.spiltterBars[0].barElement.clientWidth)*this.spiltterBars.length,i=[];for(let n=0;n<this.childContainers.length;n++){let r=this.childContainers[n];i.push((this.stackedVertical?r.containerElement.clientHeight:r.containerElement.clientWidth)/t)}return i}setRatios(e){let i=(this.stackedVertical?this.panelElement.clientHeight:this.panelElement.clientWidth)-(this.stackedVertical?this.spiltterBars[0].barElement.clientHeight:this.spiltterBars[0].barElement.clientWidth)*this.spiltterBars.length;for(let n=0;n<this.childContainers.length;n++){let r=this.childContainers[n],a=i*e[n];this.stackedVertical?r.resize(r.width,Math.floor(a)):r.resize(Math.floor(a),r.height)}}resize(e,t){if(this.childContainers.length<=1)return;let i;for(this.panelElement.style.width=e+"px",this.panelElement.style.height=t+"px",i=0;i<this.childContainers.length;i++){let h=this.childContainers[i];if(this.stackedVertical?h.resize(e,h.height?h.height:t):h.resize(h.width?h.width:e,t),i<this.spiltterBars.length){let u=this.spiltterBars[i];this.stackedVertical?u.barElement.style.width=e+"px":u.barElement.style.height=t+"px"}}let n=0;this.childContainers.forEach(h=>{n+=this.stackedVertical?h.height:h.width});const r=this.spiltterBars[0].barElement.getBoundingClientRect();let o=this.stackedVertical?t:e;o-=(this.stackedVertical?r.height:r.width)*this.spiltterBars.length,n=Math.max(n,1);let l=o/n,c=0;for(i=0;i<this.childContainers.length;i++){let h=this.childContainers[i];"none"==h.containerElement.style.display&&(h.containerElement.style.display="block");let u=this.stackedVertical?h.containerElement.clientHeight:h.containerElement.clientWidth,m=l>1?Math.floor(u*l):Math.ceil(u*l);c+=m,i===this.childContainers.length-1&&(m+=o-c),this.stackedVertical?h.resize(h.width,m):h.resize(m,h.height)}}}class xC{constructor(e,t,i,n){0!==arguments.length&&(this.name=e,this.dockManager=t,this.stackedVertical=n,this.splitterPanel=new jN(i,this.stackedVertical),this.containerElement=this.splitterPanel.panelElement,this.minimumAllowedChildNodes=2)}resize(e,t){this.splitterPanel.resize(e,t),this._cachedWidth=e,this._cachedHeight=t}performLayout(e,t=!1){this.splitterPanel.performLayout(e,t)}setActiveChild(){}destroy(){this.splitterPanel.destroy()}setContainerRatio(e,t){this.splitterPanel.setContainerRatio(e,t),this.resize(this.width,this.height)}getRatios(){return this.splitterPanel.getRatios()}setRatios(e){this.splitterPanel.setRatios(e),this.resize(this.width,this.height)}saveState(e){e.width=this.width,e.height=this.height}loadState(e){this.state={width:e.width,height:e.height}}get width(){return void 0===this._cachedWidth&&(this._cachedWidth=this.splitterPanel.panelElement.clientWidth),this._cachedWidth}get height(){return void 0===this._cachedHeight&&(this._cachedHeight=this.splitterPanel.panelElement.clientHeight),this._cachedHeight}}class oy extends xC{constructor(e,t){super(fi.getNextId("horizontal_splitter_"),e,t,!1),this.containerType=Ta.horizontal}}class ly extends xC{constructor(e,t){super(fi.getNextId("vertical_splitter_"),e,t,!0),this.containerType=Ta.vertical}}class ZN{constructor(e){this._forceResizeCompositeContainer=t=>{t.resize(t.containerElement.clientWidth,t.containerElement.clientHeight)},this.dockManager=e}dockLeft(e,t){this._performDock(e,t,"horizontal",!0)}dockRight(e,t){this._performDock(e,t,"horizontal",!1)}dockUp(e,t){this._performDock(e,t,"vertical",!0)}dockDown(e,t){this._performDock(e,t,"vertical",!1)}dockFill(e,t){this._performDock(e,t,"fill",!1)}undock(e){let t=e.parent;if(!t)throw new Error("Cannot undock.  panel is not a leaf node");let i=t.children.indexOf(e);if(e.detachFromParent(),t.children.length<t.container.minimumAllowedChildNodes){let n=t.parent;for(let r=0;r<t.children.length;r++){let a=t.children[r];if(n){n.addChildAfter(t,a),t.detachFromParent();let o=t.container.containerElement.clientWidth,l=t.container.containerElement.clientHeight;t.container.destroy(),a.container.resize(o,l),n.performLayout(!1)}else t.detachFromParent(),t.container.destroy(),this.dockManager.setRootNode(a)}}else if(t.performLayout(!1),t.children.length>0){let n=t.children[Math.max(0,i-1)];t.container.setActiveChild(n.container)}this.dockManager.invalidate(),this.dockManager.notifyOnUnDock(e)}close(e){let t=e?.parent;if(!t)throw new Error("Cannot undock.  panel is not a leaf node");let i=!1;t.children.length>0&&null!=t.container.tabHost&&(i=t.container.tabHost.getActiveTab().container==e.container);let n=t.children.indexOf(e);if(e.detachFromParent(),t.children.length<t.container.minimumAllowedChildNodes){let r=t.parent;for(let a=0;a<t.children.length;a++){let o=t.children[a];r?(r.addChildAfter(t,o),t.detachFromParent(),o.container.resize(t.container.containerElement.clientWidth,t.container.containerElement.clientHeight),t.container.destroy(),r.performLayout(!1)):(t.detachFromParent(),t.container.destroy(),this.dockManager.setRootNode(o))}}else if(t.performLayout(!1),i){let r=t.children[Math.max(0,n-1)];null!=r&&t.container.setActiveChild(r.container)}this.dockManager.invalidate(),this.dockManager.notifyOnUnDock(e)}reorderTabs(e,t,i,n){let a="left"===i?n:n+1;if("right"==i&&a>=e.children.length||"left"==i&&0==a)return;let o=Array.apply(null,{length:e.children.length}).map(Number.call,Number),l=o.splice(a,1)[0];o.splice("left"===i?n-1:n,0,l),e.children=fi.orderByIndexes(e.children,o),e.container.tabHost.performTabsLayout(o),this.dockManager.notifyOnTabsReorder(e)}_performDock(e,t,i,n){if(e.parent&&"fill"===e.parent.container.containerType&&(e=e.parent),"fill"===i&&"fill"===e.container.containerType)return e.addChild(t),e.performLayout(!1),e.container.setActiveChild(t.container),this.dockManager.invalidate(),void this.dockManager.notifyOnDock(t);let a,o,l;if(e===this.dockManager.context.model.rootNode)return n?(a=this._createDockContainer(i,t,e),o=new rc(a),o.addChild(t),o.addChild(e)):(a=this._createDockContainer(i,e,t),o=new rc(a),o.addChild(e),o.addChild(t)),this.dockManager.setRootNode(o),this.dockManager.rebuildLayout(this.dockManager.context.model.rootNode),o.container.setActiveChild(t.container),this.dockManager.invalidate(),void this.dockManager.notifyOnDock(t);if(e.parent.container.containerType!==i){l=e.parent;let u=e.container.containerElement.clientWidth,m=e.container.containerElement.clientHeight,p=l.container.containerElement.clientWidth,_=l.container.containerElement.clientHeight;a=this._createDockContainer(i,t,e),o=new rc(a),l.addChildAfter(e,o),e.detachFromParent(),fi.removeNode(e.container.containerElement),n?(o.addChild(t),o.addChild(e)):(o.addChild(e),o.addChild(t)),l.performLayout(!1),o.performLayout(!0),o.container.setActiveChild(t.container),o.container.resize(u,m),l.container.resize(p,_)}else l=e.parent,n?l.addChildBefore(e,t):l.addChildAfter(e,t),l.performLayout(!1),l.container.setActiveChild(t.container);t.container.resize(t.container.containerElement.clientWidth,t.container.containerElement.clientHeight),this.dockManager.invalidate(),this.dockManager.notifyOnDock(t)}_createDockContainer(e,t,i){if("horizontal"===e)return new oy(this.dockManager,[t.container,i.container]);if("vertical"===e)return new ly(this.dockManager,[t.container,i.container]);if("fill"===e)return new i_(this.dockManager);throw new Error("Failed to create dock container of type: "+e)}getDockBounds(e,t,i,n){let r,a,o,l;if("fill"===i){let g=e.container.containerElement,f=this.dockManager.element.getBoundingClientRect(),b=g.getBoundingClientRect();return{x:b.left-f.left,y:b.top-f.top,width:g.clientWidth,height:g.clientHeight}}e.parent&&"fill"===e.parent.container.containerType&&(e=e.parent);let c=!1;e.parent&&e.parent.container.containerType===i?(r=e.parent,a=r.children.length,o=r.children.indexOf(e)+(n?0:1)):(r=e,a=1,o=n?0:1,c=!0);let u=0,m=0;if("vertical"===i||"horizontal"===i){let g=this._getVaringDimension(r.container,i)-5*(a-1),f=this._getVaringDimension(t,i),b=g/(g+f);if(u=f*b,c)m=n?0:g*b;else{for(let C=0;C<o;C++)m+=this._getVaringDimension(r.children[C].container,i);m*=b}}l={};let p=this.dockManager.element.getBoundingClientRect(),_=r.container.containerElement.getBoundingClientRect();return"vertical"===i?(l.x=_.left-p.left,l.y=_.top-p.top+m,l.width=r.container.width,l.height=u):"horizontal"===i&&(l.x=_.left-p.left+m,l.y=_.top-p.top,l.width=u,l.height=r.container.height),l}_getVaringDimension(e,t){return"vertical"===t?e.height:"horizontal"===t?e.width:0}}class XN{constructor(e,t,i,n){this.disableDragging=!1,this.dialog=e,this.delegate=t,this.containerElement=t.containerElement,this.dockManager=t.dockManager,this.topLevelElement=i,this.containerType=t.containerType,this.mouseDownHandler=new li(n,"mousedown",this.onMouseDown.bind(this)),this.touchDownHandler=new li(n,"touchstart",this.onMouseDown.bind(this)),this.topLevelElement.style.left=i.offsetLeft+"px",this.topLevelElement.style.top=i.offsetTop+"px",this.minimumAllowedChildNodes=t.minimumAllowedChildNodes,this.iframeEventHandlers=[]}destroy(){this.removeDecorator(),this.delegate.destroy()}saveState(e){this.delegate.saveState(e)}loadState(e){this.delegate.loadState(e)}setActiveChild(){}get width(){return this.delegate.width}get height(){return this.delegate.height}get name(){return this.delegate.name}set name(e){e&&(this.delegate.name=e)}resize(e,t){this.delegate.resize(e,t)}performLayout(e){this.delegate.performLayout(e,!1)}removeDecorator(){this.mouseDownHandler&&(this.mouseDownHandler.cancel(),delete this.mouseDownHandler),this.touchDownHandler&&(this.touchDownHandler.cancel(),delete this.touchDownHandler)}onMouseDown(e){if(2!=e.button&&(e.preventDefault&&e.preventDefault(),!this.disableDragging&&(this._startDragging(e),this.previousMousePosition={x:e.clientX,y:e.clientY},this.mouseMoveHandler&&(this.mouseMoveHandler.cancel(),delete this.mouseMoveHandler),this.mouseUpHandler&&(this.mouseUpHandler.cancel(),delete this.mouseUpHandler),this.mouseMoveHandler=new li(window,"pointermove",this.onMouseMove.bind(this)),this.mouseUpHandler=new li(window,"pointerup",this.onMouseUp.bind(this)),this.dockManager.iframes)))for(let t of this.dockManager.iframes){let i=this.onMouseMovedIframe.bind(this);this.iframeEventHandlers.push(new li(t.contentWindow,"pointermove",n=>i(n,t))),this.iframeEventHandlers.push(new li(t.contentWindow,"pointerup",this.onMouseUp.bind(this)))}}onMouseUp(e){this._stopDragging(e),this.mouseMoveHandler.cancel(),delete this.mouseMoveHandler,this.mouseUpHandler.cancel(),delete this.mouseUpHandler;for(let t of this.iframeEventHandlers)t.cancel();this.iframeEventHandlers=[]}_startDragging(e){this.containerElement.classList.add("draggable-dragging-active"),this.delegate.elementContentContainer.classList.add("draggable-dragging-active"),this.dialog.eventListener&&this.dialog.eventListener._onDialogDragStarted(this.dialog,e),fi.disableGlobalTextSelection(this.dockManager.config.dialogRootElement)}_stopDragging(e){this.containerElement.classList.remove("draggable-dragging-active"),this.delegate.elementContentContainer.classList.remove("draggable-dragging-active"),this.dialog.eventListener&&this.dialog.eventListener._onDialogDragEnded(this.dialog,e),fi.enableGlobalTextSelection(this.dockManager.config.dialogRootElement)}onMouseMovedIframe(e,t){let i=t.getBoundingClientRect();this.onMouseMove(e,{x:i.x,y:i.y})}onMouseMove(e,t){e.preventDefault&&e.preventDefault();let i=new Zs(e.clientX,e.clientY);t&&(i=new Zs(e.clientX+t.x,e.clientY+t.y));let n=this.dockManager.checkXBounds(this.topLevelElement,i,this.previousMousePosition,!1,!1),r=this.dockManager.checkYBounds(this.topLevelElement,i,this.previousMousePosition,!1,!1);this._performDrag(n,r),this.previousMousePosition=i}_performDrag(e,t){let i=e+fi.getPixels(this.topLevelElement.style.left),n=t+fi.getPixels(this.topLevelElement.style.top);this.topLevelElement.style.left=i+"px",this.topLevelElement.style.top=n+"px",this.dialog.panel.setDialogPosition(i,n)}}class qN{constructor(){this.element=void 0,this.handleSize=6,this.cornerSize=12,this.east=!1,this.west=!1,this.north=!1,this.south=!1,this.corner=!1}adjustSize(e,t){this.corner?(this.west&&(this.element.style.left="0px"),this.east&&(this.element.style.left=e-this.cornerSize+"px"),this.north&&(this.element.style.top="0px"),this.south&&(this.element.style.top=t-this.cornerSize+"px")):(this.west&&(this.element.style.left="0px",this.element.style.top=this.cornerSize+"px"),this.east&&(this.element.style.left=e-this.handleSize+"px",this.element.style.top=this.cornerSize+"px"),this.north&&(this.element.style.left=this.cornerSize+"px",this.element.style.top="0px"),this.south&&(this.element.style.left=this.cornerSize+"px",this.element.style.top=t-this.handleSize+"px"),this.west||this.east?this.element.style.height=t-2*this.cornerSize+"px":this.element.style.width=e-2*this.cornerSize+"px")}}class $N{constructor(e,t,i,n=!1){this.dialog=e,this.disableResize=n,this.delegate=t,this.containerElement=t.containerElement,this.dockManager=t.dockManager,this.topLevelElement=i,this.containerType=t.containerType,this.topLevelElement.style.left=this.topLevelElement.offsetLeft+"px",this.topLevelElement.style.top=this.topLevelElement.offsetTop+"px",this.minimumAllowedChildNodes=t.minimumAllowedChildNodes,this._buildResizeHandles(),this.readyToProcessNextResize=!0,this.dockSpawnResizedEvent=new CustomEvent("DockSpawnResizedEvent",{composed:!0,bubbles:!0}),this.iframeEventHandlers=[]}setActiveChild(){}_buildResizeHandles(){this.resizeHandles=[],this.disableResize||(this._buildResizeHandle(!1,!0,!0,!1),this._buildResizeHandle(!0,!1,!1,!0),this._buildResizeHandle(!1,!0,!1,!0),this._buildResizeHandle(!0,!1,!1,!1),this._buildResizeHandle(!1,!0,!1,!1),this._buildResizeHandle(!1,!1,!0,!1),this._buildResizeHandle(!1,!1,!1,!0))}_buildResizeHandle(e,t,i,n){let r=new qN;r.east=e,r.west=t,r.north=i,r.south=n,r.element=document.createElement("div"),this.topLevelElement.appendChild(r.element);let a="",o="";i&&(a="n"),n&&(a="s"),e&&(o="e"),t&&(o="w");let l="resize-handle-"+a+o;a.length>0&&o.length>0&&(r.corner=!0),r.element.classList.add(r.corner?"resize-handle-corner":"resize-handle"),r.element.classList.add(l),this.resizeHandles.push(r),r.mouseDownHandler=new li(r.element,"mousedown",c=>{this.onMouseDown(r,c)}),r.touchDownHandler=new li(r.element,"touchstart",c=>{this.onMouseDown(r,c)})}saveState(e){this.delegate.saveState(e)}loadState(e){this.delegate.loadState(e)}get width(){return this.delegate.width}get height(){return this.delegate.height}get name(){return this.delegate.name}set name(e){e&&(this.delegate.name=e)}resize(e,t){this.delegate.resize(e,t),this._adjustResizeHandles(e,t),document.dispatchEvent(this.dockSpawnResizedEvent)}_adjustResizeHandles(e,t){this.resizeHandles.forEach(i=>{i.adjustSize(e,t)})}performLayout(e){this.delegate.performLayout(e,!1)}destroy(){this.removeDecorator(),this.delegate.destroy()}removeDecorator(){}onMouseMovedIframe(e,t,i){let n=i.getBoundingClientRect();this.onMouseMoved(e,t,{x:n.x,y:n.y})}onMouseMoved(e,t,i){let n=null;if(t.changedTouches){if(t.changedTouches.length>1)return;n=t.changedTouches[0]}else n=t;if(!this.readyToProcessNextResize)return;this.readyToProcessNextResize=!1,this.dialog.panel&&this.dockManager.suspendLayout(this.dialog.panel);let r=new Zs(n.clientX,n.clientY);i&&(r=new Zs(n.clientX+i.x,n.clientY+i.y));let a=this.dockManager.checkXBounds(this.topLevelElement,r,this.previousMousePosition,e.west,e.east),o=this.dockManager.checkYBounds(this.topLevelElement,r,this.previousMousePosition,e.north,e.south);this._performDrag(e,a,o),this.previousMousePosition=r,this.readyToProcessNextResize=!0,this.dialog.panel&&this.dockManager.resumeLayout(this.dialog.panel),this.dockManager.notifyOnContainerResized(this)}onMouseDown(e,t){let i=null;if(t.touches){if(t.touches.length>1)return;i=t.touches[0]}else i=t;this.previousMousePosition=new Zs(i.clientX,i.clientY),e.mouseMoveHandler&&(e.mouseMoveHandler.cancel(),delete e.mouseMoveHandler),e.touchMoveHandler&&(e.touchMoveHandler.cancel(),delete e.touchMoveHandler),e.mouseUpHandler&&(e.mouseUpHandler.cancel(),delete e.mouseUpHandler),e.touchUpHandler&&(e.touchUpHandler.cancel(),delete e.touchUpHandler);for(let n of this.iframeEventHandlers)n.cancel();if(this.iframeEventHandlers=[],e.mouseMoveHandler=new li(window,"mousemove",n=>{this.onMouseMoved(e,n)}),e.touchMoveHandler=new li(window,"touchmove",n=>{this.onMouseMoved(e,n)}),e.mouseUpHandler=new li(window,"mouseup",n=>{this.onMouseUp(e)}),e.touchUpHandler=new li(window,"touchend",n=>{this.onMouseUp(e)}),this.dockManager.iframes)for(let n of this.dockManager.iframes){let r=this.onMouseMovedIframe.bind(this);this.iframeEventHandlers.push(new li(n.contentWindow,"mousemove",a=>r(e,a,n))),this.iframeEventHandlers.push(new li(n.contentWindow,"mouseup",a=>this.onMouseUp(e))),this.iframeEventHandlers.push(new li(n.contentWindow,"touchmove",a=>r(e,a,n))),this.iframeEventHandlers.push(new li(n.contentWindow,"touchend",a=>this.onMouseUp(e)))}fi.disableGlobalTextSelection(this.dockManager.config.dialogRootElement)}onMouseUp(e){e.mouseMoveHandler.cancel(),e.touchMoveHandler.cancel(),e.mouseUpHandler.cancel(),e.touchUpHandler.cancel(),delete e.mouseMoveHandler,delete e.touchMoveHandler,delete e.mouseUpHandler,delete e.touchUpHandler;for(let t of this.iframeEventHandlers)t.cancel();this.iframeEventHandlers=[],fi.enableGlobalTextSelection(this.dockManager.config.dialogRootElement)}_performDrag(e,t,i){let n={};n.left=fi.getPixels(this.topLevelElement.style.left),n.top=fi.getPixels(this.topLevelElement.style.top),n.width=this.topLevelElement.clientWidth,n.height=this.topLevelElement.clientHeight,e.east&&this._resizeEast(t,n),e.west&&this._resizeWest(t,n),e.north&&this._resizeNorth(i,n),e.south&&this._resizeSouth(i,n)}_resizeWest(e,t){this._resizeContainer(e,0,-e,0,t)}_resizeEast(e,t){this._resizeContainer(0,0,e,0,t)}_resizeNorth(e,t){this._resizeContainer(0,e,0,-e,t)}_resizeSouth(e,t){this._resizeContainer(0,0,0,e,t)}_resizeContainer(e,t,i,n,r){r.left+=e,r.top+=t,r.width+=i,r.height+=n,r.width=Math.max(r.width,50),r.height=Math.max(r.height,50),this.topLevelElement.style.left=r.left+"px",this.topLevelElement.style.top=r.top+"px",this.resize(r.width,r.height)}}let s_=(()=>{class s{constructor(t,i,n,r){this.panel=t,this.dockManager=i,this.eventListener=i,this.grayoutParent=n,this.disableResize=r,this._initialize(),this.dockManager.context.model.dialogs.push(this),this.position=i.defaultDialogPosition,this.dockManager.notifyOnCreateDialog(this),t.isDialog=!0}saveState(t,i){this.position=new Zs(t,i),this.dockManager.notifyOnChangeDialogPosition(this,t,i)}static fromElement(t,i){return new s(new Xs(document.getElementById(t),i),i,null)}_initialize(){this.panel.floatingDialog=this,this.elementDialog=Object.assign(document.createElement("div"),{floatingDialog:this}),this.elementDialog.tabIndex=0,this.elementDialog.appendChild(this.panel.elementPanel),this.draggable=new XN(this,this.panel,this.elementDialog,this.panel.elementTitle),this.resizable=new $N(this,this.draggable,this.draggable.topLevelElement,this.disableResize),this.dockManager.config.dialogRootElement.appendChild(this.elementDialog),this.elementDialog.classList.add("dialog-floating"),this.focusHandler=new li(this.elementDialog,"focus",this.onFocus.bind(this),!0),this.mouseDownHandler=new li(this.elementDialog,"pointerdown",this.onMouseDown.bind(this),!0),this.keyPressHandler=new li(this.elementDialog,"keypress",this.dockManager.onKeyPressBound,!0),this.contextmenuHandler=new li(this.panel.elementTitle,"contextmenu",this.oncontextMenuClicked.bind(this)),this.resize(this.panel.elementPanel.clientWidth,this.panel.elementPanel.clientHeight),this.isHidden=!1,null!=this.grayoutParent&&this.grayoutParent.grayOut(!0),this.bringToFront()}setPosition(t,i){let n=this.dockManager.config.dialogRootElement.getBoundingClientRect();this.position=new Zs(t-n.left,i-n.top),this.elementDialog.style.left=t-n.left+"px",this.elementDialog.style.top=i-n.top+"px",this.panel.setDialogPosition(t,i),this.dockManager.notifyOnChangeDialogPosition(this,t,i)}getPosition(){return new Zs(this.position?this.position.x:0,this.position?this.position.y:0)}onFocus(){this.dockManager.activePanel!=this.panel&&(this.dockManager.activePanel=this.panel)}onMouseDown(t){2!=t.button&&this.bringToFront()}destroy(){this.panel.lastDialogSize={width:this.resizable.width,height:this.resizable.height},this.focusHandler&&(this.focusHandler.cancel(),delete this.focusHandler),this.mouseDownHandler&&(this.mouseDownHandler.cancel(),delete this.mouseDownHandler),this.keyPressHandler&&(this.keyPressHandler.cancel(),delete this.keyPressHandler),this.contextmenuHandler&&(this.contextmenuHandler.cancel(),delete this.contextmenuHandler),fi.removeNode(this.elementDialog),this.draggable.removeDecorator(),fi.removeNode(this.panel.elementPanel),fi.arrayRemove(this.dockManager.context.model.dialogs,this),delete this.panel.floatingDialog,this.grayoutParent&&this.grayoutParent.grayOut(!1)}resize(t,i){this.resizable.resize(t,i)}setTitle(t){this.panel.setTitle(t)}setTitleIcon(t){this.panel.setTitleIcon(t)}bringToFront(){this.panel.elementContentContainer.style.zIndex=this.dockManager.zIndexDialogCounter++,this.elementDialog.style.zIndex=this.dockManager.zIndexDialogCounter++,this.dockManager.activePanel=this.panel}hide(){this.elementDialog.style.zIndex="0",this.panel.elementContentContainer.style.zIndex="",this.elementDialog.style.display="none",this.isHidden||(this.isHidden=!0,this.dockManager.notifyOnHideDialog(this)),this.grayoutParent&&this.grayoutParent.grayOut(!1)}close(){this.hide(),this.remove(),this.dockManager.notifyOnClosePanel(this.panel),this.destroy()}remove(){this.elementDialog.parentNode?.removeChild(this.elementDialog)}show(){this.panel.elementContentContainer.style.zIndex=this.dockManager.zIndexDialogCounter++,this.elementDialog.style.zIndex=this.dockManager.zIndexDialogCounter++,this.elementDialog.style.display="block",this.isHidden&&(this.isHidden=!1,this.dockManager.notifyOnShowDialog(this))}static#e=this.createContextMenuContentCallback=(t,i,n)=>{if(t.panel._hideCloseButton)return!1;{let r=document.createElement("div");r.innerText=Ua.getString("CloseDialog"),i.append(r),r.onclick=()=>{t.panel.close(),t.closeContextMenu()};let a=document.createElement("div");return a.innerText=Ua.getString("NewBrowserWindow"),i.append(a),a.onclick=()=>{t.panel.undockToBrowserDialog(),t.closeContextMenu()},!0}};oncontextMenuClicked(t){t.preventDefault(),!this._ctxMenu&&s.createContextMenuContentCallback?(this._ctxMenu=document.createElement("div"),this._ctxMenu.className="dockspab-tab-handle-context-menu",!1!==s.createContextMenuContentCallback(this,this._ctxMenu,this.dockManager.context.model.documentManagerNode.children)?(this._ctxMenu.style.left=t.pageX+"px",this._ctxMenu.style.top=t.pageY+"px",document.body.appendChild(this._ctxMenu),this._windowsContextMenuCloseBound=this.windowsContextMenuClose.bind(this),window.addEventListener("pointerup",this._windowsContextMenuCloseBound)):this._ctxMenu=null):this.closeContextMenu()}closeContextMenu(){this._ctxMenu&&(document.body.removeChild(this._ctxMenu),delete this._ctxMenu,window.removeEventListener("pointerup",this._windowsContextMenuCloseBound))}windowsContextMenuClose(t){let i=t.composedPath();for(let n in i)if(i[n]==this._ctxMenu)return;this.closeContextMenu()}}return s})();class KN{serialize(e){let t=this._buildGraphInfo(e.rootNode),i=this._buildDialogsInfo(e.dialogs.sort((n,r)=>n.elementDialog.style.zIndex-r.elementDialog.style.zIndex));return JSON.stringify({graphInfo:t,dialogsInfo:i})}_buildGraphInfo(e){let t={};e.container.saveState(t);let i=[];return e.children.forEach(r=>{i.push(this._buildGraphInfo(r))}),{containerType:e.container.containerType,state:t,children:i}}_buildDialogsInfo(e){let t=[];return e.forEach(i=>{let n={},r=i.panel;r.saveState(n);let a={containerType:r.containerType,state:n,position:i.getPosition(),isHidden:i.isHidden};t.push(a)}),t}}class JN{constructor(e){this.dockManager=e}deserialize(e){var t=this;return(0,On.Z)(function*(){let i=JSON.parse(e),n=new ay;return n.rootNode=yield t._buildGraph(i.graphInfo),n.dialogs=yield t._buildDialogs(i.dialogsInfo),n.documentManagerNode=t.documentManagerNode,n})()}_buildGraph(e){var t=this;return(0,On.Z)(function*(){let i=e.children,n=[];for(let o of i){let l=yield t._buildGraph(o);null!==l&&n.push(l)}let r=yield t._createContainer(e,n);if(null===r)return null;let a=new rc(r);r instanceof n_&&(t.documentManagerNode=a),a.children=n;for(let o of a.children.reverse())o.parent=a;return a.children.reverse(),a})()}_createContainer(e,t){var i=this;return(0,On.Z)(function*(){let a,n=e.containerType,r=e.state,o=[];for(let l of t)o.push(l.container);if("panel"===n){if(a=yield Xs.loadFromState(r,i.dockManager),!a.prepareForDocking)return null;a.prepareForDocking(),fi.removeNode(a.elementPanel)}else if("horizontal"===n)a=new oy(i.dockManager,o);else if("vertical"===n)a=new ly(i.dockManager,o);else{if("fill"!==n)throw new Error("Cannot create dock container of unknown type: "+n);a=r.documentManager?new n_(i.dockManager):new i_(i.dockManager)}return a.loadState(r),a})()}_buildDialogs(e){var t=this;return(0,On.Z)(function*(){let i=[];for(let n of e){let o,a=n.state;if("panel"===n.containerType&&(o=yield Xs.loadFromState(a,t.dockManager),o.prepareForDocking)){fi.removeNode(o.elementPanel),o.isDialog=!0;let l=new s_(o,t.dockManager);(n.position.x>document.body.clientWidth||n.position.y>document.body.clientHeight-70)&&(n.position.x=20,n.position.y=70),l.setPosition(n.position.x,n.position.y),l.isHidden=n.isHidden,l.isHidden&&l.hide(),i.push(l)}}return i})()}}class QN{constructor(){this.escClosesWindow=!0,this.escClosesDialog=!0,this.dialogRootElement=document.body,this.moveOnlyWithinDockConatiner=!1}}class eU{constructor(e,t){if(void 0===e)throw new Error("Invalid Dock Manager element provided");this._config=Object.assign(new QN,t),this.element=e,this.context=this.dockWheel=this.layoutEngine=this.mouseMoveHandler=this.touchMoveHandler=void 0,this.layoutEventListeners=[],this.defaultDialogPosition=new Zs(0,0)}get config(){return this._config}initialize(){this.backgroundContext=this.element.children[0],this.context=new GN(this);let e=new rc(this.context.documentManagerView);this.context.model.rootNode=e,this.context.model.documentManagerNode=e,this.context.model.dialogs=[],this.setRootNode(this.context.model.rootNode),this.resize(this.element.clientWidth,this.element.clientHeight),this.dockWheel=new zN(this),this.layoutEngine=new ZN(this),this._undockEnabled=!0,this.rebuildLayout(this.context.model.rootNode),this.zIndexCounter=1001,this.zIndexTabHost=1e3,this.zIndexTabHandle=100,this.zIndexDialogCounter=10001,null!=this.backgroundContext&&this.context.model.rootNode.container.tabHost.hostElement.insertBefore(this.backgroundContext,this.context.model.rootNode.container.tabHost.hostElement.firstChild),this.onKeyPressBound=this.onKeyPress.bind(this),this.element.addEventListener("keydown",this.onKeyPressBound)}onKeyPress(e){if("Escape"==e.key&&this.activePanel&&!this.activePanel._hideCloseButton&&(this.activePanel.isDialog&&this._config.escClosesDialog||!this.activePanel.isDialog&&this._config.escClosesWindow)){let t=this.activePanel;this.activePanel=null,t.close()}}checkXBounds(e,t,i,n,r){if(this._config.moveOnlyWithinDockConatiner)return this.checkXBoundsWithinDockContainer(e,t,i,n,r);let a=this.element.getBoundingClientRect(),o=Math.floor(t.x-i.x),c=e.offsetLeft+o+a.left>window.innerWidth-40;if(e.offsetLeft+e.offsetWidth+o+a.left<40){i.x=t.x,o=0;let h=40-(e.offsetWidth+e.offsetLeft+a.left);h>0&&(o=h)}else if(c){i.x=t.x,o=0;let h=window.innerWidth-40-e.offsetLeft-a.left;h>0&&(o=h)}return o}checkXBoundsWithinDockContainer(e,t,i,n,r){let a=t.x-i.x,o=this.element.getBoundingClientRect(),l=e.getBoundingClientRect(),h=a>0&&l.right+a>o.right&&!n;return a<0&&l.left+a<o.left&&!r?(t.x-=a,a=o.left-l.left,t.x-=a):h&&(t.x-=a,a=o.right-l.right,t.x-=a),a}checkYBounds(e,t,i,n,r){if(this._config.moveOnlyWithinDockConatiner)return this.checkYBoundsWithinDockContainer(e,t,i,n,r);let a=this.element.getBoundingClientRect(),o=Math.floor(t.y-i.y),c=e.offsetTop+o+a.top>window.innerHeight-16;if(e.offsetTop+o+a.top<0)i.y=t.y,o=0;else if(c){i.y=t.y,o=0;let h=window.innerHeight-16-e.offsetTop-a.top;h>0&&(o=h)}return o}checkYBoundsWithinDockContainer(e,t,i,n,r){let a=t.y-i.y,o=this.element.getBoundingClientRect(),l=e.getBoundingClientRect(),h=a>0&&l.bottom+a>o.bottom&&!n;return a<0&&l.top+a<o.top&&!r?(t.y-=a,a=o.top-l.top,t.y-=a):h&&(t.y-=a,a=o.bottom-l.bottom,t.y-=a),a}rebuildLayout(e){e.children.forEach(t=>{this.rebuildLayout(t)}),e.performLayout(!1)}invalidate(){this.resize(this.element.clientWidth,this.element.clientHeight)}resize(e,t){this.element.style.width=e+"px",this.element.style.height=t+"px",this.context.model.rootNode.container.resize(e,t);let i=0,n=0;for(let r of this.context.model.dialogs)(r.position.x>this.element.clientWidth||r.position.y>this.element.clientHeight)&&((i>this.element.clientWidth||n>this.element.clientHeight)&&(i=0,n=0),r.setPosition(100+i,100+n),i+=100,n+=100)}setModel(e){fi.removeNode(this.context.documentManagerView.containerElement),this.context.model=e,this.setRootNode(e.rootNode),this.rebuildLayout(e.rootNode),this.loadResize(e.rootNode)}loadResize(e){e.children.reverse().forEach(i=>{this.loadResize(i),e.container.setActiveChild(i.container)}),e.children.reverse();let t=e.container;e.container.resize(t.state.width,t.state.height)}setRootNode(e){e.detachFromParent(),this.context.model.rootNode=e,this.element.appendChild(e.container.containerElement)}_onDialogDragStarted(e,t){this.dockWheel.activeNode=this._findNodeOnPoint(t.clientX,t.clientY),this.dockWheel.activeDialog=e,(null==e.noDocking||!0!==e.noDocking)&&this.dockWheel.showWheel(),this.mouseMoveHandler&&(this.mouseMoveHandler.cancel(),delete this.mouseMoveHandler),this.touchMoveHandler&&(this.touchMoveHandler.cancel(),delete this.touchMoveHandler),this.mouseMoveHandler=new li(window,"mousemove",this._onMouseMoved.bind(this)),this.touchMoveHandler=new li(window,"touchmove",this._onMouseMoved.bind(this))}_onDialogDragEnded(e,t){this.mouseMoveHandler&&(this.mouseMoveHandler.cancel(),delete this.mouseMoveHandler),this.touchMoveHandler&&(this.touchMoveHandler.cancel(),delete this.touchMoveHandler),this.dockWheel.onDialogDropped(e),this.dockWheel.hideWheel(),delete this.dockWheel.activeDialog,e.saveState(e.elementDialog.offsetLeft,e.elementDialog.offsetTop)}_onMouseMoved(e){null!=e.changedTouches&&(e=e.changedTouches[0]),this.dockWheel.activeNode=this._findNodeOnPoint(e.clientX,e.clientY)}_findNodeOnPoint(e,t){let n,i=[];for(i.push(this.context.model.rootNode);i.length>0;){let r=i.pop();fi.isPointInsideNode(e,t,r)&&(n=r,[].push.apply(i,r.children))}return n}dockDialogLeft(e,t){return this._requestDockDialog(e,t,this.layoutEngine.dockLeft.bind(this.layoutEngine))}dockDialogRight(e,t){return this._requestDockDialog(e,t,this.layoutEngine.dockRight.bind(this.layoutEngine))}dockDialogUp(e,t){return this._requestDockDialog(e,t,this.layoutEngine.dockUp.bind(this.layoutEngine))}dockDialogDown(e,t){return this._requestDockDialog(e,t,this.layoutEngine.dockDown.bind(this.layoutEngine))}dockDialogFill(e,t){return this._requestDockDialog(e,t,this.layoutEngine.dockFill.bind(this.layoutEngine))}dockLeft(e,t,i){return this._requestDockContainer(e,t,this.layoutEngine.dockLeft.bind(this.layoutEngine),!1,i)}dockRight(e,t,i){return this._requestDockContainer(e,t,this.layoutEngine.dockRight.bind(this.layoutEngine),!0,i)}dockUp(e,t,i){return this._requestDockContainer(e,t,this.layoutEngine.dockUp.bind(this.layoutEngine),!1,i)}dockDown(e,t,i){return this._requestDockContainer(e,t,this.layoutEngine.dockDown.bind(this.layoutEngine),!0,i)}dockFill(e,t){return this._requestDockContainer(e,t,this.layoutEngine.dockFill.bind(this.layoutEngine),!1)}floatDialog(e,t,i,n,r){let a;if(this.context.model.dialogs.forEach(c=>{e==c.panel&&(c.show(),c.setPosition(t,i),a=c)}),a)return a;try{let c=this._findNodeFromContainer(e);this.layoutEngine.undock(c)}catch{}let o=e;fi.removeNode(o.elementPanel),o.isDialog=!0;let l=new s_(o,this,n,r);return l.setPosition(t,i),l}_requestDockDialog(e,t,i){let n=t.panel,r=new rc(n);return n.prepareForDocking(),n.elementContentContainer.style.zIndex="",t.destroy(),i(e,r),r}_checkShowBackgroundContext(){null!=this.backgroundContext&&(this.backgroundContext.style.display=this.context.model.documentManagerNode.children.length>0?"none":"block")}_requestDockContainer(e,t,i,n,r){let a=new rc(t);if("panel"===t.containerType){let c=t;c.prepareForDocking(),fi.removeNode(c.elementPanel)}let l,o=null;if(e.parent&&e.parent.container&&(l=e.parent.container,l.getRatios&&(o=l.getRatios())),i(e,a),r&&a.parent&&("vertical"===a.parent.container.containerType||"horizontal"===a.parent.container.containerType)){let c=a.parent.container;if(o&&l==c){if(n){for(let h=0;h<o.length;h++)o[h]=o[h]-o[h]*r;o.push(r)}else o[0]=o[0]-r,o.unshift(r);c.setRatios(o)}else c.setContainerRatio(t,r)}return this.rebuildLayout(this.context.model.rootNode),this.invalidate(),this._checkShowBackgroundContext(),a}_requestTabReorder(e,t){let i=this._findNodeFromContainer(e);this.layoutEngine.reorderTabs(i,t.handle,t.state,t.index)}requestUndockToDialog(e,t,i){let n=this._findNodeFromContainer(e);this.layoutEngine.undock(n);let r=n.container;r.elementPanel.style.display="block";let a=new s_(r,this,null);if(r.lastDialogSize&&a.resize(r.lastDialogSize.width,r.lastDialogSize.height),void 0!==t){let o=a.elementDialog.clientWidth;i.x>o&&(i.x=.75*o),a.setPosition(t.clientX-i.x,t.clientY-i.y),a.draggable.onMouseDown(t)}return a}requestClose(e){let t=this._findNodeFromContainer(e);if(this.layoutEngine.close(t),this.activePanel==e&&(this.activePanel=null),this._activeDocument==e){const i=this._activeDocument;this._activeDocument=null,this.notifyOnActiveDocumentChange(null,i)}}openInDialog(e,t,i,n){let r=new s_(e,this,null,n);if(null!=t){let a=r.elementDialog.clientWidth;i.x>a&&(i.x=.75*a),r.setPosition(t.clientX-i.x,t.clientY-i.y),r.draggable.onMouseDown(t)}return r}requestUndock(e){let t=this._findNodeFromContainer(e);this.layoutEngine.undock(t)}requestRemove(e){let t=this._findNodeFromContainer(e),i=t.parent;return t.detachFromParent(),i&&this.rebuildLayout(i),t}getNodeByElementId(e){let t=[];for(t.push(this.context.model.rootNode);t.length>0;){let i=t.pop();if(i.container instanceof Xs&&(i.container.elementContent.id===e||i.container.elementContent instanceof HTMLSlotElement&&i.container.elementContent.assignedElements()?.[0]?.id===e))return i;[].push.apply(t,i.children)}return null}getNodeByElement(e){let t=[];for(t.push(this.context.model.rootNode);t.length>0;){let i=t.pop();if(i.container instanceof Xs&&(i.container.elementContent===e||i.container.elementContent instanceof HTMLSlotElement&&i.container.elementContent.assignedElements()?.[0]===e))return i;[].push.apply(t,i.children)}return null}_findNodeFromContainer(e){let t=[];for(t.push(this.context.model.rootNode);t.length>0;){let i=t.pop();if(i.container===e)return i;[].push.apply(t,i.children)}return null}findNodeFromContainerElement(e){let t=[];for(t.push(this.context.model.rootNode);t.length>0;){let i=t.pop();if(i.container.containerElement===e)return i;[].push.apply(t,i.children)}return null}addLayoutListener(e){this.layoutEventListeners.push(e)}removeLayoutListener(e){this.layoutEventListeners.splice(this.layoutEventListeners.indexOf(e),1)}suspendLayout(e){this.layoutEventListeners.forEach(t=>{t.onSuspendLayout&&t.onSuspendLayout(this,e)})}resumeLayout(e){this.layoutEventListeners.forEach(t=>{t.onResumeLayout&&t.onResumeLayout(this,e)})}notifyOnDock(e){this._checkShowBackgroundContext(),this.layoutEventListeners.forEach(t=>{t.onDock&&(t.onDock(this,e),e.container.resize(e.container.width,e.container.height))})}notifyOnTabsReorder(e){this.layoutEventListeners.forEach(t=>{t.onTabsReorder&&t.onTabsReorder(this,e)})}notifyOnUnDock(e){this._checkShowBackgroundContext(),this.layoutEventListeners.forEach(t=>{t.onUndock&&t.onUndock(this,e)})}notifyOnClosePanel(e){if(this._checkShowBackgroundContext(),this.activePanel==e&&(this.activePanel=null),this._activeDocument==e){const t=this._activeDocument;this._activeDocument=null,this.notifyOnActiveDocumentChange(null,t)}this.layoutEventListeners.forEach(t=>{t.onClosePanel&&t.onClosePanel(this,e)})}notifyOnCreateDialog(e){this.layoutEventListeners.forEach(t=>{t.onCreateDialog&&t.onCreateDialog(this,e)})}notifyOnHideDialog(e){this.layoutEventListeners.forEach(t=>{t.onHideDialog&&t.onHideDialog(this,e)})}notifyOnShowDialog(e){this.layoutEventListeners.forEach(t=>{t.onShowDialog&&t.onShowDialog(this,e)})}notifyOnChangeDialogPosition(e,t,i){this.layoutEventListeners.forEach(n=>{n.onChangeDialogPosition&&n.onChangeDialogPosition(this,e,t,i)})}notifyOnContainerResized(e){this.layoutEventListeners.forEach(t=>{t.onContainerResized&&t.onContainerResized(this,e)})}notifyOnTabChange(e){this.layoutEventListeners.forEach(t=>{t.onTabChanged&&t.onTabChanged(this,e)})}notifyOnActivePanelChange(e,t){this.layoutEventListeners.forEach(i=>{i.onActivePanelChange&&i.onActivePanelChange(this,e,t)})}notifyOnActiveDocumentChange(e,t){this.layoutEventListeners.forEach(i=>{i.onActiveDocumentChange&&i.onActiveDocumentChange(this,e,t)})}saveState(){return(new KN).serialize(this.context.model)}loadState(e){var t=this;return(0,On.Z)(function*(){let i=new JN(t);t.context.model=yield i.deserialize(e),t.setModel(t.context.model)})()}getPanels(){let e=[];return this._allPanels(this.context.model.rootNode,e),this.context.model.dialogs.forEach(t=>{e.push(t.panel)}),e}undockEnabled(e){this._undockEnabled=e,this.getPanels().forEach(t=>{t.canUndock(e)})}lockDockState(e){this.undockEnabled(!e),this.hideCloseButton(e)}hideCloseButton(e){this.getPanels().forEach(t=>{t.hideCloseButton(e)})}updatePanels(e){let t=[];return this._allPanels(this.context.model.rootNode,t),t.forEach(i=>{fi.arrayContains(e,i.elementContent.id)||i.close()}),this.context.model.dialogs.forEach(i=>{fi.arrayContains(e,i.panel.elementContent.id)?i.show():i.hide()}),t}getVisiblePanels(){let e=[];return this._allPanels(this.context.model.rootNode,e),this.context.model.dialogs.forEach(t=>{t.isHidden||e.push(t.panel)}),e}_allPanels(e,t){e.children.forEach(i=>{this._allPanels(i,t)}),"panel"===e.container.containerType&&t.push(e.container)}get activeDocument(){return this._activeDocument}get activePanel(){return this._activePanel}set activePanel(e){if(e!==this._activePanel){e&&!e.isDialog&&(this._lastPanelNotADialog=e),this._lastPanelNotADialog&&this.getPanels().indexOf(this._lastPanelNotADialog)<0&&(this._lastPanelNotADialog=null);let t=this.activePanel;this.activePanel&&(this.activePanel.elementTitle.classList.remove("dockspan-panel-active"),this.activePanel.elementTitleText.classList.remove("dockspan-panel-titlebar-text-active"),this.activePanel.tabPage&&this.activePanel.tabPage.host.setActive(!1)),this._activePanel=e;let i=this._activeDocument;e&&e.panelType==ur.document&&(this._activeDocument=e),!e&&t&&t.isDialog&&null==e&&this._lastPanelNotADialog&&this.activePanel!=this._lastPanelNotADialog&&(e=this._lastPanelNotADialog,this._lastPanelNotADialog=void 0),this.notifyOnActivePanelChange(e,t),i!=this._activeDocument&&this.notifyOnActiveDocumentChange(this._activeDocument,i),e&&(e.elementTitle.classList.add("dockspan-panel-active"),e.elementTitleText.classList.add("dockspan-panel-titlebar-text-active"),e.tabPage&&e.tabPage.host.setActive(!0))}else e&&e.tabPage&&e.tabPage.host.setActive(!0)}}var tU=V(3561);let cy=(()=>{class s{constructor(t,i){this.transmit=t,this.notify=i,this._panels=[],this._lockActiveDashboardLayout=new ss.X(!0),this.lockActiveDashboardLayout$().subscribe(n=>{if(n){if(this._spawnDockManager)for(const r of this._spawnDockManager.getPanels())this._spawnDockManager.suspendLayout(r),r.canUndock(!0)}else if(this._spawnDockManager)for(const r of this._spawnDockManager.getPanels())this._spawnDockManager.resumeLayout(r),r.canUndock(!1);this.rebuildDockManager()})}get lockActiveDashboardLayout(){return this._lockActiveDashboardLayout.value}get floatingWindowPanels(){return this._panels.filter(t=>t.isFloating)}get gridSterPanels(){return this._panels.filter(t=>t.isGridSter)}set lockActiveDashboardLayout(t){this._lockActiveDashboardLayout.next(t)}get getDashboardGridConfig(){return this._activeDashboard.gridConfig}lockActiveDashboardLayout$(){return this._lockActiveDashboardLayout}toggleLockActiveDashboardLayout(){this.lockActiveDashboardLayout=!this.lockActiveDashboardLayout}loadTraditionalDashboard(t){var i=this;return(0,On.Z)(function*(){if(yield i.resetDashboard(),i._activeDashboard=JSON.parse(JSON.stringify(t)),t.nodes)for(const n of t.nodes){if(i._panels.find(a=>a.nativeId===n._id))continue;const r=new __(i._spawnDockManager,n._id,na.GRID_STER);r.setGridSterConfig(n),i._panels.push(r)}(yield i.loadActiveDashboardLayoutConfigs())||i.addGridsterPanel(),setTimeout(()=>{i.rebuildDockManager()},1e3)})()}setFloatingWindowsContainer(t){this._floatingWindowsContainer=t}setContainerRef(t){this.viewContainer=t}addFloatingWindow(t){if(!this._floatingWindowsContainer)return;let i=this._floatingWindowsContainer.createComponent(t_);return i.setInput("panel",t),t.setFloatingByComponentRef(i),setTimeout(()=>{this.rebuildDockManager()},300),i}setActivePanel(t){for(const i of this._panels)i.setActive=i.id===t.id}loadActiveDashboardLayoutConfigs(){var t=this;return(0,On.Z)(function*(){let i;if(localStorage.getItem(t._activeDashboard.id)&&(i=JSON.parse(localStorage.getItem(t._activeDashboard.id))),!i)return!1;yield t.loadSpawnPanelsState(i.dock_spawn);for(const n of i.grid_ster){const r=t._panels.find(a=>a.nativeId===n._id);r&&(r.gridSterConfig.cols=n.cols,r.gridSterConfig.rows=n.rows,r.gridSterConfig.x=n.x,r.gridSterConfig.y=n.y,r._mode=na.GRID_STER)}return!0})()}saveActiveDashboardLayoutConfigs(){var t=this;return(0,On.Z)(function*(){const i=t._spawnDockManager.saveState(),n=t.gridSterPanels.map(a=>({_id:a.nativeId,rows:a.gridSterConfig.rows,cols:a.gridSterConfig.cols,x:a.gridSterConfig.x,y:a.gridSterConfig.y})),r={dock_spawn:JSON.parse(i),grid_ster:n};localStorage.setItem(t._activeDashboard.id,JSON.stringify(r)),t.notify.successSnack(`${t._activeDashboard.name} dashboard layout configurations saved`)})()}updateGridSterComponent(t){const i=this._panels.find(n=>n.gridSterConfig&&n.nativeId===t._id);i?(i.gridSterConfig.cols=t.cols,i.gridSterConfig.rows=t.rows,i.gridSterConfig.x=t.x,i.gridSterConfig.y=t.y):console.warn("can not find target gridster node panel")}initSpawnDockManager(){let t=document.getElementById("gridLayoutContainer");this._spawnDockManager&&(this._spawnDockManager=null,delete this._spawnDockManager),this._spawnDockManager=new eU(t),this._spawnDockManager.initialize();const i=(n,r,a,o)=>{o||(o=1),n.hideCloseButton(!0);const l=this._panels.find(c=>c.nativeId===r.container.id);"dock"===a?(r.container.hidePinButton&&r.container.hidePinButton(!0),r.container.hideFullscreenButton&&r.container.hideFullscreenButton(!0),l&&l.setDocked(r.container)):(r.container.hidePinButton&&r.container.hidePinButton(!1),r.container.hideFullscreenButton&&r.container.hideFullscreenButton(!1),l&&l.setFloating()),setTimeout(()=>{this.rebuildDockManager()},400)};this._spawnDockManager.addLayoutListener({onDock:(n,r,a)=>{a&&a>1||(a||(a=0),i(n,r,"dock",a))},onUndock(n,r){i(n,r,"unDock")}})}resetDashboard(){var t=this;return(0,On.Z)(function*(){t.initSpawnDockManager();let i=[];for(;t._panels.length>0;){const n=t._panels.shift();n.isPin?i.push(n):yield n.destroy()}t._panels=i,t._gridsterComponentRef&&(t._gridsterComponentRef.destroy(),t._gridsterComponentRef=void 0),t._gridsterPanel&&(t._gridsterPanel.destroy(),t._gridsterPanel=void 0)})()}addGridsterPanel(t=!0){return this._gridsterComponentRef=this.viewContainer.createComponent(mc),this._gridsterPanel=new Xs(this._gridsterComponentRef.location.nativeElement,this._spawnDockManager,"Grid",ur.document,!0),this._gridsterPanel.setId("grid"),this._gridsterPanel.hideCloseButton(!0),this._gridsterPanel.hidePinButton(!0),this._gridsterPanel.hideFullscreenButton(!0),t&&this._spawnDockManager.dockFill(this._spawnDockManager.context.model.documentManagerNode,this._gridsterPanel),this._gridsterPanel}loadSpawnPanelsState(t){var i=this;return(0,On.Z)(function*(){let n=new ay;const r=yield i._buildSpawnGraph(t.graphInfo);n.rootNode=r,n.dialogs=yield i._buildSpawnDialogs(t.dialogsInfo),n.documentManagerNode=i._spawnDockManager.context.model.documentManagerNode,i._spawnDockManager.setModel(n),i._spawnDockManager.notifyOnDock(r)})()}_buildSpawnGraph(t){var i=this;return(0,On.Z)(function*(){let n=t.children,r=[];for(let l of n){let c=yield i._buildSpawnGraph(l);null!==c&&r.push(c)}let a=yield i._createSpawnContainer(t,r);if(null===a)return null;let o=new rc(a);o.children=r;for(let l of o.children.reverse())l.parent=o;return o.children.reverse(),o})()}_createSpawnContainer(t,i){var n=this;return(0,On.Z)(function*(){let r=t.containerType,a=t.state,o=null,l=[];for(let c of i)l.push(c.container);if("panel"===t.containerType){if(t.state.panelType!==ur.document)throw new Error("Cannot create panel container");if("grid"===t.state.id)o=n.addGridsterPanel(!1);else{const c=n._panels.find(u=>u.nativeId===t.state.id);if(!c)return console.warn("can not find panel to load!",t.state.id),null;let h=n._floatingWindowsContainer.createComponent(t_);if(h.setInput("panel",c),o=new Xs(h.location.nativeElement,n._spawnDockManager,c.nativeId,ur.document),c.setDocked(o),t.state.isPin&&(c._isPin=t.state.isPin),c._floatingComponentRef=h,!o.prepareForDocking)return null;o.prepareForDocking(),fi.removeNode(o.elementPanel)}}else if("horizontal"===t.containerType)o=new oy(n._spawnDockManager,l);else if("vertical"===r)o=new ly(n._spawnDockManager,l);else{if("fill"!==r)throw new Error("Cannot create dock container of unknown type: "+r);o=a.documentManager?new n_(n._spawnDockManager):new i_(n._spawnDockManager)}return o.loadState(a),o})()}_buildSpawnDialogs(t){var i=this;return(0,On.Z)(function*(){let n=[];for(let r of t){let o=r.state;if("panel"===r.containerType){const l=i._panels.find(m=>m.nativeId===o.id);if(!l)return console.warn("can not find dialog to load!",o.id),[];if(l.isLoaded){console.warn(`dialog ${l.id} before loaded`);continue}let c=i._floatingWindowsContainer.createComponent(t_);c.setInput("panel",l);let h=new Xs(c.location.nativeElement,i._spawnDockManager,o.id,ur.document);l.setFloating(h),h.loadState(o),l._isPin=o.isPin,(r.position.x>document.body.clientWidth||r.position.y>document.body.clientHeight-70)&&(r.position.x=20,r.position.y=70);const u=i._spawnDockManager.floatDialog(h,r.position.x,r.position.y);l._floatingComponentRef=c,l._spawnDialog=u,u.setPosition(r.position.x,r.position.y),u.isHidden=r.isHidden,u.isHidden&&u.hide(),n.push(u)}}return n})()}rebuildDockManager(){if(!this._spawnDockManager)return;this._spawnDockManager._checkShowBackgroundContext();const t=i=>{for(const n of i.children)t(n);this._spawnDockManager.rebuildLayout(i),i.container.resize(i.container.width,i.container.height)};t(this._spawnDockManager.context.model.rootNode);for(const i of this._spawnDockManager.context.model.dialogs)i.resizable.resize(i.panel.width,i.panel.height);this._spawnDockManager.invalidate()}static#e=this.\u0275fac=function(i){return new(i||s)(d.LFG(qt.U),d.LFG(tU.d))};static#t=this.\u0275prov=d.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var dy=V(5191);function iU(s,e){1&s&&(d.TgZ(0,"div",18),d._UZ(1,"img",19),d.qZA())}function nU(s,e){if(1&s){const t=d.EpF();d.TgZ(0,"div",20),d.NdJ("click",function(){d.CHM(t);const n=d.oxw();return d.KtG(n.onFullScreen())}),d.TgZ(1,"span",4),d._uU(2,"fullscreen"),d.qZA()()}}function sU(s,e){if(1&s){const t=d.EpF();d.TgZ(0,"div",20),d.NdJ("click",function(){d.CHM(t);const n=d.oxw();return d.KtG(n.onExitFullScreen())}),d.TgZ(1,"span",4),d._uU(2,"fullscreen_exit"),d.qZA()()}}function rU(s,e){if(1&s){const t=d.EpF();d.TgZ(0,"div",21),d.NdJ("click",function(){d.CHM(t);const n=d.oxw();return d.KtG(n.dockManager.saveActiveDashboardLayoutConfigs())}),d.TgZ(1,"span",4),d._uU(2,"save"),d.qZA()()}}const aU=function(s,e){return{backgroundColor:s,color:e}};let oU=(()=>{class s{constructor(t,i,n,r,a,o){this.panelService=t,this.store=i,this.dockManager=n,this.dashboardService=r,this.transmit=a,this.router=o,this.menuSide_open=!0,this.menuStatic_open=!0,this.menuShow=!0,this.menu2_open=!1,this.fullscreen=!1,this.menuType="full",this.notificationsCount=0,this.downloadable_json="/assets/downloadable.json",this.roleTypes=Zm.r,this.getApplication(Zm.l)}ngOnInit(){this.username$=this.store.select(ce.bG).pipe((0,ri.U)(t=>t?.username)),document.addEventListener("fullscreenchange",this.onFullscreenChange),"static"!==this.menuType&&(this.menuSide_open=!0),this.panelService.menuType.subscribe(t=>{this.menuType=t}),this.panelService.menuShow.subscribe(t=>{this.menuShow=t}),this.panelService.notificationsCount.subscribe(t=>{this.notificationsCount=t})}ngDoCheck(){this.checkFullscreenMode()}getApplication(t){this.transmit.emit("menu-item-clicked",void 0),this.selectedAppType=t,this.store.select(ce.rh).pipe((0,Ei.w)(i=>(i&&this.dashboardService.getApplicationData(i,t),(0,D.of)()))).subscribe()}onMenuToggle(){if("static"===this.menuType)this.menuStatic_open?$("#cmp-menu-static").slideUp(100):$("#cmp-menu-static").slideDown(100),this.menuStatic_open=!this.menuStatic_open;else{let t=$(".menu-wrapper").width();this.menuSide_open?$(".menu-wrapper").velocity({marginLeft:"-"+t+"px",opacity:0},300):$(".menu-wrapper").velocity({marginLeft:0,opacity:1},300),this.menuSide_open=!this.menuSide_open}}onMenu2Click(){$("#cmp-menu-activity.ltr").velocity({right:0,opacity:1},300),$("#cmp-menu-activity.rtl").velocity({left:0,opacity:1},300)}onChangeLanguage(t){return!!["english","farsi"].includes(t)&&(localStorage.setItem("language",t),window.location.reload(),!0)}checkFullscreenMode(){this.fullscreen=window.innerHeight==screen.height}onFullscreenChange(){this.fullscreen=!!document.fullscreenElement}onFullScreen(){if(!this.fullscreen){try{document.documentElement.requestFullscreen()}catch{}this.fullscreen=!0}}onExitFullScreen(){if(this.fullscreen){try{document.exitFullscreen()}catch{}this.fullscreen=!1}}onLogout(){return localStorage.clear(),this.router.navigate(["Auth"]),(0,m_.ls)({userData:null})}switchToUserRole(t){this.transmit.emit("updated_user_role",t)}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(ie),d.Y36(Ie.yh),d.Y36(cy),d.Y36(uw.s),d.Y36(qt.U),d.Y36(_e.F0))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-top-bar"]],inputs:{skeletonConfig:"skeletonConfig"},decls:45,vars:25,consts:[["id","cmp-top-bar",1,"toolbars-bg","toolbars-text",3,"ngStyle"],[1,"items"],["class","logo",4,"ngIf"],[1,"item","icon","menu-side",3,"click"],[1,"material-icons"],["class","item icon fullscreen",3,"click",4,"ngIf"],["matTooltip","Toggle lock active dashboard layout",1,"item","icon","fullscreen",3,"click"],["mat-button","",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"matMenuTriggerFor","click"],["labUsers","matMenu"],["class","item icon fullscreen","matTooltip","Save active dashboard layout configuration",3,"click",4,"ngIf"],[1,"ms-auto"],[1,"item","user"],["id","dropdown_user",1,"caret-off","d-flex","align-items-center",3,"matMenuTriggerFor"],[1,"me-1","d-none","d-md-inline-block"],["profileMenu","matMenu"],[1,"logo"],["src","./assets/logo.svg","alt",""],[1,"item","icon","fullscreen",3,"click"],["matTooltip","Save active dashboard layout configuration",1,"item","icon","fullscreen",3,"click"]],template:function(i,n){if(1&i&&(d.TgZ(0,"div",0)(1,"div",1),d.YNc(2,iU,2,0,"div",2),d.TgZ(3,"div",3),d.NdJ("click",function(){return n.onMenuToggle()}),d.TgZ(4,"span",4),d._uU(5,"menu"),d.qZA()(),d.YNc(6,nU,3,0,"div",5),d.YNc(7,sU,3,0,"div",5),d.TgZ(8,"div",6),d.NdJ("click",function(){return n.dockManager.toggleLockActiveDashboardLayout()}),d.TgZ(9,"span",4),d._uU(10),d.qZA()(),d._UZ(11,"button",7),d.TgZ(12,"mat-menu",null,8)(14,"button",9),d.NdJ("click",function(){return n.getApplication("barname_rizi")}),d._uU(15,"\u0628\u0631\u0646\u0627\u0645\u0647 \u0631\u06cc\u0632\u06cc"),d.qZA(),d.TgZ(16,"button",10),d.NdJ("click",function(){return n.getApplication("azmayesh")}),d._uU(17,"\u0622\u0632\u0645\u0627\u06cc\u0634\u06af\u0627\u0647"),d.qZA(),d.TgZ(18,"button",9),d.NdJ("click",function(){return n.getApplication("tolid")}),d._uU(19,"\u062a\u0648\u0644\u06cc\u062f"),d.qZA(),d.TgZ(20,"button",9),d.NdJ("click",function(){return n.getApplication("automasion")}),d._uU(21,"\u0627\u062a\u0648\u0645\u0627\u0633\u06cc\u0648\u0646 \u0635\u0646\u0639\u062a\u06cc"),d.qZA(),d.TgZ(22,"button",9),d.NdJ("click",function(){return n.getApplication("anbast_bardasht")}),d._uU(23,"\u0627\u0646\u0628\u0627\u0634\u062a\u060c \u0628\u0631\u062f\u0627\u0634\u062a \u0648 \u0628\u0627\u0631\u06af\u06cc\u0631\u06cc"),d.qZA()(),d.TgZ(24,"mat-menu",null,11)(26,"button",9),d.NdJ("click",function(){return n.switchToUserRole(n.roleTypes.SUPER_ADMIN)}),d._uU(27,"\u0627\u062f\u0645\u06cc\u0646"),d.qZA(),d.TgZ(28,"button",9),d.NdJ("click",function(){return n.switchToUserRole(n.roleTypes.JUST_LAB_REPORTS)}),d._uU(29,"\u0633\u0631\u067e\u0631\u0633\u062a"),d.qZA(),d.TgZ(30,"button",9),d.NdJ("click",function(){return n.switchToUserRole(n.roleTypes.JUST_LAB_DATA_ENTRIES)}),d._uU(31,"\u06a9\u0627\u0631\u0634\u0646\u0627\u0633"),d.qZA()(),d.YNc(32,rU,3,0,"div",12),d._UZ(33,"div",13),d.TgZ(34,"div",14)(35,"div",15)(36,"span",16),d._uU(37),d.ALo(38,"async"),d.qZA(),d.TgZ(39,"span",4),d._uU(40,"person"),d.qZA()(),d.TgZ(41,"mat-menu",null,17)(43,"button",9),d.NdJ("click",function(){return n.onLogout()}),d._uU(44,"Logout"),d.qZA()()()()()),2&i){const r=d.MAs(13),a=d.MAs(25),o=d.MAs(42);d.Q6J("ngStyle",d.WLB(22,aU,n.skeletonConfig.topbarColor,n.skeletonConfig.topbarTextColor)),d.xp6(2),d.Q6J("ngIf","static"===n.menuType),d.xp6(4),d.Q6J("ngIf",!n.fullscreen),d.xp6(1),d.Q6J("ngIf",n.fullscreen),d.xp6(3),d.Oqu(n.dockManager.lockActiveDashboardLayout?"lock":"lock_open"),d.xp6(1),d.Q6J("matMenuTriggerFor",r),d.xp6(3),d.Udp("color","barname_rizi"==n.selectedAppType?"red":"unset"),d.xp6(2),d.Udp("color","azmayesh"==n.selectedAppType?"red":"unset"),d.Q6J("matMenuTriggerFor",a),d.xp6(2),d.Udp("color","tolid"==n.selectedAppType?"red":"unset"),d.xp6(2),d.Udp("color","automasion"==n.selectedAppType?"red":"unset"),d.xp6(2),d.Udp("color","anbast_bardasht"==n.selectedAppType?"red":"unset"),d.xp6(10),d.Q6J("ngIf",!n.dockManager.lockActiveDashboardLayout),d.xp6(3),d.Q6J("matMenuTriggerFor",o),d.xp6(2),d.Oqu(d.lcZ(38,20,n.username$))}},dependencies:[x.O5,x.PC,pn.lW,fn.VK,fn.OP,fn.p6,dy.gM,x.Ov],styles:["#cmp-top-bar{padding:10px 5px}@media (min-width: 576px){#cmp-top-bar{padding:10px 15px}}#cmp-top-bar .items{display:flex;align-items:center;width:100%}#cmp-top-bar .items .logo{display:flex;align-items:center}#cmp-top-bar .items .logo img{height:24px}#cmp-top-bar .items .item{display:flex;align-items:center;justify-content:center;margin:0 8px;height:30px;-webkit-user-select:none;user-select:none;cursor:pointer}@media (min-width: 576px){#cmp-top-bar .items .item{margin:0 10px}}#cmp-top-bar .items .item.lang img{height:20px}#cmp-top-bar .items .item.notifications .counter{position:absolute;display:flex;align-items:center;justify-content:center;top:-8px;right:-8px;padding:2px 2px 0 0;width:20px;height:20px;color:#fff;background-color:var(--color_red_500);border-radius:50%;font-size:11px}#cmp-top-bar .items .item .dropdown-item{font-size:13px}\n"],encapsulation:2})}return s})();var lU=V(509),wC=V(5190),dl=V(7812);function cU(s,e){if(1&s&&d._UZ(0,"img",9),2&s){const t=d.oxw(3);d.Q6J("src",t.form._meta.logo,d.LSH)}}function dU(s,e){if(1&s&&(d.TgZ(0,"div",12),d._uU(1),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Oqu(t)}}function hU(s,e){if(1&s&&(d.TgZ(0,"div",10),d.YNc(1,dU,2,1,"div",11),d.qZA()),2&s){const t=d.oxw(3);d.xp6(1),d.Q6J("ngForOf",t.form._meta.header.properties)}}function uU(s,e){if(1&s&&(d.ynx(0),d.YNc(1,cU,1,1,"img",7),d.TgZ(2,"h1"),d._uU(3),d.qZA(),d.YNc(4,hU,2,1,"div",8),d.BQk()),2&s){const t=d.oxw(2);let i,n;d.xp6(1),d.Q6J("ngIf",t.form._meta.logo),d.xp6(1),d.Udp("font-size",null!==(i=t.form._meta.header.fontSize)&&void 0!==i?i:1.2,"em")("margin",null!==(n=t.form._meta.header.fontMargin)&&void 0!==n?n:.67,"em"),d.xp6(1),d.Oqu(t.form._meta.title),d.xp6(1),d.Q6J("ngIf",t.form._meta.header.properties)}}function mU(s,e){if(1&s&&(d.TgZ(0,"div",12),d._uU(1),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Oqu(t)}}function pU(s,e){if(1&s&&(d.TgZ(0,"div",10),d.YNc(1,mU,2,1,"div",11),d.qZA()),2&s){const t=d.oxw(3);d.xp6(1),d.Q6J("ngForOf",t.form._meta.header.properties)}}function fU(s,e){if(1&s&&(d.ynx(0),d.TgZ(1,"div",13),d._UZ(2,"img",9),d.TgZ(3,"h1"),d._uU(4),d.qZA()(),d.YNc(5,pU,2,1,"div",8),d.BQk()),2&s){const t=d.oxw(2);let i,n;d.xp6(2),d.Q6J("src",t.form._meta.logo,d.LSH),d.xp6(1),d.Udp("font-size",null!==(i=t.form._meta.header.fontSize)&&void 0!==i?i:1.2,"em")("margin",null!==(n=t.form._meta.header.fontMargin)&&void 0!==n?n:.67,"em"),d.xp6(1),d.Oqu(t.form._meta.title),d.xp6(1),d.Q6J("ngIf",t.form._meta.header.properties)}}function gU(s,e){if(1&s&&(d.TgZ(0,"div",12),d._uU(1),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Oqu(t)}}function _U(s,e){if(1&s&&(d.TgZ(0,"div",10),d.YNc(1,gU,2,1,"div",11),d.qZA()),2&s){const t=d.oxw(3);d.xp6(1),d.Q6J("ngForOf",t.form._meta.header.properties)}}function bU(s,e){if(1&s&&d._UZ(0,"img",9),2&s){const t=d.oxw(3);d.Q6J("src",t.form._meta.secondLogo,d.LSH)}}function vU(s,e){if(1&s&&(d.ynx(0),d._UZ(1,"img",9),d.TgZ(2,"div",14)(3,"h1"),d._uU(4),d.qZA(),d.YNc(5,_U,2,1,"div",8),d.qZA(),d.YNc(6,bU,1,1,"img",7),d.BQk()),2&s){const t=d.oxw(2);let i,n;d.xp6(1),d.Q6J("src",t.form._meta.logo,d.LSH),d.xp6(2),d.Udp("font-size",null!==(i=t.form._meta.header.fontSize)&&void 0!==i?i:1.2,"em")("margin",null!==(n=t.form._meta.header.fontMargin)&&void 0!==n?n:.67,"em"),d.xp6(1),d.Oqu(t.form._meta.title),d.xp6(1),d.Q6J("ngIf",t.form._meta.header.properties),d.xp6(1),d.Q6J("ngIf",t.form._meta.secondLogo)}}function yU(s,e){1&s&&d._UZ(0,"img",9),2&s&&d.Q6J("src",e.$implicit,d.LSH)}function xU(s,e){if(1&s&&(d.TgZ(0,"div",12),d._uU(1),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Oqu(t)}}function wU(s,e){if(1&s&&(d.TgZ(0,"div",10),d.YNc(1,xU,2,1,"div",11),d.qZA()),2&s){const t=d.oxw(3);d.xp6(1),d.Q6J("ngForOf",t.form._meta.header.properties)}}function MU(s,e){1&s&&d._UZ(0,"img",9),2&s&&d.Q6J("src",e.$implicit,d.LSH)}function TU(s,e){if(1&s&&(d.ynx(0),d.TgZ(1,"div",15),d.YNc(2,yU,1,1,"img",16),d.qZA(),d.TgZ(3,"h1"),d._uU(4),d.qZA(),d.YNc(5,wU,2,1,"div",8),d.TgZ(6,"div",15),d.YNc(7,MU,1,1,"img",16),d.qZA(),d.BQk()),2&s){const t=d.oxw(2);let i,n;d.xp6(2),d.Q6J("ngForOf",null==t.form._meta.header?null:t.form._meta.header.settings.rightLogos),d.xp6(1),d.Udp("font-size",null!==(i=t.form._meta.header.fontSize)&&void 0!==i?i:1.2,"em")("margin",null!==(n=t.form._meta.header.fontMargin)&&void 0!==n?n:.67,"em"),d.xp6(1),d.Oqu(t.form._meta.title),d.xp6(1),d.Q6J("ngIf",t.form._meta.header.properties),d.xp6(2),d.Q6J("ngForOf",null==t.form._meta.header?null:t.form._meta.header.settings.leftLogos)}}function CU(s,e){if(1&s&&(d.ynx(0),d.TgZ(1,"table")(2,"tbody")(3,"tr")(4,"td",17)(5,"div",18),d._UZ(6,"img",9),d.TgZ(7,"div"),d._uU(8),d.qZA()()(),d.TgZ(9,"td",19),d._uU(10),d.qZA(),d.TgZ(11,"td",20)(12,"div",21)(13,"div",22),d._uU(14),d.qZA(),d.TgZ(15,"div",23),d._uU(16),d.qZA()()(),d.TgZ(17,"td",20)(18,"div",21)(19,"div",22),d._uU(20),d.qZA(),d.TgZ(21,"div",23),d._uU(22),d.qZA()()()(),d.TgZ(23,"tr")(24,"td",20)(25,"div",21)(26,"div",22),d._uU(27),d.qZA(),d.TgZ(28,"div",23),d._uU(29),d.qZA()()(),d.TgZ(30,"td",20)(31,"div",21)(32,"div",22),d._uU(33),d.qZA(),d.TgZ(34,"div",23),d._uU(35),d.qZA()()()(),d.TgZ(36,"tr")(37,"td",24),d._uU(38),d.qZA(),d.TgZ(39,"td",20)(40,"div",21)(41,"div",25)(42,"div",22),d._uU(43),d.qZA(),d.TgZ(44,"div",23),d._uU(45),d.qZA()(),d.TgZ(46,"div",25)(47,"div",22),d._uU(48),d.qZA(),d.TgZ(49,"div",23),d._uU(50),d.qZA()()()(),d.TgZ(51,"td",20)(52,"div",21)(53,"div",22),d._uU(54),d.qZA(),d.TgZ(55,"div",23),d._uU(56),d.qZA()()()()()(),d.BQk()),2&s){const t=d.oxw(2);d.xp6(6),d.Q6J("src",t.form._meta.logo,d.LSH),d.xp6(2),d.Oqu(t.headerSettings.logoTitle),d.xp6(2),d.hij(" ",t.headerSettings.englishTitle," "),d.xp6(4),d.hij(" ",t.headerSettings.col31Name," "),d.xp6(2),d.hij(" ",t.headerSettings.col31Value," "),d.xp6(4),d.hij(" ",t.headerSettings.col41Name," "),d.xp6(2),d.hij(" ",t.headerSettings.col41Value," "),d.xp6(5),d.hij(" ",t.headerSettings.col32Name," "),d.xp6(2),d.hij(" ",t.headerSettings.col32Value," "),d.xp6(4),d.hij(" ",t.headerSettings.col42Name," "),d.xp6(2),d.hij(" ",t.headerSettings.col42Value," "),d.xp6(3),d.hij(" ",t.form._meta.title," "),d.xp6(5),d.hij(" ",t.headerSettings.col331Name," "),d.xp6(2),d.hij(" ",t.headerSettings.col331Value," "),d.xp6(3),d.hij(" ",t.headerSettings.col332Name," "),d.xp6(2),d.hij(" ",t.headerSettings.col332Value," "),d.xp6(4),d.hij(" ",t.headerSettings.col43Name," "),d.xp6(2),d.hij(" ",t.headerSettings.col43Value," ")}}const MC=function(s){return[s]};function DU(s,e){if(1&s&&(d.TgZ(0,"header",6),d.YNc(1,uU,5,7,"ng-container",2),d.YNc(2,fU,6,7,"ng-container",2),d.YNc(3,vU,7,8,"ng-container",2),d.YNc(4,TU,8,8,"ng-container",2),d.YNc(5,CU,57,18,"ng-container",2),d.qZA()),2&s){const t=d.oxw();let i,n,r,a;d.Udp("border-radius",null!==(i=t.form._meta.header.borderRadius)&&void 0!==i?i:0,"px")("border-width",null!==(n=t.form._meta.header.borderWidth)&&void 0!==n?n:0,"px")("margin-bottom",null!==(r=t.form._meta.header.marginBottom)&&void 0!==r?r:0,"px")("direction",null!==(a=t.form._meta.header.direction)&&void 0!==a?a:"rtl"),d.ekj("withBorder",(null==t.form._meta.header?null:t.form._meta.header.borderWidth)&&t.form._meta.header.borderWidth>0),d.Q6J("ngClass",d.VKq(16,MC,null==t.form._meta.header?null:t.form._meta.header.style)),d.xp6(1),d.Q6J("ngIf","logo-title-props-v1"===(null==t.form._meta.header?null:t.form._meta.header.style)),d.xp6(1),d.Q6J("ngIf","logo-title-props-v2"===(null==t.form._meta.header?null:t.form._meta.header.style)),d.xp6(1),d.Q6J("ngIf","logo-title-props-v3"===(null==t.form._meta.header?null:t.form._meta.header.style)),d.xp6(1),d.Q6J("ngIf","logo-title-props-v4"===(null==t.form._meta.header?null:t.form._meta.header.style)),d.xp6(1),d.Q6J("ngIf","header-v2"===(null==t.form._meta.header?null:t.form._meta.header.style))}}function EU(s,e){1&s&&d.GkF(0)}function SU(s,e){1&s&&d.GkF(0)}const r_=function(s){return{table:s}};function kU(s,e){if(1&s&&(d.TgZ(0,"table",27),d.YNc(1,EU,1,0,"ng-container",28),d.YNc(2,SU,1,0,"ng-container",28),d.qZA()),2&s){const t=e.$implicit;d.oxw(2);const i=d.MAs(6),n=d.MAs(8);d.Udp("margin-top",t.marginTop,"px")("direction",t.direction),d.Q6J("id","form_table_"+t.name),d.xp6(1),d.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",d.VKq(9,r_,t)),d.xp6(1),d.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",d.VKq(11,r_,t))}}function AU(s,e){if(1&s&&(d.ynx(0),d.YNc(1,kU,3,13,"table",26),d.BQk()),2&s){const t=d.oxw();d.xp6(1),d.Q6J("ngForOf",t.tables)}}function PU(s,e){1&s&&d.GkF(0)}function OU(s,e){1&s&&d.GkF(0)}function RU(s,e){if(1&s&&(d.ynx(0),d.YNc(1,PU,1,0,"ng-container",28),d.YNc(2,OU,1,0,"ng-container",28),d.BQk()),2&s){const t=e.$implicit;d.oxw(2);const i=d.MAs(6),n=d.MAs(8);d.xp6(1),d.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",d.VKq(4,r_,t)),d.xp6(1),d.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",d.VKq(6,r_,t))}}function IU(s,e){if(1&s&&(d.ynx(0),d.TgZ(1,"table",27),d.YNc(2,RU,3,8,"ng-container",29),d.qZA(),d.BQk()),2&s){const t=d.oxw();d.xp6(1),d.Udp("direction",t.form._meta.direction)("font-family",t.form._meta.tableFont),d.Q6J("id","form_table"),d.xp6(1),d.Q6J("ngForOf",t.tables)}}function LU(s,e){if(1&s&&(d.TgZ(0,"div",32),d._uU(1),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Oqu(t)}}function FU(s,e){if(1&s&&(d.ynx(0),d.TgZ(1,"div",30),d._uU(2),d.qZA(),d.YNc(3,LU,2,1,"div",31),d.BQk()),2&s){const t=d.oxw(2);d.xp6(2),d.Oqu(t.form._meta.footer.isoNumber),d.xp6(1),d.Q6J("ngForOf",t.form._meta.footer.signatures)}}function BU(s,e){if(1&s&&(d.TgZ(0,"div",32),d._uU(1),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Oqu(t)}}function NU(s,e){if(1&s&&(d.TgZ(0,"div",30),d._uU(1),d.qZA()),2&s){const t=d.oxw(3);d.xp6(1),d.Oqu(t.form._meta.footer.isoNumber)}}function UU(s,e){if(1&s&&(d.ynx(0),d.TgZ(1,"div",33),d.YNc(2,BU,2,1,"div",31),d.qZA(),d.YNc(3,NU,2,1,"div",34),d.BQk()),2&s){const t=d.oxw(2);d.xp6(2),d.Q6J("ngForOf",t.form._meta.footer.signatures),d.xp6(1),d.Q6J("ngIf",t.form._meta.footer.isoNumber)}}function zU(s,e){if(1&s&&(d.TgZ(0,"div",32),d._uU(1),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Oqu(t)}}function HU(s,e){if(1&s&&(d.ynx(0),d.TgZ(1,"div",30),d._uU(2),d.qZA(),d.YNc(3,zU,2,1,"div",31),d.BQk()),2&s){const t=d.oxw(2);d.xp6(2),d.Oqu(t.form._meta.footer.isoNumber),d.xp6(1),d.Q6J("ngForOf",t.form._meta.footer.signatures)}}function VU(s,e){if(1&s&&(d.TgZ(0,"div",32),d._uU(1),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Oqu(t)}}function WU(s,e){if(1&s&&(d.ynx(0),d.YNc(1,VU,2,1,"div",31),d.BQk()),2&s){const t=d.oxw(2);d.xp6(1),d.Q6J("ngForOf",t.form._meta.footer.signatures)}}function GU(s,e){if(1&s&&(d.TgZ(0,"div",32),d._uU(1),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Oqu(t)}}function YU(s,e){if(1&s&&(d.ynx(0),d.YNc(1,GU,2,1,"div",31),d.TgZ(2,"div",30),d._uU(3),d.qZA(),d.BQk()),2&s){const t=d.oxw(2);d.xp6(1),d.Q6J("ngForOf",t.form._meta.footer.signatures),d.xp6(2),d.Oqu(t.form._meta.footer.isoNumber)}}function jU(s,e){if(1&s&&(d.TgZ(0,"div",32)(1,"p"),d._uU(2),d.qZA(),d.TgZ(3,"p"),d._uU(4),d.qZA()()),2&s){const t=e.$implicit;d.xp6(2),d.Oqu(t.position),d.xp6(2),d.Oqu(t.name)}}function ZU(s,e){if(1&s&&(d.ynx(0),d.YNc(1,jU,5,2,"div",31),d.TgZ(2,"div",30),d._uU(3),d.qZA(),d.BQk()),2&s){const t=d.oxw(2);d.xp6(1),d.Q6J("ngForOf",t.form._meta.footer.settings.signatures),d.xp6(2),d.Oqu(t.form._meta.footer.isoNumber)}}function XU(s,e){if(1&s&&(d.TgZ(0,"div",32),d._uU(1),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.hij("",t," : ................")}}function qU(s,e){if(1&s&&(d.ynx(0),d.TgZ(1,"div",33),d.YNc(2,XU,2,1,"div",31),d.qZA(),d.BQk()),2&s){const t=d.oxw(2);d.xp6(2),d.Q6J("ngForOf",t.form._meta.footer.signatures)}}function $U(s,e){if(1&s&&(d.TgZ(0,"footer",6),d.YNc(1,FU,4,2,"ng-container",2),d.YNc(2,UU,4,2,"ng-container",2),d.YNc(3,HU,4,2,"ng-container",2),d.YNc(4,WU,2,1,"ng-container",2),d.YNc(5,YU,4,2,"ng-container",2),d.YNc(6,ZU,4,2,"ng-container",2),d.YNc(7,qU,3,1,"ng-container",2),d.qZA()),2&s){const t=d.oxw();let i,n;d.Udp("margin-top",null!==(i=t.form._meta.footer.marginTop)&&void 0!==i?i:0,"px")("direction",null!==(n=t.form._meta.footer.direction)&&void 0!==n?n:"rtl"),d.Q6J("ngClass",d.VKq(12,MC,null==t.form._meta.footer?null:t.form._meta.footer.style)),d.xp6(1),d.Q6J("ngIf","iso-signatures-v1"===(null==t.form._meta.footer?null:t.form._meta.footer.style)),d.xp6(1),d.Q6J("ngIf","iso-signatures-v2"===(null==t.form._meta.footer?null:t.form._meta.footer.style)),d.xp6(1),d.Q6J("ngIf","iso-signatures-v3"===(null==t.form._meta.footer?null:t.form._meta.footer.style)),d.xp6(1),d.Q6J("ngIf","iso-signatures-v4"===(null==t.form._meta.footer?null:t.form._meta.footer.style)),d.xp6(1),d.Q6J("ngIf","iso-signatures-v5"===(null==t.form._meta.footer?null:t.form._meta.footer.style)),d.xp6(1),d.Q6J("ngIf","iso-signatures-v6"===(null==t.form._meta.footer?null:t.form._meta.footer.style)),d.xp6(1),d.Q6J("ngIf","footer-signatures-v2"===(null==t.form._meta.footer?null:t.form._meta.footer.style))}}function KU(s,e){if(1&s&&d._UZ(0,"th",36),2&s){const t=e.$implicit,i=d.oxw(2).table,n=d.oxw();let r;d.Udp("height",n.form._meta.cellHeight)("background-color",null!==(r=t.backgroundColor)&&void 0!==r?r:n.form._meta.tableHeaderBackground)("width",n.calcCellWidth(t,i.name))("min-width",i.exactWidth?n.calcCellWidth(t,i.name):"unset")("max-width",i.exactWidth?n.calcCellWidth(t,i.name):"unset")("border-left-width",t.borderLeft,"px")("border-right-width",t.borderRight,"px")("border-top-width",t.borderTop,"px")("border-bottom-width",t.borderBottom,"px"),d.ekj("bold","bold"==t.style)("h1","h1"==t.style)("small","small"==t.style)("extra-small","extra-small"==t.style)("vertically","vertically"==t.style),d.Q6J("innerHtml",t.text,d.oJD),d.uIk("colspan",t.colSpan)("rowspan",t.rowSpan)}}function JU(s,e){if(1&s&&(d.TgZ(0,"tr"),d.YNc(1,KU,1,31,"th",35),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Q6J("ngForOf",t)}}function QU(s,e){if(1&s&&(d.TgZ(0,"thead"),d.YNc(1,JU,2,1,"tr",29),d.qZA()),2&s){const t=e.table;d.Udp("direction",t.direction),d.xp6(1),d.Q6J("ngForOf",t.headerRows)}}function ez(s,e){if(1&s&&d._UZ(0,"td",36),2&s){const t=e.$implicit,i=d.oxw(2).table,n=d.oxw();d.Udp("background-color",t.backgroundColor)("height",n.form._meta.cellHeight)("min-width",i.exactWidth?n.calcCellWidth(t,i.name):"unset")("width",n.calcCellWidth(t,i.name))("max-width",i.exactWidth?n.calcCellWidth(t,i.name):"unset")("border-left-width",t.borderLeft,"px")("border-right-width",t.borderRight,"px")("border-top-width",t.borderTop,"px")("border-bottom-width",t.borderBottom,"px"),d.ekj("small","small"==t.style)("bold","bold"==t.style)("extra-small","extra-small"==t.style),d.Q6J("innerHtml",t.text,d.oJD),d.uIk("colspan",t.colSpan)("rowspan",t.rowSpan)}}function tz(s,e){if(1&s&&(d.TgZ(0,"tr"),d.YNc(1,ez,1,27,"td",37),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Q6J("ngForOf",t)}}function iz(s,e){if(1&s&&(d.TgZ(0,"tbody"),d.YNc(1,tz,2,1,"tr",29),d.qZA()),2&s){const t=e.table;d.xp6(1),d.Q6J("ngForOf",t.dataRows)}}let nz=(()=>{class s{constructor(){this.data=[],this.rowData=[],this.version="1.1.5",this.tables=[]}ngOnInit(){}get headerSettings(){return this.form?._meta?.header?this.form._meta.header.settings??{}:{}}ngOnChanges(t){t.form&&(this.tables=[],this.normalizeSchema(),this.generateTableHeaders(),this.renderTableRows(),this.fixedTableSize(),console.log(this.tables)),t.data&&this.renderTableData()}fixedTableSize(){setTimeout(()=>{const t=this.contentId?document.getElementById(this.contentId):document.getElementsByTagName("body")[0];if(!t)return void this.fixedTableSize();let i=t.offsetWidth+"px";"custom"===this.form._meta.print.paperSize?i=this.form._meta.width+"mm":"A4"===this.form._meta.print.paperSize&&(i=this.form._meta.print.isLandscape?"292mm":"205mm");const n=document.getElementById("form-container");if(n){n.style.width=i;for(const r of this.form.tables){const a=this.getTableElement(r.name);if(!a)return void this.fixedTableSize();a.style.width=i}}else this.fixedTableSize()},300)}normalizeSchema(){this.form._meta||(this.form._meta={title:"",name:""}),this.form._meta.tableMode||(this.form._meta.tableMode="one-table"),this.form._meta.properties||(this.form._meta.properties=[]),this.form._meta.style||(this.form._meta.style="form-container"),this.form._meta.direction||(this.form._meta.direction="rtl"),this.form._meta.font||(this.form._meta.font="Bnazanin"),this.form._meta.tableFont||(this.form._meta.tableFont=this.form._meta.font),this.form._meta.tableHeaderBackground||(this.form._meta.tableHeaderBackground="#f0e6cc"),this.form._meta.cellHeight||(this.form._meta.cellHeight="4mm"),this.form._meta.print||(this.form._meta.print={}),this.form._meta.print.paperSize||(this.form._meta.print.paperSize="A4");for(const t of this.form.tables){t.type||(t.type="static"),t.direction||(t.direction="ltr"),t.marginTop||(t.marginTop=0);const i=r=>{for(const a of r){if(a.height||(a.height=1),a.width||(a.width=1),a.style||(a.style="normal"),a.__beforeSet=void 0,a.subCells&&"string"==typeof a.subCells[0]){const o=a.subCells;a.subCells=[];for(const l of o)a.subCells.push({title:l})}a.subCells&&i(a.subCells)}};t?.columns.rowCells||(t.columns.rowCells=1),i(t.columns.cells);const n=r=>{for(const a of r){if(a.width||(a.width=1),a.height||(a.height=1),a.text||(a.text=""),a.backgroundColor||(a.backgroundColor="transparent"),a.__beforeSet=void 0,a.childCells&&"string"==typeof a.childCells[0]){const o=a.childCells;a.childCells=[];for(const l of o)a.childCells.push({text:l})}a.childCells&&n(a.childCells)}};t.rowSchema||(t.rowSchema={}),void 0===t.rowSchema?.height&&(t.rowSchema.height=1),t.rowSchema.reservedCols&&n(t.rowSchema.reservedCols)}}generateTableHeaders(){this.tables=[],console.log(this.form.tables);for(const t of this.form.tables){const i=(r,a,o,l)=>{if(r.__beforeSet){if(r.__beforeSet&&r.subCells)for(const c of r.subCells)i(c,a,o,r)}else{if(l&&o+1<=l.height)return;a.push({rowSpan:r.height,colSpan:r.width,text:r.title,style:r.style,backgroundColor:r.backgroundColor,borderLeft:r.borderLeft??1,borderRight:r.borderRight??1,borderTop:r.borderTop??1,borderBottom:r.borderBottom??1}),r.__beforeSet=!0}};let n=[];for(let r=0;r<t.columns.rowCells;r++){let a=[];for(const o of t.columns.cells)i(o,a,r);n.push(a)}this.tables.push({headerRows:n,direction:t.direction,dataRows:[],name:t.name,marginTop:t.marginTop,exactWidth:t.exactWidth??!1})}}renderTableRows(){for(let t=0;t<this.form.tables.length;t++){const i=this.form.tables[t];let n=[];"static"===i.type&&(i.rowSchema?.reservedCols?n=this.renderReservedTableRows(i):void 0!==i.rowSchema?.height&&i.rowSchema?.height>0&&(n=this.renderFixedTableRows(i))),this.tables[t].dataRows=n}}renderTableData(){}renderFixedTableRows(t){let i=[];const n=t.rowSchema?.height??1;for(let r=0;r<n;r++){let a=[];for(let o=0;o<t.columns.colCells;o++)a.push({text:""});i.push(a)}return i}renderReservedTableRows(t){let i=[];for(let n=0;n<t.rowSchema.reservedCols.length;n++){let r=[],a=t.rowSchema.reservedColsWidth??0;for(let o=0;o<t.rowSchema.reservedCols.length&&!(this.getCellTd(t.rowSchema.reservedCols[o],r,n,a)>0);o++);i.push(r)}return i}calcCellWidth(t,i){const n=this.form.tables.find(o=>o.name===i),r=this.getTableElement(i);return n&&r?r.offsetWidth/n.columns.colCells*(t.colSpan??1)+"px":"auto"}getTableElement(t){return"split-tables"===this.form._meta.tableMode?document.getElementById("form_table_"+t):document.getElementById("form_table")}renderEachTableRow(t,i){let n=[];if(this.form.tables[i].rowSchema?.reservedCols){const r=(o,l,c,h,u)=>{if(u||(u=0),o.__beforeSet||(l.push({rowSpan:o.height,colSpan:o.width,text:o.text}),u+=o.width,o.__beforeSet=!0),o.childCells)for(const m of o.childCells){if(u===h)break;u=r(m,l,c,h,u)}return u},a=o=>{for(const l of o)l.__beforeSet=!1,l.childCells&&a(l.childCells)};a(this.form.tables[i].rowSchema.reservedCols);for(let o=0;o<this.form.tables[i].rowSchema.height;o++){let l=[],c=this.form.tables[i].rowSchema.reservedColsWidth;for(let h=0;h<this.form.tables[i].rowSchema.reservedCols.length&&!(r(this.form.tables[i].rowSchema.reservedCols[h],l,o,c)>0);h++);for(let h=0;h<this.form.tables[i].columns.colCells-this.form.tables[i].rowSchema.reservedColsWidth;h++){let u="";try{u=String(t[o][h])}catch(m){console.warn(m)}l.push({text:u})}n.push(l)}}return n}getCellTd(t,i,n,r,a){if(a||(a=0),t.__beforeSet||(i.push({rowSpan:t.height,colSpan:t.width,text:t.text,name:t.name,style:t.style,backgroundColor:t.backgroundColor??"transparent",borderLeft:t.borderLeft??1,borderRight:t.borderRight??1,borderTop:t.borderTop??1,borderBottom:t.borderBottom??1}),a+=t.width,t.__beforeSet=!0),t.childCells)for(const o of t.childCells){if(a===r)break;a=this.getCellTd(o,i,n,r,a)}return a}static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["form-engine"]],inputs:{form:"form",data:"data",rowData:"rowData",contentId:"contentId"},features:[d.TTD],decls:9,vars:7,consts:[["id","form-container",1,"form-container",3,"ngClass"],[3,"ngClass","border-radius","withBorder","border-width","margin-bottom","direction",4,"ngIf"],[4,"ngIf"],[3,"ngClass","margin-top","direction",4,"ngIf"],["tableThead",""],["tableTbody",""],[3,"ngClass"],[3,"src",4,"ngIf"],["class","properties",4,"ngIf"],[3,"src"],[1,"properties"],["class","property",4,"ngFor","ngForOf"],[1,"property"],[1,"form-description"],[1,"description-section"],[1,"logos"],[3,"src",4,"ngFor","ngForOf"],["rowspan","3"],[1,"img"],["colspan","3","rowspan","2"],["colspan","2"],[1,"td"],[1,"name"],[1,"value"],["colspan","3","rowspan","1"],[1,"xcol"],[3,"margin-top","id","direction",4,"ngFor","ngForOf"],[3,"id"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngFor","ngForOf"],[1,"iso"],["class","signature",4,"ngFor","ngForOf"],[1,"signature"],[1,"signature-container"],["class","iso",4,"ngIf"],[3,"height","background-color","bold","width","min-width","max-width","h1","small","extra-small","vertically","border-left-width","border-right-width","border-top-width","border-bottom-width","innerHtml",4,"ngFor","ngForOf"],[3,"innerHtml"],[3,"background-color","height","min-width","width","max-width","small","bold","extra-small","border-left-width","border-right-width","border-top-width","border-bottom-width","innerHtml",4,"ngFor","ngForOf"]],template:function(i,n){1&i&&(d.TgZ(0,"div",0),d.YNc(1,DU,6,18,"header",1),d.YNc(2,AU,2,1,"ng-container",2),d.YNc(3,IU,3,6,"ng-container",2),d.YNc(4,$U,8,14,"footer",3),d.qZA(),d.YNc(5,QU,2,3,"ng-template",null,4,d.W1O),d.YNc(7,iz,2,1,"ng-template",null,5,d.W1O)),2&i&&(d.Udp("font-family",n.form._meta.font),d.Q6J("ngClass",n.form._meta.properties),d.xp6(1),d.Q6J("ngIf",null==n.form?null:n.form._meta.header),d.xp6(1),d.Q6J("ngIf","split-tables"===n.form._meta.tableMode),d.xp6(1),d.Q6J("ngIf","one-table"===n.form._meta.tableMode),d.xp6(1),d.Q6J("ngIf",null==n.form?null:n.form._meta.footer))},dependencies:[x.mk,x.sg,x.O5,x.tP],styles:["@font-face{font-family:Bnazanin;src:url(/assets/fonts/Bnazanin.ttf)}.form-container[_ngcontent-%COMP%]{border:solid 1px #1d1d1d}.form-container.no-border[_ngcontent-%COMP%]{border:none}table[_ngcontent-%COMP%]{width:100%;display:block;text-align:center;table-layout:fixed;word-break:normal}table[_ngcontent-%COMP%], td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{border:1px solid #595959;border-collapse:collapse;font-size:.7rem}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{overflow:hidden}td.h1[_ngcontent-%COMP%], th.h1[_ngcontent-%COMP%]{font-size:1.4em;font-weight:800}td.small[_ngcontent-%COMP%], th.small[_ngcontent-%COMP%]{font-size:.6rem}td.bold[_ngcontent-%COMP%], th.bold[_ngcontent-%COMP%]{font-weight:700}td.extra-small[_ngcontent-%COMP%], th.extra-small[_ngcontent-%COMP%]{font-size:.4rem}td.vertically[_ngcontent-%COMP%], th.vertically[_ngcontent-%COMP%]{writing-mode:tb-rl;white-space:nowrap}.even[_ngcontent-%COMP%]{background:#fbf8f0}.odd[_ngcontent-%COMP%]{background:#fefcf9}header.logo-title-props-v1[_ngcontent-%COMP%]{display:flex;direction:rtl;align-items:center;justify-content:center;padding:5px 0}header.logo-title-props-v1.withBorder[_ngcontent-%COMP%]{border-color:#1d1d1d;border-style:solid}header.logo-title-props-v1[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:80px}header.logo-title-props-v1[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{flex:1 1 0;text-align:center;font-size:1.2em}header.logo-title-props-v1[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%]{width:150px;display:flex;flex-direction:column}header.logo-title-props-v1[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%]   .property[_ngcontent-%COMP%]{margin-bottom:.7em}header.logo-title-props-v2[_ngcontent-%COMP%]{display:flex;flex-direction:column}header.logo-title-props-v2[_ngcontent-%COMP%]   .form-description[_ngcontent-%COMP%]{display:flex;flex:1 1 0;direction:rtl;align-items:center;justify-content:center;border:2px solid #000}header.logo-title-props-v2.withBorder[_ngcontent-%COMP%]{border-color:#1d1d1d;border-style:solid}header.logo-title-props-v2[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:70px}header.logo-title-props-v2[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{flex:1 1 0;text-align:center;font-size:1.2em}header.logo-title-props-v2[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%]{display:flex;flex-direction:column;border:2px solid #000;margin:5px 0;width:auto;direction:ltr}header.logo-title-props-v2[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%]   .property[_ngcontent-%COMP%]{margin:.7em 0;padding-left:3px;font-size:12px}header.logo-title-props-v3[_ngcontent-%COMP%]{display:flex;direction:rtl;align-items:center;justify-content:space-between;padding:5px 0}header.logo-title-props-v3[_ngcontent-%COMP%]   .description-section[_ngcontent-%COMP%]{display:flex;flex:1 1 0;flex-direction:column;margin:0 4px}header.logo-title-props-v3[_ngcontent-%COMP%]   .description-section[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}header.logo-title-props-v3.withBorder[_ngcontent-%COMP%]{border-color:#1d1d1d;border-style:solid}header.logo-title-props-v3[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:80px;border-radius:15px}header.logo-title-props-v3[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{flex:1 1 0;text-align:center;font-size:1.2em}header.logo-title-props-v3[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%]{display:flex;flex-direction:row}header.logo-title-props-v3[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%]   .property[_ngcontent-%COMP%]{font-size:11px}header.logo-title-props-v4[_ngcontent-%COMP%]{display:flex;direction:rtl;align-items:center;justify-content:center;padding:5px 0}header.logo-title-props-v4.withBorder[_ngcontent-%COMP%]{border-color:#1d1d1d;border-style:solid}header.logo-title-props-v4[_ngcontent-%COMP%]   .logos[_ngcontent-%COMP%]{display:flex;align-items:center}header.logo-title-props-v4[_ngcontent-%COMP%]   .logos[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:0 5px;height:60px}header.logo-title-props-v4[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{flex:1 1 0;text-align:center;font-size:1.2em}header.logo-title-props-v4[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%]{width:150px;display:flex;flex-direction:column}header.logo-title-props-v4[_ngcontent-%COMP%]   .properties[_ngcontent-%COMP%]   .property[_ngcontent-%COMP%]{margin-bottom:.7em}.header-v2[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;table-layout:auto!important;display:inline-table!important}.header-v2[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:5px}.header-v2[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:50px}.header-v2[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .td[_ngcontent-%COMP%]{padding:5px;display:flex;align-items:center;justify-content:center}.header-v2[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .td[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{flex:1 1 0}.header-v2[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .td[_ngcontent-%COMP%]   .xcol[_ngcontent-%COMP%]{display:flex;align-items:center;flex:1 1 0}.header-v2[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .td[_ngcontent-%COMP%]   .xcol[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:1.3em}footer.iso-signatures-v1[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;margin-top:10px;direction:rtl}footer.iso-signatures-v1[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{flex:1 1 0;height:70px;border:1px solid #000000;padding:.8em}footer.iso-signatures-v1[_ngcontent-%COMP%]   .iso[_ngcontent-%COMP%]{display:flex;align-items:center;font-family:Times New Roman,Times,serif}footer.iso-signatures-v1[_ngcontent-%COMP%]   .signature[_ngcontent-%COMP%]{display:flex;justify-content:center}footer.iso-signatures-v2[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;margin-top:10px;border:1px solid #000000}footer.iso-signatures-v2[_ngcontent-%COMP%]   .iso[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;font-size:12px;padding:0 10px 10px;border:1px solid #000000}footer.iso-signatures-v2[_ngcontent-%COMP%]   .signature-container[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;direction:rtl}footer.iso-signatures-v2[_ngcontent-%COMP%]   .signature-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{flex:1 1 0;height:130px;border:1px solid #000000;padding:.8em}footer.iso-signatures-v2[_ngcontent-%COMP%]   .signature-container[_ngcontent-%COMP%]   .signature[_ngcontent-%COMP%]{display:flex;justify-content:center;flex:1 1 0;height:60px;border:1px solid #000000;padding:.8em;font-size:11px}footer.iso-signatures-v3[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;margin-top:10px;direction:rtl}footer.iso-signatures-v3[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:calc((100% - 80.59px)/2);height:55px;border:1px solid #000000;padding:.8em;font-size:12px}footer.iso-signatures-v3[_ngcontent-%COMP%]   .iso[_ngcontent-%COMP%]{width:80.59px;display:flex}footer.iso-signatures-v3[_ngcontent-%COMP%]   .signature[_ngcontent-%COMP%]{display:flex;justify-content:center}footer.iso-signatures-v4[_ngcontent-%COMP%]{width:100%;direction:rtl}footer.iso-signatures-v5[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;margin-top:10px;direction:rtl;border:1px solid #000000}footer.iso-signatures-v5[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{flex:1 1 0;height:60px;padding:.8em}footer.iso-signatures-v5[_ngcontent-%COMP%]   .iso[_ngcontent-%COMP%]{position:absolute;font-size:11px}footer.iso-signatures-v5[_ngcontent-%COMP%]   .signature[_ngcontent-%COMP%]{display:flex;justify-content:center;font-size:11px;border:1px solid #000000}footer.iso-signatures-v6[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;margin-top:10px;direction:rtl;border:1px solid #000000}footer.iso-signatures-v6[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.7rem}footer.iso-signatures-v6[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{flex:1 1 0;height:60px;padding:2px}footer.iso-signatures-v6[_ngcontent-%COMP%]   .iso[_ngcontent-%COMP%]{position:absolute;font-size:11px}footer.iso-signatures-v6[_ngcontent-%COMP%]   .signature[_ngcontent-%COMP%]{display:flex;flex-direction:column;font-size:11px;border:1px solid #000000}.footer-signatures-v2[_ngcontent-%COMP%]   .signature-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:10px}.footer-signatures-v2[_ngcontent-%COMP%]   .signature-container[_ngcontent-%COMP%]   .signature[_ngcontent-%COMP%]{border:1px solid #000000;padding:4px;margin:0 5px;flex:1 1 0}"]})}return s})();function sz(s,e){if(1&s&&d._UZ(0,"form-engine",20),2&s){const t=d.oxw();d.Q6J("form",t.form)("contentId","content")}}let rz=(()=>{class s{ngOnChanges(t){t.formName&&(this.form=wC.r.find(i=>i._meta.name===this.formName))}static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-preview-report-form"]],inputs:{formName:"formName"},features:[d.TTD],decls:26,vars:4,consts:[[1,"main"],[2,"font-size","20px"],[1,"date-picker","no-bottom",2,"margin-right","5px"],["matInput","",3,"matDatepicker"],["matIconSuffix","",2,"margin-top","-5px",3,"for"],["matDatepickerToggleIcon","",2,"font-size","20px"],[2,"font-size","14px"],["picker",""],[2,"display","flex"],["mat-mini-fab","","color","primary","matTooltip","Excel",2,"margin-right","5px"],["xmlns","http://www.w3.org/2000/svg","x","0px","y","0px","width","28","height","28","viewBox","0 0 24 24"],["d","M 12 3 L 2 5 L 2 19 L 12 21 L 12 3 z M 14 5 L 14 7 L 16 7 L 16 9 L 14 9 L 14 11 L 16 11 L 16 13 L 14 13 L 14 15 L 16 15 L 16 17 L 14 17 L 14 19 L 21 19 C 21.552 19 22 18.552 22 18 L 22 6 C 22 5.448 21.552 5 21 5 L 14 5 z M 18 7 L 20 7 L 20 9 L 18 9 L 18 7 z M 4.1757812 8.296875 L 5.953125 8.296875 L 6.8769531 10.511719 C 6.9519531 10.692719 7.0084063 10.902625 7.0664062 11.140625 L 7.0917969 11.140625 C 7.1247969 10.997625 7.1919688 10.779141 7.2929688 10.494141 L 8.3222656 8.296875 L 9.9433594 8.296875 L 8.0078125 11.966797 L 10 15.703125 L 8.2714844 15.703125 L 7.1582031 13.289062 C 7.1162031 13.204062 7.0663906 13.032922 7.0253906 12.794922 L 7.0097656 12.794922 C 6.9847656 12.908922 6.934375 13.079594 6.859375 13.308594 L 5.7363281 15.703125 L 4 15.703125 L 6.0605469 11.996094 L 4.1757812 8.296875 z M 18 11 L 20 11 L 20 13 L 18 13 L 18 11 z M 18 15 L 20 15 L 20 17 L 18 17 L 18 15 z"],["mat-mini-fab","","color","primary","matTooltip","PDF",2,"margin-right","5px"],["aria-hidden","false","aria-label","Example home icon","fontIcon","picture_as_pdf"],["mat-mini-fab","","color","primary","matTooltip","Print",2,"margin-right","5px"],["aria-hidden","false","aria-label","Example home icon","fontIcon","print"],["mat-mini-fab","","color","primary","matTooltip","Photo",2,"margin-right","5px"],["aria-hidden","false","aria-label","Example home icon","fontIcon","photo"],["id","content",1,"content"],[3,"form","contentId",4,"ngIf"],[3,"form","contentId"]],template:function(i,n){if(1&i&&(d.TgZ(0,"div",0)(1,"header")(2,"h1",1),d._uU(3),d.qZA(),d.TgZ(4,"div",2)(5,"mat-form-field")(6,"mat-label"),d._uU(7,"Choose a date"),d.qZA(),d._UZ(8,"input",3),d.TgZ(9,"mat-datepicker-toggle",4)(10,"mat-icon",5),d._uU(11,"today"),d.qZA()(),d._UZ(12,"mat-datepicker",6,7),d.qZA()(),d.TgZ(14,"div",8)(15,"button",9),d.O4$(),d.TgZ(16,"svg",10),d._UZ(17,"path",11),d.qZA()(),d.kcU(),d.TgZ(18,"button",12),d._UZ(19,"mat-icon",13),d.qZA(),d.TgZ(20,"button",14),d._UZ(21,"mat-icon",15),d.qZA(),d.TgZ(22,"button",16),d._UZ(23,"mat-icon",17),d.qZA()()(),d.TgZ(24,"div",18),d.YNc(25,sz,1,2,"form-engine",19),d.qZA()()),2&i){const r=d.MAs(13);d.xp6(3),d.Oqu(null==n.form||null==n.form._meta?null:n.form._meta.abbreviation),d.xp6(5),d.Q6J("matDatepicker",r),d.xp6(1),d.Q6J("for",r),d.xp6(16),d.Q6J("ngIf",n.form)}},dependencies:[x.O5,pn.nh,jn.Hw,dy.gM,Xr.KE,Xr.hX,Xr.R9,Rl.Nt,dl.Mq,dl.hl,dl.nW,dl.Q0,nz],styles:[".date-picker mat-form-field{height:38px}  .date-picker .mat-mdc-form-field-infix{padding:10px 0 0!important}  .date-picker label{overflow:visible}  .date-picker mat-label{top:-8px;font-size:12px!important}  .date-picker input{margin-top:8px;font-size:12px!important}  .date-picker .mat-datepicker-toggle button{margin-top:-10px!important}  .no-bottom .mat-mdc-form-field-subscript-wrapper{display:none}.main[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;align-items:center}.main[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{flex:1 1 0}header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:10px;width:100%;align-items:center}header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0}"]})}return s})();var az=V(399),mn=V(72),iu=V(4424);function oz(s,e){if(1&s&&d._UZ(0,"img",8),2&s){const t=d.oxw();d.Q6J("src",t.imagePath,d.LSH)}}function lz(s,e){1&s&&d._UZ(0,"mat-icon",15)}function cz(s,e){if(1&s&&(d.TgZ(0,"th",12)(1,"div",13),d._uU(2),d.YNc(3,lz,1,0,"mat-icon",14),d.qZA()()),2&s){const t=d.oxw().$implicit;d.xp6(2),d.hij(" ",t," "),d.xp6(1),d.Q6J("ngIf","Date"==t)}}function dz(s,e){if(1&s&&(d.TgZ(0,"td",16),d._uU(1),d.qZA()),2&s){const t=e.$implicit,i=d.oxw().$implicit,n=d.oxw();d.Udp("background-color",t.color),d.xp6(1),d.hij(" ",n.getColumnName(t,i)," ")}}function hz(s,e){if(1&s&&(d.ynx(0)(1,9),d.YNc(2,cz,4,2,"th",10),d.YNc(3,dz,2,3,"td",11),d.BQk()()),2&s){const t=e.$implicit;d.xp6(1),d.Q6J("matColumnDef",t)}}function uz(s,e){1&s&&d._UZ(0,"tr",17)}function mz(s,e){1&s&&d._UZ(0,"tr",18)}const pz=function(){return[5,10,25,100]};let fz=(()=>{class s{constructor(){this.logs=[{Date:"29/04/24",Time:"10:30",Priority:"0",TagName:"150BW03",Event:"H Limit 950.00 t/h",Type:"Warning",Area:"Area_850",color:"yellow"},{Date:"29/04/25",Time:"10:20",Priority:"0",TagName:"850BW03",Event:"H Limit 950.00 t/h",Type:"Warning",Area:"Area_850",color:"#5eba5e"},{Date:"29/04/25",Time:"11:30",Priority:"0",TagName:"150BW03",Event:"H Limit 950.00 t/h",Type:"Warning",Area:"Area_850",color:"#5eba5e"},{Date:"29/04/25",Time:"14:00",Priority:"0",TagName:"150BW03",Event:"H Limit 950.00 t/h",Type:"Warning",Area:"Area_850",color:"yellow"},{Date:"29/04/25",Time:"15:00",Priority:"0",TagName:"150BW03",Event:"H Limit 950.00 t/h",Type:"Warning",Area:"Blain_Increasing",color:"#5eba5e"},{Date:"29/04/25",Time:"16:00",Priority:"0",TagName:"150BW03",Event:"H Limit 950.00 t/h",Type:"Warning",Area:"Area_850",color:"yellow"}],this.displayedColumns=Object.keys(this.logs[0]).filter(t=>"color"!==t)}ngOnChanges(t){t.name&&(this.imagePath=az.M.find(i=>i.name===this.name)?.image)}getColumnName(t,i){return t[i]}static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-preview-hmi-dashboard"]],inputs:{name:"name"},features:[d.TTD],decls:8,vars:9,consts:[[1,"main"],[3,"src",4,"ngIf"],[1,"mat-elevation-z8","logs"],["mat-table","",3,"dataSource"],[4,"ngFor","ngForOf"],["style","height: 25px !important","mat-header-row","",4,"matHeaderRowDef"],["style","height: 20px !important","mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page",3,"length","pageSize","pageSizeOptions"],[3,"src"],[3,"matColumnDef"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",3,"background-color",4,"matCellDef"],["mat-header-cell",""],[2,"display","flex","align-items","center","font-size","11px"],["style","font-size: 15px","fontIcon","south",4,"ngIf"],["fontIcon","south",2,"font-size","15px"],["mat-cell",""],["mat-header-row","",2,"height","25px !important"],["mat-row","",2,"height","20px !important"]],template:function(i,n){1&i&&(d.TgZ(0,"div",0),d.YNc(1,oz,1,1,"img",1),d.TgZ(2,"div",2)(3,"table",3),d.YNc(4,hz,4,1,"ng-container",4),d.YNc(5,uz,1,0,"tr",5),d.YNc(6,mz,1,0,"tr",6),d.qZA(),d._UZ(7,"mat-paginator",7),d.qZA()()),2&i&&(d.xp6(1),d.Q6J("ngIf",n.imagePath),d.xp6(2),d.Q6J("dataSource",n.logs),d.xp6(1),d.Q6J("ngForOf",n.displayedColumns),d.xp6(1),d.Q6J("matHeaderRowDef",n.displayedColumns),d.xp6(1),d.Q6J("matRowDefColumns",n.displayedColumns),d.xp6(1),d.Q6J("length",100)("pageSize",10)("pageSizeOptions",d.DdM(8,pz)))},dependencies:[x.sg,x.O5,jn.Hw,mn.BZ,mn.fO,mn.as,mn.w1,mn.Dz,mn.nj,mn.ge,mn.ev,mn.XQ,mn.Gk,iu.NW],styles:[".main[_ngcontent-%COMP%]{background-color:silver;height:100%;display:flex;flex-direction:column}img[_ngcontent-%COMP%]{max-height:70%;max-width:100%}.logs[_ngcontent-%COMP%]{flex:1 1 0;overflow:auto}"]})}return s})(),gz=(()=>{class s{ngOnChanges(t){this.title=wC.E.find(i=>i.name===this.name)?.title}static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-preview-report-excel"]],inputs:{name:"name"},features:[d.TTD],decls:19,vars:3,consts:[[1,"main"],[2,"font-size","20px"],[1,"date-picker","no-bottom",2,"margin-right","5px"],["matInput","",3,"matDatepicker"],["matIconSuffix","",2,"margin-top","-5px",3,"for"],["matDatepickerToggleIcon","",2,"font-size","20px"],[2,"font-size","14px"],["picker",""],[2,"display","flex"],["mat-mini-fab","","color","primary",2,"margin-right","5px"],["aria-hidden","false","aria-label","Example home icon","fontIcon","file_download"],[1,"content"],["src","./assets/icons/excel.png"]],template:function(i,n){if(1&i&&(d.TgZ(0,"div",0)(1,"header")(2,"h1",1),d._uU(3),d.qZA(),d.TgZ(4,"div",2)(5,"mat-form-field")(6,"mat-label"),d._uU(7,"Choose a date"),d.qZA(),d._UZ(8,"input",3),d.TgZ(9,"mat-datepicker-toggle",4)(10,"mat-icon",5),d._uU(11,"today"),d.qZA()(),d._UZ(12,"mat-datepicker",6,7),d.qZA()(),d.TgZ(14,"div",8)(15,"button",9),d._UZ(16,"mat-icon",10),d.qZA()()(),d.TgZ(17,"div",11),d._UZ(18,"img",12),d.qZA()()),2&i){const r=d.MAs(13);d.xp6(3),d.Oqu(n.title),d.xp6(5),d.Q6J("matDatepicker",r),d.xp6(1),d.Q6J("for",r)}},dependencies:[pn.nh,jn.Hw,Xr.KE,Xr.hX,Xr.R9,Rl.Nt,dl.Mq,dl.hl,dl.nW,dl.Q0],styles:[".date-picker mat-form-field{height:38px}  .date-picker .mat-mdc-form-field-infix{padding:10px 0 0!important}  .date-picker label{overflow:visible}  .date-picker mat-label{top:-8px;font-size:12px!important}  .date-picker input{margin-top:8px;font-size:12px!important}  .date-picker .mat-datepicker-toggle button{margin-top:-10px!important}  .no-bottom .mat-mdc-form-field-subscript-wrapper{display:none}.main[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.main[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{flex:1 1 0;display:flex;align-items:center;justify-content:center;padding:20px}.main[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:200px}header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:10px}header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0}"]})}return s})();function _z(s,e){1&s&&(d.TgZ(0,"th",14),d._uU(1,"No."),d.qZA())}function bz(s,e){if(1&s&&(d.TgZ(0,"td",15),d._uU(1),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Oqu(t.no)}}function vz(s,e){1&s&&(d.TgZ(0,"th",14),d._uU(1,"Sampling No"),d.qZA())}function yz(s,e){if(1&s&&(d.TgZ(0,"td",15),d._uU(1),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Oqu(t.sampling_no)}}function xz(s,e){1&s&&(d.TgZ(0,"th",14),d._uU(1,"Description"),d.qZA())}function wz(s,e){if(1&s&&(d.TgZ(0,"td",15),d._uU(1),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Oqu(t.description)}}function Mz(s,e){1&s&&(d.TgZ(0,"th",14),d._uU(1,"Sampling Person"),d.qZA())}function Tz(s,e){if(1&s&&(d.TgZ(0,"td",15),d._uU(1),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Oqu(t.sampling_person)}}function Cz(s,e){1&s&&(d.TgZ(0,"th",14),d._uU(1,"Sampling Time"),d.qZA())}function Dz(s,e){if(1&s&&(d.TgZ(0,"td",15),d._uU(1),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Oqu(t.sampling_time)}}function Ez(s,e){1&s&&(d.TgZ(0,"th",14),d._uU(1,"Entry Time"),d.qZA())}function Sz(s,e){if(1&s&&(d.TgZ(0,"td",15),d._uU(1),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Oqu(t.entry_time)}}function kz(s,e){1&s&&(d.TgZ(0,"th",14),d._uU(1,"Action"),d.qZA())}function Az(s,e){if(1&s){const t=d.EpF();d.TgZ(0,"td",15)(1,"button",16)(2,"span",17),d._uU(3,"more_vert"),d.qZA()(),d.TgZ(4,"mat-menu",null,18)(6,"a",19),d.NdJ("click",function(n){d.CHM(t);const r=d.oxw();return n.preventDefault(),d.KtG(r.openDialog())}),d._uU(7," Detail "),d.qZA()()()}if(2&s){const t=d.MAs(5);d.xp6(1),d.Q6J("matMenuTriggerFor",t)}}function Pz(s,e){1&s&&d._UZ(0,"tr",20)}function Oz(s,e){1&s&&d._UZ(0,"tr",21)}const TC=function(){return[5,10,20]};function Rz(s,e){1&s&&(d.TgZ(0,"th",12),d._uU(1,"No."),d.qZA())}function Iz(s,e){if(1&s&&(d.TgZ(0,"td",13),d._uU(1),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Oqu(t.no)}}function Lz(s,e){1&s&&(d.TgZ(0,"th",12),d._uU(1,"Sampling No"),d.qZA())}function Fz(s,e){if(1&s&&(d.TgZ(0,"td",13),d._uU(1),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Oqu(t.sampling_no)}}function Bz(s,e){1&s&&(d.TgZ(0,"th",12),d._uU(1,"Test"),d.qZA())}function Nz(s,e){if(1&s&&(d.TgZ(0,"td",13),d._uU(1),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Oqu(t.test)}}function Uz(s,e){1&s&&(d.TgZ(0,"th",12),d._uU(1,"User"),d.qZA())}function zz(s,e){if(1&s&&(d.TgZ(0,"td",13),d._uU(1),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Oqu(t.user)}}function Hz(s,e){1&s&&(d.TgZ(0,"th",12),d._uU(1,"Time"),d.qZA())}function Vz(s,e){if(1&s&&(d.TgZ(0,"td",13),d._uU(1),d.qZA()),2&s){const t=e.$implicit;d.xp6(1),d.Oqu(t.time)}}function Wz(s,e){1&s&&d._UZ(0,"tr",14)}function Gz(s,e){1&s&&d._UZ(0,"tr",15)}let Yz=(()=>{class s{constructor(){this.dialog=(0,d.f3M)($a.uw),this.displayedColumns=["no","sampling_no","description","sampling_person","sampling_time","entry_time","action"],this.dataSource=new mn.by(Array(10).fill(null).map((t,i)=>({no:i+1,sampling_no:1012030,description:"test 123",sampling_person:"User 1",sampling_time:(new Date).toISOString(),entry_time:(new Date).toISOString()})))}openDialog(){this.dialog.open(jz,{width:"1200px"})}static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-certificate"]],decls:26,vars:5,consts:[[1,"mat-elevation-z8"],["mat-table","",3,"dataSource"],["matColumnDef","no"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","sampling_no"],["matColumnDef","description"],["matColumnDef","sampling_person"],["matColumnDef","sampling_time"],["matColumnDef","entry_time"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page of periodic elements",3,"pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","primary",1,"flex-row-reverse",3,"matMenuTriggerFor"],[1,"material-icons"],["rowActionMenu","matMenu"],["href","#","mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(i,n){1&i&&(d.TgZ(0,"div",0)(1,"table",1),d.ynx(2,2),d.YNc(3,_z,2,0,"th",3),d.YNc(4,bz,2,1,"td",4),d.BQk(),d.ynx(5,5),d.YNc(6,vz,2,0,"th",3),d.YNc(7,yz,2,1,"td",4),d.BQk(),d.ynx(8,6),d.YNc(9,xz,2,0,"th",3),d.YNc(10,wz,2,1,"td",4),d.BQk(),d.ynx(11,7),d.YNc(12,Mz,2,0,"th",3),d.YNc(13,Tz,2,1,"td",4),d.BQk(),d.ynx(14,8),d.YNc(15,Cz,2,0,"th",3),d.YNc(16,Dz,2,1,"td",4),d.BQk(),d.ynx(17,9),d.YNc(18,Ez,2,0,"th",3),d.YNc(19,Sz,2,1,"td",4),d.BQk(),d.ynx(20,10),d.YNc(21,kz,2,0,"th",3),d.YNc(22,Az,8,1,"td",4),d.BQk(),d.YNc(23,Pz,1,0,"tr",11),d.YNc(24,Oz,1,0,"tr",12),d.qZA(),d._UZ(25,"mat-paginator",13),d.qZA()),2&i&&(d.xp6(1),d.Q6J("dataSource",n.dataSource),d.xp6(22),d.Q6J("matHeaderRowDef",n.displayedColumns),d.xp6(1),d.Q6J("matRowDefColumns",n.displayedColumns),d.xp6(1),d.Q6J("pageSizeOptions",d.DdM(4,TC)))},dependencies:[pn.RK,fn.VK,fn.OP,fn.p6,mn.BZ,mn.fO,mn.as,mn.w1,mn.Dz,mn.nj,mn.ge,mn.ev,mn.XQ,mn.Gk,iu.NW]})}return s})(),jz=(()=>{class s{constructor(){this.dialogRef=(0,d.f3M)($a.so),this.displayedColumns=["no","sampling_no","test","user","time"],this.dataSource=new mn.by(Array(5).fill(null).map((t,i)=>({no:i+1,sampling_no:1012030,test:["Blain","Moisture","NaOH","Bentonite","LimeStone"][i],user:"User "+(i+1),time:(new Date).toISOString()})))}onNoClick(){}static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["dialog-overview-example-dialog"]],standalone:!0,features:[d.jDz],decls:20,vars:5,consts:[[1,"mat-elevation-z8",2,"padding","5px"],["mat-table","",3,"dataSource"],["matColumnDef","no"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","sampling_no"],["matColumnDef","test"],["matColumnDef","user"],["matColumnDef","time"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page of periodic elements",3,"pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(i,n){1&i&&(d.TgZ(0,"div",0)(1,"table",1),d.ynx(2,2),d.YNc(3,Rz,2,0,"th",3),d.YNc(4,Iz,2,1,"td",4),d.BQk(),d.ynx(5,5),d.YNc(6,Lz,2,0,"th",3),d.YNc(7,Fz,2,1,"td",4),d.BQk(),d.ynx(8,6),d.YNc(9,Bz,2,0,"th",3),d.YNc(10,Nz,2,1,"td",4),d.BQk(),d.ynx(11,7),d.YNc(12,Uz,2,0,"th",3),d.YNc(13,zz,2,1,"td",4),d.BQk(),d.ynx(14,8),d.YNc(15,Hz,2,0,"th",3),d.YNc(16,Vz,2,1,"td",4),d.BQk(),d.YNc(17,Wz,1,0,"tr",9),d.YNc(18,Gz,1,0,"tr",10),d.qZA(),d._UZ(19,"mat-paginator",11),d.qZA()),2&i&&(d.xp6(1),d.Q6J("dataSource",n.dataSource),d.xp6(16),d.Q6J("matHeaderRowDef",n.displayedColumns),d.xp6(1),d.Q6J("matRowDefColumns",n.displayedColumns),d.xp6(1),d.Q6J("pageSizeOptions",d.DdM(4,TC)))},dependencies:[Xr.lN,Rl.c,A.u5,pn.ot,mn.p0,mn.BZ,mn.fO,mn.as,mn.w1,mn.Dz,mn.nj,mn.ge,mn.ev,mn.XQ,mn.Gk,iu.TU,iu.NW,$a.Is],encapsulation:2})}return s})();function Zz(s,e){if(1&s&&(d.TgZ(0,"div",6),d._UZ(1,"app-menu-side",2),d.qZA()),2&s){const t=d.oxw();d.xp6(1),d.Q6J("skeletonConfig",t.skeletonConfig)}}function Xz(s,e){1&s&&d._UZ(0,"app-menu-static")}function qz(s,e){if(1&s&&d._UZ(0,"app-data-entry-temp",12),2&s){const t=d.oxw(2);d.Q6J("label",t.activeMenu.label)}}function $z(s,e){if(1&s&&d._UZ(0,"app-preview-report-form",13),2&s){const t=d.oxw(2);d.Q6J("formName",t.activeMenu.id)}}function Kz(s,e){if(1&s&&d._UZ(0,"app-preview-hmi-dashboard",14),2&s){const t=d.oxw(2);d.Q6J("name",t.activeMenu.id)}}function Jz(s,e){if(1&s&&d._UZ(0,"app-preview-report-excel",14),2&s){const t=d.oxw(2);d.Q6J("name",t.activeMenu.id)}}function Qz(s,e){1&s&&(d.TgZ(0,"div",15),d._UZ(1,"iframe",16),d.qZA())}function eH(s,e){1&s&&(d.TgZ(0,"div"),d._UZ(1,"app-certificate"),d.qZA())}function tH(s,e){if(1&s&&(d.TgZ(0,"main",7),d.YNc(1,qz,1,1,"app-data-entry-temp",8),d.YNc(2,$z,1,1,"app-preview-report-form",9),d.YNc(3,Kz,1,1,"app-preview-hmi-dashboard",10),d.YNc(4,Jz,1,1,"app-preview-report-excel",10),d.YNc(5,Qz,2,0,"div",11),d.YNc(6,eH,2,0,"div",3),d.qZA()),2&s){const t=d.oxw();d.Udp("padding","dashboard"==t.activeMenu.type||"trend"==t.activeMenu.type?"0px":"10px"),d.xp6(1),d.Q6J("ngIf","dataEntry"==t.activeMenu.type),d.xp6(1),d.Q6J("ngIf","report"==t.activeMenu.type),d.xp6(1),d.Q6J("ngIf","dashboard"==t.activeMenu.type),d.xp6(1),d.Q6J("ngIf","excel"==t.activeMenu.type),d.xp6(1),d.Q6J("ngIf","trend"===t.activeMenu.type),d.xp6(1),d.Q6J("ngIf","certificate"===t.activeMenu.type)}}const iH=function(s){return{fontFamily:s}},nH=[{path:"",component:(()=>{class s{constructor(t,i,n){this.panelService=t,this.store=i,this.transmit=n,this.menuType="full",this.menuShow=!0}ngOnInit(){this.panelService.menuType.subscribe(t=>{this.menuType=t}),this.panelService.menuShow.subscribe(t=>{this.menuShow=t}),this.transmit.listen("menu-item-clicked").subscribe(t=>{this.activeMenu=t,console.log("active menu item",t),"trend"===this.activeMenu?.type&&this.fixedTrendIframe()}),this.panelService.getNotifications(),this.store.select(ze.iE).subscribe(t=>this.skeletonConfig=t)}fixedTrendIframe(){if(!document.getElementById("main-content")||!document.getElementById("trned_iframe"))return void setTimeout(()=>{this.fixedTrendIframe()},50);const t=document.getElementById("main-content").offsetWidth,i=document.getElementById("main-content").offsetHeight;document.getElementById("trned_iframe").setAttribute("width",t-3+"px"),document.getElementById("trned_iframe").setAttribute("height",i-9+"px")}static#e=this.\u0275fac=function(i){return new(i||s)(d.Y36(ie),d.Y36(Ie.yh),d.Y36(qt.U))};static#t=this.\u0275cmp=d.Xpm({type:s,selectors:[["app-skeleton"]],decls:8,vars:17,consts:[["id","panel"],["class","menu-wrapper sidebar-bg sidebar-text",4,"ngIf"],[3,"skeletonConfig"],[4,"ngIf"],[1,"main-wrapper"],["id","main-content","style","overflow: auto",3,"padding",4,"ngIf"],[1,"menu-wrapper","sidebar-bg","sidebar-text"],["id","main-content",2,"overflow","auto"],[3,"label",4,"ngIf"],[3,"formName",4,"ngIf"],[3,"name",4,"ngIf"],["style","position: relative; width: 100%; height: 100%",4,"ngIf"],[3,"label"],[3,"formName"],[3,"name"],[2,"position","relative","width","100%","height","100%"],["id","trned_iframe","src","https://danatadbir.github.io/demo-trend/","frameborder","0"]],template:function(i,n){1&i&&(d.TgZ(0,"div",0)(1,"div"),d.YNc(2,Zz,2,1,"div",1),d.TgZ(3,"div"),d._UZ(4,"app-top-bar",2),d.YNc(5,Xz,1,0,"app-menu-static",3),d.TgZ(6,"div",4),d.YNc(7,tH,7,8,"main",5),d.qZA()()()()),2&i&&(d.Akn(d.VKq(15,iH,n.panelService.language_data["preferred-font"])),d.Tol(n.panelService.language_data.direction),d.xp6(1),d.Gre("panel-body ",n.panelService.language_data.direction,""),d.xp6(1),d.Q6J("ngIf","static"!==n.menuType),d.xp6(1),d.Gre("main dashboard-bg ",n.panelService.language_data.direction,""),d.xp6(1),d.Q6J("skeletonConfig",n.skeletonConfig),d.xp6(1),d.Q6J("ngIf","static"===n.menuType&&n.menuShow),d.xp6(2),d.Q6J("ngIf",n.activeMenu))},dependencies:[x.O5,Ym,u_,oU,lU.X,rz,fz,gz,Yz],styles:["#panel[_ngcontent-%COMP%]{height:100vh;overflow:hidden;position:relative}#panel[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;overflow-x:hidden}#panel[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%]   .menu-wrapper[_ngcontent-%COMP%]{height:100vh}#panel[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]{flex-grow:1;position:relative;min-width:340px;overflow:hidden}#panel[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .main-wrapper[_ngcontent-%COMP%]{height:95vh;box-shadow:inset 0 7px 9px -7px #999,inset 7px 0 9px -7px #999}#panel[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .main-wrapper[_ngcontent-%COMP%]   main[_ngcontent-%COMP%]{height:100%}#panel[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%]   #page-content[_ngcontent-%COMP%]{padding:30px;min-height:100%}"]})}return s})()}];let sH=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275mod=d.oAB({type:s});static#i=this.\u0275inj=d.cJS({imports:[_e.Bz.forChild(nH),_e.Bz]})}return s})(),DC=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275mod=d.oAB({type:s});static#i=this.\u0275inj=d.cJS({})}return s})(),a_=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275mod=d.oAB({type:s});static#i=this.\u0275inj=d.cJS({imports:[DC,R.BQ,R.si,x.ez,DC,R.BQ]})}return s})(),hy=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275mod=d.oAB({type:s});static#i=this.\u0275inj=d.cJS({})}return s})();var gH=V(6785);let my=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275mod=d.oAB({type:s});static#i=this.\u0275inj=d.cJS({imports:[x.ez,R.BQ,gH.eL,R.si,is.Q8,dt.rt,R.BQ]})}return s})();const xH=[Bt,cs,pn.ot,fn.Tx,jn.Ps,Ma,$a.Is,Xr.lN,Ku.LD,Rl.c,a_,ke.xu,hy,my,mf.p9,iu.TU,xN];let wH=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275mod=d.oAB({type:s});static#i=this.\u0275inj=d.cJS({imports:[x.ez,A.u5,A.UX,xH]})}return s})();var MH=V(1426);const TH=[Bt,cs,pn.ot,fn.Tx,jn.Ps,Ma,$a.Is,Xr.lN,Ku.LD,Rl.c,a_,ke.xu,hy,my,mf.p9];let CH=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275mod=d.oAB({type:s});static#i=this.\u0275inj=d.cJS({imports:[x.ez,A.u5,A.UX,wH,rp,Ie.Aw.forFeature(ze._O,MH.l),TH]})}return s})();d.B6R(mc,function(){return[x.sg,A.JL,A.sg,Jm,_n,t_]},[]);var DH=V(5931),EH=V(371);let SH=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275mod=d.oAB({type:s});static#i=this.\u0275inj=d.cJS({imports:[x.ez]})}return s})(),kH=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275mod=d.oAB({type:s});static#i=this.\u0275inj=d.cJS({imports:[x.ez,A.UX]})}return s})();var AH=V(5770),PH=V(7132);const OH=[Bt,cs,pn.ot,fn.Tx,jn.Ps,ke.xu,rs,dy.AV,Bt,cs,pn.ot,fn.Tx,jn.Ps,$a.Is,Xr.lN,Ku.LD,Rl.c,a_,ke.xu,hy,my,mf.p9,R.XK,DH.QW,Xr.lN,Rl.c,dl.FA,A.UX,Ku.LD,PH.Hi,pn.ot,jn.Ps,mn.p0,A.u5,a_,EH.rK,iu.TU,Ma,AH.Bb];let RH=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#t=this.\u0275mod=d.oAB({type:s});static#i=this.\u0275inj=d.cJS({providers:[ie],imports:[x.ez,A.u5,sH,CH,OH,kH,SH]})}return s})()},509:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{X:()=>DataEntryTempComponent});var _angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(755),_angular_forms__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3226),_dataEntry_mock__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2200),_angular_material_button__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(393),_angular_material_dialog__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(3005),_angular_material_form_field__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(6125),_angular_material_input__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(5735),_angular_common__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(6733),_angular_material_menu__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5863),_angular_material_icon__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(9984),_angular_material_select__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(8675),_angular_material_core__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(4220),_angular_material_checkbox__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(9742),_angular_material_datepicker__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(7812),_angular_material_chips__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(7132),_angular_material_table__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(72),ngx_material_timepicker__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(371),_angular_material_paginator__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(4424),_angular_material_autocomplete__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(5770);function DataEntryTempComponent_ng_container_0_div_19_ng_container_1_mat_option_5_Template(ot,zt){if(1&ot&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(0,"mat-option",33),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()),2&ot){const V=zt.$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("value",V),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Oqu(V)}}function DataEntryTempComponent_ng_container_0_div_19_ng_container_1_Template(ot,zt){if(1&ot&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.ynx(0),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(1,"mat-form-field")(2,"mat-label"),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(3),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(4,"mat-select",32),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(5,DataEntryTempComponent_ng_container_0_div_19_ng_container_1_mat_option_5_Template,2,2,"mat-option",18),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.BQk()),2&ot){const V=_angular_core__WEBPACK_IMPORTED_MODULE_1__.oxw().$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(3),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Oqu(V.label),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("formControlName",V.id),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("ngForOf",V.config.items)}}function DataEntryTempComponent_ng_container_0_div_19_ng_container_2_mat_option_7_Template(ot,zt){if(1&ot&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(0,"mat-option",33),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()),2&ot){const V=zt.$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("value",V),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Oqu(V)}}function DataEntryTempComponent_ng_container_0_div_19_ng_container_2_Template(ot,zt){if(1&ot&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.ynx(0),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(1,"mat-form-field")(2,"mat-label"),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(3),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_1__._UZ(4,"input",34),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(5,"mat-autocomplete",null,35),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(7,DataEntryTempComponent_ng_container_0_div_19_ng_container_2_mat_option_7_Template,2,2,"mat-option",18),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.BQk()),2&ot){const V=_angular_core__WEBPACK_IMPORTED_MODULE_1__.MAs(6),x=_angular_core__WEBPACK_IMPORTED_MODULE_1__.oxw().$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(3),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Oqu(x.label),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("formControlName",x.id)("matAutocomplete",V),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(3),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("ngForOf",x.config.items)}}function DataEntryTempComponent_ng_container_0_div_19_ng_container_3_mat_hint_5_Template(ot,zt){if(1&ot&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(0,"mat-hint"),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()),2&ot){const V=_angular_core__WEBPACK_IMPORTED_MODULE_1__.oxw(2).$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.AsE("",(null==V.config?null:V.config.min)+"<"," x ","<"+(null==V.config?null:V.config.max),"")}}function DataEntryTempComponent_ng_container_0_div_19_ng_container_3_ng_container_7_mat_hint_1_Template(ot,zt){if(1&ot&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(0,"mat-hint"),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()),2&ot){const V=_angular_core__WEBPACK_IMPORTED_MODULE_1__.oxw(3).$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.AsE("",(null==V.config?null:V.config.min)+"<"," x ","<"+(null==V.config?null:V.config.max),"")}}function DataEntryTempComponent_ng_container_0_div_19_ng_container_3_ng_container_7_Template(ot,zt){if(1&ot&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.ynx(0),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(1,DataEntryTempComponent_ng_container_0_div_19_ng_container_3_ng_container_7_mat_hint_1_Template,2,2,"mat-hint",0),_angular_core__WEBPACK_IMPORTED_MODULE_1__.BQk()),2&ot){const V=_angular_core__WEBPACK_IMPORTED_MODULE_1__.oxw(2).$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("ngIf",(null==V.config?null:V.config.max)||(null==V.config?null:V.config.min))}}function DataEntryTempComponent_ng_container_0_div_19_ng_container_3_Template(ot,zt){if(1&ot&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.ynx(0),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(1,"mat-form-field")(2,"mat-label"),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(3),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_1__._UZ(4,"input",36),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(5,DataEntryTempComponent_ng_container_0_div_19_ng_container_3_mat_hint_5_Template,2,2,"mat-hint",0),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(6,"mat-error",37),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(7,DataEntryTempComponent_ng_container_0_div_19_ng_container_3_ng_container_7_Template,2,1,"ng-container",0),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.BQk()),2&ot){const V=_angular_core__WEBPACK_IMPORTED_MODULE_1__.oxw().$implicit,x=_angular_core__WEBPACK_IMPORTED_MODULE_1__.oxw(2);_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(3),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Oqu(V.label),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("readonly",V.readonly)("type",V.type)("min",V.config.min)("max",V.config.max)("formControlName",V.id),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("ngIf",(null==V.config?null:V.config.max)||(null==V.config?null:V.config.min)),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("ngIf",x.form.controls[V.id].errors)}}function DataEntryTempComponent_ng_container_0_div_19_ng_container_4_Template(ot,zt){if(1&ot&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.ynx(0),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(1,"mat-form-field")(2,"mat-label"),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(3),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_1__._UZ(4,"input",38)(5,"ngx-material-timepicker",null,39),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.BQk()),2&ot){const V=_angular_core__WEBPACK_IMPORTED_MODULE_1__.MAs(6),x=_angular_core__WEBPACK_IMPORTED_MODULE_1__.oxw().$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(3),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Oqu(x.label),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("ngxTimepicker",V)("format",24)("formControlName",x.id)}}function DataEntryTempComponent_ng_container_0_div_19_ng_container_5_Template(ot,zt){if(1&ot&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.ynx(0),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(1,"mat-checkbox",40),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(2),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.BQk()),2&ot){const V=_angular_core__WEBPACK_IMPORTED_MODULE_1__.oxw().$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("formControlName",V.id),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Oqu(V.label)}}function DataEntryTempComponent_ng_container_0_div_19_Template(ot,zt){if(1&ot&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(0,"div",31),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(1,DataEntryTempComponent_ng_container_0_div_19_ng_container_1_Template,6,3,"ng-container",0),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(2,DataEntryTempComponent_ng_container_0_div_19_ng_container_2_Template,8,4,"ng-container",0),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(3,DataEntryTempComponent_ng_container_0_div_19_ng_container_3_Template,8,8,"ng-container",0),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(4,DataEntryTempComponent_ng_container_0_div_19_ng_container_4_Template,7,4,"ng-container",0),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(5,DataEntryTempComponent_ng_container_0_div_19_ng_container_5_Template,3,2,"ng-container",0),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()),2&ot){const V=zt.$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("ngIf","select"===V.type),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("ngIf","autocomplete"===V.type),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("ngIf","text"===V.type||"number"===V.type),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("ngIf","date"===V.type),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("ngIf","checkbox"===V.type)}}function DataEntryTempComponent_ng_container_0_mat_option_31_Template(ot,zt){if(1&ot&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(0,"mat-option",33),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()),2&ot){const V=zt.$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("value",V.label),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Oqu(V.label)}}function DataEntryTempComponent_ng_container_0_ng_container_46_th_2_mat_icon_3_Template(ot,zt){1&ot&&_angular_core__WEBPACK_IMPORTED_MODULE_1__._UZ(0,"mat-icon",46)}function DataEntryTempComponent_ng_container_0_ng_container_46_th_2_Template(ot,zt){if(1&ot&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(0,"th",43)(1,"div",44),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(2),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(3,DataEntryTempComponent_ng_container_0_ng_container_46_th_2_mat_icon_3_Template,1,0,"mat-icon",45),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()()),2&ot){const V=_angular_core__WEBPACK_IMPORTED_MODULE_1__.oxw(),x=V.$implicit,A=V.index;_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_1__.hij(" ",x.label," "),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("ngIf",0===A)}}function DataEntryTempComponent_ng_container_0_ng_container_46_td_3_Template(ot,zt){if(1&ot&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(0,"td",47),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()),2&ot){const V=zt.$implicit,x=_angular_core__WEBPACK_IMPORTED_MODULE_1__.oxw().$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.hij(" ",V[x.id]," ")}}function DataEntryTempComponent_ng_container_0_ng_container_46_Template(ot,zt){if(1&ot&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.ynx(0)(1,41),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(2,DataEntryTempComponent_ng_container_0_ng_container_46_th_2_Template,4,2,"th",25),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(3,DataEntryTempComponent_ng_container_0_ng_container_46_td_3_Template,2,1,"td",42),_angular_core__WEBPACK_IMPORTED_MODULE_1__.BQk()()),2&ot){const V=zt.$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("matColumnDef",V.label)}}function DataEntryTempComponent_ng_container_0_th_48_Template(ot,zt){1&ot&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(0,"th",43),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(1,"status"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA())}function DataEntryTempComponent_ng_container_0_td_49_Template(ot,zt){1&ot&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(0,"td",48)(1,"mat-chip",49),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(2," Awaiting confirmation "),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()())}function DataEntryTempComponent_ng_container_0_th_51_Template(ot,zt){1&ot&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(0,"th",43),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(1,"Action"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA())}function DataEntryTempComponent_ng_container_0_td_52_Template(ot,zt){if(1&ot){const V=_angular_core__WEBPACK_IMPORTED_MODULE_1__.EpF();_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(0,"td",48)(1,"button",50)(2,"span",51),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(3,"more_vert"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(4,"mat-menu",null,52)(6,"button",53),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(7,"Confirm"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(8,"a",54),_angular_core__WEBPACK_IMPORTED_MODULE_1__.NdJ("click",function(A){_angular_core__WEBPACK_IMPORTED_MODULE_1__.CHM(V);const ke=_angular_core__WEBPACK_IMPORTED_MODULE_1__.oxw(2);return A.preventDefault(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.KtG(ke.openDialog())}),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(9," Repeat "),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(10,"button",53),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(11,"Detail"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()()()}if(2&ot){const V=_angular_core__WEBPACK_IMPORTED_MODULE_1__.MAs(5);_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("matMenuTriggerFor",V)}}function DataEntryTempComponent_ng_container_0_tr_53_Template(ot,zt){1&ot&&_angular_core__WEBPACK_IMPORTED_MODULE_1__._UZ(0,"tr",55)}function DataEntryTempComponent_ng_container_0_tr_54_Template(ot,zt){1&ot&&_angular_core__WEBPACK_IMPORTED_MODULE_1__._UZ(0,"tr",56)}const _c0=function(){return[5,10,25,100]};function DataEntryTempComponent_ng_container_0_Template(ot,zt){if(1&ot){const V=_angular_core__WEBPACK_IMPORTED_MODULE_1__.EpF();_angular_core__WEBPACK_IMPORTED_MODULE_1__.ynx(0),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(1,"div")(2,"div",1)(3,"h1",2),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(4),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(5,"div",3)(6,"mat-form-field")(7,"mat-label"),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(8,"Choose a date"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_1__._UZ(9,"input",4),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(10,"mat-datepicker-toggle",5)(11,"mat-icon",6),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(12,"today"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()(),_angular_core__WEBPACK_IMPORTED_MODULE_1__._UZ(13,"mat-datepicker",7,8),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()(),_angular_core__WEBPACK_IMPORTED_MODULE_1__._UZ(15,"div"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(16,"div",9)(17,"div",10)(18,"div",11),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(19,DataEntryTempComponent_ng_container_0_div_19_Template,6,5,"div",12),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(20,"div")(21,"button",13),_angular_core__WEBPACK_IMPORTED_MODULE_1__.NdJ("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_1__.CHM(V);const A=_angular_core__WEBPACK_IMPORTED_MODULE_1__.oxw();return _angular_core__WEBPACK_IMPORTED_MODULE_1__.KtG(A.addItem())}),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(22,"div",14)(23,"span"),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(24,"Save"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()()()()()(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(25,"div",15)(26,"div",16)(27,"mat-form-field",17)(28,"mat-label"),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(29,"Column Filter"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(30,"mat-select"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(31,DataEntryTempComponent_ng_container_0_mat_option_31_Template,2,2,"mat-option",18),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(32,"mat-form-field",19)(33,"mat-label"),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(34,"Search"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_1__._UZ(35,"input",19),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(36,"div",16)(37,"mat-form-field",17)(38,"mat-label"),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(39,"Group Action"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(40,"mat-select")(41,"mat-option"),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(42,"Confirm All"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()()()()(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(43,"div",20)(44,"div",21)(45,"table",22),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(46,DataEntryTempComponent_ng_container_0_ng_container_46_Template,4,1,"ng-container",23),_angular_core__WEBPACK_IMPORTED_MODULE_1__.ynx(47,24),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(48,DataEntryTempComponent_ng_container_0_th_48_Template,2,0,"th",25),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(49,DataEntryTempComponent_ng_container_0_td_49_Template,3,0,"td",26),_angular_core__WEBPACK_IMPORTED_MODULE_1__.BQk(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.ynx(50,27),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(51,DataEntryTempComponent_ng_container_0_th_51_Template,2,0,"th",25),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(52,DataEntryTempComponent_ng_container_0_td_52_Template,12,1,"td",26),_angular_core__WEBPACK_IMPORTED_MODULE_1__.BQk(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(53,DataEntryTempComponent_ng_container_0_tr_53_Template,1,0,"tr",28),_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(54,DataEntryTempComponent_ng_container_0_tr_54_Template,1,0,"tr",29),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()(),_angular_core__WEBPACK_IMPORTED_MODULE_1__._UZ(55,"mat-paginator",30),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.BQk()}if(2&ot){const V=_angular_core__WEBPACK_IMPORTED_MODULE_1__.MAs(14),x=_angular_core__WEBPACK_IMPORTED_MODULE_1__.oxw();_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(4),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Oqu(x.label),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(5),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("matDatepicker",V),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("for",V),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(7),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("formGroup",x.form),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("ngForOf",x.formStructure.items),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("disabled",x.form.invalid),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(10),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("ngForOf",x.formStructure.items),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(14),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("dataSource",x.items),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("ngForOf",x.formStructure.items),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(7),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("matHeaderRowDef",x.displayedColumns),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("matRowDefColumns",x.displayedColumns),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("length",100)("pageSize",10)("pageSizeOptions",_angular_core__WEBPACK_IMPORTED_MODULE_1__.DdM(14,_c0))}}let DataEntryTempComponent=(()=>{class DataEntryTempComponent{constructor(){this.label="",this.dialog=(0,_angular_core__WEBPACK_IMPORTED_MODULE_1__.f3M)(_angular_material_dialog__WEBPACK_IMPORTED_MODULE_2__.uw),this.formStructure=null,this.fb=(0,_angular_core__WEBPACK_IMPORTED_MODULE_1__.f3M)(_angular_forms__WEBPACK_IMPORTED_MODULE_3__.qu),this.form=null,this.displayedColumns=[],this.items=[]}ngOnChanges(ot){this.formStructure=_dataEntry_mock__WEBPACK_IMPORTED_MODULE_0__.R[this.label],this.items=[],this.initFormObject()}ngOnInit(){}initFormObject(){this.form=this.fb.group(this.formStructure.items.reduce((ot,zt)=>({...ot,[zt.id]:["",[...zt.isRequired?[_angular_forms__WEBPACK_IMPORTED_MODULE_3__.kI.required]:[],..."number"===zt.type?[_angular_forms__WEBPACK_IMPORTED_MODULE_3__.kI.min(zt.config.min),_angular_forms__WEBPACK_IMPORTED_MODULE_3__.kI.max(zt.config.max)]:[]]]}),{})),this.displayedColumns=this.formStructure?[...this.formStructure.items.map(ot=>ot.label),"status","action"]:[],this.form.valueChanges.subscribe(res=>{Object.keys(this.formStructure?.rules??{}).forEach(id=>{let selectedRule=this.formStructure.rules[id];const fv=this.form?.value??{};Object.keys(fv).forEach(ot=>{selectedRule=selectedRule.replaceAll(ot,fv[ot])});const value=eval(selectedRule);value&&this.form?.controls[id].setValue(value,{emitEvent:!1})}),(res["Loc-qtiasdfdsfsdfa0J"]||res["Sam-qtidsfsdfa0J"])&&(res["Sam-qtidsfsdfa0J"]&&this.form?.patchValue({"Loc-qtiasdfdsfsdfa0J":_dataEntry_mock__WEBPACK_IMPORTED_MODULE_0__.J.find(ot=>ot.sample===res["Sam-qtidsfsdfa0J"])?.location??""},{emitEvent:!1,onlySelf:!0}),res["Loc-qtiasdfdsfsdfa0J"]&&this.form?.patchValue({"Sam-qtidsfsdfa0J":_dataEntry_mock__WEBPACK_IMPORTED_MODULE_0__.J.find(ot=>ot.location===res["Loc-qtiasdfdsfsdfa0J"])?.sample??""},{emitEvent:!1,onlySelf:!0}))});const loc=this.form.controls["Loc-qtiasdfdsfsdfa0J"],sam=this.form.controls["Sam-qtidsfsdfa0J"];sam&&loc&&(loc.valueChanges.subscribe(ot=>{sam.setValue(_dataEntry_mock__WEBPACK_IMPORTED_MODULE_0__.J.find(zt=>zt.location===ot)?.sample??"",{emitEvent:!1,onlySelf:!0})}),sam.valueChanges.subscribe(ot=>{loc.setValue(_dataEntry_mock__WEBPACK_IMPORTED_MODULE_0__.J.find(zt=>zt.sample===ot)?.location??"",{emitEvent:!1,onlySelf:!0})}))}addItem(){this.items=[...this.items,this.form.value],this.form?.reset()}openDialog(){this.dialog.open(DialogOverviewExampleDialog,{width:"400px"})}static#_=this.\u0275fac=function ot(zt){return new(zt||DataEntryTempComponent)};static#_2=this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Xpm({type:DataEntryTempComponent,selectors:[["app-data-entry-temp"]],inputs:{label:"label"},features:[_angular_core__WEBPACK_IMPORTED_MODULE_1__.TTD],decls:1,vars:1,consts:[[4,"ngIf"],[2,"display","flex","justify-content","space-between","margin-bottom","10px"],[2,"font-size","20px"],[1,"date-picker","no-bottom",2,"display","flex","align-items","center"],["matInput","",3,"matDatepicker"],["matIconSuffix","",2,"margin-top","-5px",3,"for"],["matDatepickerToggleIcon","",2,"font-size","20px"],[2,"font-size","14px"],["picker",""],[2,"margin-bottom","5px"],[2,"display","flex","justify-content","space-between",3,"formGroup"],[2,"display","flex","flex-wrap","wrap","column-gap","10px"],["class","custom-field","style","max-width: 150px; font-size: 10px",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary","type","submit",2,"font-size","11px","height","34px",3,"disabled","click"],[2,"margin-bottom","-5px","display","flex","align-items","center","justify-content","center"],[2,"display","flex","align-items","center","justify-content","space-between"],[1,"mat-form-field","custom-field","no-bottom"],[2,"margin-right","5px"],[3,"value",4,"ngFor","ngForOf"],["matInput",""],[1,"mat-elevation-z8"],[2,"height","60vh","overflow-y","auto"],["mat-table","",3,"dataSource"],[4,"ngFor","ngForOf"],["matColumnDef","status"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page",3,"length","pageSize","pageSizeOptions"],[1,"custom-field",2,"max-width","150px","font-size","10px"],[3,"formControlName"],[3,"value"],["type","text","placeholder","Select","matInput","",3,"formControlName","matAutocomplete"],["auto","matAutocomplete"],["matInput","",3,"readonly","type","min","max","formControlName"],[2,"font-size","13px"],["matInput","",3,"ngxTimepicker","format","formControlName"],["defaultValue",""],["color","primary",1,"example-margin",3,"formControlName"],[3,"matColumnDef"],["mat-cell","","style","font-size: 10px",4,"matCellDef"],["mat-header-cell",""],[2,"display","flex","align-items","center","font-size","11px"],["style","font-size: 15px","fontIcon","south",4,"ngIf"],["fontIcon","south",2,"font-size","15px"],["mat-cell","",2,"font-size","10px"],["mat-cell",""],["color","warn",2,"background-color","#FFC107"],["mat-icon-button","","color","primary",1,"flex-row-reverse",3,"matMenuTriggerFor"],[1,"material-icons"],["rowActionMenu","matMenu"],["mat-menu-item",""],["href","#","mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function ot(zt,V){1&zt&&_angular_core__WEBPACK_IMPORTED_MODULE_1__.YNc(0,DataEntryTempComponent_ng_container_0_Template,56,15,"ng-container",0),2&zt&&_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("ngIf",V.formStructure&&V.form)},dependencies:[_angular_common__WEBPACK_IMPORTED_MODULE_4__.sg,_angular_common__WEBPACK_IMPORTED_MODULE_4__.O5,_angular_forms__WEBPACK_IMPORTED_MODULE_3__.Fj,_angular_forms__WEBPACK_IMPORTED_MODULE_3__.JJ,_angular_forms__WEBPACK_IMPORTED_MODULE_3__.JL,_angular_material_button__WEBPACK_IMPORTED_MODULE_5__.lW,_angular_material_button__WEBPACK_IMPORTED_MODULE_5__.RK,_angular_material_menu__WEBPACK_IMPORTED_MODULE_6__.VK,_angular_material_menu__WEBPACK_IMPORTED_MODULE_6__.OP,_angular_material_menu__WEBPACK_IMPORTED_MODULE_6__.p6,_angular_material_icon__WEBPACK_IMPORTED_MODULE_7__.Hw,_angular_material_form_field__WEBPACK_IMPORTED_MODULE_8__.KE,_angular_material_form_field__WEBPACK_IMPORTED_MODULE_8__.hX,_angular_material_form_field__WEBPACK_IMPORTED_MODULE_8__.bx,_angular_material_form_field__WEBPACK_IMPORTED_MODULE_8__.TO,_angular_material_form_field__WEBPACK_IMPORTED_MODULE_8__.R9,_angular_material_select__WEBPACK_IMPORTED_MODULE_9__.gD,_angular_material_core__WEBPACK_IMPORTED_MODULE_10__.ey,_angular_material_input__WEBPACK_IMPORTED_MODULE_11__.Nt,_angular_material_checkbox__WEBPACK_IMPORTED_MODULE_12__.oG,_angular_material_datepicker__WEBPACK_IMPORTED_MODULE_13__.Mq,_angular_material_datepicker__WEBPACK_IMPORTED_MODULE_13__.hl,_angular_material_datepicker__WEBPACK_IMPORTED_MODULE_13__.nW,_angular_material_datepicker__WEBPACK_IMPORTED_MODULE_13__.Q0,_angular_forms__WEBPACK_IMPORTED_MODULE_3__.sg,_angular_forms__WEBPACK_IMPORTED_MODULE_3__.u,_angular_material_chips__WEBPACK_IMPORTED_MODULE_14__.HS,_angular_material_table__WEBPACK_IMPORTED_MODULE_15__.BZ,_angular_material_table__WEBPACK_IMPORTED_MODULE_15__.fO,_angular_material_table__WEBPACK_IMPORTED_MODULE_15__.as,_angular_material_table__WEBPACK_IMPORTED_MODULE_15__.w1,_angular_material_table__WEBPACK_IMPORTED_MODULE_15__.Dz,_angular_material_table__WEBPACK_IMPORTED_MODULE_15__.nj,_angular_material_table__WEBPACK_IMPORTED_MODULE_15__.ge,_angular_material_table__WEBPACK_IMPORTED_MODULE_15__.ev,_angular_material_table__WEBPACK_IMPORTED_MODULE_15__.XQ,_angular_material_table__WEBPACK_IMPORTED_MODULE_15__.Gk,ngx_material_timepicker__WEBPACK_IMPORTED_MODULE_16__.ro,ngx_material_timepicker__WEBPACK_IMPORTED_MODULE_16__.I2,_angular_material_paginator__WEBPACK_IMPORTED_MODULE_17__.NW,_angular_material_autocomplete__WEBPACK_IMPORTED_MODULE_18__.XC,_angular_material_autocomplete__WEBPACK_IMPORTED_MODULE_18__.ZL],styles:[".custom-field .mat-mdc-text-field-wrapper{max-width:110px}  .custom-field label{overflow:visible!important}  .custom-field mat-label{top:-11px;font-size:10px!important}  .custom-field input{font-size:10px!important;margin-top:5px}  .custom-field .mat-mdc-form-field-infix{padding:8px 0 0!important;min-height:38px}  .custom-field mat-select .mat-mdc-select-trigger{display:flex;align-items:center;margin-top:5px}  .custom-field mat-select .mat-mdc-select-min-line{font-size:11px}  .custom-field mat-option{min-height:35px!important}  .custom-field mat-option span{font-size:10px!important}  .no-bottom .mat-mdc-form-field-subscript-wrapper{display:none}  .date-picker mat-form-field{height:42px}  .date-picker .mat-mdc-form-field-infix{padding:10px 0 0!important}  .date-picker label{overflow:visible}  .date-picker mat-label{top:-8px;font-size:12px!important}  .date-picker input{margin-top:8px;font-size:12px!important}  .date-picker .mat-datepicker-toggle button{margin-top:-10px!important}  .mdc-data-table__table tr{height:40px!important}input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button{appearance:none;margin:0}mat-hint[_ngcontent-%COMP%]{font-size:10px}"]})}return DataEntryTempComponent})(),DialogOverviewExampleDialog=(()=>{class ot{constructor(){this.dialogRef=(0,_angular_core__WEBPACK_IMPORTED_MODULE_1__.f3M)(_angular_material_dialog__WEBPACK_IMPORTED_MODULE_2__.so)}onNoClick(){}static#e=this.\u0275fac=function(x){return new(x||ot)};static#t=this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_1__.Xpm({type:ot,selectors:[["dialog-overview-example-dialog"]],standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_1__.jDz],decls:14,vars:2,consts:[["mat-dialog-title",""],[1,"example-full-width",2,"width","100%"],["matInput","",2,"width","100%"],["mat-button","","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(x,A){1&x&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(0,"h2",0),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(1,"Repeat"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(2,"mat-dialog-content")(3,"p"),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(4,"Reason for Repeat"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(5,"mat-form-field",1)(6,"mat-label"),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(7,"Leave a comment"),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_1__._UZ(8,"textarea",2),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(9,"mat-dialog-actions")(10,"button",3),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(11," Close "),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_1__.TgZ(12,"button",3),_angular_core__WEBPACK_IMPORTED_MODULE_1__._uU(13," Submit "),_angular_core__WEBPACK_IMPORTED_MODULE_1__.qZA()()),2&x&&(_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(10),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("mat-dialog-close",A.onNoClick()),_angular_core__WEBPACK_IMPORTED_MODULE_1__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_1__.Q6J("mat-dialog-close",A.onNoClick()))},dependencies:[_angular_material_form_field__WEBPACK_IMPORTED_MODULE_8__.lN,_angular_material_form_field__WEBPACK_IMPORTED_MODULE_8__.KE,_angular_material_form_field__WEBPACK_IMPORTED_MODULE_8__.hX,_angular_material_input__WEBPACK_IMPORTED_MODULE_11__.c,_angular_material_input__WEBPACK_IMPORTED_MODULE_11__.Nt,_angular_forms__WEBPACK_IMPORTED_MODULE_3__.u5,_angular_material_button__WEBPACK_IMPORTED_MODULE_5__.ot,_angular_material_button__WEBPACK_IMPORTED_MODULE_5__.lW,_angular_material_dialog__WEBPACK_IMPORTED_MODULE_2__.Is,_angular_material_dialog__WEBPACK_IMPORTED_MODULE_2__.ZT,_angular_material_dialog__WEBPACK_IMPORTED_MODULE_2__.uh,_angular_material_dialog__WEBPACK_IMPORTED_MODULE_2__.xY,_angular_material_dialog__WEBPACK_IMPORTED_MODULE_2__.H8],encapsulation:2})}return ot})()},2200:(ot,zt,V)=>{"use strict";V.d(zt,{J:()=>A,R:()=>ke});const x=[{id:"pHI5o",label:"Sampling Time",type:"date",hasDuplicate:!0,readonly:null,isRequired:null,config:{type:"time"}},{id:"CGtR5",label:"Sampling Person",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"W4xsk",label:"Entry Time",type:"date",hasDuplicate:!0,readonly:null,isRequired:null,config:{type:"time"}},{id:"Y7oZr",label:"Description",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"tOA0C",label:"Sampling Count",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"SBXZu",label:"Shift",type:"select",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{items:["Shift 1","Shift 2","Shift 3"]}},{id:"JKbNy",label:"Time",type:"date",hasDuplicate:!0,readonly:null,isRequired:null,config:{type:"time"}}],A=[{sample:"Chiler",location:"\u0628\u0644\u0648\u062f\u0627\u0646 \u06a9\u0648\u0644\u06cc\u0646\u06af \u062a\u0627\u0648\u0631\u0647\u0627\u06cc \u0686\u06cc\u0644\u0631 Chiler"},{sample:"Make Up",location:"\u0622\u0628 \u062c\u0628\u0631\u0627\u0646\u06cc \u0627\u0632 3/4WP031 \u0628\u0647 \u0645\u062e\u0632\u0646Wa rm Wa te r"},{sample:"Raw",location:"\u0622\u0628 \u062e\u0627\u0645 \u0648\u0631\u0648\u0631\u062f\u06cc \u0628\u0647 \u0648\u0627\u062d\u062f \u067e\u06cc\u0634 \u062a\u0635\u0641\u06cc\u0647 \u0627\u0632\u0645\u062e\u0632\u0646 2WT031"},{sample:"O-HPGR",location:"\u06a9\u0648\u0644\u06cc\u0646\u06af \u062a\u0627\u0648\u0631 HPGR \u0627\u0632 \u067e\u0645\u067e\u0647\u0627\u06cc 3/4WP150"},{sample:"CT1",location:"\u0622\u0628 \u0645\u062e\u0632\u0646 \u06a9\u0648\u0644\u06cc\u0646\u06af \u0627\u0632 \u067e\u0645\u067e\u0647\u0627\u06cc CW03"},{sample:"C-HPGR",location:"\u0633\u06cc\u06a9\u0644 \u0645\u062f\u0627\u0631 \u0628\u0633\u062a\u0647 HPGR( \u0622\u0628 \u062f\u0627\u062e\u0644 \u06a9\u0648\u06cc\u0644\u0647\u0627("},{sample:"FW-RO1",location:"\u062e\u0648\u0631\u0627\u06a9 \u0648\u0631\u0648\u0631\u062f\u06cc \u0628\u0647 1RO( \u0628\u0639\u062f \u0627\u0632 \u067e\u0645\u067e\u0647\u0627\u06cc)HP"},{sample:"P-RO1",location:"\u0622\u0628 \u062a\u0648\u0644\u06cc\u062f\u06cc 1RO \u0628\u0647 \u0633\u0645\u062a \u0645\u062e\u0632\u0646 3WT031"},{sample:"FW-RO2",location:"\u062e\u0648\u0631\u0627\u06a9 \u0648\u0631\u0648\u062f\u06cc \u0628\u0647 2RO \u0627\u0632 \u0645\u062e\u0632\u0646 Brine \u06cc\u0627-06TK( \u0622\u0628 \u062f\u0648\u0631 \u0631\u06cc\u0632 1RO)"},{sample:"P-RO2",location:"\u0622\u0628 \u062a\u0648\u0644\u06cc\u062f\u06cc 2RO \u0628\u0647 \u0633\u0645\u062a \u0645\u062e\u0632\u0646 3WT031"},{sample:"Potable",location:"\u0622\u0628 \u0645\u0635\u0631\u0641\u06cc \u06cc\u0627 Water Potable \u0627\u0632033WP1/2"},{sample:"Process",location:"\u0628 \u067e\u0631\u0648\u0633\u0633 \u0627\u0632 \u067e\u0645\u067e\u0647\u0627\u06cc 7/8WP031"},{sample:"Chiler C",location:"\u0628\u0644\u0648\u062f\u0627\u0646 \u06a9\u0648\u0644\u06cc\u0646\u06af \u062a\u0627\u0648\u0631\u0647\u0627\u06cc \u0686\u06cc\u0644\u0631 \u0628\u0633\u062a\u0647"}],ke={"100BC04":{items:[...x,{id:"tOA0Ca",label:"Fe.t (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"60",max:"69"}},{id:"tOA0Caa",label:"FeO (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"10",max:"29"}},{id:"tOA0Cas",label:"P (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.010",max:"2.2"}},{id:"tOA0Cae",label:"S (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.008",max:"2"}},{id:"tOA0Cdfa",label:"AI2O3 (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.010",max:"5"}},{id:"tOA0dsfCa",label:"SiO2 (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.9",max:"7"}},{id:"tOA0Csdfa",label:"CaO (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"3"}},{id:"tOA0sdfCa",label:"MgO (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"3"}},{id:"tOA0sdfCa",label:"W (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"15"}},{id:"tOA0Casdf",label:"TiO2 (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"4"}},{id:"tOA0Cadsf",label:"K80 (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"100"}},{id:"tOA0Cadsdff",label:"<45",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"100"}},{id:"tOA0Cadsdffdsdf",label:"Blain",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"400",max:"1400"}},{id:"tOdsssadfdddsadsdf",label:"LOI",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"20"}},{id:"tOdddfsddsdsfasadsdaaa",label:"B2",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tOdsadfddddsadsdf",label:"B4",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}}],rules:{}},"510BC01&02":{items:[...x,{id:"tOA0Cfda",label:"Fe.t (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"60",max:"69"}},{id:"tOAdsf0Ca",label:"FeO (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"10",max:"29"}},{id:"tOA0sdfCa",label:"S (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.008",max:"2"}},{id:"tOA0sdfCa",label:"P (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"2.2"}},{id:"tsdfOA0Ca",label:"AI2O3 (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"5"}},{id:"tsdfOA0Ca",label:"SiO2 (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.3",max:"7"}},{id:"tdfsdfOA0Ca",label:"CaO (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"5"}},{id:"tffssfdsOA0Ca",label:"MgO (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"5"}},{id:"tOzxcvA0Ca",label:"TiO2 (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"2"}},{id:"tOasdfsA0Ca",label:"K80 (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"100"}},{id:"tOasdfsA0Caaas",label:"<45",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tOasdfsA0Cassdsd",label:"Blain",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"700",max:"2500"}},{id:"tOasdfsAas0Cavgrfgd",label:"LOI",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"10"}},{id:"tOasdfsA0fsdafCa",label:"B2",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tOasasdfdfsA0dCa",label:"B4",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"aaasdfsdtOasdfsA0Ca",label:"Before Mixer",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"15"}},{id:"tesasdfdtOasdfsA0Ca",label:"After Mixer",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"15"}}],rules:{}},"150BC02&05&11":{items:[...x,{id:"tOA0sdfCa",label:"W (%) - (02)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"15"}},{id:"sdfsdadggga",label:"Fe (%) - (02)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"60",max:"69"}},{id:"tOA0sdgCaa",label:"FeO (%) - (02)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"10",max:"29"}},{id:"tOA0Cadsdff",label:"<45 - (02)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"100"}},{id:"tOA0Cadsdffdsdf",label:"Blain - (02)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"400",max:"1800"}},{id:"tOA0sdfCa",label:"W (%) - (05)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"15"}},{id:"tOA0Cadsdffdsdf",label:"Blain - (05)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"400",max:"1800"}},{id:"tOA0Ca",label:"Fe (%) - (11)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"60",max:"69"}},{id:"tOA0Caa",label:"FeO (%) - (11)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"10",max:"29"}},{id:"tOA0Cas",label:"P (%) - (11)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.010",max:"2.2"}},{id:"tOA0Cdfa",label:"AI2O3 (%) - (11)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.008",max:"5"}},{id:"tOA0Cae",label:"S (%) - (11)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.010",max:"2"}},{id:"tOA0dsfCa",label:"SiO2 (%) - (11)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.9",max:"7"}},{id:"tOA0Csdfa",label:"CaO (%) - (11)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"3"}},{id:"tOA0sdfCa",label:"MgO (%) - (11)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"3"}},{id:"tOA0sdfCa",label:"W (%) - (11)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"15"}},{id:"tOA0Casdf",label:"TiO2 (%) - (11)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"4"}},{id:"tOA0Cadsf",label:"K80 (%) - (11)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"20",max:"200"}},{id:"tOA0Cadsdff",label:"<45 - (11)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"100"}},{id:"tOA0Cadsdffdsdf",label:"Blain - (11)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"400",max:"2500"}},{id:"tOdsssadfdddsadsdf",label:"LOI - (11)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"100"}},{id:"tOdddfsddsdsfasadsdaaa",label:"B2 - (11)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tOdsadfddddsadsdf",label:"B4 - (11)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}}]},Blain:{items:[...x,{id:"tOA0dfCAV",label:"B HPGR",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tOA0aaCAVV",label:"510BC01&02",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tOAdfsd0CAAV",label:"A HPGR",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}}],rules:{}},Moisture:{items:[...x,{id:"fsadfffjfjfsdj;",label:"100BC04",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"15"}},{id:"fsadfffjfjfsasdj;",label:"B Dryer",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"15"}},{id:"fsadfffjfjfsasdjaa;",label:"A Dryer",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"fsadfffjfjfsasdjddaa;",label:"B Mixer",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"sdjaa;",label:"A Mixer",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}}],rules:{}},"Size Distribution & Porosity":{items:[...x,{id:"fsadfffjfjfsdj;",label:"<5mm",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"50"}},{id:"fsdfsadfffjfjfsdj;",label:"5-6.3mm",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"50"}},{id:"fjfjfsdj;",label:"6.3-9mm",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"50"}},{id:"fsdj;",label:"9-12.5mm",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"50"}},{id:"dfffjfjfsdj;",label:"12.5-16mm",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"50"}},{id:"fffjfjfsdj;",label:">16mm",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"50"}},{id:"jfjsadffsdj;",label:"9-16mm",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"50"}},{id:"jfjfasdfsdj;",label:"16-20 mm",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"50"}},{id:"jfjfsdasdfaj;",label:">20 mm",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"50"}},{id:"jfdasfjfsdasdfaj;",label:"<6.3 mm",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"50"}},{id:"fsadfjfsdj;",label:"SR 9-12.5/12.5-16",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"fsadfffjfjfsdj;",label:"Porosity",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"fsadffffsdjfjfsdj;",label:"Emergency Pile",type:"checkbox",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}}],rules:{}},CCS:{items:[...x,{id:"fsadffsdj;",label:"AVE",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"100",max:"600"}},{id:"dffsdj;",label:"STD",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"20",max:"250"}},{id:"fdffsd",label:"<100",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"60"}},{id:"fsadffsfdsadfdj;",label:"<150",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"80"}},{id:"dsadfzadfdj;",label:"<250",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"100"}},{id:"fsadffsfdsadfdj;",label:">320",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"100"}},{id:"fsadffsfdsadfdj;",label:">500",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"100"}},{id:"asdfadfdj;",label:"Min",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"20",max:"400"}},{id:"fskkkfsfdsadfdj;",label:"Max",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"200",max:"990"}},{id:"fsadffsfdsadfdj;",label:"Ave Size",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"6.5",max:"16"}},{id:"fsdfadffffsdjfjfsdj;",label:"Emergency Pile",type:"checkbox",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}}],rules:{}},"Chemical Analysis":{items:[...x,{id:"tOA0Cfda",label:"Fe.t (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"60",max:"68"}},{id:"tOAdsf0Ca",label:"FeO (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"3"}},{id:"tOA0sdfCa",label:"S (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.0005",max:"0.09"}},{id:"tOA0sdfCa",label:"P (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"2"}},{id:"tsdfOA0Ca",label:"SiO2 (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.9",max:"8"}},{id:"tdfsdfOA0Ca",label:"CaO (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"6"}},{id:"tffssfdsOA0Ca",label:"MgO (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"6"}},{id:"tsdfOA0Ca",label:"AI2O3 (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"5"}},{id:"tOzxcvA0Ca",label:"TiO2 (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"6"}},{id:"tOasdfsA0Cdda",label:"B2",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tOasdfsA0Cssa",label:"B4",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"fsadfdffffsdjfjfsdj;",label:"Emergency Pile",type:"checkbox",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}}],rules:{}},Bentonite:{items:[...x,{id:"qti0J",label:"No",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"SBXZu",label:"Shift",type:"select",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{items:["Shift 1","Shift 2","Shift 3"]}},{id:"JKbNy",label:"Time",type:"date",hasDuplicate:!0,readonly:null,isRequired:null,config:{type:"time"}},{id:"tHURP",label:"Company",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"tHUsdfRP",label:"Number Plates",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"2Lk3n",label:"Moisture (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"15"}},{id:"lbOL9",label:"Water Ab (%)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"50",max:"990"}},{id:"tOfdsaA0Ca",label:"Fe",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"60"}},{id:"sdftOA0Caasdaf",label:"SiO2",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"10",max:"80"}},{id:"tOA0Cazvcxvaaaas",label:"CaO",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"25"}},{id:"tOAfsdfasdfasd0Ca",label:"Na2O",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"15"}},{id:"tOA0sadfCa",label:"<45",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"20",max:"100"}},{id:"ddsaftOA0asCa",label:"LOI",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"80"}},{id:"tHUsdfRPsa",label:"Considerations",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{}}],rules:{}},NaOH:{items:[...x,{id:"tHURP",label:"Company",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"tHUsdfRP",label:"Number Plates",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"tHUsdfRasdfP",label:"Bome",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"35",max:"60"}},{id:"tHUsdfRPsa",label:"Considerations",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{}}]},Limestone:{items:[...x,{id:"qti0J",label:"No.",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"tHUdfsRP",label:"Company",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"tHUsdfRP",label:"Number Plates",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"sdgdsfgfddfdsaRP",label:"CaO",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"10",max:"85"}},{id:"sdgdsfgfddfRP",label:"SiO2",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"50"}},{id:"sdgdsfgfddfRP",label:"MgO",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"60"}},{id:"sdgdsfgfddfRP",label:"AI2O3",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"35"}},{id:"sdgdsfgfddfRP",label:"P",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"10"}},{id:"sdgdsfgfddfRP",label:"MnO",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"15"}},{id:"sdgdsfgfddfRP",label:"TiO2",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"60"}},{id:"sdgdsfgfddfRP",label:"LOI",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"60"}},{id:"sdgdsfgfddfRP",label:"<45",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0",max:"100"}},{id:"tHUsdfRPsa",label:"Considerations",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{}}],rules:{}},"Green Pellet":{items:[...x,{id:"SBdsfsdXZu",label:"Disk",type:"select",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{items:["All Disk","Disk 1","Disk 2","Disk 3","Disk 4","Disk 5","Disk 6","Disk 7","Disk 8","Disk 9"]}},{id:"qtsdfi0J",label:"Drop",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"0",max:"12"}},{id:"qtsdfsdfi0J",label:"Moisture (%)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"0.01",max:"15"}},{id:"qtsdfsdfi0dsdfJ",label:"WCS",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"150",max:"2000"}},{id:"fsadfffjfjfsdj;",label:"<5 mm",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"50"}},{id:"fsdfsadfffjfjfsdj;",label:"5-6.3 mm",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"50"}},{id:"fjfjsdffsdj;",label:"6.3-9 mm",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"50"}},{id:"fdfssdj;",label:"9-11.2 mm",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"50"}},{id:"dfffjfjsdffsdj;",label:"11.2-16 mm",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"50"}},{id:"fffjfjsdffsdj;",label:"16-20 mm",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"50"}},{id:"fffjfsdfjfsdj;",label:">20 mm",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"0.01",max:"50"}}],rules:{}},Tumble:{items:[...x,{id:"qsdfti0J",label:"Ti (%)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"90",max:"99"}},{id:"qsdsdffti0J",label:"Ai (%)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"0.1",max:"6.99"}},{id:"fsadffffsdjdffjfsdj;",label:"Emergency Pile",type:"checkboxs",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}}],rules:{}},"Water Analysis":{items:[...x,{id:"Sam-qtidsfsdfa0J",label:"Sample",type:"autocomplete",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{items:A.map(d=>d.sample)}},{id:"Loc-qtiasdfdsfsdfa0J",label:"Location",type:"autocomplete",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{items:A.map(d=>d.location)}},{id:"fsdfsd",label:"PH",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"EdsfdCfsd",label:"EC (\xb5s/cm)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"fsdfsdsdfsd",label:"TDS (ppm)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"fsfsdfsddfdfsd",label:"TSS (ppm)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"sdffs",label:"TH (ppm)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"fsfsfdsdfsddfsd",label:"CT (ppm)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"fsfsdfsdffsddfsd",label:"P_Alk (ppm)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"fsfssdfsdfdsfdfsd",label:"M_Alk (ppm)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"ffdsfsfsdfsddfsd",label:"Ca_H (ppm)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"fsfdsdfsddfsd",label:"Mg_H (ppm)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"fsfdssdfdddsffsddfsd",label:"TUR (NTU)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"fsfddfsdffdsdfssddfsd",label:"T_Fe (ppm)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"fsfdsdfsdsafddfsd",label:"O-PO4-3 (ppm)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"fsfdsdfdfsddfsd",label:"NO2- (ppm)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"fsfdsdsdfsddfsd",label:"SRB (cfu/ml)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"fsfsdfsdsdfdfsddfsd",label:"TBC (cfu/ml)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"fsdfsfdsdffsdsddfsd",label:"SO4-2  (ppm)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}}],rules:{}},"Reduction Test":{items:[...x,{id:"qtdi0sdfJ",label:"Weight (gr) B",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"qtdi0\u06cc\u0633\u0628sdfJ",label:"CCS (AVG kg/p) (B)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"tOA0dfsCfda",label:"Fe.t (%) (B)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tOAdssddsfff0Ca",label:"FeO (B)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tsdfOA0Ca",label:"AI2O3 (B)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tsddfOA0Ca",label:"SiO2 (B)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tdfsdfOA0Ca",label:"CaO (B)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tffssfdsOA0Ca",label:"MgO (B)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tffssfdsOA0sdfCa",label:"MnO (B)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tOzxcvA0Ca",label:"TiO2 (B)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"sdfsdf",label:"P (B)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tOA0sdffdssdfsdfCa",label:"C (B)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"qtdi0sdfJ1",label:"Weight (gr) (A)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"qtdi0\u06cc\u0633\u0628sdfJ1",label:"CCS (AVG kg/p) (A)",type:"number",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{min:"",max:""}},{id:"tOA0dfsCfda1",label:"Fe.t (%) (A)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tfdOAdssdf1f0Ca",label:"FeM(%) (A)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tsdfOA0Ca1",label:"AI2O3 (A)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tsddfOA01Ca",label:"SiO2 (A)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tdfsdfO1A0Ca",label:"CaO (A)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tffssfd1sOA0Ca",label:"MgO (A)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tffssfd1sOA0sdfCa",label:"MnO (A)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tOzxcvA01Ca",label:"TiO2 (A)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"sdfsd1f",label:"P (A)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tOA0s1dffdssdfsdfCa",label:"C (A)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tOA0dffddf1dsdfsdfCa",label:"Me (%) (A)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tOA0ddffsdfsdfCa1",label:"Reduction (%) (A)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tdfsOA0dfsdfdfsdf1Cdfa",label:"Fragmentation (A)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tdfsOA0sdfdfs1Cdfa",label:"Wight (gr) 2 min",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tdsdffsOA0dfs1Cdfa",label:"Wight (gr) 5 min",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tsdfsddfsOA0dfs1Cdfa",label:"% 2 min",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"tdfdsfsdsOA0dfs1Cdfa",label:"% 5 min",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}}],rules:{}},"Analysis Result":{items:[...x,{id:"tdfsdfsdOA0dfsdfdfsdf1Cdfa",label:"Test Item",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"sdfdfsdf1Cdfa",label:"Unit",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"OA0dfsdfdfsdf1Cdfa",label:"Result",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"OA0dfsdfdfsdf1Cdfa",label:"Uncertainty",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"sdfdfsdf1Cdfa",label:"Stand Method",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}},{id:"sdfdfsdf1Cdfa",label:"Test Type",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{min:"",max:""}}],rules:{}},"Annual Plan":{items:[{id:"tOA0Cfda",label:"Month",type:"select",hasDuplicate:!0,readonly:null,isRequired:null,config:{items:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}},{id:"tfHURP",label:"Day Count",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"tHURPf",label:"Warm Stop",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"fsdfadf",label:"Cold Stop",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"ghgfdfdffd",label:"Emergency Stop",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"tHUdfdfdRfdP",label:"Working Day",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"tHUddffdfdRP",label:"Total Hour",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"tfdffdfdHUfdfRP",label:"Working Hour",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"tHUdRsdfdfsfP",label:"Prod Rate",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"tHURPd",label:"Co Usage (T)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"tHdfdfsssadURP",label:"Ben Usage (T)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"tHURdsfP",label:"Lime Usage (T)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"tHfdsafURP",label:"Accessibility",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"tHURPsdfs",label:"Prod Monthly (T)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"tHURPsdfs",label:"Prod Daily (T)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"tHURPsdfs",label:"Cumulative Prod (T)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{}}]},"Daily Plan":{items:[{id:"dfsdddfsdasdf1Cdfa",label:"Date",type:"date",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"SBXZsdfudsf",label:"Shift",type:"select",hasDuplicate:!0,readonly:!1,isRequired:!1,config:{items:["Shift 1","Shift 2","Shift 3"]}},{id:"tHUsdfRPdff",label:"Daily Product",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"tHaURPddsafff",label:"OP Time",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{}}]},"Block List":{items:[{id:"fsdfdfsdf1Cdfa",label:"Equipment Tag",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"tdfsOA0dfsdfdfsdf1Cdfa",label:"Item Block",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"sdfdfsdf1Cdfa",label:"Desc",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"OA0dfsdfdfsdf1a",label:"Job",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{}}],rules:{}},"Factory Stop":{items:[{id:"dfsdddfsdf1Cdfa",label:"Start",type:"date",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"dfdfssdfdfsdf1Cdfa",label:"End",type:"date",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"dfsdsafdfsdf1Cdfa",label:"Duration",type:"date",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"dsfdf",label:"Desc",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{}}],rules:{}},"Pille Table":{items:[{id:"dfsdddffsdfasdf1Cdfa",label:"Start",type:"date",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"dfdfsadfssdfdfsdf1Cdfa",label:"End",type:"date",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"dfsdsafdfsdsfdf1Cdfa",label:"Exit Rate (T)",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"fsddfsdf1Cdfa",label:"Amount",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"dsfdf",label:"Desc",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{}}],rules:{}},"Prod Decrease":{items:[{id:"dfsdddfsdf1Cdfa",label:"Start",type:"date",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"dfdfssdfdfsdf1Cdfa",label:"End",type:"date",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"dfsdsafdfsdf1Cdfa",label:"Duration",type:"date",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"dfsdsafdfsdf1sdfCdfa",label:"Tonnage Reduction",type:"number",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"dsfdf",label:"Desc",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{}}],rules:{}},"Reason for stopping":{items:[{id:"dfdfssdfdfsdf1Cdfa",label:"pellet",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{}},{id:"dfdfssdfdfsdf1Cdfa",label:"rah",type:"text",hasDuplicate:!0,readonly:null,isRequired:null,config:{}}]}}},5981:(ot,zt,V)=>{"use strict";V.d(zt,{Ov:()=>$t,Z9:()=>R,eX:()=>mi,k:()=>Bt,o2:()=>d,yy:()=>Qi});var x=V(8793),A=V(8748),ke=V(755);class d{}function R(tt){return tt&&"function"==typeof tt.connect&&!(tt instanceof x.c)}class Qi{applyChanges(Ve,Nt,Vt,Pi,Fi){Ve.forEachOperation((Ht,si,Je)=>{let pi,ni;if(null==Ht.previousIndex){const Mn=Vt(Ht,si,Je);pi=Nt.createEmbeddedView(Mn.templateRef,Mn.context,Mn.index),ni=1}else null==Je?(Nt.remove(si),ni=3):(pi=Nt.get(si),Nt.move(pi,Je),ni=2);Fi&&Fi({context:pi?.context,operation:ni,record:Ht})})}detach(){}}class mi{constructor(){this.viewCacheSize=20,this._viewCache=[]}applyChanges(Ve,Nt,Vt,Pi,Fi){Ve.forEachOperation((Ht,si,Je)=>{let pi,ni;null==Ht.previousIndex?(pi=this._insertView(()=>Vt(Ht,si,Je),Je,Nt,Pi(Ht)),ni=pi?1:0):null==Je?(this._detachAndCacheView(si,Nt),ni=3):(pi=this._moveView(si,Je,Nt,Pi(Ht)),ni=2),Fi&&Fi({context:pi?.context,operation:ni,record:Ht})})}detach(){for(const Ve of this._viewCache)Ve.destroy();this._viewCache=[]}_insertView(Ve,Nt,Vt,Pi){const Fi=this._insertViewFromCache(Nt,Vt);if(Fi)return void(Fi.context.$implicit=Pi);const Ht=Ve();return Vt.createEmbeddedView(Ht.templateRef,Ht.context,Ht.index)}_detachAndCacheView(Ve,Nt){const Vt=Nt.detach(Ve);this._maybeCacheView(Vt,Nt)}_moveView(Ve,Nt,Vt,Pi){const Fi=Vt.get(Ve);return Vt.move(Fi,Nt),Fi.context.$implicit=Pi,Fi}_maybeCacheView(Ve,Nt){if(this._viewCache.length<this.viewCacheSize)this._viewCache.push(Ve);else{const Vt=Nt.indexOf(Ve);-1===Vt?Ve.destroy():Nt.remove(Vt)}}_insertViewFromCache(Ve,Nt){const Vt=this._viewCache.pop();return Vt&&Nt.insert(Vt,Ve),Vt||null}}class $t{get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}constructor(Ve=!1,Nt,Vt=!0,Pi){this._multiple=Ve,this._emitChanges=Vt,this.compareWith=Pi,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new A.x,Nt&&Nt.length&&(Ve?Nt.forEach(Fi=>this._markSelected(Fi)):this._markSelected(Nt[0]),this._selectedToEmit.length=0)}select(...Ve){this._verifyValueAssignment(Ve),Ve.forEach(Vt=>this._markSelected(Vt));const Nt=this._hasQueuedChanges();return this._emitChangeEvent(),Nt}deselect(...Ve){this._verifyValueAssignment(Ve),Ve.forEach(Vt=>this._unmarkSelected(Vt));const Nt=this._hasQueuedChanges();return this._emitChangeEvent(),Nt}setSelection(...Ve){this._verifyValueAssignment(Ve);const Nt=this.selected,Vt=new Set(Ve);Ve.forEach(Fi=>this._markSelected(Fi)),Nt.filter(Fi=>!Vt.has(Fi)).forEach(Fi=>this._unmarkSelected(Fi));const Pi=this._hasQueuedChanges();return this._emitChangeEvent(),Pi}toggle(Ve){return this.isSelected(Ve)?this.deselect(Ve):this.select(Ve)}clear(Ve=!0){this._unmarkAll();const Nt=this._hasQueuedChanges();return Ve&&this._emitChangeEvent(),Nt}isSelected(Ve){return this._selection.has(this._getConcreteValue(Ve))}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(Ve){this._multiple&&this.selected&&this._selected.sort(Ve)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(Ve){Ve=this._getConcreteValue(Ve),this.isSelected(Ve)||(this._multiple||this._unmarkAll(),this.isSelected(Ve)||this._selection.add(Ve),this._emitChanges&&this._selectedToEmit.push(Ve))}_unmarkSelected(Ve){Ve=this._getConcreteValue(Ve),this.isSelected(Ve)&&(this._selection.delete(Ve),this._emitChanges&&this._deselectedToEmit.push(Ve))}_unmarkAll(){this.isEmpty()||this._selection.forEach(Ve=>this._unmarkSelected(Ve))}_verifyValueAssignment(Ve){}_hasQueuedChanges(){return!(!this._deselectedToEmit.length&&!this._selectedToEmit.length)}_getConcreteValue(Ve){if(this.compareWith){for(let Nt of this._selection)if(this.compareWith(Ve,Nt))return Nt;return Ve}return Ve}}const Bt=new ke.OlP("_ViewRepeater")},5770:(ot,zt,V)=>{"use strict";V.d(zt,{Bb:()=>Sn,XC:()=>pn,ZL:()=>Tn});var x=V(755),A=V(4220),ke=V(6733),d=V(3753),R=V(8146),Li=V(7583),Qi=V(2561),mi=V(8491),$t=V(2405),Zi=V(902),Hi=V(8748),Bt=V(3562),tt=V(5047),Ve=V(1209),Nt=V(409),Vt=V(5262),Pi=V(6785),Fi=V(3226),Ht=V(6125),si=V(3843),Je=V(4787),pi=V(1813),ni=V(5333),Mn=V(2425),ls=V(1570),ir=V(9286),jt=V(5667);const zn=["panel"];function ut(dt,Ni){if(1&dt){const j=x.EpF();x.TgZ(0,"div",0,1),x.NdJ("@panelAnimation.done",function(De){x.CHM(j);const Mt=x.oxw();return x.KtG(Mt._animationDone.next(De))}),x.Hsn(2),x.qZA()}if(2&dt){const j=Ni.id,he=x.oxw();x.Q6J("id",he.id)("ngClass",he._classList)("@panelAnimation",he.isOpen?"visible":"hidden"),x.uIk("aria-label",he.ariaLabel||null)("aria-labelledby",he._getPanelAriaLabelledby(j))}}const yi=["*"],Qt=(0,$t.X$)("panelAnimation",[(0,$t.SB)("void, hidden",(0,$t.oB)({opacity:0,transform:"scaleY(0.8)"})),(0,$t.eR)(":enter, hidden => visible",[(0,$t.ru)([(0,$t.jt)("0.03s linear",(0,$t.oB)({opacity:1})),(0,$t.jt)("0.12s cubic-bezier(0, 0, 0.2, 1)",(0,$t.oB)({transform:"scaleY(1)"}))])]),(0,$t.eR)(":leave, visible => hidden",[(0,$t.jt)("0.075s linear",(0,$t.oB)({opacity:0}))])]);let Bi=0;class ts{constructor(Ni,j){this.source=Ni,this.option=j}}const ps=(0,A.Kr)(class{}),Os=new x.OlP("mat-autocomplete-default-options",{providedIn:"root",factory:function Rs(){return{autoActiveFirstOption:!1,autoSelectActiveOption:!1,hideSingleSelectionIndicator:!1,requireSelection:!1}}});let cs=(()=>{class dt extends ps{get isOpen(){return this._isOpen&&this.showPanel}_setColor(j){this._color=j,this._setThemeClasses(this._classList)}get autoActiveFirstOption(){return this._autoActiveFirstOption}set autoActiveFirstOption(j){this._autoActiveFirstOption=(0,Qi.Ig)(j)}get autoSelectActiveOption(){return this._autoSelectActiveOption}set autoSelectActiveOption(j){this._autoSelectActiveOption=(0,Qi.Ig)(j)}get requireSelection(){return this._requireSelection}set requireSelection(j){this._requireSelection=(0,Qi.Ig)(j)}set classList(j){this._classList=j&&j.length?(0,Qi.du)(j).reduce((he,De)=>(he[De]=!0,he),{}):{},this._setVisibilityClasses(this._classList),this._setThemeClasses(this._classList),this._elementRef.nativeElement.className=""}constructor(j,he,De,Mt){super(),this._changeDetectorRef=j,this._elementRef=he,this._defaults=De,this._activeOptionChanges=Zi.w0.EMPTY,this.showPanel=!1,this._isOpen=!1,this.displayWith=null,this.optionSelected=new x.vpe,this.opened=new x.vpe,this.closed=new x.vpe,this.optionActivated=new x.vpe,this._classList={},this.id="mat-autocomplete-"+Bi++,this.inertGroups=Mt?.SAFARI||!1,this._autoActiveFirstOption=!!De.autoActiveFirstOption,this._autoSelectActiveOption=!!De.autoSelectActiveOption,this._requireSelection=!!De.requireSelection}ngAfterContentInit(){this._keyManager=new Li.s1(this.options).withWrap().skipPredicate(this._skipPredicate),this._activeOptionChanges=this._keyManager.change.subscribe(j=>{this.isOpen&&this.optionActivated.emit({source:this,option:this.options.toArray()[j]||null})}),this._setVisibility()}ngOnDestroy(){this._keyManager?.destroy(),this._activeOptionChanges.unsubscribe()}_setScrollTop(j){this.panel&&(this.panel.nativeElement.scrollTop=j)}_getScrollTop(){return this.panel?this.panel.nativeElement.scrollTop:0}_setVisibility(){this.showPanel=!!this.options.length,this._setVisibilityClasses(this._classList),this._changeDetectorRef.markForCheck()}_emitSelectEvent(j){const he=new ts(this,j);this.optionSelected.emit(he)}_getPanelAriaLabelledby(j){return this.ariaLabel?null:this.ariaLabelledby?(j?j+" ":"")+this.ariaLabelledby:j}_setVisibilityClasses(j){j[this._visibleClass]=this.showPanel,j[this._hiddenClass]=!this.showPanel}_setThemeClasses(j){j["mat-primary"]="primary"===this._color,j["mat-warn"]="warn"===this._color,j["mat-accent"]="accent"===this._color}_skipPredicate(j){return j.disabled}static#e=this.\u0275fac=function(he){return new(he||dt)(x.Y36(x.sBO),x.Y36(x.SBq),x.Y36(Os),x.Y36(mi.t4))};static#t=this.\u0275dir=x.lG2({type:dt,viewQuery:function(he,De){if(1&he&&(x.Gf(x.Rgc,7),x.Gf(zn,5)),2&he){let Mt;x.iGM(Mt=x.CRH())&&(De.template=Mt.first),x.iGM(Mt=x.CRH())&&(De.panel=Mt.first)}},inputs:{ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],displayWith:"displayWith",autoActiveFirstOption:"autoActiveFirstOption",autoSelectActiveOption:"autoSelectActiveOption",requireSelection:"requireSelection",panelWidth:"panelWidth",classList:["class","classList"]},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},features:[x.qOj]})}return dt})(),pn=(()=>{class dt extends cs{constructor(){super(...arguments),this._visibleClass="mat-mdc-autocomplete-visible",this._hiddenClass="mat-mdc-autocomplete-hidden",this._animationDone=new x.vpe,this._hideSingleSelectionIndicator=this._defaults.hideSingleSelectionIndicator??!1}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(j){this._hideSingleSelectionIndicator=(0,Qi.Ig)(j),this._syncParentProperties()}_syncParentProperties(){if(this.options)for(const j of this.options)j._changeDetectorRef.markForCheck()}ngOnDestroy(){super.ngOnDestroy(),this._animationDone.complete()}_skipPredicate(j){return!1}static#e=this.\u0275fac=function(){let j;return function(De){return(j||(j=x.n5z(dt)))(De||dt)}}();static#t=this.\u0275cmp=x.Xpm({type:dt,selectors:[["mat-autocomplete"]],contentQueries:function(he,De,Mt){if(1&he&&(x.Suo(Mt,A.K7,5),x.Suo(Mt,A.ey,5)),2&he){let it;x.iGM(it=x.CRH())&&(De.optionGroups=it),x.iGM(it=x.CRH())&&(De.options=it)}},hostAttrs:["ngSkipHydration","",1,"mat-mdc-autocomplete"],inputs:{disableRipple:"disableRipple",hideSingleSelectionIndicator:"hideSingleSelectionIndicator"},exportAs:["matAutocomplete"],features:[x._Bn([{provide:A.HF,useExisting:dt}]),x.qOj],ngContentSelectors:yi,decls:1,vars:0,consts:[["role","listbox",1,"mat-mdc-autocomplete-panel","mdc-menu-surface","mdc-menu-surface--open",3,"id","ngClass"],["panel",""]],template:function(he,De){1&he&&(x.F$t(),x.YNc(0,ut,3,5,"ng-template"))},dependencies:[ke.mk],styles:["div.mat-mdc-autocomplete-panel{box-shadow:0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12);width:100%;max-height:256px;visibility:hidden;transform-origin:center top;overflow:auto;padding:8px 0;border-radius:4px;box-sizing:border-box;position:static;background-color:var(--mat-autocomplete-background-color)}.cdk-high-contrast-active div.mat-mdc-autocomplete-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-autocomplete-panel-above) div.mat-mdc-autocomplete-panel{border-top-left-radius:0;border-top-right-radius:0}.mat-mdc-autocomplete-panel-above div.mat-mdc-autocomplete-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:center bottom}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-visible{visibility:visible}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-hidden{visibility:hidden}mat-autocomplete{display:none}"],encapsulation:2,data:{animation:[Qt]},changeDetection:0})}return dt})();const Vi={provide:Fi.JU,useExisting:(0,x.Gpc)(()=>Tn),multi:!0},fs=new x.OlP("mat-autocomplete-scroll-strategy"),gi={provide:fs,deps:[R.aV],useFactory:function bn(dt){return()=>dt.scrollStrategies.reposition()}};let is=(()=>{class dt{get autocompleteDisabled(){return this._autocompleteDisabled}set autocompleteDisabled(j){this._autocompleteDisabled=(0,Qi.Ig)(j)}constructor(j,he,De,Mt,it,Ln,ge,Ne,je,Zt,ne){this._element=j,this._overlay=he,this._viewContainerRef=De,this._zone=Mt,this._changeDetectorRef=it,this._dir=ge,this._formField=Ne,this._document=je,this._viewportRuler=Zt,this._defaults=ne,this._componentDestroyed=!1,this._autocompleteDisabled=!1,this._manuallyFloatingLabel=!1,this._viewportSubscription=Zi.w0.EMPTY,this._canOpenOnNextFocus=!0,this._closeKeyEventStream=new Hi.x,this._windowBlurHandler=()=>{this._canOpenOnNextFocus=this._document.activeElement!==this._element.nativeElement||this.panelOpen},this._onChange=()=>{},this._onTouched=()=>{},this.position="auto",this.autocompleteAttribute="off",this._overlayAttached=!1,this.optionSelections=(0,Bt.P)(()=>{const z=this.autocomplete?this.autocomplete.options:null;return z?z.changes.pipe((0,si.O)(z),(0,Je.w)(()=>(0,tt.T)(...z.map(Qe=>Qe.onSelectionChange)))):this._zone.onStable.pipe((0,pi.q)(1),(0,Je.w)(()=>this.optionSelections))}),this._handlePanelKeydown=z=>{(z.keyCode===Vt.hY&&!(0,Vt.Vb)(z)||z.keyCode===Vt.LH&&(0,Vt.Vb)(z,"altKey"))&&(this._pendingAutoselectedOption&&(this._updateNativeInputValue(this._valueBeforeAutoSelection??""),this._pendingAutoselectedOption=null),this._closeKeyEventStream.next(),this._resetActiveItem(),z.stopPropagation(),z.preventDefault())},this._trackedModal=null,this._scrollStrategy=Ln}ngAfterViewInit(){const j=this._getWindow();typeof j<"u"&&this._zone.runOutsideAngular(()=>j.addEventListener("blur",this._windowBlurHandler))}ngOnChanges(j){j.position&&this._positionStrategy&&(this._setStrategyPositions(this._positionStrategy),this.panelOpen&&this._overlayRef.updatePosition())}ngOnDestroy(){const j=this._getWindow();typeof j<"u"&&j.removeEventListener("blur",this._windowBlurHandler),this._viewportSubscription.unsubscribe(),this._componentDestroyed=!0,this._destroyPanel(),this._closeKeyEventStream.complete(),this._clearFromModal()}get panelOpen(){return this._overlayAttached&&this.autocomplete.showPanel}openPanel(){this._attachOverlay(),this._floatLabel(),this._trackedModal&&(0,Li.Zf)(this._trackedModal,"aria-owns",this.autocomplete.id)}closePanel(){this._resetLabel(),this._overlayAttached&&(this.panelOpen&&this._zone.run(()=>{this.autocomplete.closed.emit()}),this.autocomplete._isOpen=this._overlayAttached=!1,this._pendingAutoselectedOption=null,this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._closingActionsSubscription.unsubscribe()),this._updatePanelState(),this._componentDestroyed||this._changeDetectorRef.detectChanges(),this._trackedModal)&&(0,Li.iD)(this._trackedModal,"aria-owns",this.autocomplete.id)}updatePosition(){this._overlayAttached&&this._overlayRef.updatePosition()}get panelClosingActions(){return(0,tt.T)(this.optionSelections,this.autocomplete._keyManager.tabOut.pipe((0,ni.h)(()=>this._overlayAttached)),this._closeKeyEventStream,this._getOutsideClickStream(),this._overlayRef?this._overlayRef.detachments().pipe((0,ni.h)(()=>this._overlayAttached)):(0,Ve.of)()).pipe((0,Mn.U)(j=>j instanceof A.rN?j:null))}get activeOption(){return this.autocomplete&&this.autocomplete._keyManager?this.autocomplete._keyManager.activeItem:null}_getOutsideClickStream(){return(0,tt.T)((0,Nt.R)(this._document,"click"),(0,Nt.R)(this._document,"auxclick"),(0,Nt.R)(this._document,"touchend")).pipe((0,ni.h)(j=>{const he=(0,mi.sA)(j),De=this._formField?this._formField._elementRef.nativeElement:null,Mt=this.connectedTo?this.connectedTo.elementRef.nativeElement:null;return this._overlayAttached&&he!==this._element.nativeElement&&this._document.activeElement!==this._element.nativeElement&&(!De||!De.contains(he))&&(!Mt||!Mt.contains(he))&&!!this._overlayRef&&!this._overlayRef.overlayElement.contains(he)}))}writeValue(j){Promise.resolve(null).then(()=>this._assignOptionValue(j))}registerOnChange(j){this._onChange=j}registerOnTouched(j){this._onTouched=j}setDisabledState(j){this._element.nativeElement.disabled=j}_handleKeydown(j){const he=j.keyCode,De=(0,Vt.Vb)(j);if(he===Vt.hY&&!De&&j.preventDefault(),this.activeOption&&he===Vt.K5&&this.panelOpen&&!De)this.activeOption._selectViaInteraction(),this._resetActiveItem(),j.preventDefault();else if(this.autocomplete){const Mt=this.autocomplete._keyManager.activeItem,it=he===Vt.LH||he===Vt.JH;he===Vt.Mf||it&&!De&&this.panelOpen?this.autocomplete._keyManager.onKeydown(j):it&&this._canOpen()&&this.openPanel(),(it||this.autocomplete._keyManager.activeItem!==Mt)&&(this._scrollToOption(this.autocomplete._keyManager.activeItemIndex||0),this.autocomplete.autoSelectActiveOption&&this.activeOption&&(this._pendingAutoselectedOption||(this._valueBeforeAutoSelection=this._element.nativeElement.value),this._pendingAutoselectedOption=this.activeOption,this._assignOptionValue(this.activeOption.value)))}}_handleInput(j){let he=j.target,De=he.value;"number"===he.type&&(De=""==De?null:parseFloat(De)),this._previousValue!==De&&(this._previousValue=De,this._pendingAutoselectedOption=null,(!this.autocomplete||!this.autocomplete.requireSelection)&&this._onChange(De),De||this._clearPreviousSelectedOption(null,!1),this._canOpen()&&this._document.activeElement===j.target&&this.openPanel())}_handleFocus(){this._canOpenOnNextFocus?this._canOpen()&&(this._previousValue=this._element.nativeElement.value,this._attachOverlay(),this._floatLabel(!0)):this._canOpenOnNextFocus=!0}_handleClick(){this._canOpen()&&!this.panelOpen&&this.openPanel()}_floatLabel(j=!1){this._formField&&"auto"===this._formField.floatLabel&&(j?this._formField._animateAndLockLabel():this._formField.floatLabel="always",this._manuallyFloatingLabel=!0)}_resetLabel(){this._manuallyFloatingLabel&&(this._formField&&(this._formField.floatLabel="auto"),this._manuallyFloatingLabel=!1)}_subscribeToClosingActions(){const j=this._zone.onStable.pipe((0,pi.q)(1)),he=this.autocomplete.options.changes.pipe((0,ls.b)(()=>this._positionStrategy.reapplyLastPosition()),(0,ir.g)(0));return(0,tt.T)(j,he).pipe((0,Je.w)(()=>(this._zone.run(()=>{const De=this.panelOpen;this._resetActiveItem(),this._updatePanelState(),this._changeDetectorRef.detectChanges(),this.panelOpen&&this._overlayRef.updatePosition(),De!==this.panelOpen&&(this.panelOpen?(this._captureValueOnAttach(),this._emitOpened()):this.autocomplete.closed.emit())}),this.panelClosingActions)),(0,pi.q)(1)).subscribe(De=>this._setValueAndClose(De))}_emitOpened(){this.autocomplete.opened.emit()}_captureValueOnAttach(){this._valueOnAttach=this._element.nativeElement.value}_destroyPanel(){this._overlayRef&&(this.closePanel(),this._overlayRef.dispose(),this._overlayRef=null)}_assignOptionValue(j){const he=this.autocomplete&&this.autocomplete.displayWith?this.autocomplete.displayWith(j):j;this._updateNativeInputValue(he??"")}_updateNativeInputValue(j){this._formField?this._formField._control.value=j:this._element.nativeElement.value=j,this._previousValue=j}_setValueAndClose(j){const he=this.autocomplete,De=j?j.source:this._pendingAutoselectedOption;De?(this._clearPreviousSelectedOption(De),this._assignOptionValue(De.value),this._onChange(De.value),he._emitSelectEvent(De),this._element.nativeElement.focus()):he.requireSelection&&this._element.nativeElement.value!==this._valueOnAttach&&(this._clearPreviousSelectedOption(null),this._assignOptionValue(null),he._animationDone?he._animationDone.pipe((0,pi.q)(1)).subscribe(()=>this._onChange(null)):this._onChange(null)),this.closePanel()}_clearPreviousSelectedOption(j,he){this.autocomplete?.options?.forEach(De=>{De!==j&&De.selected&&De.deselect(he)})}_attachOverlay(){let j=this._overlayRef;j?(this._positionStrategy.setOrigin(this._getConnectedElement()),j.updateSize({width:this._getPanelWidth()})):(this._portal=new Pi.UE(this.autocomplete.template,this._viewContainerRef,{id:this._formField?.getLabelId()}),j=this._overlay.create(this._getOverlayConfig()),this._overlayRef=j,this._viewportSubscription=this._viewportRuler.change().subscribe(()=>{this.panelOpen&&j&&j.updateSize({width:this._getPanelWidth()})})),j&&!j.hasAttached()&&(j.attach(this._portal),this._closingActionsSubscription=this._subscribeToClosingActions());const he=this.panelOpen;this.autocomplete._isOpen=this._overlayAttached=!0,this.autocomplete._setColor(this._formField?.color),this._updatePanelState(),this._applyModalPanelOwnership(),this._captureValueOnAttach(),this.panelOpen&&he!==this.panelOpen&&this._emitOpened()}_updatePanelState(){if(this.autocomplete._setVisibility(),this.panelOpen){const j=this._overlayRef;this._keydownSubscription||(this._keydownSubscription=j.keydownEvents().subscribe(this._handlePanelKeydown)),this._outsideClickSubscription||(this._outsideClickSubscription=j.outsidePointerEvents().subscribe())}else this._keydownSubscription?.unsubscribe(),this._outsideClickSubscription?.unsubscribe(),this._keydownSubscription=this._outsideClickSubscription=null}_getOverlayConfig(){return new R.X_({positionStrategy:this._getOverlayPosition(),scrollStrategy:this._scrollStrategy(),width:this._getPanelWidth(),direction:this._dir??void 0,panelClass:this._defaults?.overlayPanelClass})}_getOverlayPosition(){const j=this._overlay.position().flexibleConnectedTo(this._getConnectedElement()).withFlexibleDimensions(!1).withPush(!1);return this._setStrategyPositions(j),this._positionStrategy=j,j}_setStrategyPositions(j){const he=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],De=this._aboveClass,Mt=[{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:De},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:De}];let it;it="above"===this.position?Mt:"below"===this.position?he:[...he,...Mt],j.withPositions(it)}_getConnectedElement(){return this.connectedTo?this.connectedTo.elementRef:this._formField?this._formField.getConnectedOverlayOrigin():this._element}_getPanelWidth(){return this.autocomplete.panelWidth||this._getHostWidth()}_getHostWidth(){return this._getConnectedElement().nativeElement.getBoundingClientRect().width}_resetActiveItem(){const j=this.autocomplete;if(j.autoActiveFirstOption){let he=-1;for(let De=0;De<j.options.length;De++)if(!j.options.get(De).disabled){he=De;break}j._keyManager.setActiveItem(he)}else j._keyManager.setActiveItem(-1)}_canOpen(){const j=this._element.nativeElement;return!j.readOnly&&!j.disabled&&!this._autocompleteDisabled}_getWindow(){return this._document?.defaultView||window}_scrollToOption(j){const he=this.autocomplete,De=(0,A.CB)(j,he.options,he.optionGroups);if(0===j&&1===De)he._setScrollTop(0);else if(he.panel){const Mt=he.options.toArray()[j];if(Mt){const it=Mt._getHostElement(),Ln=(0,A.jH)(it.offsetTop,it.offsetHeight,he._getScrollTop(),he.panel.nativeElement.offsetHeight);he._setScrollTop(Ln)}}}_applyModalPanelOwnership(){const j=this._element.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!j)return;const he=this.autocomplete.id;this._trackedModal&&(0,Li.iD)(this._trackedModal,"aria-owns",he),(0,Li.Zf)(j,"aria-owns",he),this._trackedModal=j}_clearFromModal(){this._trackedModal&&((0,Li.iD)(this._trackedModal,"aria-owns",this.autocomplete.id),this._trackedModal=null)}static#e=this.\u0275fac=function(he){return new(he||dt)(x.Y36(x.SBq),x.Y36(R.aV),x.Y36(x.s_b),x.Y36(x.R0b),x.Y36(x.sBO),x.Y36(fs),x.Y36(jt.Is,8),x.Y36(Ht.G_,9),x.Y36(ke.K0,8),x.Y36(d.rL),x.Y36(Os,8))};static#t=this.\u0275dir=x.lG2({type:dt,inputs:{autocomplete:["matAutocomplete","autocomplete"],position:["matAutocompletePosition","position"],connectedTo:["matAutocompleteConnectedTo","connectedTo"],autocompleteAttribute:["autocomplete","autocompleteAttribute"],autocompleteDisabled:["matAutocompleteDisabled","autocompleteDisabled"]},features:[x.TTD]})}return dt})(),Tn=(()=>{class dt extends is{constructor(){super(...arguments),this._aboveClass="mat-mdc-autocomplete-panel-above"}static#e=this.\u0275fac=function(){let j;return function(De){return(j||(j=x.n5z(dt)))(De||dt)}}();static#t=this.\u0275dir=x.lG2({type:dt,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-mdc-autocomplete-trigger"],hostVars:7,hostBindings:function(he,De){1&he&&x.NdJ("focusin",function(){return De._handleFocus()})("blur",function(){return De._onTouched()})("input",function(it){return De._handleInput(it)})("keydown",function(it){return De._handleKeydown(it)})("click",function(){return De._handleClick()}),2&he&&x.uIk("autocomplete",De.autocompleteAttribute)("role",De.autocompleteDisabled?null:"combobox")("aria-autocomplete",De.autocompleteDisabled?null:"list")("aria-activedescendant",De.panelOpen&&De.activeOption?De.activeOption.id:null)("aria-expanded",De.autocompleteDisabled?null:De.panelOpen.toString())("aria-controls",De.autocompleteDisabled||!De.panelOpen||null==De.autocomplete?null:De.autocomplete.id)("aria-haspopup",De.autocompleteDisabled?null:"listbox")},exportAs:["matAutocompleteTrigger"],features:[x._Bn([Vi]),x.qOj]})}return dt})(),Sn=(()=>{class dt{static#e=this.\u0275fac=function(he){return new(he||dt)};static#t=this.\u0275mod=x.oAB({type:dt});static#i=this.\u0275inj=x.cJS({providers:[gi],imports:[R.U8,A.Ng,A.BQ,ke.ez,d.ZD,A.Ng,A.BQ]})}return dt})()},7132:(ot,zt,V)=>{"use strict";V.d(zt,{HS:()=>Tn,Hi:()=>ht});var x=V(2561),A=V(755),ke=V(6733),d=V(4220),R=V(7583),Li=V(8748),Qi=V(5047),mi=V(1813),Bt=(V(1749),V(3843),V(4787),V(5262));function Vt(Ae,Lt){1&Ae&&(A.TgZ(0,"span",7),A.Hsn(1,1),A.qZA())}function Pi(Ae,Lt){1&Ae&&(A.TgZ(0,"span",8),A.Hsn(1,2),A.qZA())}V(5667),V(3226),V(6125);const Fi=["*",[["mat-chip-avatar"],["","matChipAvatar",""]],[["mat-chip-trailing-icon"],["","matChipRemove",""],["","matChipTrailingIcon",""]]],Ht=["*","mat-chip-avatar, [matChipAvatar]","mat-chip-trailing-icon,[matChipRemove],[matChipTrailingIcon]"],ps=new A.OlP("mat-chips-default-options"),Os=new A.OlP("MatChipAvatar"),Rs=new A.OlP("MatChipTrailingIcon"),cs=new A.OlP("MatChipRemove"),pn=new A.OlP("MatChip");class fn{}const jn=(0,d.sb)(fn,-1);let Vi=(()=>{class Ae extends jn{get disabled(){return this._disabled||this._parentChip.disabled}set disabled(Y){this._disabled=(0,x.Ig)(Y)}_getDisabledAttribute(){return this.disabled&&!this._allowFocusWhenDisabled?"":null}_getTabindex(){return this.disabled&&!this._allowFocusWhenDisabled||!this.isInteractive?null:this.tabIndex.toString()}constructor(Y,be){super(),this._elementRef=Y,this._parentChip=be,this.isInteractive=!0,this._isPrimary=!0,this._disabled=!1,this._allowFocusWhenDisabled=!1,"BUTTON"===Y.nativeElement.nodeName&&Y.nativeElement.setAttribute("type","button")}focus(){this._elementRef.nativeElement.focus()}_handleClick(Y){!this.disabled&&this.isInteractive&&this._isPrimary&&(Y.preventDefault(),this._parentChip._handlePrimaryActionInteraction())}_handleKeydown(Y){(Y.keyCode===Bt.K5||Y.keyCode===Bt.L_)&&!this.disabled&&this.isInteractive&&this._isPrimary&&!this._parentChip._isEditing&&(Y.preventDefault(),this._parentChip._handlePrimaryActionInteraction())}static#e=this.\u0275fac=function(be){return new(be||Ae)(A.Y36(A.SBq),A.Y36(pn))};static#t=this.\u0275dir=A.lG2({type:Ae,selectors:[["","matChipAction",""]],hostAttrs:[1,"mdc-evolution-chip__action","mat-mdc-chip-action"],hostVars:9,hostBindings:function(be,fe){1&be&&A.NdJ("click",function(Tt){return fe._handleClick(Tt)})("keydown",function(Tt){return fe._handleKeydown(Tt)}),2&be&&(A.uIk("tabindex",fe._getTabindex())("disabled",fe._getDisabledAttribute())("aria-disabled",fe.disabled),A.ekj("mdc-evolution-chip__action--primary",fe._isPrimary)("mdc-evolution-chip__action--presentational",!fe.isInteractive)("mdc-evolution-chip__action--trailing",!fe._isPrimary))},inputs:{disabled:"disabled",tabIndex:"tabIndex",isInteractive:"isInteractive",_allowFocusWhenDisabled:"_allowFocusWhenDisabled"},features:[A.qOj]})}return Ae})(),gi=0;const is=(0,d.sb)((0,d.pj)((0,d.Kr)((0,d.Id)(class{constructor(Ae){this._elementRef=Ae}})),"primary"),-1);let Tn=(()=>{class Ae extends is{_hasFocus(){return this._hasFocusInternal}get value(){return void 0!==this._value?this._value:this._textElement.textContent.trim()}set value(Y){this._value=Y}get removable(){return this._removable}set removable(Y){this._removable=(0,x.Ig)(Y)}get highlighted(){return this._highlighted}set highlighted(Y){this._highlighted=(0,x.Ig)(Y)}get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(Y){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,Y)}constructor(Y,be,fe,St,Tt,xi,Hn,Wi){super(be),this._changeDetectorRef=Y,this._ngZone=fe,this._focusMonitor=St,this._globalRippleOptions=Hn,this._onFocus=new Li.x,this._onBlur=new Li.x,this.role=null,this._hasFocusInternal=!1,this.id="mat-mdc-chip-"+gi++,this.ariaLabel=null,this.ariaDescription=null,this._ariaDescriptionId=`${this.id}-aria-description`,this._removable=!0,this._highlighted=!1,this.removed=new A.vpe,this.destroyed=new A.vpe,this.basicChipAttrName="mat-basic-chip",this._rippleLoader=(0,A.f3M)(d.Fq),this._document=Tt,this._animationsDisabled="NoopAnimations"===xi,null!=Wi&&(this.tabIndex=parseInt(Wi)??this.defaultTabIndex),this._monitorFocus(),this._rippleLoader?.configureRipple(this._elementRef.nativeElement,{className:"mat-mdc-chip-ripple",disabled:this._isRippleDisabled()})}ngOnInit(){const Y=this._elementRef.nativeElement;this._isBasicChip=Y.hasAttribute(this.basicChipAttrName)||Y.tagName.toLowerCase()===this.basicChipAttrName}ngAfterViewInit(){this._textElement=this._elementRef.nativeElement.querySelector(".mat-mdc-chip-action-label"),this._pendingFocus&&(this._pendingFocus=!1,this.focus())}ngAfterContentInit(){this._actionChanges=(0,Qi.T)(this._allLeadingIcons.changes,this._allTrailingIcons.changes,this._allRemoveIcons.changes).subscribe(()=>this._changeDetectorRef.markForCheck())}ngDoCheck(){this._rippleLoader.setDisabled(this._elementRef.nativeElement,this._isRippleDisabled())}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._actionChanges?.unsubscribe(),this.destroyed.emit({chip:this}),this.destroyed.complete()}remove(){this.removable&&this.removed.emit({chip:this})}_isRippleDisabled(){return this.disabled||this.disableRipple||this._animationsDisabled||this._isBasicChip||!!this._globalRippleOptions?.disabled}_hasTrailingIcon(){return!(!this.trailingIcon&&!this.removeIcon)}_handleKeydown(Y){(Y.keyCode===Bt.ZH||Y.keyCode===Bt.yY)&&(Y.preventDefault(),this.remove())}focus(){this.disabled||(this.primaryAction?this.primaryAction.focus():this._pendingFocus=!0)}_getSourceAction(Y){return this._getActions().find(be=>{const fe=be._elementRef.nativeElement;return fe===Y||fe.contains(Y)})}_getActions(){const Y=[];return this.primaryAction&&Y.push(this.primaryAction),this.removeIcon&&Y.push(this.removeIcon),this.trailingIcon&&Y.push(this.trailingIcon),Y}_handlePrimaryActionInteraction(){}_monitorFocus(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(Y=>{const be=null!==Y;be!==this._hasFocusInternal&&(this._hasFocusInternal=be,be?this._onFocus.next({chip:this}):this._ngZone.onStable.pipe((0,mi.q)(1)).subscribe(()=>this._ngZone.run(()=>this._onBlur.next({chip:this}))))})}static#e=this.\u0275fac=function(be){return new(be||Ae)(A.Y36(A.sBO),A.Y36(A.SBq),A.Y36(A.R0b),A.Y36(R.tE),A.Y36(ke.K0),A.Y36(A.QbO,8),A.Y36(d.Y2,8),A.$8M("tabindex"))};static#t=this.\u0275cmp=A.Xpm({type:Ae,selectors:[["mat-basic-chip"],["","mat-basic-chip",""],["mat-chip"],["","mat-chip",""]],contentQueries:function(be,fe,St){if(1&be&&(A.Suo(St,Os,5),A.Suo(St,Rs,5),A.Suo(St,cs,5),A.Suo(St,Os,5),A.Suo(St,Rs,5),A.Suo(St,cs,5)),2&be){let Tt;A.iGM(Tt=A.CRH())&&(fe.leadingIcon=Tt.first),A.iGM(Tt=A.CRH())&&(fe.trailingIcon=Tt.first),A.iGM(Tt=A.CRH())&&(fe.removeIcon=Tt.first),A.iGM(Tt=A.CRH())&&(fe._allLeadingIcons=Tt),A.iGM(Tt=A.CRH())&&(fe._allTrailingIcons=Tt),A.iGM(Tt=A.CRH())&&(fe._allRemoveIcons=Tt)}},viewQuery:function(be,fe){if(1&be&&A.Gf(Vi,5),2&be){let St;A.iGM(St=A.CRH())&&(fe.primaryAction=St.first)}},hostAttrs:[1,"mat-mdc-chip"],hostVars:30,hostBindings:function(be,fe){1&be&&A.NdJ("keydown",function(Tt){return fe._handleKeydown(Tt)}),2&be&&(A.Ikx("id",fe.id),A.uIk("role",fe.role)("tabindex",fe.role?fe.tabIndex:null)("aria-label",fe.ariaLabel),A.ekj("mdc-evolution-chip",!fe._isBasicChip)("mdc-evolution-chip--disabled",fe.disabled)("mdc-evolution-chip--with-trailing-action",fe._hasTrailingIcon())("mdc-evolution-chip--with-primary-graphic",fe.leadingIcon)("mdc-evolution-chip--with-primary-icon",fe.leadingIcon)("mdc-evolution-chip--with-avatar",fe.leadingIcon)("mat-mdc-chip-with-avatar",fe.leadingIcon)("mat-mdc-chip-highlighted",fe.highlighted)("mat-mdc-chip-disabled",fe.disabled)("mat-mdc-basic-chip",fe._isBasicChip)("mat-mdc-standard-chip",!fe._isBasicChip)("mat-mdc-chip-with-trailing-icon",fe._hasTrailingIcon())("_mat-animation-noopable",fe._animationsDisabled))},inputs:{color:"color",disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex",role:"role",id:"id",ariaLabel:["aria-label","ariaLabel"],ariaDescription:["aria-description","ariaDescription"],value:"value",removable:"removable",highlighted:"highlighted"},outputs:{removed:"removed",destroyed:"destroyed"},exportAs:["matChip"],features:[A._Bn([{provide:pn,useExisting:Ae}]),A.qOj],ngContentSelectors:Ht,decls:8,vars:3,consts:[[1,"mat-mdc-chip-focus-overlay"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--primary"],["matChipAction","",3,"isInteractive"],["class","mdc-evolution-chip__graphic mat-mdc-chip-graphic",4,"ngIf"],[1,"mdc-evolution-chip__text-label","mat-mdc-chip-action-label"],[1,"mat-mdc-chip-primary-focus-indicator","mat-mdc-focus-indicator"],["class","mdc-evolution-chip__cell mdc-evolution-chip__cell--trailing",4,"ngIf"],[1,"mdc-evolution-chip__graphic","mat-mdc-chip-graphic"],[1,"mdc-evolution-chip__cell","mdc-evolution-chip__cell--trailing"]],template:function(be,fe){1&be&&(A.F$t(Fi),A._UZ(0,"span",0),A.TgZ(1,"span",1)(2,"span",2),A.YNc(3,Vt,2,0,"span",3),A.TgZ(4,"span",4),A.Hsn(5),A._UZ(6,"span",5),A.qZA()()(),A.YNc(7,Pi,2,0,"span",6)),2&be&&(A.xp6(2),A.Q6J("isInteractive",!1),A.xp6(1),A.Q6J("ngIf",fe.leadingIcon),A.xp6(4),A.Q6J("ngIf",fe._hasTrailingIcon()))},dependencies:[ke.O5,Vi],styles:['.mdc-evolution-chip,.mdc-evolution-chip__cell,.mdc-evolution-chip__action{display:inline-flex;align-items:center}.mdc-evolution-chip{position:relative;max-width:100%}.mdc-evolution-chip .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-evolution-chip__cell,.mdc-evolution-chip__action{height:100%}.mdc-evolution-chip__cell--primary{overflow-x:hidden}.mdc-evolution-chip__cell--trailing{flex:1 0 auto}.mdc-evolution-chip__action{align-items:center;background:none;border:none;box-sizing:content-box;cursor:pointer;display:inline-flex;justify-content:center;outline:none;padding:0;text-decoration:none;color:inherit}.mdc-evolution-chip__action--presentational{cursor:auto}.mdc-evolution-chip--disabled,.mdc-evolution-chip__action:disabled{pointer-events:none}.mdc-evolution-chip__action--primary{overflow-x:hidden}.mdc-evolution-chip__action--trailing{position:relative;overflow:visible}.mdc-evolution-chip__action--primary:before{box-sizing:border-box;content:"";height:100%;left:0;position:absolute;pointer-events:none;top:0;width:100%;z-index:1}.mdc-evolution-chip--touch{margin-top:8px;margin-bottom:8px}.mdc-evolution-chip__action-touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-evolution-chip__text-label{white-space:nowrap;user-select:none;text-overflow:ellipsis;overflow:hidden}.mdc-evolution-chip__graphic{align-items:center;display:inline-flex;justify-content:center;overflow:hidden;pointer-events:none;position:relative;flex:1 0 auto}.mdc-evolution-chip__checkmark{position:absolute;opacity:0;top:50%;left:50%}.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--selected):not(.mdc-evolution-chip--with-primary-icon) .mdc-evolution-chip__graphic{width:0}.mdc-evolution-chip__checkmark-background{opacity:0}.mdc-evolution-chip__checkmark-svg{display:block}.mdc-evolution-chip__checkmark-path{stroke-width:2px;stroke-dasharray:29.7833385;stroke-dashoffset:29.7833385;stroke:currentColor}.mdc-evolution-chip--selecting .mdc-evolution-chip__graphic{transition:width 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark{transition:transform 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-75%, -50%)}.mdc-evolution-chip--selecting .mdc-evolution-chip__checkmark-path{transition:stroke-dashoffset 150ms 45ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__graphic{transition:width 100ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__checkmark{transition:opacity 50ms 0ms linear,transform 100ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-75%, -50%)}.mdc-evolution-chip--deselecting .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}.mdc-evolution-chip--selecting-with-primary-icon .mdc-evolution-chip__icon--primary{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--selecting-with-primary-icon .mdc-evolution-chip__checkmark-path{transition:stroke-dashoffset 150ms 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__icon--primary{transition:opacity 150ms 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__checkmark{transition:opacity 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);transform:translate(-50%, -50%)}.mdc-evolution-chip--deselecting-with-primary-icon .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}.mdc-evolution-chip--selected .mdc-evolution-chip__icon--primary{opacity:0}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark{transform:translate(-50%, -50%);opacity:1}.mdc-evolution-chip--selected .mdc-evolution-chip__checkmark-path{stroke-dashoffset:0}@keyframes mdc-evolution-chip-enter{from{transform:scale(0.8);opacity:.4}to{transform:scale(1);opacity:1}}.mdc-evolution-chip--enter{animation:mdc-evolution-chip-enter 100ms 0ms cubic-bezier(0, 0, 0.2, 1)}@keyframes mdc-evolution-chip-exit{from{opacity:1}to{opacity:0}}.mdc-evolution-chip--exit{animation:mdc-evolution-chip-exit 75ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-evolution-chip--hidden{opacity:0;pointer-events:none;transition:width 150ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mat-mdc-standard-chip{border-radius:var(--mdc-chip-container-shape-radius);height:var(--mdc-chip-container-height);--mdc-chip-container-shape-family:rounded;--mdc-chip-container-shape-radius:16px 16px 16px 16px;--mdc-chip-with-avatar-avatar-shape-family:rounded;--mdc-chip-with-avatar-avatar-shape-radius:14px 14px 14px 14px;--mdc-chip-with-avatar-avatar-size:28px;--mdc-chip-with-icon-icon-size:18px}.mat-mdc-standard-chip .mdc-evolution-chip__ripple{border-radius:var(--mdc-chip-container-shape-radius)}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary:before{border-radius:var(--mdc-chip-container-shape-radius)}.mat-mdc-standard-chip .mdc-evolution-chip__icon--primary{border-radius:var(--mdc-chip-with-avatar-avatar-shape-radius)}.mat-mdc-standard-chip.mdc-evolution-chip--selectable:not(.mdc-evolution-chip--with-primary-icon){--mdc-chip-graphic-selected-width:var(--mdc-chip-with-avatar-avatar-size)}.mat-mdc-standard-chip .mdc-evolution-chip__graphic{height:var(--mdc-chip-with-avatar-avatar-size);width:var(--mdc-chip-with-avatar-avatar-size);font-size:var(--mdc-chip-with-avatar-avatar-size)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled){background-color:var(--mdc-chip-elevated-container-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-elevated-disabled-container-color)}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled{background-color:var(--mdc-chip-elevated-disabled-container-color)}.mat-mdc-standard-chip .mdc-evolution-chip__text-label{font-family:var(--mdc-chip-label-text-font);line-height:var(--mdc-chip-label-text-line-height);font-size:var(--mdc-chip-label-text-size);font-weight:var(--mdc-chip-label-text-weight);letter-spacing:var(--mdc-chip-label-text-tracking)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__text-label{color:var(--mdc-chip-label-text-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label{color:var(--mdc-chip-disabled-label-text-color)}.mat-mdc-standard-chip.mdc-evolution-chip--selected.mdc-evolution-chip--disabled .mdc-evolution-chip__text-label{color:var(--mdc-chip-disabled-label-text-color)}.mat-mdc-standard-chip .mdc-evolution-chip__icon--primary{height:var(--mdc-chip-with-icon-icon-size);width:var(--mdc-chip-with-icon-icon-size);font-size:var(--mdc-chip-with-icon-icon-size)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-icon-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--primary{color:var(--mdc-chip-with-icon-disabled-icon-color)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-selected-icon-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-disabled-icon-color)}.mat-mdc-standard-chip:not(.mdc-evolution-chip--disabled) .mdc-evolution-chip__icon--trailing{color:var(--mdc-chip-with-trailing-icon-trailing-icon-color)}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__icon--trailing{color:var(--mdc-chip-with-trailing-icon-disabled-trailing-icon-color)}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary.mdc-ripple-upgraded--background-focused .mdc-evolution-chip__ripple::before,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary:not(.mdc-ripple-upgraded):focus .mdc-evolution-chip__ripple::before{transition-duration:75ms;opacity:var(--mdc-chip-focus-state-layer-opacity)}.mat-mdc-chip-focus-overlay{background:var(--mdc-chip-focus-state-layer-color);opacity:var(--mdc-chip-focus-state-layer-opacity)}.mat-mdc-standard-chip .mdc-evolution-chip__checkmark{height:20px;width:20px}.mat-mdc-standard-chip .mdc-evolution-chip__icon--trailing{height:18px;width:18px;font-size:18px}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:12px}[dir=rtl] .mat-mdc-standard-chip .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic[dir=rtl]{padding-left:6px;padding-right:6px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:0}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:12px;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:12px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:6px;padding-right:6px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic[dir=rtl]{padding-left:6px;padding-right:6px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:0}.mat-mdc-standard-chip.mdc-evolution-chip--disabled .mdc-evolution-chip__checkmark{color:var(--mdc-chip-with-icon-selected-icon-color, currentColor)}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__graphic[dir=rtl]{padding-left:8px;padding-right:4px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary{padding-left:0;padding-right:12px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:12px;padding-right:0}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic{padding-left:4px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__graphic[dir=rtl]{padding-left:8px;padding-right:4px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing{padding-left:8px;padding-right:8px}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--trailing[dir=rtl]{padding-left:8px;padding-right:8px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing{left:8px;right:initial}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__ripple--trailing[dir=rtl]{left:initial;right:8px}.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0;padding-right:0}[dir=rtl] .mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary,.mdc-evolution-chip--with-avatar.mdc-evolution-chip--with-primary-graphic.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary[dir=rtl]{padding-left:0;padding-right:0}.mat-mdc-standard-chip{-webkit-tap-highlight-color:rgba(0,0,0,0)}.cdk-high-contrast-active .mat-mdc-standard-chip{outline:solid 1px}.cdk-high-contrast-active .mat-mdc-standard-chip .mdc-evolution-chip__checkmark-path{stroke:CanvasText !important}.mat-mdc-standard-chip.mdc-evolution-chip--disabled{opacity:.4}.mat-mdc-standard-chip .mdc-evolution-chip__cell--primary,.mat-mdc-standard-chip .mdc-evolution-chip__action--primary,.mat-mdc-standard-chip .mat-mdc-chip-action-label{overflow:visible}.mat-mdc-standard-chip .mdc-evolution-chip__cell--primary{flex-basis:100%}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary{font:inherit;letter-spacing:inherit;white-space:inherit}.mat-mdc-standard-chip .mat-mdc-chip-graphic,.mat-mdc-standard-chip .mat-mdc-chip-trailing-icon{box-sizing:content-box}.mat-mdc-standard-chip._mat-animation-noopable,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__graphic,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark,.mat-mdc-standard-chip._mat-animation-noopable .mdc-evolution-chip__checkmark-path{transition-duration:1ms;animation-duration:1ms}.mat-mdc-basic-chip .mdc-evolution-chip__action--primary{font:inherit}.mat-mdc-chip-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;opacity:0;border-radius:inherit;transition:opacity 150ms linear}._mat-animation-noopable .mat-mdc-chip-focus-overlay{transition:none}.mat-mdc-basic-chip .mat-mdc-chip-focus-overlay{display:none}.mat-mdc-chip:hover .mat-mdc-chip-focus-overlay{opacity:.04}.mat-mdc-chip.cdk-focused .mat-mdc-chip-focus-overlay{opacity:.12}.mat-mdc-chip .mat-ripple.mat-mdc-chip-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-chip-avatar{text-align:center;line-height:1;color:var(--mdc-chip-with-icon-icon-color, currentColor)}.mat-mdc-chip{position:relative;z-index:0}.mat-mdc-chip-action-label{text-align:left;z-index:1}[dir=rtl] .mat-mdc-chip-action-label{text-align:right}.mat-mdc-chip.mdc-evolution-chip--with-trailing-action .mat-mdc-chip-action-label{position:relative}.mat-mdc-chip-action-label .mat-mdc-chip-primary-focus-indicator{position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none}.mat-mdc-chip-action-label .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-chip-remove{opacity:.54}.mat-mdc-chip-remove:focus{opacity:1}.mat-mdc-chip-remove::before{margin:calc(var(--mat-mdc-focus-indicator-border-width, 3px) * -1);left:8px;right:8px}.mat-mdc-chip-remove .mat-icon{width:inherit;height:inherit;font-size:inherit;box-sizing:content-box}.mat-chip-edit-input{cursor:text;display:inline-block;color:inherit;outline:0}.cdk-high-contrast-active .mat-mdc-chip-selected:not(.mat-mdc-chip-multiple){outline-width:3px}.mat-mdc-chip-action:focus .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}return Ae})(),ht=(()=>{class Ae{static#e=this.\u0275fac=function(be){return new(be||Ae)};static#t=this.\u0275mod=A.oAB({type:Ae});static#i=this.\u0275inj=A.cJS({providers:[d.rD,{provide:ps,useValue:{separatorKeyCodes:[Bt.K5]}}],imports:[d.BQ,ke.ez,d.si,d.BQ]})}return Ae})()},7812:(ot,zt,V)=>{"use strict";V.d(zt,{FA:()=>Gi,Mq:()=>ya,Q0:()=>Ba,hl:()=>wa,nW:()=>Io});var x=V(7583),A=V(8146),ke=V(6785),d=V(6733),R=V(755),Li=V(393),Qi=V(3753),mi=V(4220),$t=V(8748),Zi=V(902),Hi=V(5047),Bt=V(1209),tt=V(5262),Ve=V(5667),Nt=V(8491),Vt=V(1813),Pi=V(3843),Fi=V(5333),Ht=V(2561),si=V(2405),Je=V(3226),pi=V(6125),ni=V(5735);const Mn=["mat-calendar-body",""];function ls(ce,bt){if(1&ce&&(R.TgZ(0,"tr",3)(1,"td",4),R._uU(2),R.qZA()()),2&ce){const D=R.oxw();R.xp6(1),R.Udp("padding-top",D._cellPadding)("padding-bottom",D._cellPadding),R.uIk("colspan",D.numCols),R.xp6(1),R.hij(" ",D.label," ")}}function ir(ce,bt){if(1&ce&&(R.TgZ(0,"td",4),R._uU(1),R.qZA()),2&ce){const D=R.oxw(2);R.Udp("padding-top",D._cellPadding)("padding-bottom",D._cellPadding),R.uIk("colspan",D._firstRowOffset),R.xp6(1),R.hij(" ",D._firstRowOffset>=D.labelMinRequiredCells?D.label:""," ")}}function jt(ce,bt){if(1&ce){const D=R.EpF();R.TgZ(0,"td",8)(1,"button",9),R.NdJ("click",function(F){const Ee=R.CHM(D).$implicit,Ot=R.oxw(2);return R.KtG(Ot._cellClicked(Ee,F))})("focus",function(F){const Ee=R.CHM(D).$implicit,Ot=R.oxw(2);return R.KtG(Ot._emitActiveDateChange(Ee,F))}),R.TgZ(2,"span",10),R._uU(3),R.qZA(),R._UZ(4,"span",11),R.qZA()()}if(2&ce){const D=bt.$implicit,U=bt.index,F=R.oxw().index,X=R.oxw();R.Udp("width",X._cellWidth)("padding-top",X._cellPadding)("padding-bottom",X._cellPadding),R.uIk("data-mat-row",F)("data-mat-col",U),R.xp6(1),R.ekj("mat-calendar-body-disabled",!D.enabled)("mat-calendar-body-active",X._isActiveCell(F,U))("mat-calendar-body-range-start",X._isRangeStart(D.compareValue))("mat-calendar-body-range-end",X._isRangeEnd(D.compareValue))("mat-calendar-body-in-range",X._isInRange(D.compareValue))("mat-calendar-body-comparison-bridge-start",X._isComparisonBridgeStart(D.compareValue,F,U))("mat-calendar-body-comparison-bridge-end",X._isComparisonBridgeEnd(D.compareValue,F,U))("mat-calendar-body-comparison-start",X._isComparisonStart(D.compareValue))("mat-calendar-body-comparison-end",X._isComparisonEnd(D.compareValue))("mat-calendar-body-in-comparison-range",X._isInComparisonRange(D.compareValue))("mat-calendar-body-preview-start",X._isPreviewStart(D.compareValue))("mat-calendar-body-preview-end",X._isPreviewEnd(D.compareValue))("mat-calendar-body-in-preview",X._isInPreview(D.compareValue)),R.Q6J("ngClass",D.cssClasses)("tabindex",X._isActiveCell(F,U)?0:-1),R.uIk("aria-label",D.ariaLabel)("aria-disabled",!D.enabled||null)("aria-pressed",X._isSelected(D.compareValue))("aria-current",X.todayValue===D.compareValue?"date":null)("aria-describedby",X._getDescribedby(D.compareValue)),R.xp6(1),R.ekj("mat-calendar-body-selected",X._isSelected(D.compareValue))("mat-calendar-body-comparison-identical",X._isComparisonIdentical(D.compareValue))("mat-calendar-body-today",X.todayValue===D.compareValue),R.xp6(1),R.hij(" ",D.displayValue," ")}}function zn(ce,bt){if(1&ce&&(R.TgZ(0,"tr",5),R.YNc(1,ir,2,6,"td",6),R.YNc(2,jt,5,48,"td",7),R.qZA()),2&ce){const D=bt.$implicit,U=bt.index,F=R.oxw();R.xp6(1),R.Q6J("ngIf",0===U&&F._firstRowOffset),R.xp6(1),R.Q6J("ngForOf",D)}}function ut(ce,bt){if(1&ce&&(R.TgZ(0,"th",5)(1,"span",6),R._uU(2),R.qZA(),R.TgZ(3,"span",7),R._uU(4),R.qZA()()),2&ce){const D=bt.$implicit;R.xp6(2),R.Oqu(D.long),R.xp6(2),R.Oqu(D.narrow)}}const yi=["*"];function Qt(ce,bt){}function Bi(ce,bt){if(1&ce){const D=R.EpF();R.TgZ(0,"mat-month-view",5),R.NdJ("activeDateChange",function(F){R.CHM(D);const X=R.oxw();return R.KtG(X.activeDate=F)})("_userSelection",function(F){R.CHM(D);const X=R.oxw();return R.KtG(X._dateSelected(F))})("dragStarted",function(F){R.CHM(D);const X=R.oxw();return R.KtG(X._dragStarted(F))})("dragEnded",function(F){R.CHM(D);const X=R.oxw();return R.KtG(X._dragEnded(F))}),R.qZA()}if(2&ce){const D=R.oxw();R.Q6J("activeDate",D.activeDate)("selected",D.selected)("dateFilter",D.dateFilter)("maxDate",D.maxDate)("minDate",D.minDate)("dateClass",D.dateClass)("comparisonStart",D.comparisonStart)("comparisonEnd",D.comparisonEnd)("startDateAccessibleName",D.startDateAccessibleName)("endDateAccessibleName",D.endDateAccessibleName)("activeDrag",D._activeDrag)}}function ts(ce,bt){if(1&ce){const D=R.EpF();R.TgZ(0,"mat-year-view",6),R.NdJ("activeDateChange",function(F){R.CHM(D);const X=R.oxw();return R.KtG(X.activeDate=F)})("monthSelected",function(F){R.CHM(D);const X=R.oxw();return R.KtG(X._monthSelectedInYearView(F))})("selectedChange",function(F){R.CHM(D);const X=R.oxw();return R.KtG(X._goToDateInView(F,"month"))}),R.qZA()}if(2&ce){const D=R.oxw();R.Q6J("activeDate",D.activeDate)("selected",D.selected)("dateFilter",D.dateFilter)("maxDate",D.maxDate)("minDate",D.minDate)("dateClass",D.dateClass)}}function ps(ce,bt){if(1&ce){const D=R.EpF();R.TgZ(0,"mat-multi-year-view",7),R.NdJ("activeDateChange",function(F){R.CHM(D);const X=R.oxw();return R.KtG(X.activeDate=F)})("yearSelected",function(F){R.CHM(D);const X=R.oxw();return R.KtG(X._yearSelectedInMultiYearView(F))})("selectedChange",function(F){R.CHM(D);const X=R.oxw();return R.KtG(X._goToDateInView(F,"year"))}),R.qZA()}if(2&ce){const D=R.oxw();R.Q6J("activeDate",D.activeDate)("selected",D.selected)("dateFilter",D.dateFilter)("maxDate",D.maxDate)("minDate",D.minDate)("dateClass",D.dateClass)}}function Os(ce,bt){}const Rs=["button"];function cs(ce,bt){1&ce&&(R.O4$(),R.TgZ(0,"svg",3),R._UZ(1,"path",4),R.qZA())}const pn=[[["","matDatepickerToggleIcon",""]]],fn=["[matDatepickerToggleIcon]"];let bn=(()=>{class ce{constructor(){this.changes=new $t.x,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.closeCalendarLabel="Close calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 24 years",this.nextMultiYearLabel="Next 24 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year",this.startDateLabel="Start date",this.endDateLabel="End date"}formatYearRange(D,U){return`${D} \u2013 ${U}`}formatYearRangeLabel(D,U){return`${D} to ${U}`}static#e=this.\u0275fac=function(U){return new(U||ce)};static#t=this.\u0275prov=R.Yz7({token:ce,factory:ce.\u0275fac,providedIn:"root"})}return ce})();class gi{constructor(bt,D,U,F,X={},Ee=bt,Ot){this.value=bt,this.displayValue=D,this.ariaLabel=U,this.enabled=F,this.cssClasses=X,this.compareValue=Ee,this.rawValue=Ot}}let is=1;const Tn=(0,Nt.i$)({passive:!1,capture:!0}),Sn=(0,Nt.i$)({passive:!0,capture:!0}),dt=(0,Nt.i$)({passive:!0});let Ni=(()=>{class ce{ngAfterViewChecked(){this._focusActiveCellAfterViewChecked&&(this._focusActiveCell(),this._focusActiveCellAfterViewChecked=!1)}constructor(D,U){this._elementRef=D,this._ngZone=U,this._platform=(0,R.f3M)(Nt.t4),this._focusActiveCellAfterViewChecked=!1,this.numCols=7,this.activeCell=0,this.isRange=!1,this.cellAspectRatio=1,this.previewStart=null,this.previewEnd=null,this.selectedValueChange=new R.vpe,this.previewChange=new R.vpe,this.activeDateChange=new R.vpe,this.dragStarted=new R.vpe,this.dragEnded=new R.vpe,this._didDragSinceMouseDown=!1,this._enterHandler=F=>{if(this._skipNextFocus&&"focus"===F.type)this._skipNextFocus=!1;else if(F.target&&this.isRange){const X=this._getCellFromElement(F.target);X&&this._ngZone.run(()=>this.previewChange.emit({value:X.enabled?X:null,event:F}))}},this._touchmoveHandler=F=>{if(!this.isRange)return;const X=Ln(F),Ee=X?this._getCellFromElement(X):null;X!==F.target&&(this._didDragSinceMouseDown=!0),he(F.target)&&F.preventDefault(),this._ngZone.run(()=>this.previewChange.emit({value:Ee?.enabled?Ee:null,event:F}))},this._leaveHandler=F=>{null!==this.previewEnd&&this.isRange&&("blur"!==F.type&&(this._didDragSinceMouseDown=!0),F.target&&this._getCellFromElement(F.target)&&(!F.relatedTarget||!this._getCellFromElement(F.relatedTarget))&&this._ngZone.run(()=>this.previewChange.emit({value:null,event:F})))},this._mousedownHandler=F=>{if(!this.isRange)return;this._didDragSinceMouseDown=!1;const X=F.target&&this._getCellFromElement(F.target);!X||!this._isInRange(X.rawValue)||this._ngZone.run(()=>{this.dragStarted.emit({value:X.rawValue,event:F})})},this._mouseupHandler=F=>{if(!this.isRange)return;const X=he(F.target);X?X.closest(".mat-calendar-body")===this._elementRef.nativeElement&&this._ngZone.run(()=>{const Ee=this._getCellFromElement(X);this.dragEnded.emit({value:Ee?.rawValue??null,event:F})}):this._ngZone.run(()=>{this.dragEnded.emit({value:null,event:F})})},this._touchendHandler=F=>{const X=Ln(F);X&&this._mouseupHandler({target:X})},this._id="mat-calendar-body-"+is++,this._startDateLabelId=`${this._id}-start-date`,this._endDateLabelId=`${this._id}-end-date`,U.runOutsideAngular(()=>{const F=D.nativeElement;F.addEventListener("touchmove",this._touchmoveHandler,Tn),F.addEventListener("mouseenter",this._enterHandler,Sn),F.addEventListener("focus",this._enterHandler,Sn),F.addEventListener("mouseleave",this._leaveHandler,Sn),F.addEventListener("blur",this._leaveHandler,Sn),F.addEventListener("mousedown",this._mousedownHandler,dt),F.addEventListener("touchstart",this._mousedownHandler,dt),this._platform.isBrowser&&(window.addEventListener("mouseup",this._mouseupHandler),window.addEventListener("touchend",this._touchendHandler))})}_cellClicked(D,U){this._didDragSinceMouseDown||D.enabled&&this.selectedValueChange.emit({value:D.value,event:U})}_emitActiveDateChange(D,U){D.enabled&&this.activeDateChange.emit({value:D.value,event:U})}_isSelected(D){return this.startValue===D||this.endValue===D}ngOnChanges(D){const U=D.numCols,{rows:F,numCols:X}=this;(D.rows||U)&&(this._firstRowOffset=F&&F.length&&F[0].length?X-F[0].length:0),(D.cellAspectRatio||U||!this._cellPadding)&&(this._cellPadding=50*this.cellAspectRatio/X+"%"),(U||!this._cellWidth)&&(this._cellWidth=100/X+"%")}ngOnDestroy(){const D=this._elementRef.nativeElement;D.removeEventListener("touchmove",this._touchmoveHandler,Tn),D.removeEventListener("mouseenter",this._enterHandler,Sn),D.removeEventListener("focus",this._enterHandler,Sn),D.removeEventListener("mouseleave",this._leaveHandler,Sn),D.removeEventListener("blur",this._leaveHandler,Sn),D.removeEventListener("mousedown",this._mousedownHandler,dt),D.removeEventListener("touchstart",this._mousedownHandler,dt),this._platform.isBrowser&&(window.removeEventListener("mouseup",this._mouseupHandler),window.removeEventListener("touchend",this._touchendHandler))}_isActiveCell(D,U){let F=D*this.numCols+U;return D&&(F-=this._firstRowOffset),F==this.activeCell}_focusActiveCell(D=!0){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe((0,Vt.q)(1)).subscribe(()=>{setTimeout(()=>{const U=this._elementRef.nativeElement.querySelector(".mat-calendar-body-active");U&&(D||(this._skipNextFocus=!0),U.focus())})})})}_scheduleFocusActiveCellAfterViewChecked(){this._focusActiveCellAfterViewChecked=!0}_isRangeStart(D){return De(D,this.startValue,this.endValue)}_isRangeEnd(D){return Mt(D,this.startValue,this.endValue)}_isInRange(D){return it(D,this.startValue,this.endValue,this.isRange)}_isComparisonStart(D){return De(D,this.comparisonStart,this.comparisonEnd)}_isComparisonBridgeStart(D,U,F){if(!this._isComparisonStart(D)||this._isRangeStart(D)||!this._isInRange(D))return!1;let X=this.rows[U][F-1];if(!X){const Ee=this.rows[U-1];X=Ee&&Ee[Ee.length-1]}return X&&!this._isRangeEnd(X.compareValue)}_isComparisonBridgeEnd(D,U,F){if(!this._isComparisonEnd(D)||this._isRangeEnd(D)||!this._isInRange(D))return!1;let X=this.rows[U][F+1];if(!X){const Ee=this.rows[U+1];X=Ee&&Ee[0]}return X&&!this._isRangeStart(X.compareValue)}_isComparisonEnd(D){return Mt(D,this.comparisonStart,this.comparisonEnd)}_isInComparisonRange(D){return it(D,this.comparisonStart,this.comparisonEnd,this.isRange)}_isComparisonIdentical(D){return this.comparisonStart===this.comparisonEnd&&D===this.comparisonStart}_isPreviewStart(D){return De(D,this.previewStart,this.previewEnd)}_isPreviewEnd(D){return Mt(D,this.previewStart,this.previewEnd)}_isInPreview(D){return it(D,this.previewStart,this.previewEnd,this.isRange)}_getDescribedby(D){return this.isRange?this.startValue===D&&this.endValue===D?`${this._startDateLabelId} ${this._endDateLabelId}`:this.startValue===D?this._startDateLabelId:this.endValue===D?this._endDateLabelId:null:null}_getCellFromElement(D){const U=he(D);if(U){const F=U.getAttribute("data-mat-row"),X=U.getAttribute("data-mat-col");if(F&&X)return this.rows[parseInt(F)][parseInt(X)]}return null}static#e=this.\u0275fac=function(U){return new(U||ce)(R.Y36(R.SBq),R.Y36(R.R0b))};static#t=this.\u0275cmp=R.Xpm({type:ce,selectors:[["","mat-calendar-body",""]],hostAttrs:[1,"mat-calendar-body"],inputs:{label:"label",rows:"rows",todayValue:"todayValue",startValue:"startValue",endValue:"endValue",labelMinRequiredCells:"labelMinRequiredCells",numCols:"numCols",activeCell:"activeCell",isRange:"isRange",cellAspectRatio:"cellAspectRatio",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",previewStart:"previewStart",previewEnd:"previewEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedValueChange:"selectedValueChange",previewChange:"previewChange",activeDateChange:"activeDateChange",dragStarted:"dragStarted",dragEnded:"dragEnded"},exportAs:["matCalendarBody"],features:[R.TTD],attrs:Mn,decls:6,vars:6,consts:[["aria-hidden","true",4,"ngIf"],["role","row",4,"ngFor","ngForOf"],[1,"mat-calendar-body-hidden-label",3,"id"],["aria-hidden","true"],[1,"mat-calendar-body-label"],["role","row"],["class","mat-calendar-body-label",3,"paddingTop","paddingBottom",4,"ngIf"],["role","gridcell","class","mat-calendar-body-cell-container",3,"width","paddingTop","paddingBottom",4,"ngFor","ngForOf"],["role","gridcell",1,"mat-calendar-body-cell-container"],["type","button",1,"mat-calendar-body-cell",3,"ngClass","tabindex","click","focus"],[1,"mat-calendar-body-cell-content","mat-focus-indicator"],["aria-hidden","true",1,"mat-calendar-body-cell-preview"]],template:function(U,F){1&U&&(R.YNc(0,ls,3,6,"tr",0),R.YNc(1,zn,3,2,"tr",1),R.TgZ(2,"label",2),R._uU(3),R.qZA(),R.TgZ(4,"label",2),R._uU(5),R.qZA()),2&U&&(R.Q6J("ngIf",F._firstRowOffset<F.labelMinRequiredCells),R.xp6(1),R.Q6J("ngForOf",F.rows),R.xp6(1),R.Q6J("id",F._startDateLabelId),R.xp6(1),R.hij(" ",F.startDateAccessibleName,"\n"),R.xp6(1),R.Q6J("id",F._endDateLabelId),R.xp6(1),R.hij(" ",F.endDateAccessibleName,"\n"))},dependencies:[d.mk,d.sg,d.O5],styles:['.mat-calendar-body{min-width:224px}.mat-calendar-body-today:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){border-color:var(--mat-datepicker-calendar-date-today-outline-color)}.mat-calendar-body-label{height:0;line-height:0;text-align:left;padding-left:4.7142857143%;padding-right:4.7142857143%;font-size:var(--mat-datepicker-calendar-body-label-text-size);font-weight:var(--mat-datepicker-calendar-body-label-text-weight);color:var(--mat-datepicker-calendar-body-label-text-color)}.mat-calendar-body-hidden-label{display:none}.mat-calendar-body-cell-container{position:relative;height:0;line-height:0}.mat-calendar-body-cell{-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);position:absolute;top:0;left:0;width:100%;height:100%;background:none;text-align:center;outline:none;font-family:inherit;margin:0}.mat-calendar-body-cell::-moz-focus-inner{border:0}.mat-calendar-body-cell::before,.mat-calendar-body-cell::after,.mat-calendar-body-cell-preview{content:"";position:absolute;top:5%;left:0;z-index:0;box-sizing:border-box;display:block;height:90%;width:100%}.mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-start::after,.mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,.mat-calendar-body-comparison-start::after,.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:5%;width:95%;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,[dir=rtl] .mat-calendar-body-comparison-start::after,[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:0;border-radius:0;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,.mat-calendar-body-comparison-end::after,.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}[dir=rtl] .mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,[dir=rtl] .mat-calendar-body-comparison-end::after,[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{left:5%;border-radius:0;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-comparison-bridge-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-bridge-end.mat-calendar-body-range-start::after{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end.mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-end.mat-calendar-body-range-start::after{width:90%}.mat-calendar-body-in-preview{color:var(--mat-datepicker-calendar-date-preview-state-outline-color)}.mat-calendar-body-in-preview .mat-calendar-body-cell-preview{border-top:dashed 1px;border-bottom:dashed 1px}.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:dashed 1px}[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:0;border-right:dashed 1px}.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:dashed 1px}[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:0;border-left:dashed 1px}.mat-calendar-body-disabled{cursor:default}.mat-calendar-body-disabled>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){color:var(--mat-datepicker-calendar-date-disabled-state-text-color)}.mat-calendar-body-disabled>.mat-calendar-body-today:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){border-color:var(--mat-datepicker-calendar-date-today-disabled-state-outline-color)}.cdk-high-contrast-active .mat-calendar-body-disabled{opacity:.5}.mat-calendar-body-cell-content{top:5%;left:5%;z-index:1;display:flex;align-items:center;justify-content:center;box-sizing:border-box;width:90%;height:90%;line-height:1;border-width:1px;border-style:solid;border-radius:999px;color:var(--mat-datepicker-calendar-date-text-color);border-color:var(--mat-datepicker-calendar-date-outline-color)}.mat-calendar-body-cell-content.mat-focus-indicator{position:absolute}.cdk-high-contrast-active .mat-calendar-body-cell-content{border:none}.cdk-keyboard-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical),.cdk-program-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){background-color:var(--mat-datepicker-calendar-date-focus-state-background-color)}@media(hover: hover){.mat-calendar-body-cell:not(.mat-calendar-body-disabled):hover>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){background-color:var(--mat-datepicker-calendar-date-hover-state-background-color)}}.mat-calendar-body-selected{background-color:var(--mat-datepicker-calendar-date-selected-state-background-color);color:var(--mat-datepicker-calendar-date-selected-state-text-color)}.mat-calendar-body-disabled>.mat-calendar-body-selected{background-color:var(--mat-datepicker-calendar-date-selected-disabled-state-background-color)}.mat-calendar-body-selected.mat-calendar-body-today{box-shadow:inset 0 0 0 1px var(--mat-datepicker-calendar-date-today-selected-state-outline-color)}.mat-calendar-body-in-range::before{background:var(--mat-datepicker-calendar-date-in-range-state-background-color)}.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range::before{background:var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color)}.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range::before{background:var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color)}.mat-calendar-body-comparison-bridge-start::before,[dir=rtl] .mat-calendar-body-comparison-bridge-end::before{background:linear-gradient(to right, var(--mat-datepicker-calendar-date-in-range-state-background-color) 50%, var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color) 50%)}.mat-calendar-body-comparison-bridge-end::before,[dir=rtl] .mat-calendar-body-comparison-bridge-start::before{background:linear-gradient(to left, var(--mat-datepicker-calendar-date-in-range-state-background-color) 50%, var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color) 50%)}.mat-calendar-body-in-range>.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range.mat-calendar-body-in-range::after{background:var(--mat-datepicker-calendar-date-in-overlap-range-state-background-color)}.mat-calendar-body-comparison-identical.mat-calendar-body-selected,.mat-calendar-body-in-comparison-range>.mat-calendar-body-selected{background:var(--mat-datepicker-calendar-date-in-overlap-range-selected-state-background-color)}.cdk-high-contrast-active .mat-datepicker-popup:not(:empty),.cdk-high-contrast-active .mat-calendar-body-cell:not(.mat-calendar-body-in-range) .mat-calendar-body-selected{outline:solid 1px}.cdk-high-contrast-active .mat-calendar-body-today{outline:dotted 1px}.cdk-high-contrast-active .mat-calendar-body-cell::before,.cdk-high-contrast-active .mat-calendar-body-cell::after,.cdk-high-contrast-active .mat-calendar-body-selected{background:none}.cdk-high-contrast-active .mat-calendar-body-in-range::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-start::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-end::before{border-top:solid 1px;border-bottom:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:0;border-right:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:0;border-left:solid 1px}.cdk-high-contrast-active .mat-calendar-body-in-comparison-range::before{border-top:dashed 1px;border-bottom:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:0;border-right:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:0;border-left:dashed 1px}[dir=rtl] .mat-calendar-body-label{text-align:right}'],encapsulation:2,changeDetection:0})}return ce})();function j(ce){return"TD"===ce?.nodeName}function he(ce){let bt;return j(ce)?bt=ce:j(ce.parentNode)?bt=ce.parentNode:j(ce.parentNode?.parentNode)&&(bt=ce.parentNode.parentNode),null!=bt?.getAttribute("data-mat-row")?bt:null}function De(ce,bt,D){return null!==D&&bt!==D&&ce<D&&ce===bt}function Mt(ce,bt,D){return null!==bt&&bt!==D&&ce>=bt&&ce===D}function it(ce,bt,D,U){return U&&null!==bt&&null!==D&&bt!==D&&ce>=bt&&ce<=D}function Ln(ce){const bt=ce.changedTouches[0];return document.elementFromPoint(bt.clientX,bt.clientY)}class ge{constructor(bt,D){this.start=bt,this.end=D}}let Ne=(()=>{class ce{constructor(D,U){this.selection=D,this._adapter=U,this._selectionChanged=new $t.x,this.selectionChanged=this._selectionChanged,this.selection=D}updateSelection(D,U){const F=this.selection;this.selection=D,this._selectionChanged.next({selection:D,source:U,oldValue:F})}ngOnDestroy(){this._selectionChanged.complete()}_isValidDateInstance(D){return this._adapter.isDateInstance(D)&&this._adapter.isValid(D)}static#e=this.\u0275fac=function(U){R.$Z()};static#t=this.\u0275prov=R.Yz7({token:ce,factory:ce.\u0275fac})}return ce})(),je=(()=>{class ce extends Ne{constructor(D){super(null,D)}add(D){super.updateSelection(D,this)}isValid(){return null!=this.selection&&this._isValidDateInstance(this.selection)}isComplete(){return null!=this.selection}clone(){const D=new ce(this._adapter);return D.updateSelection(this.selection,this),D}static#e=this.\u0275fac=function(U){return new(U||ce)(R.LFG(mi._A))};static#t=this.\u0275prov=R.Yz7({token:ce,factory:ce.\u0275fac})}return ce})();const z={provide:Ne,deps:[[new R.FiY,new R.tp0,Ne],mi._A],useFactory:function ne(ce,bt){return ce||new je(bt)}},ht=new R.OlP("MAT_DATE_RANGE_SELECTION_STRATEGY");let fe=(()=>{class ce{get activeDate(){return this._activeDate}set activeDate(D){const U=this._activeDate,F=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(D))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(F,this.minDate,this.maxDate),this._hasSameMonthAndYear(U,this._activeDate)||this._init()}get selected(){return this._selected}set selected(D){this._selected=D instanceof ge?D:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(D)),this._setRanges(this._selected)}get minDate(){return this._minDate}set minDate(D){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(D))}get maxDate(){return this._maxDate}set maxDate(D){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(D))}constructor(D,U,F,X,Ee){this._changeDetectorRef=D,this._dateFormats=U,this._dateAdapter=F,this._dir=X,this._rangeStrategy=Ee,this._rerenderSubscription=Zi.w0.EMPTY,this.activeDrag=null,this.selectedChange=new R.vpe,this._userSelection=new R.vpe,this.dragStarted=new R.vpe,this.dragEnded=new R.vpe,this.activeDateChange=new R.vpe,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe((0,Pi.O)(null)).subscribe(()=>this._init())}ngOnChanges(D){const U=D.comparisonStart||D.comparisonEnd;U&&!U.firstChange&&this._setRanges(this.selected),D.activeDrag&&!this.activeDrag&&this._clearPreview()}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_dateSelected(D){const U=D.value,F=this._getDateFromDayOfMonth(U);let X,Ee;this._selected instanceof ge?(X=this._getDateInCurrentMonth(this._selected.start),Ee=this._getDateInCurrentMonth(this._selected.end)):X=Ee=this._getDateInCurrentMonth(this._selected),(X!==U||Ee!==U)&&this.selectedChange.emit(F),this._userSelection.emit({value:F,event:D.event}),this._clearPreview(),this._changeDetectorRef.markForCheck()}_updateActiveDate(D){const F=this._activeDate;this.activeDate=this._getDateFromDayOfMonth(D.value),this._dateAdapter.compareDate(F,this.activeDate)&&this.activeDateChange.emit(this._activeDate)}_handleCalendarBodyKeydown(D){const U=this._activeDate,F=this._isRtl();switch(D.keyCode){case tt.oh:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,F?1:-1);break;case tt.SV:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,F?-1:1);break;case tt.LH:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,-7);break;case tt.JH:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,7);break;case tt.Sd:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,1-this._dateAdapter.getDate(this._activeDate));break;case tt.uR:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,this._dateAdapter.getNumDaysInMonth(this._activeDate)-this._dateAdapter.getDate(this._activeDate));break;case tt.Ku:this.activeDate=D.altKey?this._dateAdapter.addCalendarYears(this._activeDate,-1):this._dateAdapter.addCalendarMonths(this._activeDate,-1);break;case tt.VM:this.activeDate=D.altKey?this._dateAdapter.addCalendarYears(this._activeDate,1):this._dateAdapter.addCalendarMonths(this._activeDate,1);break;case tt.K5:case tt.L_:return this._selectionKeyPressed=!0,void(this._canSelect(this._activeDate)&&D.preventDefault());case tt.hY:return void(null!=this._previewEnd&&!(0,tt.Vb)(D)&&(this._clearPreview(),this.activeDrag?this.dragEnded.emit({value:null,event:D}):(this.selectedChange.emit(null),this._userSelection.emit({value:null,event:D})),D.preventDefault(),D.stopPropagation()));default:return}this._dateAdapter.compareDate(U,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),D.preventDefault()}_handleCalendarBodyKeyup(D){(D.keyCode===tt.L_||D.keyCode===tt.K5)&&(this._selectionKeyPressed&&this._canSelect(this._activeDate)&&this._dateSelected({value:this._dateAdapter.getDate(this._activeDate),event:D}),this._selectionKeyPressed=!1)}_init(){this._setRanges(this.selected),this._todayDate=this._getCellCompareValue(this._dateAdapter.today()),this._monthLabel=this._dateFormats.display.monthLabel?this._dateAdapter.format(this.activeDate,this._dateFormats.display.monthLabel):this._dateAdapter.getMonthNames("short")[this._dateAdapter.getMonth(this.activeDate)].toLocaleUpperCase();let D=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),1);this._firstWeekOffset=(7+this._dateAdapter.getDayOfWeek(D)-this._dateAdapter.getFirstDayOfWeek())%7,this._initWeekdays(),this._createWeekCells(),this._changeDetectorRef.markForCheck()}_focusActiveCell(D){this._matCalendarBody._focusActiveCell(D)}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_previewChanged({event:D,value:U}){if(this._rangeStrategy){const F=U?U.rawValue:null,X=this._rangeStrategy.createPreview(F,this.selected,D);if(this._previewStart=this._getCellCompareValue(X.start),this._previewEnd=this._getCellCompareValue(X.end),this.activeDrag&&F){const Ee=this._rangeStrategy.createDrag?.(this.activeDrag.value,this.selected,F,D);Ee&&(this._previewStart=this._getCellCompareValue(Ee.start),this._previewEnd=this._getCellCompareValue(Ee.end))}this._changeDetectorRef.detectChanges()}}_dragEnded(D){if(this.activeDrag)if(D.value){const U=this._rangeStrategy?.createDrag?.(this.activeDrag.value,this.selected,D.value,D.event);this.dragEnded.emit({value:U??null,event:D.event})}else this.dragEnded.emit({value:null,event:D.event})}_getDateFromDayOfMonth(D){return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),D)}_initWeekdays(){const D=this._dateAdapter.getFirstDayOfWeek(),U=this._dateAdapter.getDayOfWeekNames("narrow");let X=this._dateAdapter.getDayOfWeekNames("long").map((Ee,Ot)=>({long:Ee,narrow:U[Ot]}));this._weekdays=X.slice(D).concat(X.slice(0,D))}_createWeekCells(){const D=this._dateAdapter.getNumDaysInMonth(this.activeDate),U=this._dateAdapter.getDateNames();this._weeks=[[]];for(let F=0,X=this._firstWeekOffset;F<D;F++,X++){7==X&&(this._weeks.push([]),X=0);const Ee=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),F+1),Ot=this._shouldEnableDate(Ee),Pn=this._dateAdapter.format(Ee,this._dateFormats.display.dateA11yLabel),Bn=this.dateClass?this.dateClass(Ee,"month"):void 0;this._weeks[this._weeks.length-1].push(new gi(F+1,U[F],Pn,Ot,Bn,this._getCellCompareValue(Ee),Ee))}}_shouldEnableDate(D){return!!D&&(!this.minDate||this._dateAdapter.compareDate(D,this.minDate)>=0)&&(!this.maxDate||this._dateAdapter.compareDate(D,this.maxDate)<=0)&&(!this.dateFilter||this.dateFilter(D))}_getDateInCurrentMonth(D){return D&&this._hasSameMonthAndYear(D,this.activeDate)?this._dateAdapter.getDate(D):null}_hasSameMonthAndYear(D,U){return!(!D||!U||this._dateAdapter.getMonth(D)!=this._dateAdapter.getMonth(U)||this._dateAdapter.getYear(D)!=this._dateAdapter.getYear(U))}_getCellCompareValue(D){if(D){const U=this._dateAdapter.getYear(D),F=this._dateAdapter.getMonth(D),X=this._dateAdapter.getDate(D);return new Date(U,F,X).getTime()}return null}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setRanges(D){D instanceof ge?(this._rangeStart=this._getCellCompareValue(D.start),this._rangeEnd=this._getCellCompareValue(D.end),this._isRange=!0):(this._rangeStart=this._rangeEnd=this._getCellCompareValue(D),this._isRange=!1),this._comparisonRangeStart=this._getCellCompareValue(this.comparisonStart),this._comparisonRangeEnd=this._getCellCompareValue(this.comparisonEnd)}_canSelect(D){return!this.dateFilter||this.dateFilter(D)}_clearPreview(){this._previewStart=this._previewEnd=null}static#e=this.\u0275fac=function(U){return new(U||ce)(R.Y36(R.sBO),R.Y36(mi.sG,8),R.Y36(mi._A,8),R.Y36(Ve.Is,8),R.Y36(ht,8))};static#t=this.\u0275cmp=R.Xpm({type:ce,selectors:[["mat-month-view"]],viewQuery:function(U,F){if(1&U&&R.Gf(Ni,5),2&U){let X;R.iGM(X=R.CRH())&&(F._matCalendarBody=X.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName",activeDrag:"activeDrag"},outputs:{selectedChange:"selectedChange",_userSelection:"_userSelection",dragStarted:"dragStarted",dragEnded:"dragEnded",activeDateChange:"activeDateChange"},exportAs:["matMonthView"],features:[R.TTD],decls:7,vars:15,consts:[["role","grid",1,"mat-calendar-table"],[1,"mat-calendar-table-header"],["scope","col",4,"ngFor","ngForOf"],["aria-hidden","true","colspan","7",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"label","rows","todayValue","startValue","endValue","comparisonStart","comparisonEnd","previewStart","previewEnd","isRange","labelMinRequiredCells","activeCell","startDateAccessibleName","endDateAccessibleName","selectedValueChange","activeDateChange","previewChange","dragStarted","dragEnded","keyup","keydown"],["scope","col"],[1,"cdk-visually-hidden"],["aria-hidden","true"]],template:function(U,F){1&U&&(R.TgZ(0,"table",0)(1,"thead",1)(2,"tr"),R.YNc(3,ut,5,2,"th",2),R.qZA(),R.TgZ(4,"tr"),R._UZ(5,"th",3),R.qZA()(),R.TgZ(6,"tbody",4),R.NdJ("selectedValueChange",function(Ee){return F._dateSelected(Ee)})("activeDateChange",function(Ee){return F._updateActiveDate(Ee)})("previewChange",function(Ee){return F._previewChanged(Ee)})("dragStarted",function(Ee){return F.dragStarted.emit(Ee)})("dragEnded",function(Ee){return F._dragEnded(Ee)})("keyup",function(Ee){return F._handleCalendarBodyKeyup(Ee)})("keydown",function(Ee){return F._handleCalendarBodyKeydown(Ee)}),R.qZA()()),2&U&&(R.xp6(3),R.Q6J("ngForOf",F._weekdays),R.xp6(3),R.Q6J("label",F._monthLabel)("rows",F._weeks)("todayValue",F._todayDate)("startValue",F._rangeStart)("endValue",F._rangeEnd)("comparisonStart",F._comparisonRangeStart)("comparisonEnd",F._comparisonRangeEnd)("previewStart",F._previewStart)("previewEnd",F._previewEnd)("isRange",F._isRange)("labelMinRequiredCells",3)("activeCell",F._dateAdapter.getDate(F.activeDate)-1)("startDateAccessibleName",F.startDateAccessibleName)("endDateAccessibleName",F.endDateAccessibleName))},dependencies:[d.sg,Ni],encapsulation:2,changeDetection:0})}return ce})();const St=24;let xi=(()=>{class ce{get activeDate(){return this._activeDate}set activeDate(D){let U=this._activeDate;const F=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(D))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(F,this.minDate,this.maxDate),Hn(this._dateAdapter,U,this._activeDate,this.minDate,this.maxDate)||this._init()}get selected(){return this._selected}set selected(D){this._selected=D instanceof ge?D:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(D)),this._setSelectedYear(D)}get minDate(){return this._minDate}set minDate(D){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(D))}get maxDate(){return this._maxDate}set maxDate(D){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(D))}constructor(D,U,F){this._changeDetectorRef=D,this._dateAdapter=U,this._dir=F,this._rerenderSubscription=Zi.w0.EMPTY,this.selectedChange=new R.vpe,this.yearSelected=new R.vpe,this.activeDateChange=new R.vpe,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe((0,Pi.O)(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_init(){this._todayYear=this._dateAdapter.getYear(this._dateAdapter.today());const U=this._dateAdapter.getYear(this._activeDate)-Wi(this._dateAdapter,this.activeDate,this.minDate,this.maxDate);this._years=[];for(let F=0,X=[];F<St;F++)X.push(U+F),4==X.length&&(this._years.push(X.map(Ee=>this._createCellForYear(Ee))),X=[]);this._changeDetectorRef.markForCheck()}_yearSelected(D){const U=D.value,F=this._dateAdapter.createDate(U,0,1),X=this._getDateFromYear(U);this.yearSelected.emit(F),this.selectedChange.emit(X)}_updateActiveDate(D){const F=this._activeDate;this.activeDate=this._getDateFromYear(D.value),this._dateAdapter.compareDate(F,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(D){const U=this._activeDate,F=this._isRtl();switch(D.keyCode){case tt.oh:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,F?1:-1);break;case tt.SV:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,F?-1:1);break;case tt.LH:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-4);break;case tt.JH:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,4);break;case tt.Sd:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-Wi(this._dateAdapter,this.activeDate,this.minDate,this.maxDate));break;case tt.uR:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,St-Wi(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)-1);break;case tt.Ku:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,D.altKey?10*-St:-St);break;case tt.VM:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,D.altKey?10*St:St);break;case tt.K5:case tt.L_:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(U,this.activeDate)&&this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked(),D.preventDefault()}_handleCalendarBodyKeyup(D){(D.keyCode===tt.L_||D.keyCode===tt.K5)&&(this._selectionKeyPressed&&this._yearSelected({value:this._dateAdapter.getYear(this._activeDate),event:D}),this._selectionKeyPressed=!1)}_getActiveCell(){return Wi(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getDateFromYear(D){const U=this._dateAdapter.getMonth(this.activeDate),F=this._dateAdapter.getNumDaysInMonth(this._dateAdapter.createDate(D,U,1));return this._dateAdapter.createDate(D,U,Math.min(this._dateAdapter.getDate(this.activeDate),F))}_createCellForYear(D){const U=this._dateAdapter.createDate(D,0,1),F=this._dateAdapter.getYearName(U),X=this.dateClass?this.dateClass(U,"multi-year"):void 0;return new gi(D,F,F,this._shouldEnableYear(D),X)}_shouldEnableYear(D){if(null==D||this.maxDate&&D>this._dateAdapter.getYear(this.maxDate)||this.minDate&&D<this._dateAdapter.getYear(this.minDate))return!1;if(!this.dateFilter)return!0;for(let F=this._dateAdapter.createDate(D,0,1);this._dateAdapter.getYear(F)==D;F=this._dateAdapter.addCalendarDays(F,1))if(this.dateFilter(F))return!0;return!1}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setSelectedYear(D){if(this._selectedYear=null,D instanceof ge){const U=D.start||D.end;U&&(this._selectedYear=this._dateAdapter.getYear(U))}else D&&(this._selectedYear=this._dateAdapter.getYear(D))}static#e=this.\u0275fac=function(U){return new(U||ce)(R.Y36(R.sBO),R.Y36(mi._A,8),R.Y36(Ve.Is,8))};static#t=this.\u0275cmp=R.Xpm({type:ce,selectors:[["mat-multi-year-view"]],viewQuery:function(U,F){if(1&U&&R.Gf(Ni,5),2&U){let X;R.iGM(X=R.CRH())&&(F._matCalendarBody=X.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",activeDateChange:"activeDateChange"},exportAs:["matMultiYearView"],decls:5,vars:7,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"rows","todayValue","startValue","endValue","numCols","cellAspectRatio","activeCell","selectedValueChange","activeDateChange","keyup","keydown"]],template:function(U,F){1&U&&(R.TgZ(0,"table",0)(1,"thead",1)(2,"tr"),R._UZ(3,"th",2),R.qZA()(),R.TgZ(4,"tbody",3),R.NdJ("selectedValueChange",function(Ee){return F._yearSelected(Ee)})("activeDateChange",function(Ee){return F._updateActiveDate(Ee)})("keyup",function(Ee){return F._handleCalendarBodyKeyup(Ee)})("keydown",function(Ee){return F._handleCalendarBodyKeydown(Ee)}),R.qZA()()),2&U&&(R.xp6(4),R.Q6J("rows",F._years)("todayValue",F._todayYear)("startValue",F._selectedYear)("endValue",F._selectedYear)("numCols",4)("cellAspectRatio",4/7)("activeCell",F._getActiveCell()))},dependencies:[Ni],encapsulation:2,changeDetection:0})}return ce})();function Hn(ce,bt,D,U,F){const X=ce.getYear(bt),Ee=ce.getYear(D),Ot=ns(ce,U,F);return Math.floor((X-Ot)/St)===Math.floor((Ee-Ot)/St)}function Wi(ce,bt,D,U){return function Ia(ce,bt){return(ce%bt+bt)%bt}(ce.getYear(bt)-ns(ce,D,U),St)}function ns(ce,bt,D){let U=0;return D?U=ce.getYear(D)-St+1:bt&&(U=ce.getYear(bt)),U}let Si=(()=>{class ce{get activeDate(){return this._activeDate}set activeDate(D){let U=this._activeDate;const F=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(D))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(F,this.minDate,this.maxDate),this._dateAdapter.getYear(U)!==this._dateAdapter.getYear(this._activeDate)&&this._init()}get selected(){return this._selected}set selected(D){this._selected=D instanceof ge?D:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(D)),this._setSelectedMonth(D)}get minDate(){return this._minDate}set minDate(D){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(D))}get maxDate(){return this._maxDate}set maxDate(D){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(D))}constructor(D,U,F,X){this._changeDetectorRef=D,this._dateFormats=U,this._dateAdapter=F,this._dir=X,this._rerenderSubscription=Zi.w0.EMPTY,this.selectedChange=new R.vpe,this.monthSelected=new R.vpe,this.activeDateChange=new R.vpe,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe((0,Pi.O)(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_monthSelected(D){const U=D.value,F=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),U,1);this.monthSelected.emit(F);const X=this._getDateFromMonth(U);this.selectedChange.emit(X)}_updateActiveDate(D){const F=this._activeDate;this.activeDate=this._getDateFromMonth(D.value),this._dateAdapter.compareDate(F,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(D){const U=this._activeDate,F=this._isRtl();switch(D.keyCode){case tt.oh:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,F?1:-1);break;case tt.SV:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,F?-1:1);break;case tt.LH:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-4);break;case tt.JH:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,4);break;case tt.Sd:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-this._dateAdapter.getMonth(this._activeDate));break;case tt.uR:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,11-this._dateAdapter.getMonth(this._activeDate));break;case tt.Ku:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,D.altKey?-10:-1);break;case tt.VM:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,D.altKey?10:1);break;case tt.K5:case tt.L_:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(U,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),D.preventDefault()}_handleCalendarBodyKeyup(D){(D.keyCode===tt.L_||D.keyCode===tt.K5)&&(this._selectionKeyPressed&&this._monthSelected({value:this._dateAdapter.getMonth(this._activeDate),event:D}),this._selectionKeyPressed=!1)}_init(){this._setSelectedMonth(this.selected),this._todayMonth=this._getMonthInCurrentYear(this._dateAdapter.today()),this._yearLabel=this._dateAdapter.getYearName(this.activeDate);let D=this._dateAdapter.getMonthNames("short");this._months=[[0,1,2,3],[4,5,6,7],[8,9,10,11]].map(U=>U.map(F=>this._createCellForMonth(F,D[F]))),this._changeDetectorRef.markForCheck()}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getMonthInCurrentYear(D){return D&&this._dateAdapter.getYear(D)==this._dateAdapter.getYear(this.activeDate)?this._dateAdapter.getMonth(D):null}_getDateFromMonth(D){const U=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),D,1),F=this._dateAdapter.getNumDaysInMonth(U);return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),D,Math.min(this._dateAdapter.getDate(this.activeDate),F))}_createCellForMonth(D,U){const F=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),D,1),X=this._dateAdapter.format(F,this._dateFormats.display.monthYearA11yLabel),Ee=this.dateClass?this.dateClass(F,"year"):void 0;return new gi(D,U.toLocaleUpperCase(),X,this._shouldEnableMonth(D),Ee)}_shouldEnableMonth(D){const U=this._dateAdapter.getYear(this.activeDate);if(null==D||this._isYearAndMonthAfterMaxDate(U,D)||this._isYearAndMonthBeforeMinDate(U,D))return!1;if(!this.dateFilter)return!0;for(let X=this._dateAdapter.createDate(U,D,1);this._dateAdapter.getMonth(X)==D;X=this._dateAdapter.addCalendarDays(X,1))if(this.dateFilter(X))return!0;return!1}_isYearAndMonthAfterMaxDate(D,U){if(this.maxDate){const F=this._dateAdapter.getYear(this.maxDate),X=this._dateAdapter.getMonth(this.maxDate);return D>F||D===F&&U>X}return!1}_isYearAndMonthBeforeMinDate(D,U){if(this.minDate){const F=this._dateAdapter.getYear(this.minDate),X=this._dateAdapter.getMonth(this.minDate);return D<F||D===F&&U<X}return!1}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setSelectedMonth(D){this._selectedMonth=D instanceof ge?this._getMonthInCurrentYear(D.start)||this._getMonthInCurrentYear(D.end):this._getMonthInCurrentYear(D)}static#e=this.\u0275fac=function(U){return new(U||ce)(R.Y36(R.sBO),R.Y36(mi.sG,8),R.Y36(mi._A,8),R.Y36(Ve.Is,8))};static#t=this.\u0275cmp=R.Xpm({type:ce,selectors:[["mat-year-view"]],viewQuery:function(U,F){if(1&U&&R.Gf(Ni,5),2&U){let X;R.iGM(X=R.CRH())&&(F._matCalendarBody=X.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",monthSelected:"monthSelected",activeDateChange:"activeDateChange"},exportAs:["matYearView"],decls:5,vars:9,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"label","rows","todayValue","startValue","endValue","labelMinRequiredCells","numCols","cellAspectRatio","activeCell","selectedValueChange","activeDateChange","keyup","keydown"]],template:function(U,F){1&U&&(R.TgZ(0,"table",0)(1,"thead",1)(2,"tr"),R._UZ(3,"th",2),R.qZA()(),R.TgZ(4,"tbody",3),R.NdJ("selectedValueChange",function(Ee){return F._monthSelected(Ee)})("activeDateChange",function(Ee){return F._updateActiveDate(Ee)})("keyup",function(Ee){return F._handleCalendarBodyKeyup(Ee)})("keydown",function(Ee){return F._handleCalendarBodyKeydown(Ee)}),R.qZA()()),2&U&&(R.xp6(4),R.Q6J("label",F._yearLabel)("rows",F._months)("todayValue",F._todayMonth)("startValue",F._selectedMonth)("endValue",F._selectedMonth)("labelMinRequiredCells",2)("numCols",4)("cellAspectRatio",4/7)("activeCell",F._dateAdapter.getMonth(F.activeDate)))},dependencies:[Ni],encapsulation:2,changeDetection:0})}return ce})(),Sr=1,Fn=(()=>{class ce{constructor(D,U,F,X,Ee){this._intl=D,this.calendar=U,this._dateAdapter=F,this._dateFormats=X,this._id="mat-calendar-header-"+Sr++,this._periodButtonLabelId=`${this._id}-period-label`,this.calendar.stateChanges.subscribe(()=>Ee.markForCheck())}get periodButtonText(){return"month"==this.calendar.currentView?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():"year"==this.calendar.currentView?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRange(...this._formatMinAndMaxYearLabels())}get periodButtonDescription(){return"month"==this.calendar.currentView?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():"year"==this.calendar.currentView?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRangeLabel(...this._formatMinAndMaxYearLabels())}get periodButtonLabel(){return"month"==this.calendar.currentView?this._intl.switchToMultiYearViewLabel:this._intl.switchToMonthViewLabel}get prevButtonLabel(){return{month:this._intl.prevMonthLabel,year:this._intl.prevYearLabel,"multi-year":this._intl.prevMultiYearLabel}[this.calendar.currentView]}get nextButtonLabel(){return{month:this._intl.nextMonthLabel,year:this._intl.nextYearLabel,"multi-year":this._intl.nextMultiYearLabel}[this.calendar.currentView]}currentPeriodClicked(){this.calendar.currentView="month"==this.calendar.currentView?"multi-year":"month"}previousClicked(){this.calendar.activeDate="month"==this.calendar.currentView?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,-1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,"year"==this.calendar.currentView?-1:-St)}nextClicked(){this.calendar.activeDate="month"==this.calendar.currentView?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,"year"==this.calendar.currentView?1:St)}previousEnabled(){return!this.calendar.minDate||!this.calendar.minDate||!this._isSameView(this.calendar.activeDate,this.calendar.minDate)}nextEnabled(){return!this.calendar.maxDate||!this._isSameView(this.calendar.activeDate,this.calendar.maxDate)}_isSameView(D,U){return"month"==this.calendar.currentView?this._dateAdapter.getYear(D)==this._dateAdapter.getYear(U)&&this._dateAdapter.getMonth(D)==this._dateAdapter.getMonth(U):"year"==this.calendar.currentView?this._dateAdapter.getYear(D)==this._dateAdapter.getYear(U):Hn(this._dateAdapter,D,U,this.calendar.minDate,this.calendar.maxDate)}_formatMinAndMaxYearLabels(){const U=this._dateAdapter.getYear(this.calendar.activeDate)-Wi(this._dateAdapter,this.calendar.activeDate,this.calendar.minDate,this.calendar.maxDate),F=U+St-1;return[this._dateAdapter.getYearName(this._dateAdapter.createDate(U,0,1)),this._dateAdapter.getYearName(this._dateAdapter.createDate(F,0,1))]}static#e=this.\u0275fac=function(U){return new(U||ce)(R.Y36(bn),R.Y36((0,R.Gpc)(()=>kr)),R.Y36(mi._A,8),R.Y36(mi.sG,8),R.Y36(R.sBO))};static#t=this.\u0275cmp=R.Xpm({type:ce,selectors:[["mat-calendar-header"]],exportAs:["matCalendarHeader"],ngContentSelectors:yi,decls:13,vars:11,consts:[[1,"mat-calendar-header"],[1,"mat-calendar-controls"],["mat-button","","type","button","aria-live","polite",1,"mat-calendar-period-button",3,"click"],["aria-hidden","true"],["viewBox","0 0 10 5","focusable","false","aria-hidden","true",1,"mat-calendar-arrow"],["points","0,0 5,5 10,0"],[1,"mat-calendar-spacer"],["mat-icon-button","","type","button",1,"mat-calendar-previous-button",3,"disabled","click"],["mat-icon-button","","type","button",1,"mat-calendar-next-button",3,"disabled","click"],[1,"mat-calendar-hidden-label",3,"id"]],template:function(U,F){1&U&&(R.F$t(),R.TgZ(0,"div",0)(1,"div",1)(2,"button",2),R.NdJ("click",function(){return F.currentPeriodClicked()}),R.TgZ(3,"span",3),R._uU(4),R.qZA(),R.O4$(),R.TgZ(5,"svg",4),R._UZ(6,"polygon",5),R.qZA()(),R.kcU(),R._UZ(7,"div",6),R.Hsn(8),R.TgZ(9,"button",7),R.NdJ("click",function(){return F.previousClicked()}),R.qZA(),R.TgZ(10,"button",8),R.NdJ("click",function(){return F.nextClicked()}),R.qZA()()(),R.TgZ(11,"label",9),R._uU(12),R.qZA()),2&U&&(R.xp6(2),R.uIk("aria-label",F.periodButtonLabel)("aria-describedby",F._periodButtonLabelId),R.xp6(2),R.Oqu(F.periodButtonText),R.xp6(1),R.ekj("mat-calendar-invert","month"!==F.calendar.currentView),R.xp6(4),R.Q6J("disabled",!F.previousEnabled()),R.uIk("aria-label",F.prevButtonLabel),R.xp6(1),R.Q6J("disabled",!F.nextEnabled()),R.uIk("aria-label",F.nextButtonLabel),R.xp6(1),R.Q6J("id",F._periodButtonLabelId),R.xp6(1),R.Oqu(F.periodButtonDescription))},dependencies:[Li.lW,Li.RK],encapsulation:2,changeDetection:0})}return ce})(),kr=(()=>{class ce{get startAt(){return this._startAt}set startAt(D){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(D))}get selected(){return this._selected}set selected(D){this._selected=D instanceof ge?D:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(D))}get minDate(){return this._minDate}set minDate(D){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(D))}get maxDate(){return this._maxDate}set maxDate(D){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(D))}get activeDate(){return this._clampedActiveDate}set activeDate(D){this._clampedActiveDate=this._dateAdapter.clampDate(D,this.minDate,this.maxDate),this.stateChanges.next(),this._changeDetectorRef.markForCheck()}get currentView(){return this._currentView}set currentView(D){const U=this._currentView!==D?D:null;this._currentView=D,this._moveFocusOnNextTick=!0,this._changeDetectorRef.markForCheck(),U&&this.viewChanged.emit(U)}constructor(D,U,F,X){this._dateAdapter=U,this._dateFormats=F,this._changeDetectorRef=X,this._moveFocusOnNextTick=!1,this.startView="month",this.selectedChange=new R.vpe,this.yearSelected=new R.vpe,this.monthSelected=new R.vpe,this.viewChanged=new R.vpe(!0),this._userSelection=new R.vpe,this._userDragDrop=new R.vpe,this._activeDrag=null,this.stateChanges=new $t.x,this._intlChanges=D.changes.subscribe(()=>{X.markForCheck(),this.stateChanges.next()})}ngAfterContentInit(){this._calendarHeaderPortal=new ke.C5(this.headerComponent||Fn),this.activeDate=this.startAt||this._dateAdapter.today(),this._currentView=this.startView}ngAfterViewChecked(){this._moveFocusOnNextTick&&(this._moveFocusOnNextTick=!1,this.focusActiveCell())}ngOnDestroy(){this._intlChanges.unsubscribe(),this.stateChanges.complete()}ngOnChanges(D){const U=D.minDate&&!this._dateAdapter.sameDate(D.minDate.previousValue,D.minDate.currentValue)?D.minDate:void 0,F=D.maxDate&&!this._dateAdapter.sameDate(D.maxDate.previousValue,D.maxDate.currentValue)?D.maxDate:void 0,X=U||F||D.dateFilter;if(X&&!X.firstChange){const Ee=this._getCurrentViewComponent();Ee&&(this._changeDetectorRef.detectChanges(),Ee._init())}this.stateChanges.next()}focusActiveCell(){this._getCurrentViewComponent()._focusActiveCell(!1)}updateTodaysDate(){this._getCurrentViewComponent()._init()}_dateSelected(D){const U=D.value;(this.selected instanceof ge||U&&!this._dateAdapter.sameDate(U,this.selected))&&this.selectedChange.emit(U),this._userSelection.emit(D)}_yearSelectedInMultiYearView(D){this.yearSelected.emit(D)}_monthSelectedInYearView(D){this.monthSelected.emit(D)}_goToDateInView(D,U){this.activeDate=D,this.currentView=U}_dragStarted(D){this._activeDrag=D}_dragEnded(D){this._activeDrag&&(D.value&&this._userDragDrop.emit(D),this._activeDrag=null)}_getCurrentViewComponent(){return this.monthView||this.yearView||this.multiYearView}static#e=this.\u0275fac=function(U){return new(U||ce)(R.Y36(bn),R.Y36(mi._A,8),R.Y36(mi.sG,8),R.Y36(R.sBO))};static#t=this.\u0275cmp=R.Xpm({type:ce,selectors:[["mat-calendar"]],viewQuery:function(U,F){if(1&U&&(R.Gf(fe,5),R.Gf(Si,5),R.Gf(xi,5)),2&U){let X;R.iGM(X=R.CRH())&&(F.monthView=X.first),R.iGM(X=R.CRH())&&(F.yearView=X.first),R.iGM(X=R.CRH())&&(F.multiYearView=X.first)}},hostAttrs:[1,"mat-calendar"],inputs:{headerComponent:"headerComponent",startAt:"startAt",startView:"startView",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",_userSelection:"_userSelection",_userDragDrop:"_userDragDrop"},exportAs:["matCalendar"],features:[R._Bn([z]),R.TTD],decls:5,vars:5,consts:[[3,"cdkPortalOutlet"],["cdkMonitorSubtreeFocus","","tabindex","-1",1,"mat-calendar-content",3,"ngSwitch"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag","activeDateChange","_userSelection","dragStarted","dragEnded",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","monthSelected","selectedChange",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","yearSelected","selectedChange",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag","activeDateChange","_userSelection","dragStarted","dragEnded"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","monthSelected","selectedChange"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","yearSelected","selectedChange"]],template:function(U,F){1&U&&(R.YNc(0,Qt,0,0,"ng-template",0),R.TgZ(1,"div",1),R.YNc(2,Bi,1,11,"mat-month-view",2),R.YNc(3,ts,1,6,"mat-year-view",3),R.YNc(4,ps,1,6,"mat-multi-year-view",4),R.qZA()),2&U&&(R.Q6J("cdkPortalOutlet",F._calendarHeaderPortal),R.xp6(1),R.Q6J("ngSwitch",F.currentView),R.xp6(1),R.Q6J("ngSwitchCase","month"),R.xp6(1),R.Q6J("ngSwitchCase","year"),R.xp6(1),R.Q6J("ngSwitchCase","multi-year"))},dependencies:[d.RF,d.n9,x.kH,ke.Pl,fe,Si,xi],styles:['.mat-calendar{display:block;font-family:var(--mat-datepicker-calendar-text-font);font-size:var(--mat-datepicker-calendar-text-size)}.mat-calendar-header{padding:8px 8px 0 8px}.mat-calendar-content{padding:0 8px 8px 8px;outline:none}.mat-calendar-controls{display:flex;align-items:center;margin:5% calc(4.7142857143% - 16px)}.mat-calendar-spacer{flex:1 1 auto}.mat-calendar-period-button{min-width:0;margin:0 8px;font-size:var(--mat-datepicker-calendar-period-button-text-size);font-weight:var(--mat-datepicker-calendar-period-button-text-weight)}.mat-calendar-arrow{display:inline-block;width:10px;height:5px;margin:0 0 0 5px;vertical-align:middle;fill:var(--mat-datepicker-calendar-period-button-icon-color)}.mat-calendar-arrow.mat-calendar-invert{transform:rotate(180deg)}[dir=rtl] .mat-calendar-arrow{margin:0 5px 0 0}.cdk-high-contrast-active .mat-calendar-arrow{fill:CanvasText}.mat-calendar-previous-button,.mat-calendar-next-button{position:relative}.mat-datepicker-content .mat-calendar-previous-button,.mat-datepicker-content .mat-calendar-next-button{color:var(--mat-datepicker-calendar-navigation-button-icon-color)}.mat-calendar-previous-button::after,.mat-calendar-next-button::after{top:0;left:0;right:0;bottom:0;position:absolute;content:"";margin:15.5px;border:0 solid currentColor;border-top-width:2px}[dir=rtl] .mat-calendar-previous-button,[dir=rtl] .mat-calendar-next-button{transform:rotate(180deg)}.mat-calendar-previous-button::after{border-left-width:2px;transform:translateX(2px) rotate(-45deg)}.mat-calendar-next-button::after{border-right-width:2px;transform:translateX(-2px) rotate(45deg)}.mat-calendar-table{border-spacing:0;border-collapse:collapse;width:100%}.mat-calendar-table-header th{text-align:center;padding:0 0 8px 0;color:var(--mat-datepicker-calendar-header-text-color);font-size:var(--mat-datepicker-calendar-header-text-size);font-weight:var(--mat-datepicker-calendar-header-text-weight)}.mat-calendar-table-header-divider{position:relative;height:1px}.mat-calendar-table-header-divider::after{content:"";position:absolute;top:0;left:-8px;right:-8px;height:1px;background:var(--mat-datepicker-calendar-header-divider-color)}.mat-calendar-body-cell-content::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px) * -1)}.mat-calendar-body-cell:focus .mat-focus-indicator::before{content:""}.mat-calendar-hidden-label{display:none}'],encapsulation:2,changeDetection:0})}return ce})();const Ys={transformPanel:(0,si.X$)("transformPanel",[(0,si.eR)("void => enter-dropdown",(0,si.jt)("120ms cubic-bezier(0, 0, 0.2, 1)",(0,si.F4)([(0,si.oB)({opacity:0,transform:"scale(1, 0.8)"}),(0,si.oB)({opacity:1,transform:"scale(1, 1)"})]))),(0,si.eR)("void => enter-dialog",(0,si.jt)("150ms cubic-bezier(0, 0, 0.2, 1)",(0,si.F4)([(0,si.oB)({opacity:0,transform:"scale(0.7)"}),(0,si.oB)({transform:"none",opacity:1})]))),(0,si.eR)("* => void",(0,si.jt)("100ms linear",(0,si.oB)({opacity:0})))]),fadeInCalendar:(0,si.X$)("fadeInCalendar",[(0,si.SB)("void",(0,si.oB)({opacity:0})),(0,si.SB)("enter",(0,si.oB)({opacity:1})),(0,si.eR)("void => *",(0,si.jt)("120ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)"))])};let Is=0;const Qr=new R.OlP("mat-datepicker-scroll-strategy"),La={provide:Qr,deps:[A.aV],useFactory:function Nr(ce){return()=>ce.scrollStrategies.reposition()}},Ro=(0,mi.pj)(class{constructor(ce){this._elementRef=ce}});let Fa=(()=>{class ce extends Ro{constructor(D,U,F,X,Ee,Ot){super(D),this._changeDetectorRef=U,this._globalModel=F,this._dateAdapter=X,this._rangeSelectionStrategy=Ee,this._subscriptions=new Zi.w0,this._animationDone=new $t.x,this._isAnimating=!1,this._actionsPortal=null,this._closeButtonText=Ot.closeCalendarLabel}ngOnInit(){this._animationState=this.datepicker.touchUi?"enter-dialog":"enter-dropdown"}ngAfterViewInit(){this._subscriptions.add(this.datepicker.stateChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})),this._calendar.focusActiveCell()}ngOnDestroy(){this._subscriptions.unsubscribe(),this._animationDone.complete()}_handleUserSelection(D){const U=this._model.selection,F=D.value,X=U instanceof ge;if(X&&this._rangeSelectionStrategy){const Ee=this._rangeSelectionStrategy.selectionFinished(F,U,D.event);this._model.updateSelection(Ee,this)}else F&&(X||!this._dateAdapter.sameDate(F,U))&&this._model.add(F);(!this._model||this._model.isComplete())&&!this._actionsPortal&&this.datepicker.close()}_handleUserDragDrop(D){this._model.updateSelection(D.value,this)}_startExitAnimation(){this._animationState="void",this._changeDetectorRef.markForCheck()}_handleAnimationEvent(D){this._isAnimating="start"===D.phaseName,this._isAnimating||this._animationDone.next()}_getSelected(){return this._model.selection}_applyPendingSelection(){this._model!==this._globalModel&&this._globalModel.updateSelection(this._model.selection,this)}_assignActions(D,U){this._model=D?this._globalModel.clone():this._globalModel,this._actionsPortal=D,U&&this._changeDetectorRef.detectChanges()}static#e=this.\u0275fac=function(U){return new(U||ce)(R.Y36(R.SBq),R.Y36(R.sBO),R.Y36(Ne),R.Y36(mi._A),R.Y36(ht,8),R.Y36(bn))};static#t=this.\u0275cmp=R.Xpm({type:ce,selectors:[["mat-datepicker-content"]],viewQuery:function(U,F){if(1&U&&R.Gf(kr,5),2&U){let X;R.iGM(X=R.CRH())&&(F._calendar=X.first)}},hostAttrs:[1,"mat-datepicker-content"],hostVars:3,hostBindings:function(U,F){1&U&&R.WFA("@transformPanel.start",function(Ee){return F._handleAnimationEvent(Ee)})("@transformPanel.done",function(Ee){return F._handleAnimationEvent(Ee)}),2&U&&(R.d8E("@transformPanel",F._animationState),R.ekj("mat-datepicker-content-touch",F.datepicker.touchUi))},inputs:{color:"color"},exportAs:["matDatepickerContent"],features:[R.qOj],decls:5,vars:26,consts:[["cdkTrapFocus","","role","dialog",1,"mat-datepicker-content-container"],[3,"id","ngClass","startAt","startView","minDate","maxDate","dateFilter","headerComponent","selected","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","yearSelected","monthSelected","viewChanged","_userSelection","_userDragDrop"],[3,"cdkPortalOutlet"],["type","button","mat-raised-button","",1,"mat-datepicker-close-button",3,"color","focus","blur","click"]],template:function(U,F){if(1&U&&(R.TgZ(0,"div",0)(1,"mat-calendar",1),R.NdJ("yearSelected",function(Ee){return F.datepicker._selectYear(Ee)})("monthSelected",function(Ee){return F.datepicker._selectMonth(Ee)})("viewChanged",function(Ee){return F.datepicker._viewChanged(Ee)})("_userSelection",function(Ee){return F._handleUserSelection(Ee)})("_userDragDrop",function(Ee){return F._handleUserDragDrop(Ee)}),R.qZA(),R.YNc(2,Os,0,0,"ng-template",2),R.TgZ(3,"button",3),R.NdJ("focus",function(){return F._closeButtonFocused=!0})("blur",function(){return F._closeButtonFocused=!1})("click",function(){return F.datepicker.close()}),R._uU(4),R.qZA()()),2&U){let X;R.ekj("mat-datepicker-content-container-with-custom-header",F.datepicker.calendarHeaderComponent)("mat-datepicker-content-container-with-actions",F._actionsPortal),R.uIk("aria-modal",!0)("aria-labelledby",null!==(X=F._dialogLabelId)&&void 0!==X?X:void 0),R.xp6(1),R.Q6J("id",F.datepicker.id)("ngClass",F.datepicker.panelClass)("startAt",F.datepicker.startAt)("startView",F.datepicker.startView)("minDate",F.datepicker._getMinDate())("maxDate",F.datepicker._getMaxDate())("dateFilter",F.datepicker._getDateFilter())("headerComponent",F.datepicker.calendarHeaderComponent)("selected",F._getSelected())("dateClass",F.datepicker.dateClass)("comparisonStart",F.comparisonStart)("comparisonEnd",F.comparisonEnd)("@fadeInCalendar","enter")("startDateAccessibleName",F.startDateAccessibleName)("endDateAccessibleName",F.endDateAccessibleName),R.xp6(1),R.Q6J("cdkPortalOutlet",F._actionsPortal),R.xp6(1),R.ekj("cdk-visually-hidden",!F._closeButtonFocused),R.Q6J("color",F.color||"primary"),R.xp6(1),R.Oqu(F._closeButtonText)}},dependencies:[d.mk,Li.lW,x.mK,ke.Pl,kr],styles:[".mat-datepicker-content{box-shadow:0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12);display:block;border-radius:4px;background-color:var(--mat-datepicker-calendar-container-background-color);color:var(--mat-datepicker-calendar-container-text-color)}.mat-datepicker-content .mat-calendar{width:296px;height:354px}.mat-datepicker-content .mat-datepicker-content-container-with-custom-header .mat-calendar{height:auto}.mat-datepicker-content .mat-datepicker-close-button{position:absolute;top:100%;left:0;margin-top:8px}.ng-animating .mat-datepicker-content .mat-datepicker-close-button{display:none}.mat-datepicker-content-container{display:flex;flex-direction:column;justify-content:space-between}.mat-datepicker-content-touch{box-shadow:0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12);display:block;max-height:80vh;position:relative;overflow:visible}.mat-datepicker-content-touch .mat-datepicker-content-container{min-height:312px;max-height:788px;min-width:250px;max-width:750px}.mat-datepicker-content-touch .mat-calendar{width:100%;height:auto}@media all and (orientation: landscape){.mat-datepicker-content-touch .mat-datepicker-content-container{width:64vh;height:80vh}}@media all and (orientation: portrait){.mat-datepicker-content-touch .mat-datepicker-content-container{width:80vw;height:100vw}.mat-datepicker-content-touch .mat-datepicker-content-container-with-actions{height:115vw}}"],encapsulation:2,data:{animation:[Ys.transformPanel,Ys.fadeInCalendar]},changeDetection:0})}return ce})(),so=(()=>{class ce{get startAt(){return this._startAt||(this.datepickerInput?this.datepickerInput.getStartValue():null)}set startAt(D){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(D))}get color(){return this._color||(this.datepickerInput?this.datepickerInput.getThemePalette():void 0)}set color(D){this._color=D}get touchUi(){return this._touchUi}set touchUi(D){this._touchUi=(0,Ht.Ig)(D)}get disabled(){return void 0===this._disabled&&this.datepickerInput?this.datepickerInput.disabled:!!this._disabled}set disabled(D){const U=(0,Ht.Ig)(D);U!==this._disabled&&(this._disabled=U,this.stateChanges.next(void 0))}get restoreFocus(){return this._restoreFocus}set restoreFocus(D){this._restoreFocus=(0,Ht.Ig)(D)}get panelClass(){return this._panelClass}set panelClass(D){this._panelClass=(0,Ht.du)(D)}get opened(){return this._opened}set opened(D){(0,Ht.Ig)(D)?this.open():this.close()}_getMinDate(){return this.datepickerInput&&this.datepickerInput.min}_getMaxDate(){return this.datepickerInput&&this.datepickerInput.max}_getDateFilter(){return this.datepickerInput&&this.datepickerInput.dateFilter}constructor(D,U,F,X,Ee,Ot,Pn){this._overlay=D,this._ngZone=U,this._viewContainerRef=F,this._dateAdapter=Ee,this._dir=Ot,this._model=Pn,this._inputStateChanges=Zi.w0.EMPTY,this._document=(0,R.f3M)(d.K0),this.startView="month",this._touchUi=!1,this.xPosition="start",this.yPosition="below",this._restoreFocus=!0,this.yearSelected=new R.vpe,this.monthSelected=new R.vpe,this.viewChanged=new R.vpe(!0),this.openedStream=new R.vpe,this.closedStream=new R.vpe,this._opened=!1,this.id="mat-datepicker-"+Is++,this._focusedElementBeforeOpen=null,this._backdropHarnessClass=`${this.id}-backdrop`,this.stateChanges=new $t.x,this._scrollStrategy=X}ngOnChanges(D){const U=D.xPosition||D.yPosition;if(U&&!U.firstChange&&this._overlayRef){const F=this._overlayRef.getConfig().positionStrategy;F instanceof A._G&&(this._setConnectedPositions(F),this.opened&&this._overlayRef.updatePosition())}this.stateChanges.next(void 0)}ngOnDestroy(){this._destroyOverlay(),this.close(),this._inputStateChanges.unsubscribe(),this.stateChanges.complete()}select(D){this._model.add(D)}_selectYear(D){this.yearSelected.emit(D)}_selectMonth(D){this.monthSelected.emit(D)}_viewChanged(D){this.viewChanged.emit(D)}registerInput(D){return this._inputStateChanges.unsubscribe(),this.datepickerInput=D,this._inputStateChanges=D.stateChanges.subscribe(()=>this.stateChanges.next(void 0)),this._model}registerActions(D){this._actionsPortal=D,this._componentRef?.instance._assignActions(D,!0)}removeActions(D){D===this._actionsPortal&&(this._actionsPortal=null,this._componentRef?.instance._assignActions(null,!0))}open(){this._opened||this.disabled||this._componentRef?.instance._isAnimating||(this._focusedElementBeforeOpen=(0,Nt.ht)(),this._openOverlay(),this._opened=!0,this.openedStream.emit())}close(){if(!this._opened||this._componentRef?.instance._isAnimating)return;const D=this._restoreFocus&&this._focusedElementBeforeOpen&&"function"==typeof this._focusedElementBeforeOpen.focus,U=()=>{this._opened&&(this._opened=!1,this.closedStream.emit())};if(this._componentRef){const{instance:F,location:X}=this._componentRef;F._startExitAnimation(),F._animationDone.pipe((0,Vt.q)(1)).subscribe(()=>{const Ee=this._document.activeElement;D&&(!Ee||Ee===this._document.activeElement||X.nativeElement.contains(Ee))&&this._focusedElementBeforeOpen.focus(),this._focusedElementBeforeOpen=null,this._destroyOverlay()})}D?setTimeout(U):U()}_applyPendingSelection(){this._componentRef?.instance?._applyPendingSelection()}_forwardContentValues(D){D.datepicker=this,D.color=this.color,D._dialogLabelId=this.datepickerInput.getOverlayLabelId(),D._assignActions(this._actionsPortal,!1)}_openOverlay(){this._destroyOverlay();const D=this.touchUi,U=new ke.C5(Fa,this._viewContainerRef),F=this._overlayRef=this._overlay.create(new A.X_({positionStrategy:D?this._getDialogStrategy():this._getDropdownStrategy(),hasBackdrop:!0,backdropClass:[D?"cdk-overlay-dark-backdrop":"mat-overlay-transparent-backdrop",this._backdropHarnessClass],direction:this._dir,scrollStrategy:D?this._overlay.scrollStrategies.block():this._scrollStrategy(),panelClass:"mat-datepicker-"+(D?"dialog":"popup")}));this._getCloseStream(F).subscribe(X=>{X&&X.preventDefault(),this.close()}),F.keydownEvents().subscribe(X=>{const Ee=X.keyCode;(Ee===tt.LH||Ee===tt.JH||Ee===tt.oh||Ee===tt.SV||Ee===tt.Ku||Ee===tt.VM)&&X.preventDefault()}),this._componentRef=F.attach(U),this._forwardContentValues(this._componentRef.instance),D||this._ngZone.onStable.pipe((0,Vt.q)(1)).subscribe(()=>F.updatePosition())}_destroyOverlay(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=this._componentRef=null)}_getDialogStrategy(){return this._overlay.position().global().centerHorizontally().centerVertically()}_getDropdownStrategy(){const D=this._overlay.position().flexibleConnectedTo(this.datepickerInput.getConnectedOverlayOrigin()).withTransformOriginOn(".mat-datepicker-content").withFlexibleDimensions(!1).withViewportMargin(8).withLockedPosition();return this._setConnectedPositions(D)}_setConnectedPositions(D){const U="end"===this.xPosition?"end":"start",F="start"===U?"end":"start",X="above"===this.yPosition?"bottom":"top",Ee="top"===X?"bottom":"top";return D.withPositions([{originX:U,originY:Ee,overlayX:U,overlayY:X},{originX:U,originY:X,overlayX:U,overlayY:Ee},{originX:F,originY:Ee,overlayX:F,overlayY:X},{originX:F,originY:X,overlayX:F,overlayY:Ee}])}_getCloseStream(D){const U=["ctrlKey","shiftKey","metaKey"];return(0,Hi.T)(D.backdropClick(),D.detachments(),D.keydownEvents().pipe((0,Fi.h)(F=>F.keyCode===tt.hY&&!(0,tt.Vb)(F)||this.datepickerInput&&(0,tt.Vb)(F,"altKey")&&F.keyCode===tt.LH&&U.every(X=>!(0,tt.Vb)(F,X)))))}static#e=this.\u0275fac=function(U){return new(U||ce)(R.Y36(A.aV),R.Y36(R.R0b),R.Y36(R.s_b),R.Y36(Qr),R.Y36(mi._A,8),R.Y36(Ve.Is,8),R.Y36(Ne))};static#t=this.\u0275dir=R.lG2({type:ce,inputs:{calendarHeaderComponent:"calendarHeaderComponent",startAt:"startAt",startView:"startView",color:"color",touchUi:"touchUi",disabled:"disabled",xPosition:"xPosition",yPosition:"yPosition",restoreFocus:"restoreFocus",dateClass:"dateClass",panelClass:"panelClass",opened:"opened"},outputs:{yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",openedStream:"opened",closedStream:"closed"},features:[R.TTD]})}return ce})(),ya=(()=>{class ce extends so{static#e=this.\u0275fac=function(){let D;return function(F){return(D||(D=R.n5z(ce)))(F||ce)}}();static#t=this.\u0275cmp=R.Xpm({type:ce,selectors:[["mat-datepicker"]],exportAs:["matDatepicker"],features:[R._Bn([z,{provide:so,useExisting:ce}]),R.qOj],decls:0,vars:0,template:function(U,F){},encapsulation:2,changeDetection:0})}return ce})();class gn{constructor(bt,D){this.target=bt,this.targetElement=D,this.value=this.target.value}}let Ls=(()=>{class ce{get value(){return this._model?this._getValueFromModel(this._model.selection):this._pendingValue}set value(D){this._assignValueProgrammatically(D)}get disabled(){return!!this._disabled||this._parentDisabled()}set disabled(D){const U=(0,Ht.Ig)(D),F=this._elementRef.nativeElement;this._disabled!==U&&(this._disabled=U,this.stateChanges.next(void 0)),U&&this._isInitialized&&F.blur&&F.blur()}_getValidators(){return[this._parseValidator,this._minValidator,this._maxValidator,this._filterValidator]}_registerModel(D){this._model=D,this._valueChangesSubscription.unsubscribe(),this._pendingValue&&this._assignValue(this._pendingValue),this._valueChangesSubscription=this._model.selectionChanged.subscribe(U=>{if(this._shouldHandleChangeEvent(U)){const F=this._getValueFromModel(U.selection);this._lastValueValid=this._isValidValue(F),this._cvaOnChange(F),this._onTouched(),this._formatValue(F),this.dateInput.emit(new gn(this,this._elementRef.nativeElement)),this.dateChange.emit(new gn(this,this._elementRef.nativeElement))}})}constructor(D,U,F){this._elementRef=D,this._dateAdapter=U,this._dateFormats=F,this.dateChange=new R.vpe,this.dateInput=new R.vpe,this.stateChanges=new $t.x,this._onTouched=()=>{},this._validatorOnChange=()=>{},this._cvaOnChange=()=>{},this._valueChangesSubscription=Zi.w0.EMPTY,this._localeSubscription=Zi.w0.EMPTY,this._parseValidator=()=>this._lastValueValid?null:{matDatepickerParse:{text:this._elementRef.nativeElement.value}},this._filterValidator=X=>{const Ee=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(X.value));return!Ee||this._matchesFilter(Ee)?null:{matDatepickerFilter:!0}},this._minValidator=X=>{const Ee=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(X.value)),Ot=this._getMinDate();return!Ot||!Ee||this._dateAdapter.compareDate(Ot,Ee)<=0?null:{matDatepickerMin:{min:Ot,actual:Ee}}},this._maxValidator=X=>{const Ee=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(X.value)),Ot=this._getMaxDate();return!Ot||!Ee||this._dateAdapter.compareDate(Ot,Ee)>=0?null:{matDatepickerMax:{max:Ot,actual:Ee}}},this._lastValueValid=!1,this._localeSubscription=U.localeChanges.subscribe(()=>{this._assignValueProgrammatically(this.value)})}ngAfterViewInit(){this._isInitialized=!0}ngOnChanges(D){(function xa(ce,bt){const D=Object.keys(ce);for(let U of D){const{previousValue:F,currentValue:X}=ce[U];if(!bt.isDateInstance(F)||!bt.isDateInstance(X))return!0;if(!bt.sameDate(F,X))return!0}return!1})(D,this._dateAdapter)&&this.stateChanges.next(void 0)}ngOnDestroy(){this._valueChangesSubscription.unsubscribe(),this._localeSubscription.unsubscribe(),this.stateChanges.complete()}registerOnValidatorChange(D){this._validatorOnChange=D}validate(D){return this._validator?this._validator(D):null}writeValue(D){this._assignValueProgrammatically(D)}registerOnChange(D){this._cvaOnChange=D}registerOnTouched(D){this._onTouched=D}setDisabledState(D){this.disabled=D}_onKeydown(D){(0,tt.Vb)(D,"altKey")&&D.keyCode===tt.JH&&["ctrlKey","shiftKey","metaKey"].every(X=>!(0,tt.Vb)(D,X))&&!this._elementRef.nativeElement.readOnly&&(this._openPopup(),D.preventDefault())}_onInput(D){const U=this._lastValueValid;let F=this._dateAdapter.parse(D,this._dateFormats.parse.dateInput);this._lastValueValid=this._isValidValue(F),F=this._dateAdapter.getValidDateOrNull(F);const X=!this._dateAdapter.sameDate(F,this.value);!F||X?this._cvaOnChange(F):(D&&!this.value&&this._cvaOnChange(F),U!==this._lastValueValid&&this._validatorOnChange()),X&&(this._assignValue(F),this.dateInput.emit(new gn(this,this._elementRef.nativeElement)))}_onChange(){this.dateChange.emit(new gn(this,this._elementRef.nativeElement))}_onBlur(){this.value&&this._formatValue(this.value),this._onTouched()}_formatValue(D){this._elementRef.nativeElement.value=null!=D?this._dateAdapter.format(D,this._dateFormats.display.dateInput):""}_assignValue(D){this._model?(this._assignValueToModel(D),this._pendingValue=null):this._pendingValue=D}_isValidValue(D){return!D||this._dateAdapter.isValid(D)}_parentDisabled(){return!1}_assignValueProgrammatically(D){D=this._dateAdapter.deserialize(D),this._lastValueValid=this._isValidValue(D),D=this._dateAdapter.getValidDateOrNull(D),this._assignValue(D),this._formatValue(D)}_matchesFilter(D){const U=this._getDateFilter();return!U||U(D)}static#e=this.\u0275fac=function(U){return new(U||ce)(R.Y36(R.SBq),R.Y36(mi._A,8),R.Y36(mi.sG,8))};static#t=this.\u0275dir=R.lG2({type:ce,inputs:{value:"value",disabled:"disabled"},outputs:{dateChange:"dateChange",dateInput:"dateInput"},features:[R.TTD]})}return ce})();const ro={provide:Je.JU,useExisting:(0,R.Gpc)(()=>wa),multi:!0},Fs={provide:Je.Cf,useExisting:(0,R.Gpc)(()=>wa),multi:!0};let wa=(()=>{class ce extends Ls{set matDatepicker(D){D&&(this._datepicker=D,this._closedSubscription=D.closedStream.subscribe(()=>this._onTouched()),this._registerModel(D.registerInput(this)))}get min(){return this._min}set min(D){const U=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(D));this._dateAdapter.sameDate(U,this._min)||(this._min=U,this._validatorOnChange())}get max(){return this._max}set max(D){const U=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(D));this._dateAdapter.sameDate(U,this._max)||(this._max=U,this._validatorOnChange())}get dateFilter(){return this._dateFilter}set dateFilter(D){const U=this._matchesFilter(this.value);this._dateFilter=D,this._matchesFilter(this.value)!==U&&this._validatorOnChange()}constructor(D,U,F,X){super(D,U,F),this._formField=X,this._closedSubscription=Zi.w0.EMPTY,this._validator=Je.kI.compose(super._getValidators())}getConnectedOverlayOrigin(){return this._formField?this._formField.getConnectedOverlayOrigin():this._elementRef}getOverlayLabelId(){return this._formField?this._formField.getLabelId():this._elementRef.nativeElement.getAttribute("aria-labelledby")}getThemePalette(){return this._formField?this._formField.color:void 0}getStartValue(){return this.value}ngOnDestroy(){super.ngOnDestroy(),this._closedSubscription.unsubscribe()}_openPopup(){this._datepicker&&this._datepicker.open()}_getValueFromModel(D){return D}_assignValueToModel(D){this._model&&this._model.updateSelection(D,this)}_getMinDate(){return this._min}_getMaxDate(){return this._max}_getDateFilter(){return this._dateFilter}_shouldHandleChangeEvent(D){return D.source!==this}static#e=this.\u0275fac=function(U){return new(U||ce)(R.Y36(R.SBq),R.Y36(mi._A,8),R.Y36(mi.sG,8),R.Y36(pi.G_,8))};static#t=this.\u0275dir=R.lG2({type:ce,selectors:[["input","matDatepicker",""]],hostAttrs:[1,"mat-datepicker-input"],hostVars:6,hostBindings:function(U,F){1&U&&R.NdJ("input",function(Ee){return F._onInput(Ee.target.value)})("change",function(){return F._onChange()})("blur",function(){return F._onBlur()})("keydown",function(Ee){return F._onKeydown(Ee)}),2&U&&(R.Ikx("disabled",F.disabled),R.uIk("aria-haspopup",F._datepicker?"dialog":null)("aria-owns",(null==F._datepicker?null:F._datepicker.opened)&&F._datepicker.id||null)("min",F.min?F._dateAdapter.toIso8601(F.min):null)("max",F.max?F._dateAdapter.toIso8601(F.max):null)("data-mat-calendar",F._datepicker?F._datepicker.id:null))},inputs:{matDatepicker:"matDatepicker",min:"min",max:"max",dateFilter:["matDatepickerFilter","dateFilter"]},exportAs:["matDatepickerInput"],features:[R._Bn([ro,Fs,{provide:ni.Jk,useExisting:ce}]),R.qOj]})}return ce})(),Ba=(()=>{class ce{static#e=this.\u0275fac=function(U){return new(U||ce)};static#t=this.\u0275dir=R.lG2({type:ce,selectors:[["","matDatepickerToggleIcon",""]]})}return ce})(),Io=(()=>{class ce{get disabled(){return void 0===this._disabled&&this.datepicker?this.datepicker.disabled:!!this._disabled}set disabled(D){this._disabled=(0,Ht.Ig)(D)}constructor(D,U,F){this._intl=D,this._changeDetectorRef=U,this._stateChanges=Zi.w0.EMPTY;const X=Number(F);this.tabIndex=X||0===X?X:null}ngOnChanges(D){D.datepicker&&this._watchStateChanges()}ngOnDestroy(){this._stateChanges.unsubscribe()}ngAfterContentInit(){this._watchStateChanges()}_open(D){this.datepicker&&!this.disabled&&(this.datepicker.open(),D.stopPropagation())}_watchStateChanges(){const D=this.datepicker?this.datepicker.stateChanges:(0,Bt.of)(),U=this.datepicker&&this.datepicker.datepickerInput?this.datepicker.datepickerInput.stateChanges:(0,Bt.of)(),F=this.datepicker?(0,Hi.T)(this.datepicker.openedStream,this.datepicker.closedStream):(0,Bt.of)();this._stateChanges.unsubscribe(),this._stateChanges=(0,Hi.T)(this._intl.changes,D,U,F).subscribe(()=>this._changeDetectorRef.markForCheck())}static#e=this.\u0275fac=function(U){return new(U||ce)(R.Y36(bn),R.Y36(R.sBO),R.$8M("tabindex"))};static#t=this.\u0275cmp=R.Xpm({type:ce,selectors:[["mat-datepicker-toggle"]],contentQueries:function(U,F,X){if(1&U&&R.Suo(X,Ba,5),2&U){let Ee;R.iGM(Ee=R.CRH())&&(F._customIcon=Ee.first)}},viewQuery:function(U,F){if(1&U&&R.Gf(Rs,5),2&U){let X;R.iGM(X=R.CRH())&&(F._button=X.first)}},hostAttrs:[1,"mat-datepicker-toggle"],hostVars:8,hostBindings:function(U,F){1&U&&R.NdJ("click",function(Ee){return F._open(Ee)}),2&U&&(R.uIk("tabindex",null)("data-mat-calendar",F.datepicker?F.datepicker.id:null),R.ekj("mat-datepicker-toggle-active",F.datepicker&&F.datepicker.opened)("mat-accent",F.datepicker&&"accent"===F.datepicker.color)("mat-warn",F.datepicker&&"warn"===F.datepicker.color))},inputs:{datepicker:["for","datepicker"],tabIndex:"tabIndex",ariaLabel:["aria-label","ariaLabel"],disabled:"disabled",disableRipple:"disableRipple"},exportAs:["matDatepickerToggle"],features:[R.TTD],ngContentSelectors:fn,decls:4,vars:6,consts:[["mat-icon-button","","type","button",3,"disabled","disableRipple"],["button",""],["class","mat-datepicker-toggle-default-icon","viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false","aria-hidden","true",4,"ngIf"],["viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false","aria-hidden","true",1,"mat-datepicker-toggle-default-icon"],["d","M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"]],template:function(U,F){1&U&&(R.F$t(pn),R.TgZ(0,"button",0,1),R.YNc(2,cs,2,0,"svg",2),R.Hsn(3),R.qZA()),2&U&&(R.Q6J("disabled",F.disabled)("disableRipple",F.disableRipple),R.uIk("aria-haspopup",F.datepicker?"dialog":null)("aria-label",F.ariaLabel||F._intl.openCalendarLabel)("tabindex",F.disabled?-1:F.tabIndex),R.xp6(2),R.Q6J("ngIf",!F._customIcon))},dependencies:[d.O5,Li.RK],styles:[".mat-datepicker-toggle{pointer-events:auto;color:var(--mat-datepicker-toggle-icon-color)}.mat-datepicker-toggle-active{color:var(--mat-datepicker-toggle-active-state-icon-color)}.cdk-high-contrast-active .mat-datepicker-toggle-default-icon{color:CanvasText}"],encapsulation:2,changeDetection:0})}return ce})(),Gi=(()=>{class ce{static#e=this.\u0275fac=function(U){return new(U||ce)};static#t=this.\u0275mod=R.oAB({type:ce});static#i=this.\u0275inj=R.cJS({providers:[bn,La],imports:[d.ez,Li.ot,A.U8,x.rt,ke.eL,mi.BQ,Qi.ZD]})}return ce})()},5863:(ot,zt,V)=>{"use strict";V.d(zt,{OP:()=>Bi,Tx:()=>Mt,VK:()=>is,p6:()=>De});var x=V(755),A=V(7583),ke=V(2561),d=V(5262),R=V(8748),Li=V(5047),Qi=V(902),mi=V(1209),$t=V(5407),Zi=V(3843),Hi=V(4787),Bt=V(1813),tt=V(1749),Ve=V(5333),Nt=V(9286),Vt=V(4220),Pi=V(6733),Fi=V(6785),Ht=V(2405),si=V(5667),Je=V(8146),pi=V(8491),ni=V(3753);const Mn=["mat-menu-item",""];function ls(it,Ln){1&it&&(x.O4$(),x.TgZ(0,"svg",3),x._UZ(1,"polygon",4),x.qZA())}const ir=[[["mat-icon"],["","matMenuItemIcon",""]],"*"],jt=["mat-icon, [matMenuItemIcon]","*"];function zn(it,Ln){if(1&it){const ge=x.EpF();x.TgZ(0,"div",0),x.NdJ("keydown",function(je){x.CHM(ge);const Zt=x.oxw();return x.KtG(Zt._handleKeydown(je))})("click",function(){x.CHM(ge);const je=x.oxw();return x.KtG(je.closed.emit("click"))})("@transformMenu.start",function(je){x.CHM(ge);const Zt=x.oxw();return x.KtG(Zt._onAnimationStart(je))})("@transformMenu.done",function(je){x.CHM(ge);const Zt=x.oxw();return x.KtG(Zt._onAnimationDone(je))}),x.TgZ(1,"div",1),x.Hsn(2),x.qZA()()}if(2&it){const ge=x.oxw();x.Q6J("id",ge.panelId)("ngClass",ge._classList)("@transformMenu",ge._panelAnimationState),x.uIk("aria-label",ge.ariaLabel||null)("aria-labelledby",ge.ariaLabelledby||null)("aria-describedby",ge.ariaDescribedby||null)}}const ut=["*"],yi=new x.OlP("MAT_MENU_PANEL"),Qt=(0,Vt.Kr)((0,Vt.Id)(class{}));let Bi=(()=>{class it extends Qt{constructor(ge,Ne,je,Zt,ne){super(),this._elementRef=ge,this._document=Ne,this._focusMonitor=je,this._parentMenu=Zt,this._changeDetectorRef=ne,this.role="menuitem",this._hovered=new R.x,this._focused=new R.x,this._highlighted=!1,this._triggersSubmenu=!1,Zt?.addItem?.(this)}focus(ge,Ne){this._focusMonitor&&ge?this._focusMonitor.focusVia(this._getHostElement(),ge,Ne):this._getHostElement().focus(Ne),this._focused.next(this)}ngAfterViewInit(){this._focusMonitor&&this._focusMonitor.monitor(this._elementRef,!1)}ngOnDestroy(){this._focusMonitor&&this._focusMonitor.stopMonitoring(this._elementRef),this._parentMenu&&this._parentMenu.removeItem&&this._parentMenu.removeItem(this),this._hovered.complete(),this._focused.complete()}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._elementRef.nativeElement}_checkDisabled(ge){this.disabled&&(ge.preventDefault(),ge.stopPropagation())}_handleMouseEnter(){this._hovered.next(this)}getLabel(){const ge=this._elementRef.nativeElement.cloneNode(!0),Ne=ge.querySelectorAll("mat-icon, .material-icons");for(let je=0;je<Ne.length;je++)Ne[je].remove();return ge.textContent?.trim()||""}_setHighlighted(ge){this._highlighted=ge,this._changeDetectorRef?.markForCheck()}_setTriggersSubmenu(ge){this._triggersSubmenu=ge,this._changeDetectorRef?.markForCheck()}_hasFocus(){return this._document&&this._document.activeElement===this._getHostElement()}static#e=this.\u0275fac=function(Ne){return new(Ne||it)(x.Y36(x.SBq),x.Y36(Pi.K0),x.Y36(A.tE),x.Y36(yi,8),x.Y36(x.sBO))};static#t=this.\u0275cmp=x.Xpm({type:it,selectors:[["","mat-menu-item",""]],hostAttrs:[1,"mat-mdc-menu-item","mat-mdc-focus-indicator"],hostVars:8,hostBindings:function(Ne,je){1&Ne&&x.NdJ("click",function(ne){return je._checkDisabled(ne)})("mouseenter",function(){return je._handleMouseEnter()}),2&Ne&&(x.uIk("role",je.role)("tabindex",je._getTabIndex())("aria-disabled",je.disabled)("disabled",je.disabled||null),x.ekj("mat-mdc-menu-item-highlighted",je._highlighted)("mat-mdc-menu-item-submenu-trigger",je._triggersSubmenu))},inputs:{disabled:"disabled",disableRipple:"disableRipple",role:"role"},exportAs:["matMenuItem"],features:[x.qOj],attrs:Mn,ngContentSelectors:jt,decls:5,vars:3,consts:[[1,"mat-mdc-menu-item-text"],["matRipple","",1,"mat-mdc-menu-ripple",3,"matRippleDisabled","matRippleTrigger"],["class","mat-mdc-menu-submenu-icon","viewBox","0 0 5 10","focusable","false","aria-hidden","true",4,"ngIf"],["viewBox","0 0 5 10","focusable","false","aria-hidden","true",1,"mat-mdc-menu-submenu-icon"],["points","0,0 5,5 0,10"]],template:function(Ne,je){1&Ne&&(x.F$t(ir),x.Hsn(0),x.TgZ(1,"span",0),x.Hsn(2,1),x.qZA(),x._UZ(3,"div",1),x.YNc(4,ls,2,0,"svg",2)),2&Ne&&(x.xp6(3),x.Q6J("matRippleDisabled",je.disableRipple||je.disabled)("matRippleTrigger",je._getHostElement()),x.xp6(1),x.Q6J("ngIf",je._triggersSubmenu))},dependencies:[Pi.O5,Vt.wG],encapsulation:2,changeDetection:0})}return it})();const Rs=new x.OlP("MatMenuContent"),fn={transformMenu:(0,Ht.X$)("transformMenu",[(0,Ht.SB)("void",(0,Ht.oB)({opacity:0,transform:"scale(0.8)"})),(0,Ht.eR)("void => enter",(0,Ht.jt)("120ms cubic-bezier(0, 0, 0.2, 1)",(0,Ht.oB)({opacity:1,transform:"scale(1)"}))),(0,Ht.eR)("* => void",(0,Ht.jt)("100ms 25ms linear",(0,Ht.oB)({opacity:0})))]),fadeInItems:(0,Ht.X$)("fadeInItems",[(0,Ht.SB)("showing",(0,Ht.oB)({opacity:1})),(0,Ht.eR)("void => *",[(0,Ht.oB)({opacity:0}),(0,Ht.jt)("400ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let ds=0;const fs=new x.OlP("mat-menu-default-options",{providedIn:"root",factory:function bn(){return{overlapTrigger:!1,xPosition:"after",yPosition:"below",backdropClass:"cdk-overlay-transparent-backdrop"}}});let gi=(()=>{class it{get xPosition(){return this._xPosition}set xPosition(ge){this._xPosition=ge,this.setPositionClasses()}get yPosition(){return this._yPosition}set yPosition(ge){this._yPosition=ge,this.setPositionClasses()}get overlapTrigger(){return this._overlapTrigger}set overlapTrigger(ge){this._overlapTrigger=(0,ke.Ig)(ge)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(ge){this._hasBackdrop=(0,ke.Ig)(ge)}set panelClass(ge){const Ne=this._previousPanelClass;Ne&&Ne.length&&Ne.split(" ").forEach(je=>{this._classList[je]=!1}),this._previousPanelClass=ge,ge&&ge.length&&(ge.split(" ").forEach(je=>{this._classList[je]=!0}),this._elementRef.nativeElement.className="")}get classList(){return this.panelClass}set classList(ge){this.panelClass=ge}constructor(ge,Ne,je,Zt){this._elementRef=ge,this._ngZone=Ne,this._changeDetectorRef=Zt,this._directDescendantItems=new x.n_E,this._classList={},this._panelAnimationState="void",this._animationDone=new R.x,this.closed=new x.vpe,this.close=this.closed,this.panelId="mat-menu-panel-"+ds++,this.overlayPanelClass=je.overlayPanelClass||"",this._xPosition=je.xPosition,this._yPosition=je.yPosition,this.backdropClass=je.backdropClass,this._overlapTrigger=je.overlapTrigger,this._hasBackdrop=je.hasBackdrop}ngOnInit(){this.setPositionClasses()}ngAfterContentInit(){this._updateDirectDescendants(),this._keyManager=new A.Em(this._directDescendantItems).withWrap().withTypeAhead().withHomeAndEnd(),this._keyManager.tabOut.subscribe(()=>this.closed.emit("tab")),this._directDescendantItems.changes.pipe((0,Zi.O)(this._directDescendantItems),(0,Hi.w)(ge=>(0,Li.T)(...ge.map(Ne=>Ne._focused)))).subscribe(ge=>this._keyManager.updateActiveItem(ge)),this._directDescendantItems.changes.subscribe(ge=>{const Ne=this._keyManager;if("enter"===this._panelAnimationState&&Ne.activeItem?._hasFocus()){const je=ge.toArray(),Zt=Math.max(0,Math.min(je.length-1,Ne.activeItemIndex||0));je[Zt]&&!je[Zt].disabled?Ne.setActiveItem(Zt):Ne.setNextItemActive()}})}ngOnDestroy(){this._keyManager?.destroy(),this._directDescendantItems.destroy(),this.closed.complete(),this._firstItemFocusSubscription?.unsubscribe()}_hovered(){return this._directDescendantItems.changes.pipe((0,Zi.O)(this._directDescendantItems),(0,Hi.w)(Ne=>(0,Li.T)(...Ne.map(je=>je._hovered))))}addItem(ge){}removeItem(ge){}_handleKeydown(ge){const Ne=ge.keyCode,je=this._keyManager;switch(Ne){case d.hY:(0,d.Vb)(ge)||(ge.preventDefault(),this.closed.emit("keydown"));break;case d.oh:this.parentMenu&&"ltr"===this.direction&&this.closed.emit("keydown");break;case d.SV:this.parentMenu&&"rtl"===this.direction&&this.closed.emit("keydown");break;default:return(Ne===d.LH||Ne===d.JH)&&je.setFocusOrigin("keyboard"),void je.onKeydown(ge)}ge.stopPropagation()}focusFirstItem(ge="program"){this._firstItemFocusSubscription?.unsubscribe(),this._firstItemFocusSubscription=this._ngZone.onStable.pipe((0,Bt.q)(1)).subscribe(()=>{let Ne=null;if(this._directDescendantItems.length&&(Ne=this._directDescendantItems.first._getHostElement().closest('[role="menu"]')),!Ne||!Ne.contains(document.activeElement)){const je=this._keyManager;je.setFocusOrigin(ge).setFirstItemActive(),!je.activeItem&&Ne&&Ne.focus()}})}resetActiveItem(){this._keyManager.setActiveItem(-1)}setElevation(ge){const Ne=Math.min(this._baseElevation+ge,24),je=`${this._elevationPrefix}${Ne}`,Zt=Object.keys(this._classList).find(ne=>ne.startsWith(this._elevationPrefix));(!Zt||Zt===this._previousElevation)&&(this._previousElevation&&(this._classList[this._previousElevation]=!1),this._classList[je]=!0,this._previousElevation=je)}setPositionClasses(ge=this.xPosition,Ne=this.yPosition){const je=this._classList;je["mat-menu-before"]="before"===ge,je["mat-menu-after"]="after"===ge,je["mat-menu-above"]="above"===Ne,je["mat-menu-below"]="below"===Ne,this._changeDetectorRef?.markForCheck()}_startAnimation(){this._panelAnimationState="enter"}_resetAnimation(){this._panelAnimationState="void"}_onAnimationDone(ge){this._animationDone.next(ge),this._isAnimating=!1}_onAnimationStart(ge){this._isAnimating=!0,"enter"===ge.toState&&0===this._keyManager.activeItemIndex&&(ge.element.scrollTop=0)}_updateDirectDescendants(){this._allItems.changes.pipe((0,Zi.O)(this._allItems)).subscribe(ge=>{this._directDescendantItems.reset(ge.filter(Ne=>Ne._parentMenu===this)),this._directDescendantItems.notifyOnChanges()})}static#e=this.\u0275fac=function(Ne){return new(Ne||it)(x.Y36(x.SBq),x.Y36(x.R0b),x.Y36(fs),x.Y36(x.sBO))};static#t=this.\u0275dir=x.lG2({type:it,contentQueries:function(Ne,je,Zt){if(1&Ne&&(x.Suo(Zt,Rs,5),x.Suo(Zt,Bi,5),x.Suo(Zt,Bi,4)),2&Ne){let ne;x.iGM(ne=x.CRH())&&(je.lazyContent=ne.first),x.iGM(ne=x.CRH())&&(je._allItems=ne),x.iGM(ne=x.CRH())&&(je.items=ne)}},viewQuery:function(Ne,je){if(1&Ne&&x.Gf(x.Rgc,5),2&Ne){let Zt;x.iGM(Zt=x.CRH())&&(je.templateRef=Zt.first)}},inputs:{backdropClass:"backdropClass",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],xPosition:"xPosition",yPosition:"yPosition",overlapTrigger:"overlapTrigger",hasBackdrop:"hasBackdrop",panelClass:["class","panelClass"],classList:"classList"},outputs:{closed:"closed",close:"close"}})}return it})(),is=(()=>{class it extends gi{constructor(ge,Ne,je,Zt){super(ge,Ne,je,Zt),this._elevationPrefix="mat-elevation-z",this._baseElevation=8}static#e=this.\u0275fac=function(Ne){return new(Ne||it)(x.Y36(x.SBq),x.Y36(x.R0b),x.Y36(fs),x.Y36(x.sBO))};static#t=this.\u0275cmp=x.Xpm({type:it,selectors:[["mat-menu"]],hostAttrs:["ngSkipHydration",""],hostVars:3,hostBindings:function(Ne,je){2&Ne&&x.uIk("aria-label",null)("aria-labelledby",null)("aria-describedby",null)},exportAs:["matMenu"],features:[x._Bn([{provide:yi,useExisting:it}]),x.qOj],ngContentSelectors:ut,decls:1,vars:0,consts:[["tabindex","-1","role","menu",1,"mat-mdc-menu-panel","mat-mdc-elevation-specific",3,"id","ngClass","keydown","click"],[1,"mat-mdc-menu-content"]],template:function(Ne,je){1&Ne&&(x.F$t(),x.YNc(0,zn,3,6,"ng-template"))},dependencies:[Pi.mk],styles:['mat-menu{display:none}.mat-mdc-menu-content{margin:0;padding:8px 0;list-style-type:none}.mat-mdc-menu-content:focus{outline:none}.mat-mdc-menu-content,.mat-mdc-menu-content .mat-mdc-menu-item .mat-mdc-menu-item-text{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;white-space:normal;font-family:var(--mat-menu-item-label-text-font);line-height:var(--mat-menu-item-label-text-line-height);font-size:var(--mat-menu-item-label-text-size);letter-spacing:var(--mat-menu-item-label-text-tracking);font-weight:var(--mat-menu-item-label-text-weight)}.mat-mdc-menu-panel{--mat-menu-container-shape:4px;min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;box-sizing:border-box;outline:0;border-radius:var(--mat-menu-container-shape);background-color:var(--mat-menu-container-color);will-change:transform,opacity}.mat-mdc-menu-panel.ng-animating{pointer-events:none}.cdk-high-contrast-active .mat-mdc-menu-panel{outline:solid 1px}.mat-mdc-menu-item{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;padding-left:16px;padding-right:16px;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);cursor:pointer;width:100%;text-align:left;box-sizing:border-box;color:inherit;font-size:inherit;background:none;text-decoration:none;margin:0;align-items:center;min-height:48px}.mat-mdc-menu-item:focus{outline:none}[dir=rtl] .mat-mdc-menu-item,.mat-mdc-menu-item[dir=rtl]{padding-left:16px;padding-right:16px}.mat-mdc-menu-item::-moz-focus-inner{border:0}.mat-mdc-menu-item,.mat-mdc-menu-item:visited,.mat-mdc-menu-item:link{color:var(--mat-menu-item-label-text-color)}.mat-mdc-menu-item .mat-icon-no-color,.mat-mdc-menu-item .mat-mdc-menu-submenu-icon{color:var(--mat-menu-item-icon-color)}.mat-mdc-menu-item[disabled]{cursor:default;opacity:.38}.mat-mdc-menu-item[disabled]::after{display:block;position:absolute;content:"";top:0;left:0;bottom:0;right:0}.mat-mdc-menu-item .mat-icon{margin-right:16px}[dir=rtl] .mat-mdc-menu-item{text-align:right}[dir=rtl] .mat-mdc-menu-item .mat-icon{margin-right:0;margin-left:16px}.mat-mdc-menu-item.mat-mdc-menu-item-submenu-trigger{padding-right:32px}[dir=rtl] .mat-mdc-menu-item.mat-mdc-menu-item-submenu-trigger{padding-right:16px;padding-left:32px}.mat-mdc-menu-item:not([disabled]):hover{background-color:var(--mat-menu-item-hover-state-layer-color)}.mat-mdc-menu-item:not([disabled]).cdk-program-focused,.mat-mdc-menu-item:not([disabled]).cdk-keyboard-focused,.mat-mdc-menu-item:not([disabled]).mat-mdc-menu-item-highlighted{background-color:var(--mat-menu-item-focus-state-layer-color)}.cdk-high-contrast-active .mat-mdc-menu-item{margin-top:1px}.mat-mdc-menu-submenu-icon{position:absolute;top:50%;right:16px;transform:translateY(-50%);width:5px;height:10px;fill:currentColor}[dir=rtl] .mat-mdc-menu-submenu-icon{right:auto;left:16px;transform:translateY(-50%) scaleX(-1)}.cdk-high-contrast-active .mat-mdc-menu-submenu-icon{fill:CanvasText}.mat-mdc-menu-item .mat-mdc-menu-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}'],encapsulation:2,data:{animation:[fn.transformMenu,fn.fadeInItems]},changeDetection:0})}return it})();const Tn=new x.OlP("mat-menu-scroll-strategy"),dt={provide:Tn,deps:[Je.aV],useFactory:function Sn(it){return()=>it.scrollStrategies.reposition()}},Ni=(0,pi.i$)({passive:!0});let he=(()=>{class it{get _deprecatedMatMenuTriggerFor(){return this.menu}set _deprecatedMatMenuTriggerFor(ge){this.menu=ge}get menu(){return this._menu}set menu(ge){ge!==this._menu&&(this._menu=ge,this._menuCloseSubscription.unsubscribe(),ge&&(this._menuCloseSubscription=ge.close.subscribe(Ne=>{this._destroyMenu(Ne),("click"===Ne||"tab"===Ne)&&this._parentMaterialMenu&&this._parentMaterialMenu.closed.emit(Ne)})),this._menuItemInstance?._setTriggersSubmenu(this.triggersSubmenu()))}constructor(ge,Ne,je,Zt,ne,z,Qe,mt,ht){this._overlay=ge,this._element=Ne,this._viewContainerRef=je,this._menuItemInstance=z,this._dir=Qe,this._focusMonitor=mt,this._ngZone=ht,this._overlayRef=null,this._menuOpen=!1,this._closingActionsSubscription=Qi.w0.EMPTY,this._hoverSubscription=Qi.w0.EMPTY,this._menuCloseSubscription=Qi.w0.EMPTY,this._changeDetectorRef=(0,x.f3M)(x.sBO),this._handleTouchStart=Ae=>{(0,A.yG)(Ae)||(this._openedBy="touch")},this._openedBy=void 0,this.restoreFocus=!0,this.menuOpened=new x.vpe,this.onMenuOpen=this.menuOpened,this.menuClosed=new x.vpe,this.onMenuClose=this.menuClosed,this._scrollStrategy=Zt,this._parentMaterialMenu=ne instanceof gi?ne:void 0,Ne.nativeElement.addEventListener("touchstart",this._handleTouchStart,Ni)}ngAfterContentInit(){this._handleHover()}ngOnDestroy(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=null),this._element.nativeElement.removeEventListener("touchstart",this._handleTouchStart,Ni),this._menuCloseSubscription.unsubscribe(),this._closingActionsSubscription.unsubscribe(),this._hoverSubscription.unsubscribe()}get menuOpen(){return this._menuOpen}get dir(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}triggersSubmenu(){return!!(this._menuItemInstance&&this._parentMaterialMenu&&this.menu)}toggleMenu(){return this._menuOpen?this.closeMenu():this.openMenu()}openMenu(){const ge=this.menu;if(this._menuOpen||!ge)return;const Ne=this._createOverlay(ge),je=Ne.getConfig(),Zt=je.positionStrategy;this._setPosition(ge,Zt),je.hasBackdrop=null==ge.hasBackdrop?!this.triggersSubmenu():ge.hasBackdrop,Ne.attach(this._getPortal(ge)),ge.lazyContent&&ge.lazyContent.attach(this.menuData),this._closingActionsSubscription=this._menuClosingActions().subscribe(()=>this.closeMenu()),this._initMenu(ge),ge instanceof gi&&(ge._startAnimation(),ge._directDescendantItems.changes.pipe((0,tt.R)(ge.close)).subscribe(()=>{Zt.withLockedPosition(!1).reapplyLastPosition(),Zt.withLockedPosition(!0)}))}closeMenu(){this.menu?.close.emit()}focus(ge,Ne){this._focusMonitor&&ge?this._focusMonitor.focusVia(this._element,ge,Ne):this._element.nativeElement.focus(Ne)}updatePosition(){this._overlayRef?.updatePosition()}_destroyMenu(ge){if(!this._overlayRef||!this.menuOpen)return;const Ne=this.menu;this._closingActionsSubscription.unsubscribe(),this._overlayRef.detach(),this.restoreFocus&&("keydown"===ge||!this._openedBy||!this.triggersSubmenu())&&this.focus(this._openedBy),this._openedBy=void 0,Ne instanceof gi?(Ne._resetAnimation(),Ne.lazyContent?Ne._animationDone.pipe((0,Ve.h)(je=>"void"===je.toState),(0,Bt.q)(1),(0,tt.R)(Ne.lazyContent._attached)).subscribe({next:()=>Ne.lazyContent.detach(),complete:()=>this._setIsMenuOpen(!1)}):this._setIsMenuOpen(!1)):(this._setIsMenuOpen(!1),Ne?.lazyContent?.detach())}_initMenu(ge){ge.parentMenu=this.triggersSubmenu()?this._parentMaterialMenu:void 0,ge.direction=this.dir,this._setMenuElevation(ge),ge.focusFirstItem(this._openedBy||"program"),this._setIsMenuOpen(!0)}_setMenuElevation(ge){if(ge.setElevation){let Ne=0,je=ge.parentMenu;for(;je;)Ne++,je=je.parentMenu;ge.setElevation(Ne)}}_setIsMenuOpen(ge){ge!==this._menuOpen&&(this._menuOpen=ge,this._menuOpen?this.menuOpened.emit():this.menuClosed.emit(),this.triggersSubmenu()&&this._menuItemInstance._setHighlighted(ge),this._changeDetectorRef.markForCheck())}_createOverlay(ge){if(!this._overlayRef){const Ne=this._getOverlayConfig(ge);this._subscribeToPositions(ge,Ne.positionStrategy),this._overlayRef=this._overlay.create(Ne),this._overlayRef.keydownEvents().subscribe()}return this._overlayRef}_getOverlayConfig(ge){return new Je.X_({positionStrategy:this._overlay.position().flexibleConnectedTo(this._element).withLockedPosition().withGrowAfterOpen().withTransformOriginOn(".mat-menu-panel, .mat-mdc-menu-panel"),backdropClass:ge.backdropClass||"cdk-overlay-transparent-backdrop",panelClass:ge.overlayPanelClass,scrollStrategy:this._scrollStrategy(),direction:this._dir})}_subscribeToPositions(ge,Ne){ge.setPositionClasses&&Ne.positionChanges.subscribe(je=>{const Zt="start"===je.connectionPair.overlayX?"after":"before",ne="top"===je.connectionPair.overlayY?"below":"above";this._ngZone?this._ngZone.run(()=>ge.setPositionClasses(Zt,ne)):ge.setPositionClasses(Zt,ne)})}_setPosition(ge,Ne){let[je,Zt]="before"===ge.xPosition?["end","start"]:["start","end"],[ne,z]="above"===ge.yPosition?["bottom","top"]:["top","bottom"],[Qe,mt]=[ne,z],[ht,Ae]=[je,Zt],Lt=0;if(this.triggersSubmenu()){if(Ae=je="before"===ge.xPosition?"start":"end",Zt=ht="end"===je?"start":"end",this._parentMaterialMenu){if(null==this._parentInnerPadding){const Y=this._parentMaterialMenu.items.first;this._parentInnerPadding=Y?Y._getHostElement().offsetTop:0}Lt="bottom"===ne?this._parentInnerPadding:-this._parentInnerPadding}}else ge.overlapTrigger||(Qe="top"===ne?"bottom":"top",mt="top"===z?"bottom":"top");Ne.withPositions([{originX:je,originY:Qe,overlayX:ht,overlayY:ne,offsetY:Lt},{originX:Zt,originY:Qe,overlayX:Ae,overlayY:ne,offsetY:Lt},{originX:je,originY:mt,overlayX:ht,overlayY:z,offsetY:-Lt},{originX:Zt,originY:mt,overlayX:Ae,overlayY:z,offsetY:-Lt}])}_menuClosingActions(){const ge=this._overlayRef.backdropClick(),Ne=this._overlayRef.detachments(),je=this._parentMaterialMenu?this._parentMaterialMenu.closed:(0,mi.of)(),Zt=this._parentMaterialMenu?this._parentMaterialMenu._hovered().pipe((0,Ve.h)(ne=>ne!==this._menuItemInstance),(0,Ve.h)(()=>this._menuOpen)):(0,mi.of)();return(0,Li.T)(ge,je,Zt,Ne)}_handleMousedown(ge){(0,A.X6)(ge)||(this._openedBy=0===ge.button?"mouse":void 0,this.triggersSubmenu()&&ge.preventDefault())}_handleKeydown(ge){const Ne=ge.keyCode;(Ne===d.K5||Ne===d.L_)&&(this._openedBy="keyboard"),this.triggersSubmenu()&&(Ne===d.SV&&"ltr"===this.dir||Ne===d.oh&&"rtl"===this.dir)&&(this._openedBy="keyboard",this.openMenu())}_handleClick(ge){this.triggersSubmenu()?(ge.stopPropagation(),this.openMenu()):this.toggleMenu()}_handleHover(){!this.triggersSubmenu()||!this._parentMaterialMenu||(this._hoverSubscription=this._parentMaterialMenu._hovered().pipe((0,Ve.h)(ge=>ge===this._menuItemInstance&&!ge.disabled),(0,Nt.g)(0,$t.E)).subscribe(()=>{this._openedBy="mouse",this.menu instanceof gi&&this.menu._isAnimating?this.menu._animationDone.pipe((0,Bt.q)(1),(0,Nt.g)(0,$t.E),(0,tt.R)(this._parentMaterialMenu._hovered())).subscribe(()=>this.openMenu()):this.openMenu()}))}_getPortal(ge){return(!this._portal||this._portal.templateRef!==ge.templateRef)&&(this._portal=new Fi.UE(ge.templateRef,this._viewContainerRef)),this._portal}static#e=this.\u0275fac=function(Ne){return new(Ne||it)(x.Y36(Je.aV),x.Y36(x.SBq),x.Y36(x.s_b),x.Y36(Tn),x.Y36(yi,8),x.Y36(Bi,10),x.Y36(si.Is,8),x.Y36(A.tE),x.Y36(x.R0b))};static#t=this.\u0275dir=x.lG2({type:it,hostVars:3,hostBindings:function(Ne,je){1&Ne&&x.NdJ("click",function(ne){return je._handleClick(ne)})("mousedown",function(ne){return je._handleMousedown(ne)})("keydown",function(ne){return je._handleKeydown(ne)}),2&Ne&&x.uIk("aria-haspopup",je.menu?"menu":null)("aria-expanded",je.menuOpen)("aria-controls",je.menuOpen?je.menu.panelId:null)},inputs:{_deprecatedMatMenuTriggerFor:["mat-menu-trigger-for","_deprecatedMatMenuTriggerFor"],menu:["matMenuTriggerFor","menu"],menuData:["matMenuTriggerData","menuData"],restoreFocus:["matMenuTriggerRestoreFocus","restoreFocus"]},outputs:{menuOpened:"menuOpened",onMenuOpen:"onMenuOpen",menuClosed:"menuClosed",onMenuClose:"onMenuClose"}})}return it})(),De=(()=>{class it extends he{static#e=this.\u0275fac=function(){let ge;return function(je){return(ge||(ge=x.n5z(it)))(je||it)}}();static#t=this.\u0275dir=x.lG2({type:it,selectors:[["","mat-menu-trigger-for",""],["","matMenuTriggerFor",""]],hostAttrs:[1,"mat-mdc-menu-trigger"],exportAs:["matMenuTrigger"],features:[x.qOj]})}return it})(),Mt=(()=>{class it{static#e=this.\u0275fac=function(Ne){return new(Ne||it)};static#t=this.\u0275mod=x.oAB({type:it});static#i=this.\u0275inj=x.cJS({providers:[dt],imports:[Pi.ez,Vt.si,Vt.BQ,Je.U8,ni.ZD,Vt.BQ]})}return it})()},4424:(ot,zt,V)=>{"use strict";V.d(zt,{NW:()=>ls,TU:()=>ir});var x=V(6733),A=V(755),ke=V(8748),d=V(393),R=V(8675),Li=V(5191),Qi=V(4220),mi=V(2561),$t=V(6125);function Zi(jt,zn){if(1&jt&&(A.TgZ(0,"mat-option",19),A._uU(1),A.qZA()),2&jt){const ut=zn.$implicit;A.Q6J("value",ut),A.xp6(1),A.hij(" ",ut," ")}}function Hi(jt,zn){if(1&jt){const ut=A.EpF();A.TgZ(0,"mat-form-field",16)(1,"mat-select",17),A.NdJ("selectionChange",function(Qt){A.CHM(ut);const Bi=A.oxw(2);return A.KtG(Bi._changePageSize(Qt.value))}),A.YNc(2,Zi,2,2,"mat-option",18),A.qZA()()}if(2&jt){const ut=A.oxw(2);A.Q6J("appearance",ut._formFieldAppearance)("color",ut.color),A.xp6(1),A.Q6J("value",ut.pageSize)("disabled",ut.disabled)("aria-labelledby",ut._pageSizeLabelId)("panelClass",ut.selectConfig.panelClass||"")("disableOptionCentering",ut.selectConfig.disableOptionCentering),A.xp6(1),A.Q6J("ngForOf",ut._displayedPageSizeOptions)}}function Bt(jt,zn){if(1&jt&&(A.TgZ(0,"div",20),A._uU(1),A.qZA()),2&jt){const ut=A.oxw(2);A.xp6(1),A.Oqu(ut.pageSize)}}function tt(jt,zn){if(1&jt&&(A.TgZ(0,"div",12)(1,"div",13),A._uU(2),A.qZA(),A.YNc(3,Hi,3,8,"mat-form-field",14),A.YNc(4,Bt,2,1,"div",15),A.qZA()),2&jt){const ut=A.oxw();A.xp6(1),A.s9C("id",ut._pageSizeLabelId),A.xp6(1),A.hij(" ",ut._intl.itemsPerPageLabel," "),A.xp6(1),A.Q6J("ngIf",ut._displayedPageSizeOptions.length>1),A.xp6(1),A.Q6J("ngIf",ut._displayedPageSizeOptions.length<=1)}}function Ve(jt,zn){if(1&jt){const ut=A.EpF();A.TgZ(0,"button",21),A.NdJ("click",function(){A.CHM(ut);const Qt=A.oxw();return A.KtG(Qt.firstPage())}),A.O4$(),A.TgZ(1,"svg",7),A._UZ(2,"path",22),A.qZA()()}if(2&jt){const ut=A.oxw();A.Q6J("matTooltip",ut._intl.firstPageLabel)("matTooltipDisabled",ut._previousButtonsDisabled())("matTooltipPosition","above")("disabled",ut._previousButtonsDisabled()),A.uIk("aria-label",ut._intl.firstPageLabel)}}function Nt(jt,zn){if(1&jt){const ut=A.EpF();A.O4$(),A.kcU(),A.TgZ(0,"button",23),A.NdJ("click",function(){A.CHM(ut);const Qt=A.oxw();return A.KtG(Qt.lastPage())}),A.O4$(),A.TgZ(1,"svg",7),A._UZ(2,"path",24),A.qZA()()}if(2&jt){const ut=A.oxw();A.Q6J("matTooltip",ut._intl.lastPageLabel)("matTooltipDisabled",ut._nextButtonsDisabled())("matTooltipPosition","above")("disabled",ut._nextButtonsDisabled()),A.uIk("aria-label",ut._intl.lastPageLabel)}}let Vt=(()=>{class jt{constructor(){this.changes=new ke.x,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=(ut,yi,Qt)=>{if(0==Qt||0==yi)return`0 of ${Qt}`;const Bi=ut*yi;return`${Bi+1} \u2013 ${Bi<(Qt=Math.max(Qt,0))?Math.min(Bi+yi,Qt):Bi+yi} of ${Qt}`}}static#e=this.\u0275fac=function(yi){return new(yi||jt)};static#t=this.\u0275prov=A.Yz7({token:jt,factory:jt.\u0275fac,providedIn:"root"})}return jt})();const Fi={provide:Vt,deps:[[new A.FiY,new A.tp0,Vt]],useFactory:function Pi(jt){return jt||new Vt}},Je=new A.OlP("MAT_PAGINATOR_DEFAULT_OPTIONS"),pi=(0,Qi.Id)((0,Qi.dB)(class{}));let ni=(()=>{class jt extends pi{get pageIndex(){return this._pageIndex}set pageIndex(ut){this._pageIndex=Math.max((0,mi.su)(ut),0),this._changeDetectorRef.markForCheck()}get length(){return this._length}set length(ut){this._length=(0,mi.su)(ut),this._changeDetectorRef.markForCheck()}get pageSize(){return this._pageSize}set pageSize(ut){this._pageSize=Math.max((0,mi.su)(ut),0),this._updateDisplayedPageSizeOptions()}get pageSizeOptions(){return this._pageSizeOptions}set pageSizeOptions(ut){this._pageSizeOptions=(ut||[]).map(yi=>(0,mi.su)(yi)),this._updateDisplayedPageSizeOptions()}get hidePageSize(){return this._hidePageSize}set hidePageSize(ut){this._hidePageSize=(0,mi.Ig)(ut)}get showFirstLastButtons(){return this._showFirstLastButtons}set showFirstLastButtons(ut){this._showFirstLastButtons=(0,mi.Ig)(ut)}constructor(ut,yi,Qt){if(super(),this._intl=ut,this._changeDetectorRef=yi,this._pageIndex=0,this._length=0,this._pageSizeOptions=[],this._hidePageSize=!1,this._showFirstLastButtons=!1,this.selectConfig={},this.page=new A.vpe,this._intlChanges=ut.changes.subscribe(()=>this._changeDetectorRef.markForCheck()),Qt){const{pageSize:Bi,pageSizeOptions:ts,hidePageSize:ps,showFirstLastButtons:Os}=Qt;null!=Bi&&(this._pageSize=Bi),null!=ts&&(this._pageSizeOptions=ts),null!=ps&&(this._hidePageSize=ps),null!=Os&&(this._showFirstLastButtons=Os)}}ngOnInit(){this._initialized=!0,this._updateDisplayedPageSizeOptions(),this._markInitialized()}ngOnDestroy(){this._intlChanges.unsubscribe()}nextPage(){if(!this.hasNextPage())return;const ut=this.pageIndex;this.pageIndex=this.pageIndex+1,this._emitPageEvent(ut)}previousPage(){if(!this.hasPreviousPage())return;const ut=this.pageIndex;this.pageIndex=this.pageIndex-1,this._emitPageEvent(ut)}firstPage(){if(!this.hasPreviousPage())return;const ut=this.pageIndex;this.pageIndex=0,this._emitPageEvent(ut)}lastPage(){if(!this.hasNextPage())return;const ut=this.pageIndex;this.pageIndex=this.getNumberOfPages()-1,this._emitPageEvent(ut)}hasPreviousPage(){return this.pageIndex>=1&&0!=this.pageSize}hasNextPage(){const ut=this.getNumberOfPages()-1;return this.pageIndex<ut&&0!=this.pageSize}getNumberOfPages(){return this.pageSize?Math.ceil(this.length/this.pageSize):0}_changePageSize(ut){const Qt=this.pageIndex;this.pageIndex=Math.floor(this.pageIndex*this.pageSize/ut)||0,this.pageSize=ut,this._emitPageEvent(Qt)}_nextButtonsDisabled(){return this.disabled||!this.hasNextPage()}_previousButtonsDisabled(){return this.disabled||!this.hasPreviousPage()}_updateDisplayedPageSizeOptions(){this._initialized&&(this.pageSize||(this._pageSize=0!=this.pageSizeOptions.length?this.pageSizeOptions[0]:50),this._displayedPageSizeOptions=this.pageSizeOptions.slice(),-1===this._displayedPageSizeOptions.indexOf(this.pageSize)&&this._displayedPageSizeOptions.push(this.pageSize),this._displayedPageSizeOptions.sort((ut,yi)=>ut-yi),this._changeDetectorRef.markForCheck())}_emitPageEvent(ut){this.page.emit({previousPageIndex:ut,pageIndex:this.pageIndex,pageSize:this.pageSize,length:this.length})}static#e=this.\u0275fac=function(yi){A.$Z()};static#t=this.\u0275dir=A.lG2({type:jt,inputs:{color:"color",pageIndex:"pageIndex",length:"length",pageSize:"pageSize",pageSizeOptions:"pageSizeOptions",hidePageSize:"hidePageSize",showFirstLastButtons:"showFirstLastButtons",selectConfig:"selectConfig"},outputs:{page:"page"},features:[A.qOj]})}return jt})(),Mn=0,ls=(()=>{class jt extends ni{constructor(ut,yi,Qt){super(ut,yi,Qt),this._pageSizeLabelId="mat-paginator-page-size-label-"+Mn++,this._formFieldAppearance=Qt?.formFieldAppearance||"outline"}static#e=this.\u0275fac=function(yi){return new(yi||jt)(A.Y36(Vt),A.Y36(A.sBO),A.Y36(Je,8))};static#t=this.\u0275cmp=A.Xpm({type:jt,selectors:[["mat-paginator"]],hostAttrs:["role","group",1,"mat-mdc-paginator"],inputs:{disabled:"disabled"},exportAs:["matPaginator"],features:[A.qOj],decls:14,vars:14,consts:[[1,"mat-mdc-paginator-outer-container"],[1,"mat-mdc-paginator-container"],["class","mat-mdc-paginator-page-size",4,"ngIf"],[1,"mat-mdc-paginator-range-actions"],["aria-live","polite",1,"mat-mdc-paginator-range-label"],["mat-icon-button","","type","button","class","mat-mdc-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-previous",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["viewBox","0 0 24 24","focusable","false","aria-hidden","true",1,"mat-mdc-paginator-icon"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-next",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["mat-icon-button","","type","button","class","mat-mdc-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click",4,"ngIf"],[1,"mat-mdc-paginator-page-size"],[1,"mat-mdc-paginator-page-size-label",3,"id"],["class","mat-mdc-paginator-page-size-select",3,"appearance","color",4,"ngIf"],["class","mat-mdc-paginator-page-size-value",4,"ngIf"],[1,"mat-mdc-paginator-page-size-select",3,"appearance","color"],["hideSingleSelectionIndicator","",3,"value","disabled","aria-labelledby","panelClass","disableOptionCentering","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"mat-mdc-paginator-page-size-value"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled","click"],["d","M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"]],template:function(yi,Qt){1&yi&&(A.TgZ(0,"div",0)(1,"div",1),A.YNc(2,tt,5,4,"div",2),A.TgZ(3,"div",3)(4,"div",4),A._uU(5),A.qZA(),A.YNc(6,Ve,3,5,"button",5),A.TgZ(7,"button",6),A.NdJ("click",function(){return Qt.previousPage()}),A.O4$(),A.TgZ(8,"svg",7),A._UZ(9,"path",8),A.qZA()(),A.kcU(),A.TgZ(10,"button",9),A.NdJ("click",function(){return Qt.nextPage()}),A.O4$(),A.TgZ(11,"svg",7),A._UZ(12,"path",10),A.qZA()(),A.YNc(13,Nt,3,5,"button",11),A.qZA()()()),2&yi&&(A.xp6(2),A.Q6J("ngIf",!Qt.hidePageSize),A.xp6(3),A.hij(" ",Qt._intl.getRangeLabel(Qt.pageIndex,Qt.pageSize,Qt.length)," "),A.xp6(1),A.Q6J("ngIf",Qt.showFirstLastButtons),A.xp6(1),A.Q6J("matTooltip",Qt._intl.previousPageLabel)("matTooltipDisabled",Qt._previousButtonsDisabled())("matTooltipPosition","above")("disabled",Qt._previousButtonsDisabled()),A.uIk("aria-label",Qt._intl.previousPageLabel),A.xp6(3),A.Q6J("matTooltip",Qt._intl.nextPageLabel)("matTooltipDisabled",Qt._nextButtonsDisabled())("matTooltipPosition","above")("disabled",Qt._nextButtonsDisabled()),A.uIk("aria-label",Qt._intl.nextPageLabel),A.xp6(3),A.Q6J("ngIf",Qt.showFirstLastButtons))},dependencies:[x.sg,x.O5,d.RK,$t.KE,R.gD,Qi.ey,Li.gM],styles:[".mat-mdc-paginator{display:block;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:var(--mat-paginator-container-text-color);background-color:var(--mat-paginator-container-background-color);font-family:var(--mat-paginator-container-text-font);line-height:var(--mat-paginator-container-text-line-height);font-size:var(--mat-paginator-container-text-size);font-weight:var(--mat-paginator-container-text-weight);letter-spacing:var(--mat-paginator-container-text-tracking)}.mat-mdc-paginator .mat-mdc-select-value{font-size:var(--mat-paginator-select-trigger-text-size)}.mat-mdc-paginator .mat-mdc-form-field-subscript-wrapper{display:none}.mat-mdc-paginator .mat-mdc-select{line-height:1.5}.mat-mdc-paginator-outer-container{display:flex}.mat-mdc-paginator-container{display:flex;align-items:center;justify-content:flex-end;padding:0 8px;flex-wrap:wrap-reverse;width:100%;min-height:var(--mat-paginator-container-size)}.mat-mdc-paginator-page-size{display:flex;align-items:baseline;margin-right:8px}[dir=rtl] .mat-mdc-paginator-page-size{margin-right:0;margin-left:8px}.mat-mdc-paginator-page-size-label{margin:0 4px}.mat-mdc-paginator-page-size-select{margin:0 4px;width:84px}.mat-mdc-paginator-range-label{margin:0 32px 0 24px}.mat-mdc-paginator-range-actions{display:flex;align-items:center}.mat-mdc-paginator-icon{display:inline-block;width:28px;fill:var(--mat-paginator-enabled-icon-color)}.mat-mdc-icon-button[disabled] .mat-mdc-paginator-icon{fill:var(--mat-paginator-disabled-icon-color)}[dir=rtl] .mat-mdc-paginator-icon{transform:rotate(180deg)}.cdk-high-contrast-active .mat-mdc-icon-button[disabled] .mat-mdc-paginator-icon,.cdk-high-contrast-active .mat-mdc-paginator-icon{fill:currentColor;fill:CanvasText}.cdk-high-contrast-active .mat-mdc-paginator-range-actions .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0})}return jt})(),ir=(()=>{class jt{static#e=this.\u0275fac=function(yi){return new(yi||jt)};static#t=this.\u0275mod=A.oAB({type:jt});static#i=this.\u0275inj=A.cJS({providers:[Fi],imports:[x.ez,d.ot,R.LD,Li.AV]})}return jt})()},8675:(ot,zt,V)=>{"use strict";V.d(zt,{LD:()=>Sn,gD:()=>Tn});var x=V(8146),A=V(6733),ke=V(755),d=V(4220),R=V(6125),Li=V(3753),Qi=V(7583),mi=V(5667),$t=V(2561),Zi=V(5981),Hi=V(5262),Bt=V(3226),tt=V(8748),Ve=V(3562),Nt=V(5047),Vt=V(3843),Pi=V(4787),Fi=V(1813),Ht=V(5333),si=V(2425),Je=V(8004),pi=V(1749),ni=V(2405);const Mn=["trigger"],ls=["panel"];function ir(dt,Ni){if(1&dt&&(ke.TgZ(0,"span",10),ke._uU(1),ke.qZA()),2&dt){const j=ke.oxw();ke.xp6(1),ke.Oqu(j.placeholder)}}function jt(dt,Ni){if(1&dt&&(ke.TgZ(0,"span",14),ke._uU(1),ke.qZA()),2&dt){const j=ke.oxw(2);ke.xp6(1),ke.Oqu(j.triggerValue)}}function zn(dt,Ni){1&dt&&ke.Hsn(0,0,["*ngSwitchCase","true"])}function ut(dt,Ni){if(1&dt&&(ke.TgZ(0,"span",11),ke.YNc(1,jt,2,1,"span",12),ke.YNc(2,zn,1,0,"ng-content",13),ke.qZA()),2&dt){const j=ke.oxw();ke.Q6J("ngSwitch",!!j.customTrigger),ke.xp6(2),ke.Q6J("ngSwitchCase",!0)}}function yi(dt,Ni){if(1&dt){const j=ke.EpF();ke.O4$(),ke.kcU(),ke.TgZ(0,"div",15,16),ke.NdJ("@transformPanel.done",function(De){ke.CHM(j);const Mt=ke.oxw();return ke.KtG(Mt._panelDoneAnimatingStream.next(De.toState))})("keydown",function(De){ke.CHM(j);const Mt=ke.oxw();return ke.KtG(Mt._handleKeydown(De))}),ke.Hsn(2,1),ke.qZA()}if(2&dt){const j=ke.oxw();ke.Gre("mat-mdc-select-panel mdc-menu-surface mdc-menu-surface--open ",j._getPanelTheme(),""),ke.Q6J("ngClass",j.panelClass)("@transformPanel","showing"),ke.uIk("id",j.id+"-panel")("aria-multiselectable",j.multiple)("aria-label",j.ariaLabel||null)("aria-labelledby",j._getPanelAriaLabelledby())}}const Qt=[[["mat-select-trigger"]],"*"],Bi=["mat-select-trigger","*"],ts={transformPanelWrap:(0,ni.X$)("transformPanelWrap",[(0,ni.eR)("* => void",(0,ni.IO)("@transformPanel",[(0,ni.pV)()],{optional:!0}))]),transformPanel:(0,ni.X$)("transformPanel",[(0,ni.SB)("void",(0,ni.oB)({opacity:0,transform:"scale(1, 0.8)"})),(0,ni.eR)("void => showing",(0,ni.jt)("120ms cubic-bezier(0, 0, 0.2, 1)",(0,ni.oB)({opacity:1,transform:"scale(1, 1)"}))),(0,ni.eR)("* => void",(0,ni.jt)("100ms linear",(0,ni.oB)({opacity:0})))])};let cs=0;const pn=new ke.OlP("mat-select-scroll-strategy"),jn=new ke.OlP("MAT_SELECT_CONFIG"),Vi={provide:pn,deps:[x.aV],useFactory:function fn(dt){return()=>dt.scrollStrategies.reposition()}},ds=new ke.OlP("MatSelectTrigger");class fs{constructor(Ni,j){this.source=Ni,this.value=j}}const bn=(0,d.Kr)((0,d.sb)((0,d.Id)((0,d.FD)(class{constructor(dt,Ni,j,he,De){this._elementRef=dt,this._defaultErrorStateMatcher=Ni,this._parentForm=j,this._parentFormGroup=he,this.ngControl=De,this.stateChanges=new tt.x}}))));let gi=(()=>{class dt extends bn{get focused(){return this._focused||this._panelOpen}get placeholder(){return this._placeholder}set placeholder(j){this._placeholder=j,this.stateChanges.next()}get required(){return this._required??this.ngControl?.control?.hasValidator(Bt.kI.required)??!1}set required(j){this._required=(0,$t.Ig)(j),this.stateChanges.next()}get multiple(){return this._multiple}set multiple(j){this._multiple=(0,$t.Ig)(j)}get disableOptionCentering(){return this._disableOptionCentering}set disableOptionCentering(j){this._disableOptionCentering=(0,$t.Ig)(j)}get compareWith(){return this._compareWith}set compareWith(j){this._compareWith=j,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(j){this._assignValue(j)&&this._onChange(j)}get typeaheadDebounceInterval(){return this._typeaheadDebounceInterval}set typeaheadDebounceInterval(j){this._typeaheadDebounceInterval=(0,$t.su)(j)}get id(){return this._id}set id(j){this._id=j||this._uid,this.stateChanges.next()}constructor(j,he,De,Mt,it,Ln,ge,Ne,je,Zt,ne,z,Qe,mt){super(it,Mt,ge,Ne,Zt),this._viewportRuler=j,this._changeDetectorRef=he,this._ngZone=De,this._dir=Ln,this._parentFormField=je,this._liveAnnouncer=Qe,this._defaultOptions=mt,this._panelOpen=!1,this._compareWith=(ht,Ae)=>ht===Ae,this._uid="mat-select-"+cs++,this._triggerAriaLabelledBy=null,this._destroy=new tt.x,this._onChange=()=>{},this._onTouched=()=>{},this._valueId="mat-select-value-"+cs++,this._panelDoneAnimatingStream=new tt.x,this._overlayPanelClass=this._defaultOptions?.overlayPanelClass||"",this._focused=!1,this.controlType="mat-select",this._multiple=!1,this._disableOptionCentering=this._defaultOptions?.disableOptionCentering??!1,this.ariaLabel="",this.optionSelectionChanges=(0,Ve.P)(()=>{const ht=this.options;return ht?ht.changes.pipe((0,Vt.O)(ht),(0,Pi.w)(()=>(0,Nt.T)(...ht.map(Ae=>Ae.onSelectionChange)))):this._ngZone.onStable.pipe((0,Fi.q)(1),(0,Pi.w)(()=>this.optionSelectionChanges))}),this.openedChange=new ke.vpe,this._openedStream=this.openedChange.pipe((0,Ht.h)(ht=>ht),(0,si.U)(()=>{})),this._closedStream=this.openedChange.pipe((0,Ht.h)(ht=>!ht),(0,si.U)(()=>{})),this.selectionChange=new ke.vpe,this.valueChange=new ke.vpe,this._trackedModal=null,this.ngControl&&(this.ngControl.valueAccessor=this),null!=mt?.typeaheadDebounceInterval&&(this._typeaheadDebounceInterval=mt.typeaheadDebounceInterval),this._scrollStrategyFactory=z,this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=parseInt(ne)||0,this.id=this.id}ngOnInit(){this._selectionModel=new Zi.Ov(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe((0,Je.x)(),(0,pi.R)(this._destroy)).subscribe(()=>this._panelDoneAnimating(this.panelOpen))}ngAfterContentInit(){this._initKeyManager(),this._selectionModel.changed.pipe((0,pi.R)(this._destroy)).subscribe(j=>{j.added.forEach(he=>he.select()),j.removed.forEach(he=>he.deselect())}),this.options.changes.pipe((0,Vt.O)(null),(0,pi.R)(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){const j=this._getTriggerAriaLabelledby(),he=this.ngControl;if(j!==this._triggerAriaLabelledBy){const De=this._elementRef.nativeElement;this._triggerAriaLabelledBy=j,j?De.setAttribute("aria-labelledby",j):De.removeAttribute("aria-labelledby")}he&&(this._previousControl!==he.control&&(void 0!==this._previousControl&&null!==he.disabled&&he.disabled!==this.disabled&&(this.disabled=he.disabled),this._previousControl=he.control),this.updateErrorState())}ngOnChanges(j){(j.disabled||j.userAriaDescribedBy)&&this.stateChanges.next(),j.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this._typeaheadDebounceInterval)}ngOnDestroy(){this._keyManager?.destroy(),this._destroy.next(),this._destroy.complete(),this.stateChanges.complete(),this._clearFromModal()}toggle(){this.panelOpen?this.close():this.open()}open(){this._canOpen()&&(this._applyModalPanelOwnership(),this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck())}_applyModalPanelOwnership(){const j=this._elementRef.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!j)return;const he=`${this.id}-panel`;this._trackedModal&&(0,Qi.iD)(this._trackedModal,"aria-owns",he),(0,Qi.Zf)(j,"aria-owns",he),this._trackedModal=j}_clearFromModal(){this._trackedModal&&((0,Qi.iD)(this._trackedModal,"aria-owns",`${this.id}-panel`),this._trackedModal=null)}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched())}writeValue(j){this._assignValue(j)}registerOnChange(j){this._onChange=j}registerOnTouched(j){this._onTouched=j}setDisabledState(j){this.disabled=j,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel?.selected||[]:this._selectionModel?.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){const j=this._selectionModel.selected.map(he=>he.viewValue);return this._isRtl()&&j.reverse(),j.join(", ")}return this._selectionModel.selected[0].viewValue}_isRtl(){return!!this._dir&&"rtl"===this._dir.value}_handleKeydown(j){this.disabled||(this.panelOpen?this._handleOpenKeydown(j):this._handleClosedKeydown(j))}_handleClosedKeydown(j){const he=j.keyCode,De=he===Hi.JH||he===Hi.LH||he===Hi.oh||he===Hi.SV,Mt=he===Hi.K5||he===Hi.L_,it=this._keyManager;if(!it.isTyping()&&Mt&&!(0,Hi.Vb)(j)||(this.multiple||j.altKey)&&De)j.preventDefault(),this.open();else if(!this.multiple){const Ln=this.selected;it.onKeydown(j);const ge=this.selected;ge&&Ln!==ge&&this._liveAnnouncer.announce(ge.viewValue,1e4)}}_handleOpenKeydown(j){const he=this._keyManager,De=j.keyCode,Mt=De===Hi.JH||De===Hi.LH,it=he.isTyping();if(Mt&&j.altKey)j.preventDefault(),this.close();else if(it||De!==Hi.K5&&De!==Hi.L_||!he.activeItem||(0,Hi.Vb)(j))if(!it&&this._multiple&&De===Hi.A&&j.ctrlKey){j.preventDefault();const Ln=this.options.some(ge=>!ge.disabled&&!ge.selected);this.options.forEach(ge=>{ge.disabled||(Ln?ge.select():ge.deselect())})}else{const Ln=he.activeItemIndex;he.onKeydown(j),this._multiple&&Mt&&j.shiftKey&&he.activeItem&&he.activeItemIndex!==Ln&&he.activeItem._selectViaInteraction()}else j.preventDefault(),he.activeItem._selectViaInteraction()}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,this._keyManager?.cancelTypeahead(),!this.disabled&&!this.panelOpen&&(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this._overlayDir.positionChange.pipe((0,Fi.q)(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._positioningSettled()})}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this.ngControl&&(this._value=this.ngControl.value),this._setSelectionByValue(this._value),this.stateChanges.next()})}_setSelectionByValue(j){if(this.options.forEach(he=>he.setInactiveStyles()),this._selectionModel.clear(),this.multiple&&j)Array.isArray(j),j.forEach(he=>this._selectOptionByValue(he)),this._sortValues();else{const he=this._selectOptionByValue(j);he?this._keyManager.updateActiveItem(he):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectOptionByValue(j){const he=this.options.find(De=>{if(this._selectionModel.isSelected(De))return!1;try{return null!=De.value&&this._compareWith(De.value,j)}catch{return!1}});return he&&this._selectionModel.select(he),he}_assignValue(j){return!!(j!==this._value||this._multiple&&Array.isArray(j))&&(this.options&&this._setSelectionByValue(j),this._value=j,!0)}_skipPredicate(j){return j.disabled}_initKeyManager(){this._keyManager=new Qi.s1(this.options).withTypeAhead(this._typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withPageUpDown().withAllowedModifierKeys(["shiftKey"]).skipPredicate(this._skipPredicate),this._keyManager.tabOut.subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.subscribe(()=>{this._panelOpen&&this.panel?this._scrollOptionIntoView(this._keyManager.activeItemIndex||0):!this._panelOpen&&!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){const j=(0,Nt.T)(this.options.changes,this._destroy);this.optionSelectionChanges.pipe((0,pi.R)(j)).subscribe(he=>{this._onSelect(he.source,he.isUserInput),he.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),(0,Nt.T)(...this.options.map(he=>he._stateChanges)).pipe((0,pi.R)(j)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this.stateChanges.next()})}_onSelect(j,he){const De=this._selectionModel.isSelected(j);null!=j.value||this._multiple?(De!==j.selected&&(j.selected?this._selectionModel.select(j):this._selectionModel.deselect(j)),he&&this._keyManager.setActiveItem(j),this.multiple&&(this._sortValues(),he&&this.focus())):(j.deselect(),this._selectionModel.clear(),null!=this.value&&this._propagateChanges(j.value)),De!==this._selectionModel.isSelected(j)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){const j=this.options.toArray();this._selectionModel.sort((he,De)=>this.sortComparator?this.sortComparator(he,De,j):j.indexOf(he)-j.indexOf(De)),this.stateChanges.next()}}_propagateChanges(j){let he=null;he=this.multiple?this.selected.map(De=>De.value):this.selected?this.selected.value:j,this._value=he,this.valueChange.emit(he),this._onChange(he),this.selectionChange.emit(this._getChangeEvent(he)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){if(this._keyManager)if(this.empty){let j=-1;for(let he=0;he<this.options.length;he++)if(!this.options.get(he).disabled){j=he;break}this._keyManager.setActiveItem(j)}else this._keyManager.setActiveItem(this._selectionModel.selected[0])}_canOpen(){return!this._panelOpen&&!this.disabled&&this.options?.length>0}focus(j){this._elementRef.nativeElement.focus(j)}_getPanelAriaLabelledby(){if(this.ariaLabel)return null;const j=this._parentFormField?.getLabelId();return this.ariaLabelledby?(j?j+" ":"")+this.ariaLabelledby:j}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getTriggerAriaLabelledby(){if(this.ariaLabel)return null;const j=this._parentFormField?.getLabelId();let he=(j?j+" ":"")+this._valueId;return this.ariaLabelledby&&(he+=" "+this.ariaLabelledby),he}_panelDoneAnimating(j){this.openedChange.emit(j)}setDescribedByIds(j){j.length?this._elementRef.nativeElement.setAttribute("aria-describedby",j.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this._panelOpen||!this.empty||this._focused&&!!this._placeholder}static#e=this.\u0275fac=function(he){return new(he||dt)(ke.Y36(Li.rL),ke.Y36(ke.sBO),ke.Y36(ke.R0b),ke.Y36(d.rD),ke.Y36(ke.SBq),ke.Y36(mi.Is,8),ke.Y36(Bt.F,8),ke.Y36(Bt.sg,8),ke.Y36(R.G_,8),ke.Y36(Bt.a5,10),ke.$8M("tabindex"),ke.Y36(pn),ke.Y36(Qi.Kd),ke.Y36(jn,8))};static#t=this.\u0275dir=ke.lG2({type:dt,viewQuery:function(he,De){if(1&he&&(ke.Gf(Mn,5),ke.Gf(ls,5),ke.Gf(x.pI,5)),2&he){let Mt;ke.iGM(Mt=ke.CRH())&&(De.trigger=Mt.first),ke.iGM(Mt=ke.CRH())&&(De.panel=Mt.first),ke.iGM(Mt=ke.CRH())&&(De._overlayDir=Mt.first)}},inputs:{userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],panelClass:"panelClass",placeholder:"placeholder",required:"required",multiple:"multiple",disableOptionCentering:"disableOptionCentering",compareWith:"compareWith",value:"value",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",typeaheadDebounceInterval:"typeaheadDebounceInterval",sortComparator:"sortComparator",id:"id"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},features:[ke.qOj,ke.TTD]})}return dt})(),Tn=(()=>{class dt extends gi{constructor(){super(...arguments),this.panelWidth=this._defaultOptions&&typeof this._defaultOptions.panelWidth<"u"?this._defaultOptions.panelWidth:"auto",this._positions=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"}],this._hideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1,this._skipPredicate=j=>!this.panelOpen&&j.disabled}get shouldLabelFloat(){return this.panelOpen||!this.empty||this.focused&&!!this.placeholder}ngOnInit(){super.ngOnInit(),this._viewportRuler.change().pipe((0,pi.R)(this._destroy)).subscribe(()=>{this.panelOpen&&(this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._changeDetectorRef.detectChanges())})}open(){this._parentFormField&&(this._preferredOverlayOrigin=this._parentFormField.getConnectedOverlayOrigin()),this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),super.open(),this.stateChanges.next()}close(){super.close(),this.stateChanges.next()}_scrollOptionIntoView(j){const he=this.options.toArray()[j];if(he){const De=this.panel.nativeElement,Mt=(0,d.CB)(j,this.options,this.optionGroups),it=he._getHostElement();De.scrollTop=0===j&&1===Mt?0:(0,d.jH)(it.offsetTop,it.offsetHeight,De.scrollTop,De.offsetHeight)}}_positioningSettled(){this._scrollOptionIntoView(this._keyManager.activeItemIndex||0)}_getChangeEvent(j){return new fs(this,j)}_getOverlayWidth(j){return"auto"===this.panelWidth?(j instanceof x.xu?j.elementRef:j||this._elementRef).nativeElement.getBoundingClientRect().width:null===this.panelWidth?"":this.panelWidth}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(j){this._hideSingleSelectionIndicator=(0,$t.Ig)(j),this._syncParentProperties()}_syncParentProperties(){if(this.options)for(const j of this.options)j._changeDetectorRef.markForCheck()}static#e=this.\u0275fac=function(){let j;return function(De){return(j||(j=ke.n5z(dt)))(De||dt)}}();static#t=this.\u0275cmp=ke.Xpm({type:dt,selectors:[["mat-select"]],contentQueries:function(he,De,Mt){if(1&he&&(ke.Suo(Mt,ds,5),ke.Suo(Mt,d.ey,5),ke.Suo(Mt,d.K7,5)),2&he){let it;ke.iGM(it=ke.CRH())&&(De.customTrigger=it.first),ke.iGM(it=ke.CRH())&&(De.options=it),ke.iGM(it=ke.CRH())&&(De.optionGroups=it)}},hostAttrs:["role","combobox","aria-autocomplete","none","aria-haspopup","listbox","ngSkipHydration","",1,"mat-mdc-select"],hostVars:19,hostBindings:function(he,De){1&he&&ke.NdJ("keydown",function(it){return De._handleKeydown(it)})("focus",function(){return De._onFocus()})("blur",function(){return De._onBlur()}),2&he&&(ke.uIk("id",De.id)("tabindex",De.tabIndex)("aria-controls",De.panelOpen?De.id+"-panel":null)("aria-expanded",De.panelOpen)("aria-label",De.ariaLabel||null)("aria-required",De.required.toString())("aria-disabled",De.disabled.toString())("aria-invalid",De.errorState)("aria-activedescendant",De._getAriaActiveDescendant()),ke.ekj("mat-mdc-select-disabled",De.disabled)("mat-mdc-select-invalid",De.errorState)("mat-mdc-select-required",De.required)("mat-mdc-select-empty",De.empty)("mat-mdc-select-multiple",De.multiple))},inputs:{disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex",panelWidth:"panelWidth",hideSingleSelectionIndicator:"hideSingleSelectionIndicator"},exportAs:["matSelect"],features:[ke._Bn([{provide:R.Eo,useExisting:dt},{provide:d.HF,useExisting:dt}]),ke.qOj],ngContentSelectors:Bi,decls:11,vars:10,consts:[["cdk-overlay-origin","",1,"mat-mdc-select-trigger",3,"click"],["fallbackOverlayOrigin","cdkOverlayOrigin","trigger",""],[1,"mat-mdc-select-value",3,"ngSwitch"],["class","mat-mdc-select-placeholder mat-mdc-select-min-line",4,"ngSwitchCase"],["class","mat-mdc-select-value-text",3,"ngSwitch",4,"ngSwitchCase"],[1,"mat-mdc-select-arrow-wrapper"],[1,"mat-mdc-select-arrow"],["viewBox","0 0 24 24","width","24px","height","24px","focusable","false","aria-hidden","true"],["d","M7 10l5 5 5-5z"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"cdkConnectedOverlayPanelClass","cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayWidth","backdropClick","attach","detach"],[1,"mat-mdc-select-placeholder","mat-mdc-select-min-line"],[1,"mat-mdc-select-value-text",3,"ngSwitch"],["class","mat-mdc-select-min-line",4,"ngSwitchDefault"],[4,"ngSwitchCase"],[1,"mat-mdc-select-min-line"],["role","listbox","tabindex","-1",3,"ngClass","keydown"],["panel",""]],template:function(he,De){if(1&he&&(ke.F$t(Qt),ke.TgZ(0,"div",0,1),ke.NdJ("click",function(){return De.toggle()}),ke.TgZ(3,"div",2),ke.YNc(4,ir,2,1,"span",3),ke.YNc(5,ut,3,2,"span",4),ke.qZA(),ke.TgZ(6,"div",5)(7,"div",6),ke.O4$(),ke.TgZ(8,"svg",7),ke._UZ(9,"path",8),ke.qZA()()()(),ke.YNc(10,yi,3,9,"ng-template",9),ke.NdJ("backdropClick",function(){return De.close()})("attach",function(){return De._onAttached()})("detach",function(){return De.close()})),2&he){const Mt=ke.MAs(1);ke.xp6(3),ke.Q6J("ngSwitch",De.empty),ke.uIk("id",De._valueId),ke.xp6(1),ke.Q6J("ngSwitchCase",!0),ke.xp6(1),ke.Q6J("ngSwitchCase",!1),ke.xp6(5),ke.Q6J("cdkConnectedOverlayPanelClass",De._overlayPanelClass)("cdkConnectedOverlayScrollStrategy",De._scrollStrategy)("cdkConnectedOverlayOrigin",De._preferredOverlayOrigin||Mt)("cdkConnectedOverlayOpen",De.panelOpen)("cdkConnectedOverlayPositions",De._positions)("cdkConnectedOverlayWidth",De._overlayWidth)}},dependencies:[A.mk,A.RF,A.n9,A.ED,x.pI,x.xu],styles:['.mat-mdc-select{display:inline-block;width:100%;outline:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:var(--mat-select-enabled-trigger-text-color);font-family:var(--mat-select-trigger-text-font);line-height:var(--mat-select-trigger-text-line-height);font-size:var(--mat-select-trigger-text-size);font-weight:var(--mat-select-trigger-text-weight);letter-spacing:var(--mat-select-trigger-text-tracking)}.mat-mdc-select-disabled{color:var(--mat-select-disabled-trigger-text-color)}.mat-mdc-select-trigger{display:inline-flex;align-items:center;cursor:pointer;position:relative;box-sizing:border-box;width:100%}.mat-mdc-select-disabled .mat-mdc-select-trigger{-webkit-user-select:none;user-select:none;cursor:default}.mat-mdc-select-value{width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-mdc-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-mdc-select-arrow-wrapper{height:24px;flex-shrink:0;display:inline-flex;align-items:center}.mat-form-field-appearance-fill .mat-mdc-select-arrow-wrapper{transform:translateY(-8px)}.mat-form-field-appearance-fill .mdc-text-field--no-label .mat-mdc-select-arrow-wrapper{transform:none}.mat-mdc-select-arrow{width:10px;height:5px;position:relative;color:var(--mat-select-enabled-arrow-color)}.mat-mdc-form-field.mat-focused .mat-mdc-select-arrow{color:var(--mat-select-focused-arrow-color)}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-invalid .mat-mdc-select-arrow{color:var(--mat-select-invalid-arrow-color)}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-disabled .mat-mdc-select-arrow{color:var(--mat-select-disabled-arrow-color)}.mat-mdc-select-arrow svg{fill:currentColor;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}.cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:CanvasText}.mat-mdc-select-disabled .cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:GrayText}div.mat-mdc-select-panel{box-shadow:0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12);width:100%;max-height:275px;outline:0;overflow:auto;padding:8px 0;border-radius:4px;box-sizing:border-box;position:static;background-color:var(--mat-select-panel-background-color)}.cdk-high-contrast-active div.mat-mdc-select-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-select-panel-above) div.mat-mdc-select-panel{border-top-left-radius:0;border-top-right-radius:0;transform-origin:top center}.mat-mdc-select-panel-above div.mat-mdc-select-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:bottom center}.mat-mdc-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1);color:var(--mat-select-placeholder-text-color)}._mat-animation-noopable .mat-mdc-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-mdc-select-placeholder{color:rgba(0,0,0,0);-webkit-text-fill-color:rgba(0,0,0,0);transition:none;display:block}.mat-mdc-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper{cursor:pointer}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mat-mdc-floating-label{max-width:calc(100% - 18px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 24px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-text-field--label-floating .mdc-notched-outline__notch{max-width:calc(100% - 24px)}.mat-mdc-select-min-line:empty::before{content:" ";white-space:pre;width:1px;display:inline-block;visibility:hidden}'],encapsulation:2,data:{animation:[ts.transformPanel]},changeDetection:0})}return dt})(),Sn=(()=>{class dt{static#e=this.\u0275fac=function(he){return new(he||dt)};static#t=this.\u0275mod=ke.oAB({type:dt});static#i=this.\u0275inj=ke.cJS({providers:[Vi],imports:[A.ez,x.U8,d.Ng,d.BQ,Li.ZD,R.lN,d.Ng,d.BQ]})}return dt})()},72:(ot,zt,V)=>{"use strict";V.d(zt,{ev:()=>Fa,Dz:()=>Ys,w1:()=>Nr,ge:()=>La,fO:()=>Is,XQ:()=>xa,as:()=>ya,Gk:()=>Fs,nj:()=>Ls,BZ:()=>kr,by:()=>ta,p0:()=>Ma});var x=V(755),A=V(5667),ke=V(2561),d=V(5981),R=V(8491),Li=V(3753),Qi=V(6733),mi=V(8748),$t=V(4690),Zi=V(6424),Hi=V(1070),Bt=V(1209),tt=V(1749),Ve=V(1813);const Nt=[[["caption"]],[["colgroup"],["col"]]],Vt=["caption","colgroup, col"];function Ht(J){return class extends J{get sticky(){return this._sticky}set sticky(_t){const W=this._sticky;this._sticky=(0,ke.Ig)(_t),this._hasStickyChanged=W!==this._sticky}hasStickyChanged(){const _t=this._hasStickyChanged;return this._hasStickyChanged=!1,_t}resetStickyChanged(){this._hasStickyChanged=!1}constructor(..._t){super(..._t),this._sticky=!1,this._hasStickyChanged=!1}}}const si=new x.OlP("CDK_TABLE");let pi=(()=>{class J{constructor(W){this.template=W}static#e=this.\u0275fac=function(ie){return new(ie||J)(x.Y36(x.Rgc))};static#t=this.\u0275dir=x.lG2({type:J,selectors:[["","cdkCellDef",""]]})}return J})(),ni=(()=>{class J{constructor(W){this.template=W}static#e=this.\u0275fac=function(ie){return new(ie||J)(x.Y36(x.Rgc))};static#t=this.\u0275dir=x.lG2({type:J,selectors:[["","cdkHeaderCellDef",""]]})}return J})(),Mn=(()=>{class J{constructor(W){this.template=W}static#e=this.\u0275fac=function(ie){return new(ie||J)(x.Y36(x.Rgc))};static#t=this.\u0275dir=x.lG2({type:J,selectors:[["","cdkFooterCellDef",""]]})}return J})();class ls{}const ir=Ht(ls);let jt=(()=>{class J extends ir{get name(){return this._name}set name(W){this._setNameInput(W)}get stickyEnd(){return this._stickyEnd}set stickyEnd(W){const ie=this._stickyEnd;this._stickyEnd=(0,ke.Ig)(W),this._hasStickyChanged=ie!==this._stickyEnd}constructor(W){super(),this._table=W,this._stickyEnd=!1}_updateColumnCssClassName(){this._columnCssClassName=[`cdk-column-${this.cssClassFriendlyName}`]}_setNameInput(W){W&&(this._name=W,this.cssClassFriendlyName=W.replace(/[^a-z0-9_-]/gi,"-"),this._updateColumnCssClassName())}static#e=this.\u0275fac=function(ie){return new(ie||J)(x.Y36(si,8))};static#t=this.\u0275dir=x.lG2({type:J,selectors:[["","cdkColumnDef",""]],contentQueries:function(ie,_e,ze){if(1&ie&&(x.Suo(ze,pi,5),x.Suo(ze,ni,5),x.Suo(ze,Mn,5)),2&ie){let Ie;x.iGM(Ie=x.CRH())&&(_e.cell=Ie.first),x.iGM(Ie=x.CRH())&&(_e.headerCell=Ie.first),x.iGM(Ie=x.CRH())&&(_e.footerCell=Ie.first)}},inputs:{sticky:"sticky",name:["cdkColumnDef","name"],stickyEnd:"stickyEnd"},features:[x._Bn([{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:J}]),x.qOj]})}return J})();class zn{constructor(_t,W){W.nativeElement.classList.add(..._t._columnCssClassName)}}let ut=(()=>{class J extends zn{constructor(W,ie){super(W,ie)}static#e=this.\u0275fac=function(ie){return new(ie||J)(x.Y36(jt),x.Y36(x.SBq))};static#t=this.\u0275dir=x.lG2({type:J,selectors:[["cdk-header-cell"],["th","cdk-header-cell",""]],hostAttrs:["role","columnheader",1,"cdk-header-cell"],features:[x.qOj]})}return J})(),Qt=(()=>{class J extends zn{constructor(W,ie){if(super(W,ie),1===W._table?._elementRef.nativeElement.nodeType){const _e=W._table._elementRef.nativeElement.getAttribute("role");ie.nativeElement.setAttribute("role","grid"===_e||"treegrid"===_e?"gridcell":"cell")}}static#e=this.\u0275fac=function(ie){return new(ie||J)(x.Y36(jt),x.Y36(x.SBq))};static#t=this.\u0275dir=x.lG2({type:J,selectors:[["cdk-cell"],["td","cdk-cell",""]],hostAttrs:[1,"cdk-cell"],features:[x.qOj]})}return J})();class Bi{constructor(){this.tasks=[],this.endTasks=[]}}const ts=new x.OlP("_COALESCED_STYLE_SCHEDULER");let ps=(()=>{class J{constructor(W){this._ngZone=W,this._currentSchedule=null,this._destroyed=new mi.x}schedule(W){this._createScheduleIfNeeded(),this._currentSchedule.tasks.push(W)}scheduleEnd(W){this._createScheduleIfNeeded(),this._currentSchedule.endTasks.push(W)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_createScheduleIfNeeded(){this._currentSchedule||(this._currentSchedule=new Bi,this._getScheduleObservable().pipe((0,tt.R)(this._destroyed)).subscribe(()=>{for(;this._currentSchedule.tasks.length||this._currentSchedule.endTasks.length;){const W=this._currentSchedule;this._currentSchedule=new Bi;for(const ie of W.tasks)ie();for(const ie of W.endTasks)ie()}this._currentSchedule=null}))}_getScheduleObservable(){return this._ngZone.isStable?(0,$t.D)(Promise.resolve(void 0)):this._ngZone.onStable.pipe((0,Ve.q)(1))}static#e=this.\u0275fac=function(ie){return new(ie||J)(x.LFG(x.R0b))};static#t=this.\u0275prov=x.Yz7({token:J,factory:J.\u0275fac})}return J})(),Rs=(()=>{class J{constructor(W,ie){this.template=W,this._differs=ie}ngOnChanges(W){if(!this._columnsDiffer){const ie=W.columns&&W.columns.currentValue||[];this._columnsDiffer=this._differs.find(ie).create(),this._columnsDiffer.diff(ie)}}getColumnsDiff(){return this._columnsDiffer.diff(this.columns)}extractCellTemplate(W){return this instanceof fn?W.headerCell.template:this instanceof ds?W.footerCell.template:W.cell.template}static#e=this.\u0275fac=function(ie){return new(ie||J)(x.Y36(x.Rgc),x.Y36(x.ZZ4))};static#t=this.\u0275dir=x.lG2({type:J,features:[x.TTD]})}return J})();class cs extends Rs{}const pn=Ht(cs);let fn=(()=>{class J extends pn{constructor(W,ie,_e){super(W,ie),this._table=_e}ngOnChanges(W){super.ngOnChanges(W)}static#e=this.\u0275fac=function(ie){return new(ie||J)(x.Y36(x.Rgc),x.Y36(x.ZZ4),x.Y36(si,8))};static#t=this.\u0275dir=x.lG2({type:J,selectors:[["","cdkHeaderRowDef",""]],inputs:{columns:["cdkHeaderRowDef","columns"],sticky:["cdkHeaderRowDefSticky","sticky"]},features:[x.qOj,x.TTD]})}return J})();class jn extends Rs{}const Vi=Ht(jn);let ds=(()=>{class J extends Vi{constructor(W,ie,_e){super(W,ie),this._table=_e}ngOnChanges(W){super.ngOnChanges(W)}static#e=this.\u0275fac=function(ie){return new(ie||J)(x.Y36(x.Rgc),x.Y36(x.ZZ4),x.Y36(si,8))};static#t=this.\u0275dir=x.lG2({type:J,selectors:[["","cdkFooterRowDef",""]],inputs:{columns:["cdkFooterRowDef","columns"],sticky:["cdkFooterRowDefSticky","sticky"]},features:[x.qOj,x.TTD]})}return J})(),fs=(()=>{class J extends Rs{constructor(W,ie,_e){super(W,ie),this._table=_e}static#e=this.\u0275fac=function(ie){return new(ie||J)(x.Y36(x.Rgc),x.Y36(x.ZZ4),x.Y36(si,8))};static#t=this.\u0275dir=x.lG2({type:J,selectors:[["","cdkRowDef",""]],inputs:{columns:["cdkRowDefColumns","columns"],when:["cdkRowDefWhen","when"]},features:[x.qOj]})}return J})(),bn=(()=>{class J{static#e=this.mostRecentCellOutlet=null;constructor(W){this._viewContainer=W,J.mostRecentCellOutlet=this}ngOnDestroy(){J.mostRecentCellOutlet===this&&(J.mostRecentCellOutlet=null)}static#t=this.\u0275fac=function(ie){return new(ie||J)(x.Y36(x.s_b))};static#i=this.\u0275dir=x.lG2({type:J,selectors:[["","cdkCellOutlet",""]]})}return J})(),gi=(()=>{class J{static#e=this.\u0275fac=function(ie){return new(ie||J)};static#t=this.\u0275cmp=x.Xpm({type:J,selectors:[["cdk-header-row"],["tr","cdk-header-row",""]],hostAttrs:["role","row",1,"cdk-header-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(ie,_e){1&ie&&x.GkF(0,0)},dependencies:[bn],encapsulation:2})}return J})(),Tn=(()=>{class J{static#e=this.\u0275fac=function(ie){return new(ie||J)};static#t=this.\u0275cmp=x.Xpm({type:J,selectors:[["cdk-row"],["tr","cdk-row",""]],hostAttrs:["role","row",1,"cdk-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(ie,_e){1&ie&&x.GkF(0,0)},dependencies:[bn],encapsulation:2})}return J})(),Sn=(()=>{class J{constructor(W){this.templateRef=W,this._contentClassName="cdk-no-data-row"}static#e=this.\u0275fac=function(ie){return new(ie||J)(x.Y36(x.Rgc))};static#t=this.\u0275dir=x.lG2({type:J,selectors:[["ng-template","cdkNoDataRow",""]]})}return J})();const dt=["top","bottom","left","right"];class Ni{constructor(_t,W,ie,_e,ze=!0,Ie=!0,qt){this._isNativeHtmlTable=_t,this._stickCellCss=W,this.direction=ie,this._coalescedStyleScheduler=_e,this._isBrowser=ze,this._needsPositionStickyOnElement=Ie,this._positionListener=qt,this._cachedCellWidths=[],this._borderCellCss={top:`${W}-border-elem-top`,bottom:`${W}-border-elem-bottom`,left:`${W}-border-elem-left`,right:`${W}-border-elem-right`}}clearStickyPositioning(_t,W){const ie=[];for(const _e of _t)if(_e.nodeType===_e.ELEMENT_NODE){ie.push(_e);for(let ze=0;ze<_e.children.length;ze++)ie.push(_e.children[ze])}this._coalescedStyleScheduler.schedule(()=>{for(const _e of ie)this._removeStickyStyle(_e,W)})}updateStickyColumns(_t,W,ie,_e=!0){if(!_t.length||!this._isBrowser||!W.some(Gi=>Gi)&&!ie.some(Gi=>Gi))return void(this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:[]}),this._positionListener.stickyEndColumnsUpdated({sizes:[]})));const ze=_t[0],Ie=ze.children.length,qt=this._getCellWidths(ze,_e),Ei=this._getStickyStartColumnPositions(qt,W),ri=this._getStickyEndColumnPositions(qt,ie),Di=W.lastIndexOf(!0),Zn=ie.indexOf(!0);this._coalescedStyleScheduler.schedule(()=>{const Gi="rtl"===this.direction,ce=Gi?"right":"left",bt=Gi?"left":"right";for(const D of _t)for(let U=0;U<Ie;U++){const F=D.children[U];W[U]&&this._addStickyStyle(F,ce,Ei[U],U===Di),ie[U]&&this._addStickyStyle(F,bt,ri[U],U===Zn)}this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:-1===Di?[]:qt.slice(0,Di+1).map((D,U)=>W[U]?D:null)}),this._positionListener.stickyEndColumnsUpdated({sizes:-1===Zn?[]:qt.slice(Zn).map((D,U)=>ie[U+Zn]?D:null).reverse()}))})}stickRows(_t,W,ie){if(!this._isBrowser)return;const _e="bottom"===ie?_t.slice().reverse():_t,ze="bottom"===ie?W.slice().reverse():W,Ie=[],qt=[],Ei=[];for(let Di=0,Zn=0;Di<_e.length;Di++){if(!ze[Di])continue;Ie[Di]=Zn;const Gi=_e[Di];Ei[Di]=this._isNativeHtmlTable?Array.from(Gi.children):[Gi];const ce=Gi.getBoundingClientRect().height;Zn+=ce,qt[Di]=ce}const ri=ze.lastIndexOf(!0);this._coalescedStyleScheduler.schedule(()=>{for(let Di=0;Di<_e.length;Di++){if(!ze[Di])continue;const Zn=Ie[Di],Gi=Di===ri;for(const ce of Ei[Di])this._addStickyStyle(ce,ie,Zn,Gi)}"top"===ie?this._positionListener?.stickyHeaderRowsUpdated({sizes:qt,offsets:Ie,elements:Ei}):this._positionListener?.stickyFooterRowsUpdated({sizes:qt,offsets:Ie,elements:Ei})})}updateStickyFooterContainer(_t,W){if(!this._isNativeHtmlTable)return;const ie=_t.querySelector("tfoot");this._coalescedStyleScheduler.schedule(()=>{W.some(_e=>!_e)?this._removeStickyStyle(ie,["bottom"]):this._addStickyStyle(ie,"bottom",0,!1)})}_removeStickyStyle(_t,W){for(const _e of W)_t.style[_e]="",_t.classList.remove(this._borderCellCss[_e]);dt.some(_e=>-1===W.indexOf(_e)&&_t.style[_e])?_t.style.zIndex=this._getCalculatedZIndex(_t):(_t.style.zIndex="",this._needsPositionStickyOnElement&&(_t.style.position=""),_t.classList.remove(this._stickCellCss))}_addStickyStyle(_t,W,ie,_e){_t.classList.add(this._stickCellCss),_e&&_t.classList.add(this._borderCellCss[W]),_t.style[W]=`${ie}px`,_t.style.zIndex=this._getCalculatedZIndex(_t),this._needsPositionStickyOnElement&&(_t.style.cssText+="position: -webkit-sticky; position: sticky; ")}_getCalculatedZIndex(_t){const W={top:100,bottom:10,left:1,right:1};let ie=0;for(const _e of dt)_t.style[_e]&&(ie+=W[_e]);return ie?`${ie}`:""}_getCellWidths(_t,W=!0){if(!W&&this._cachedCellWidths.length)return this._cachedCellWidths;const ie=[],_e=_t.children;for(let ze=0;ze<_e.length;ze++)ie.push(_e[ze].getBoundingClientRect().width);return this._cachedCellWidths=ie,ie}_getStickyStartColumnPositions(_t,W){const ie=[];let _e=0;for(let ze=0;ze<_t.length;ze++)W[ze]&&(ie[ze]=_e,_e+=_t[ze]);return ie}_getStickyEndColumnPositions(_t,W){const ie=[];let _e=0;for(let ze=_t.length;ze>0;ze--)W[ze]&&(ie[ze]=_e,_e+=_t[ze]);return ie}}const je=new x.OlP("CDK_SPL");let ne=(()=>{class J{constructor(W,ie){this.viewContainer=W,this.elementRef=ie}static#e=this.\u0275fac=function(ie){return new(ie||J)(x.Y36(x.s_b),x.Y36(x.SBq))};static#t=this.\u0275dir=x.lG2({type:J,selectors:[["","rowOutlet",""]]})}return J})(),z=(()=>{class J{constructor(W,ie){this.viewContainer=W,this.elementRef=ie}static#e=this.\u0275fac=function(ie){return new(ie||J)(x.Y36(x.s_b),x.Y36(x.SBq))};static#t=this.\u0275dir=x.lG2({type:J,selectors:[["","headerRowOutlet",""]]})}return J})(),Qe=(()=>{class J{constructor(W,ie){this.viewContainer=W,this.elementRef=ie}static#e=this.\u0275fac=function(ie){return new(ie||J)(x.Y36(x.s_b),x.Y36(x.SBq))};static#t=this.\u0275dir=x.lG2({type:J,selectors:[["","footerRowOutlet",""]]})}return J})(),mt=(()=>{class J{constructor(W,ie){this.viewContainer=W,this.elementRef=ie}static#e=this.\u0275fac=function(ie){return new(ie||J)(x.Y36(x.s_b),x.Y36(x.SBq))};static#t=this.\u0275dir=x.lG2({type:J,selectors:[["","noDataRowOutlet",""]]})}return J})(),Lt=(()=>{class J{get trackBy(){return this._trackByFn}set trackBy(W){this._trackByFn=W}get dataSource(){return this._dataSource}set dataSource(W){this._dataSource!==W&&this._switchDataSource(W)}get multiTemplateDataRows(){return this._multiTemplateDataRows}set multiTemplateDataRows(W){this._multiTemplateDataRows=(0,ke.Ig)(W),this._rowOutlet&&this._rowOutlet.viewContainer.length&&(this._forceRenderDataRows(),this.updateStickyColumnStyles())}get fixedLayout(){return this._fixedLayout}set fixedLayout(W){this._fixedLayout=(0,ke.Ig)(W),this._forceRecalculateCellWidths=!0,this._stickyColumnStylesNeedReset=!0}constructor(W,ie,_e,ze,Ie,qt,Ei,ri,Di,Zn,Gi,ce){this._differs=W,this._changeDetectorRef=ie,this._elementRef=_e,this._dir=Ie,this._platform=Ei,this._viewRepeater=ri,this._coalescedStyleScheduler=Di,this._viewportRuler=Zn,this._stickyPositioningListener=Gi,this._ngZone=ce,this._onDestroy=new mi.x,this._columnDefsByName=new Map,this._customColumnDefs=new Set,this._customRowDefs=new Set,this._customHeaderRowDefs=new Set,this._customFooterRowDefs=new Set,this._headerRowDefChanged=!0,this._footerRowDefChanged=!0,this._stickyColumnStylesNeedReset=!0,this._forceRecalculateCellWidths=!0,this._cachedRenderRowsMap=new Map,this.stickyCssClass="cdk-table-sticky",this.needsPositionStickyOnElement=!0,this._isShowingNoDataRow=!1,this._multiTemplateDataRows=!1,this._fixedLayout=!1,this.contentChanged=new x.vpe,this.viewChange=new Zi.X({start:0,end:Number.MAX_VALUE}),ze||this._elementRef.nativeElement.setAttribute("role","table"),this._document=qt,this._isNativeHtmlTable="TABLE"===this._elementRef.nativeElement.nodeName}ngOnInit(){this._setupStickyStyler(),this._isNativeHtmlTable&&this._applyNativeTableSections(),this._dataDiffer=this._differs.find([]).create((W,ie)=>this.trackBy?this.trackBy(ie.dataIndex,ie.data):ie),this._viewportRuler.change().pipe((0,tt.R)(this._onDestroy)).subscribe(()=>{this._forceRecalculateCellWidths=!0})}ngAfterContentChecked(){this._cacheRowDefs(),this._cacheColumnDefs();const ie=this._renderUpdatedColumns()||this._headerRowDefChanged||this._footerRowDefChanged;this._stickyColumnStylesNeedReset=this._stickyColumnStylesNeedReset||ie,this._forceRecalculateCellWidths=ie,this._headerRowDefChanged&&(this._forceRenderHeaderRows(),this._headerRowDefChanged=!1),this._footerRowDefChanged&&(this._forceRenderFooterRows(),this._footerRowDefChanged=!1),this.dataSource&&this._rowDefs.length>0&&!this._renderChangeSubscription?this._observeRenderChanges():this._stickyColumnStylesNeedReset&&this.updateStickyColumnStyles(),this._checkStickyStates()}ngOnDestroy(){[this._rowOutlet.viewContainer,this._headerRowOutlet.viewContainer,this._footerRowOutlet.viewContainer,this._cachedRenderRowsMap,this._customColumnDefs,this._customRowDefs,this._customHeaderRowDefs,this._customFooterRowDefs,this._columnDefsByName].forEach(W=>{W.clear()}),this._headerRowDefs=[],this._footerRowDefs=[],this._defaultRowDef=null,this._onDestroy.next(),this._onDestroy.complete(),(0,d.Z9)(this.dataSource)&&this.dataSource.disconnect(this)}renderRows(){this._renderRows=this._getAllRenderRows();const W=this._dataDiffer.diff(this._renderRows);if(!W)return this._updateNoDataRow(),void this.contentChanged.next();const ie=this._rowOutlet.viewContainer;this._viewRepeater.applyChanges(W,ie,(_e,ze,Ie)=>this._getEmbeddedViewArgs(_e.item,Ie),_e=>_e.item.data,_e=>{1===_e.operation&&_e.context&&this._renderCellTemplateForItem(_e.record.item.rowDef,_e.context)}),this._updateRowIndexContext(),W.forEachIdentityChange(_e=>{ie.get(_e.currentIndex).context.$implicit=_e.item.data}),this._updateNoDataRow(),this._ngZone&&x.R0b.isInAngularZone()?this._ngZone.onStable.pipe((0,Ve.q)(1),(0,tt.R)(this._onDestroy)).subscribe(()=>{this.updateStickyColumnStyles()}):this.updateStickyColumnStyles(),this.contentChanged.next()}addColumnDef(W){this._customColumnDefs.add(W)}removeColumnDef(W){this._customColumnDefs.delete(W)}addRowDef(W){this._customRowDefs.add(W)}removeRowDef(W){this._customRowDefs.delete(W)}addHeaderRowDef(W){this._customHeaderRowDefs.add(W),this._headerRowDefChanged=!0}removeHeaderRowDef(W){this._customHeaderRowDefs.delete(W),this._headerRowDefChanged=!0}addFooterRowDef(W){this._customFooterRowDefs.add(W),this._footerRowDefChanged=!0}removeFooterRowDef(W){this._customFooterRowDefs.delete(W),this._footerRowDefChanged=!0}setNoDataRow(W){this._customNoDataRow=W}updateStickyHeaderRowStyles(){const W=this._getRenderedRows(this._headerRowOutlet),_e=this._elementRef.nativeElement.querySelector("thead");_e&&(_e.style.display=W.length?"":"none");const ze=this._headerRowDefs.map(Ie=>Ie.sticky);this._stickyStyler.clearStickyPositioning(W,["top"]),this._stickyStyler.stickRows(W,ze,"top"),this._headerRowDefs.forEach(Ie=>Ie.resetStickyChanged())}updateStickyFooterRowStyles(){const W=this._getRenderedRows(this._footerRowOutlet),_e=this._elementRef.nativeElement.querySelector("tfoot");_e&&(_e.style.display=W.length?"":"none");const ze=this._footerRowDefs.map(Ie=>Ie.sticky);this._stickyStyler.clearStickyPositioning(W,["bottom"]),this._stickyStyler.stickRows(W,ze,"bottom"),this._stickyStyler.updateStickyFooterContainer(this._elementRef.nativeElement,ze),this._footerRowDefs.forEach(Ie=>Ie.resetStickyChanged())}updateStickyColumnStyles(){const W=this._getRenderedRows(this._headerRowOutlet),ie=this._getRenderedRows(this._rowOutlet),_e=this._getRenderedRows(this._footerRowOutlet);(this._isNativeHtmlTable&&!this._fixedLayout||this._stickyColumnStylesNeedReset)&&(this._stickyStyler.clearStickyPositioning([...W,...ie,..._e],["left","right"]),this._stickyColumnStylesNeedReset=!1),W.forEach((ze,Ie)=>{this._addStickyColumnStyles([ze],this._headerRowDefs[Ie])}),this._rowDefs.forEach(ze=>{const Ie=[];for(let qt=0;qt<ie.length;qt++)this._renderRows[qt].rowDef===ze&&Ie.push(ie[qt]);this._addStickyColumnStyles(Ie,ze)}),_e.forEach((ze,Ie)=>{this._addStickyColumnStyles([ze],this._footerRowDefs[Ie])}),Array.from(this._columnDefsByName.values()).forEach(ze=>ze.resetStickyChanged())}_getAllRenderRows(){const W=[],ie=this._cachedRenderRowsMap;this._cachedRenderRowsMap=new Map;for(let _e=0;_e<this._data.length;_e++){let ze=this._data[_e];const Ie=this._getRenderRowsForData(ze,_e,ie.get(ze));this._cachedRenderRowsMap.has(ze)||this._cachedRenderRowsMap.set(ze,new WeakMap);for(let qt=0;qt<Ie.length;qt++){let Ei=Ie[qt];const ri=this._cachedRenderRowsMap.get(Ei.data);ri.has(Ei.rowDef)?ri.get(Ei.rowDef).push(Ei):ri.set(Ei.rowDef,[Ei]),W.push(Ei)}}return W}_getRenderRowsForData(W,ie,_e){return this._getRowDefs(W,ie).map(Ie=>{const qt=_e&&_e.has(Ie)?_e.get(Ie):[];if(qt.length){const Ei=qt.shift();return Ei.dataIndex=ie,Ei}return{data:W,rowDef:Ie,dataIndex:ie}})}_cacheColumnDefs(){this._columnDefsByName.clear(),Y(this._getOwnDefs(this._contentColumnDefs),this._customColumnDefs).forEach(ie=>{this._columnDefsByName.has(ie.name),this._columnDefsByName.set(ie.name,ie)})}_cacheRowDefs(){this._headerRowDefs=Y(this._getOwnDefs(this._contentHeaderRowDefs),this._customHeaderRowDefs),this._footerRowDefs=Y(this._getOwnDefs(this._contentFooterRowDefs),this._customFooterRowDefs),this._rowDefs=Y(this._getOwnDefs(this._contentRowDefs),this._customRowDefs);const W=this._rowDefs.filter(ie=>!ie.when);this._defaultRowDef=W[0]}_renderUpdatedColumns(){const W=(Ie,qt)=>Ie||!!qt.getColumnsDiff(),ie=this._rowDefs.reduce(W,!1);ie&&this._forceRenderDataRows();const _e=this._headerRowDefs.reduce(W,!1);_e&&this._forceRenderHeaderRows();const ze=this._footerRowDefs.reduce(W,!1);return ze&&this._forceRenderFooterRows(),ie||_e||ze}_switchDataSource(W){this._data=[],(0,d.Z9)(this.dataSource)&&this.dataSource.disconnect(this),this._renderChangeSubscription&&(this._renderChangeSubscription.unsubscribe(),this._renderChangeSubscription=null),W||(this._dataDiffer&&this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear()),this._dataSource=W}_observeRenderChanges(){if(!this.dataSource)return;let W;(0,d.Z9)(this.dataSource)?W=this.dataSource.connect(this):(0,Hi.b)(this.dataSource)?W=this.dataSource:Array.isArray(this.dataSource)&&(W=(0,Bt.of)(this.dataSource)),this._renderChangeSubscription=W.pipe((0,tt.R)(this._onDestroy)).subscribe(ie=>{this._data=ie||[],this.renderRows()})}_forceRenderHeaderRows(){this._headerRowOutlet.viewContainer.length>0&&this._headerRowOutlet.viewContainer.clear(),this._headerRowDefs.forEach((W,ie)=>this._renderRow(this._headerRowOutlet,W,ie)),this.updateStickyHeaderRowStyles()}_forceRenderFooterRows(){this._footerRowOutlet.viewContainer.length>0&&this._footerRowOutlet.viewContainer.clear(),this._footerRowDefs.forEach((W,ie)=>this._renderRow(this._footerRowOutlet,W,ie)),this.updateStickyFooterRowStyles()}_addStickyColumnStyles(W,ie){const _e=Array.from(ie.columns||[]).map(qt=>this._columnDefsByName.get(qt)),ze=_e.map(qt=>qt.sticky),Ie=_e.map(qt=>qt.stickyEnd);this._stickyStyler.updateStickyColumns(W,ze,Ie,!this._fixedLayout||this._forceRecalculateCellWidths)}_getRenderedRows(W){const ie=[];for(let _e=0;_e<W.viewContainer.length;_e++){const ze=W.viewContainer.get(_e);ie.push(ze.rootNodes[0])}return ie}_getRowDefs(W,ie){if(1==this._rowDefs.length)return[this._rowDefs[0]];let _e=[];if(this.multiTemplateDataRows)_e=this._rowDefs.filter(ze=>!ze.when||ze.when(ie,W));else{let ze=this._rowDefs.find(Ie=>Ie.when&&Ie.when(ie,W))||this._defaultRowDef;ze&&_e.push(ze)}return _e}_getEmbeddedViewArgs(W,ie){return{templateRef:W.rowDef.template,context:{$implicit:W.data},index:ie}}_renderRow(W,ie,_e,ze={}){const Ie=W.viewContainer.createEmbeddedView(ie.template,ze,_e);return this._renderCellTemplateForItem(ie,ze),Ie}_renderCellTemplateForItem(W,ie){for(let _e of this._getCellTemplates(W))bn.mostRecentCellOutlet&&bn.mostRecentCellOutlet._viewContainer.createEmbeddedView(_e,ie);this._changeDetectorRef.markForCheck()}_updateRowIndexContext(){const W=this._rowOutlet.viewContainer;for(let ie=0,_e=W.length;ie<_e;ie++){const Ie=W.get(ie).context;Ie.count=_e,Ie.first=0===ie,Ie.last=ie===_e-1,Ie.even=ie%2==0,Ie.odd=!Ie.even,this.multiTemplateDataRows?(Ie.dataIndex=this._renderRows[ie].dataIndex,Ie.renderIndex=ie):Ie.index=this._renderRows[ie].dataIndex}}_getCellTemplates(W){return W&&W.columns?Array.from(W.columns,ie=>{const _e=this._columnDefsByName.get(ie);return W.extractCellTemplate(_e)}):[]}_applyNativeTableSections(){const W=this._document.createDocumentFragment(),ie=[{tag:"thead",outlets:[this._headerRowOutlet]},{tag:"tbody",outlets:[this._rowOutlet,this._noDataRowOutlet]},{tag:"tfoot",outlets:[this._footerRowOutlet]}];for(const _e of ie){const ze=this._document.createElement(_e.tag);ze.setAttribute("role","rowgroup");for(const Ie of _e.outlets)ze.appendChild(Ie.elementRef.nativeElement);W.appendChild(ze)}this._elementRef.nativeElement.appendChild(W)}_forceRenderDataRows(){this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear(),this.renderRows()}_checkStickyStates(){const W=(ie,_e)=>ie||_e.hasStickyChanged();this._headerRowDefs.reduce(W,!1)&&this.updateStickyHeaderRowStyles(),this._footerRowDefs.reduce(W,!1)&&this.updateStickyFooterRowStyles(),Array.from(this._columnDefsByName.values()).reduce(W,!1)&&(this._stickyColumnStylesNeedReset=!0,this.updateStickyColumnStyles())}_setupStickyStyler(){this._stickyStyler=new Ni(this._isNativeHtmlTable,this.stickyCssClass,this._dir?this._dir.value:"ltr",this._coalescedStyleScheduler,this._platform.isBrowser,this.needsPositionStickyOnElement,this._stickyPositioningListener),(this._dir?this._dir.change:(0,Bt.of)()).pipe((0,tt.R)(this._onDestroy)).subscribe(ie=>{this._stickyStyler.direction=ie,this.updateStickyColumnStyles()})}_getOwnDefs(W){return W.filter(ie=>!ie._table||ie._table===this)}_updateNoDataRow(){const W=this._customNoDataRow||this._noDataRow;if(!W)return;const ie=0===this._rowOutlet.viewContainer.length;if(ie===this._isShowingNoDataRow)return;const _e=this._noDataRowOutlet.viewContainer;if(ie){const ze=_e.createEmbeddedView(W.templateRef),Ie=ze.rootNodes[0];1===ze.rootNodes.length&&Ie?.nodeType===this._document.ELEMENT_NODE&&(Ie.setAttribute("role","row"),Ie.classList.add(W._contentClassName))}else _e.clear();this._isShowingNoDataRow=ie,this._changeDetectorRef.markForCheck()}static#e=this.\u0275fac=function(ie){return new(ie||J)(x.Y36(x.ZZ4),x.Y36(x.sBO),x.Y36(x.SBq),x.$8M("role"),x.Y36(A.Is,8),x.Y36(Qi.K0),x.Y36(R.t4),x.Y36(d.k),x.Y36(ts),x.Y36(Li.rL),x.Y36(je,12),x.Y36(x.R0b,8))};static#t=this.\u0275cmp=x.Xpm({type:J,selectors:[["cdk-table"],["table","cdk-table",""]],contentQueries:function(ie,_e,ze){if(1&ie&&(x.Suo(ze,Sn,5),x.Suo(ze,jt,5),x.Suo(ze,fs,5),x.Suo(ze,fn,5),x.Suo(ze,ds,5)),2&ie){let Ie;x.iGM(Ie=x.CRH())&&(_e._noDataRow=Ie.first),x.iGM(Ie=x.CRH())&&(_e._contentColumnDefs=Ie),x.iGM(Ie=x.CRH())&&(_e._contentRowDefs=Ie),x.iGM(Ie=x.CRH())&&(_e._contentHeaderRowDefs=Ie),x.iGM(Ie=x.CRH())&&(_e._contentFooterRowDefs=Ie)}},viewQuery:function(ie,_e){if(1&ie&&(x.Gf(ne,7),x.Gf(z,7),x.Gf(Qe,7),x.Gf(mt,7)),2&ie){let ze;x.iGM(ze=x.CRH())&&(_e._rowOutlet=ze.first),x.iGM(ze=x.CRH())&&(_e._headerRowOutlet=ze.first),x.iGM(ze=x.CRH())&&(_e._footerRowOutlet=ze.first),x.iGM(ze=x.CRH())&&(_e._noDataRowOutlet=ze.first)}},hostAttrs:["ngSkipHydration","",1,"cdk-table"],hostVars:2,hostBindings:function(ie,_e){2&ie&&x.ekj("cdk-table-fixed-layout",_e.fixedLayout)},inputs:{trackBy:"trackBy",dataSource:"dataSource",multiTemplateDataRows:"multiTemplateDataRows",fixedLayout:"fixedLayout"},outputs:{contentChanged:"contentChanged"},exportAs:["cdkTable"],features:[x._Bn([{provide:si,useExisting:J},{provide:d.k,useClass:d.yy},{provide:ts,useClass:ps},{provide:je,useValue:null}])],ngContentSelectors:Vt,decls:6,vars:0,consts:[["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(ie,_e){1&ie&&(x.F$t(Nt),x.Hsn(0),x.Hsn(1,1),x.GkF(2,0)(3,1)(4,2)(5,3))},dependencies:[ne,z,Qe,mt],styles:[".cdk-table-fixed-layout{table-layout:fixed}"],encapsulation:2})}return J})();function Y(J,_t){return J.concat(Array.from(_t))}let St=(()=>{class J{static#e=this.\u0275fac=function(ie){return new(ie||J)};static#t=this.\u0275mod=x.oAB({type:J});static#i=this.\u0275inj=x.cJS({imports:[Li.Cl]})}return J})();var Tt=V(4220),xi=V(5047),Hn=V(8442),Wi=V(2425);const ns=[[["caption"]],[["colgroup"],["col"]]],Ia=["caption","colgroup, col"];let kr=(()=>{class J extends Lt{constructor(){super(...arguments),this.stickyCssClass="mat-mdc-table-sticky",this.needsPositionStickyOnElement=!1}ngOnInit(){super.ngOnInit(),this._isNativeHtmlTable&&this._elementRef.nativeElement.querySelector("tbody").classList.add("mdc-data-table__content")}static#e=this.\u0275fac=function(){let W;return function(_e){return(W||(W=x.n5z(J)))(_e||J)}}();static#t=this.\u0275cmp=x.Xpm({type:J,selectors:[["mat-table"],["table","mat-table",""]],hostAttrs:["ngSkipHydration","",1,"mat-mdc-table","mdc-data-table__table"],hostVars:2,hostBindings:function(ie,_e){2&ie&&x.ekj("mdc-table-fixed-layout",_e.fixedLayout)},exportAs:["matTable"],features:[x._Bn([{provide:Lt,useExisting:J},{provide:si,useExisting:J},{provide:ts,useClass:ps},{provide:d.k,useClass:d.yy},{provide:je,useValue:null}]),x.qOj],ngContentSelectors:Ia,decls:6,vars:0,consts:[["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(ie,_e){1&ie&&(x.F$t(ns),x.Hsn(0),x.Hsn(1,1),x.GkF(2,0)(3,1)(4,2)(5,3))},dependencies:[ne,z,Qe,mt],styles:[".mat-mdc-table-sticky{position:sticky !important}.mdc-data-table{-webkit-overflow-scrolling:touch;display:inline-flex;flex-direction:column;box-sizing:border-box;position:relative}.mdc-data-table__table-container{-webkit-overflow-scrolling:touch;overflow-x:auto;width:100%}.mdc-data-table__table{min-width:100%;border:0;white-space:nowrap;border-spacing:0;table-layout:fixed}.mdc-data-table__cell{box-sizing:border-box;overflow:hidden;text-align:left;text-overflow:ellipsis}[dir=rtl] .mdc-data-table__cell,.mdc-data-table__cell[dir=rtl]{text-align:right}.mdc-data-table__cell--numeric{text-align:right}[dir=rtl] .mdc-data-table__cell--numeric,.mdc-data-table__cell--numeric[dir=rtl]{text-align:left}.mdc-data-table__header-cell{box-sizing:border-box;text-overflow:ellipsis;overflow:hidden;outline:none;text-align:left}[dir=rtl] .mdc-data-table__header-cell,.mdc-data-table__header-cell[dir=rtl]{text-align:right}.mdc-data-table__header-cell--numeric{text-align:right}[dir=rtl] .mdc-data-table__header-cell--numeric,.mdc-data-table__header-cell--numeric[dir=rtl]{text-align:left}.mdc-data-table__header-cell-wrapper{align-items:center;display:inline-flex;vertical-align:middle}.mdc-data-table__cell,.mdc-data-table__header-cell{padding:0 16px 0 16px}.mdc-data-table__header-cell--checkbox,.mdc-data-table__cell--checkbox{padding-left:4px;padding-right:0}[dir=rtl] .mdc-data-table__header-cell--checkbox,[dir=rtl] .mdc-data-table__cell--checkbox,.mdc-data-table__header-cell--checkbox[dir=rtl],.mdc-data-table__cell--checkbox[dir=rtl]{padding-left:0;padding-right:4px}mat-table{display:block}mat-header-row{min-height:56px}mat-row,mat-footer-row{min-height:48px}mat-row,mat-header-row,mat-footer-row{display:flex;border-width:0;border-bottom-width:1px;border-style:solid;align-items:center;box-sizing:border-box}mat-cell:first-of-type,mat-header-cell:first-of-type,mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] mat-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:first-of-type:not(:only-of-type){padding-left:0;padding-right:24px}mat-cell:last-of-type,mat-header-cell:last-of-type,mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] mat-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:last-of-type:not(:only-of-type){padding-right:0;padding-left:24px}mat-cell,mat-header-cell,mat-footer-cell{flex:1;display:flex;align-items:center;overflow:hidden;word-wrap:break-word;min-height:inherit}.mat-mdc-table{--mat-table-row-item-outline-width:1px;table-layout:auto;white-space:normal;background-color:var(--mat-table-background-color)}.mat-mdc-header-row{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mat-table-header-container-height, 56px);color:var(--mat-table-header-headline-color, rgba(0, 0, 0, 0.87));font-family:var(--mat-table-header-headline-font, Roboto, sans-serif);line-height:var(--mat-table-header-headline-line-height);font-size:var(--mat-table-header-headline-size, 14px);font-weight:var(--mat-table-header-headline-weight, 500)}.mat-mdc-row{height:var(--mat-table-row-item-container-height, 52px);color:var(--mat-table-row-item-label-text-color, rgba(0, 0, 0, 0.87))}.mat-mdc-row,.mdc-data-table__content{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-table-row-item-label-text-font, Roboto, sans-serif);line-height:var(--mat-table-row-item-label-text-line-height);font-size:var(--mat-table-row-item-label-text-size, 14px);font-weight:var(--mat-table-row-item-label-text-weight)}.mat-mdc-footer-row{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mat-table-footer-container-height, 52px);color:var(--mat-table-row-item-label-text-color, rgba(0, 0, 0, 0.87));font-family:var(--mat-table-footer-supporting-text-font, Roboto, sans-serif);line-height:var(--mat-table-footer-supporting-text-line-height);font-size:var(--mat-table-footer-supporting-text-size, 14px);font-weight:var(--mat-table-footer-supporting-text-weight);letter-spacing:var(--mat-table-footer-supporting-text-tracking)}.mat-mdc-header-cell{border-bottom-color:var(--mat-table-row-item-outline-color, rgba(0, 0, 0, 0.12));border-bottom-width:var(--mat-table-row-item-outline-width, 1px);border-bottom-style:solid;letter-spacing:var(--mat-table-header-headline-tracking);font-weight:inherit;line-height:inherit}.mat-mdc-cell{border-bottom-color:var(--mat-table-row-item-outline-color, rgba(0, 0, 0, 0.12));border-bottom-width:var(--mat-table-row-item-outline-width, 1px);border-bottom-style:solid;letter-spacing:var(--mat-table-row-item-label-text-tracking);line-height:inherit}.mdc-data-table__row:last-child .mat-mdc-cell{border-bottom:none}.mat-mdc-footer-cell{letter-spacing:var(--mat-table-row-item-label-text-tracking)}mat-row.mat-mdc-row,mat-header-row.mat-mdc-header-row,mat-footer-row.mat-mdc-footer-row{border-bottom:none}.mat-mdc-table tbody,.mat-mdc-table tfoot,.mat-mdc-table thead,.mat-mdc-cell,.mat-mdc-footer-cell,.mat-mdc-header-row,.mat-mdc-row,.mat-mdc-footer-row,.mat-mdc-table .mat-mdc-header-cell{background:inherit}.mat-mdc-table mat-header-row.mat-mdc-header-row,.mat-mdc-table mat-row.mat-mdc-row,.mat-mdc-table mat-footer-row.mat-mdc-footer-cell{height:unset}mat-header-cell.mat-mdc-header-cell,mat-cell.mat-mdc-cell,mat-footer-cell.mat-mdc-footer-cell{align-self:stretch}"],encapsulation:2})}return J})(),Ys=(()=>{class J extends pi{static#e=this.\u0275fac=function(){let W;return function(_e){return(W||(W=x.n5z(J)))(_e||J)}}();static#t=this.\u0275dir=x.lG2({type:J,selectors:[["","matCellDef",""]],features:[x._Bn([{provide:pi,useExisting:J}]),x.qOj]})}return J})(),Is=(()=>{class J extends ni{static#e=this.\u0275fac=function(){let W;return function(_e){return(W||(W=x.n5z(J)))(_e||J)}}();static#t=this.\u0275dir=x.lG2({type:J,selectors:[["","matHeaderCellDef",""]],features:[x._Bn([{provide:ni,useExisting:J}]),x.qOj]})}return J})(),Nr=(()=>{class J extends jt{get name(){return this._name}set name(W){this._setNameInput(W)}_updateColumnCssClassName(){super._updateColumnCssClassName(),this._columnCssClassName.push(`mat-column-${this.cssClassFriendlyName}`)}static#e=this.\u0275fac=function(){let W;return function(_e){return(W||(W=x.n5z(J)))(_e||J)}}();static#t=this.\u0275dir=x.lG2({type:J,selectors:[["","matColumnDef",""]],inputs:{sticky:"sticky",name:["matColumnDef","name"]},features:[x._Bn([{provide:jt,useExisting:J},{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:J}]),x.qOj]})}return J})(),La=(()=>{class J extends ut{static#e=this.\u0275fac=function(){let W;return function(_e){return(W||(W=x.n5z(J)))(_e||J)}}();static#t=this.\u0275dir=x.lG2({type:J,selectors:[["mat-header-cell"],["th","mat-header-cell",""]],hostAttrs:["role","columnheader",1,"mat-mdc-header-cell","mdc-data-table__header-cell"],features:[x.qOj]})}return J})(),Fa=(()=>{class J extends Qt{static#e=this.\u0275fac=function(){let W;return function(_e){return(W||(W=x.n5z(J)))(_e||J)}}();static#t=this.\u0275dir=x.lG2({type:J,selectors:[["mat-cell"],["td","mat-cell",""]],hostAttrs:[1,"mat-mdc-cell","mdc-data-table__cell"],features:[x.qOj]})}return J})(),ya=(()=>{class J extends fn{static#e=this.\u0275fac=function(){let W;return function(_e){return(W||(W=x.n5z(J)))(_e||J)}}();static#t=this.\u0275dir=x.lG2({type:J,selectors:[["","matHeaderRowDef",""]],inputs:{columns:["matHeaderRowDef","columns"],sticky:["matHeaderRowDefSticky","sticky"]},features:[x._Bn([{provide:fn,useExisting:J}]),x.qOj]})}return J})(),Ls=(()=>{class J extends fs{static#e=this.\u0275fac=function(){let W;return function(_e){return(W||(W=x.n5z(J)))(_e||J)}}();static#t=this.\u0275dir=x.lG2({type:J,selectors:[["","matRowDef",""]],inputs:{columns:["matRowDefColumns","columns"],when:["matRowDefWhen","when"]},features:[x._Bn([{provide:fs,useExisting:J}]),x.qOj]})}return J})(),xa=(()=>{class J extends gi{static#e=this.\u0275fac=function(){let W;return function(_e){return(W||(W=x.n5z(J)))(_e||J)}}();static#t=this.\u0275cmp=x.Xpm({type:J,selectors:[["mat-header-row"],["tr","mat-header-row",""]],hostAttrs:["role","row",1,"mat-mdc-header-row","mdc-data-table__header-row"],exportAs:["matHeaderRow"],features:[x._Bn([{provide:gi,useExisting:J}]),x.qOj],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(ie,_e){1&ie&&x.GkF(0,0)},dependencies:[bn],encapsulation:2})}return J})(),Fs=(()=>{class J extends Tn{static#e=this.\u0275fac=function(){let W;return function(_e){return(W||(W=x.n5z(J)))(_e||J)}}();static#t=this.\u0275cmp=x.Xpm({type:J,selectors:[["mat-row"],["tr","mat-row",""]],hostAttrs:["role","row",1,"mat-mdc-row","mdc-data-table__row"],exportAs:["matRow"],features:[x._Bn([{provide:Tn,useExisting:J}]),x.qOj],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(ie,_e){1&ie&&x.GkF(0,0)},dependencies:[bn],encapsulation:2})}return J})(),Ma=(()=>{class J{static#e=this.\u0275fac=function(ie){return new(ie||J)};static#t=this.\u0275mod=x.oAB({type:J});static#i=this.\u0275inj=x.cJS({imports:[Tt.BQ,St,Tt.BQ]})}return J})();class ea extends d.o2{get data(){return this._data.value}set data(_t){_t=Array.isArray(_t)?_t:[],this._data.next(_t),this._renderChangesSubscription||this._filterData(_t)}get filter(){return this._filter.value}set filter(_t){this._filter.next(_t),this._renderChangesSubscription||this._filterData(this.data)}get sort(){return this._sort}set sort(_t){this._sort=_t,this._updateChangeSubscription()}get paginator(){return this._paginator}set paginator(_t){this._paginator=_t,this._updateChangeSubscription()}constructor(_t=[]){super(),this._renderData=new Zi.X([]),this._filter=new Zi.X(""),this._internalPageChanges=new mi.x,this._renderChangesSubscription=null,this.sortingDataAccessor=(W,ie)=>{const _e=W[ie];if((0,ke.t6)(_e)){const ze=Number(_e);return ze<9007199254740991?ze:_e}return _e},this.sortData=(W,ie)=>{const _e=ie.active,ze=ie.direction;return _e&&""!=ze?W.sort((Ie,qt)=>{let Ei=this.sortingDataAccessor(Ie,_e),ri=this.sortingDataAccessor(qt,_e);const Di=typeof Ei,Zn=typeof ri;Di!==Zn&&("number"===Di&&(Ei+=""),"number"===Zn&&(ri+=""));let Gi=0;return null!=Ei&&null!=ri?Ei>ri?Gi=1:Ei<ri&&(Gi=-1):null!=Ei?Gi=1:null!=ri&&(Gi=-1),Gi*("asc"==ze?1:-1)}):W},this.filterPredicate=(W,ie)=>{const _e=Object.keys(W).reduce((Ie,qt)=>Ie+W[qt]+"\u25ec","").toLowerCase(),ze=ie.trim().toLowerCase();return-1!=_e.indexOf(ze)},this._data=new Zi.X(_t),this._updateChangeSubscription()}_updateChangeSubscription(){const _t=this._sort?(0,xi.T)(this._sort.sortChange,this._sort.initialized):(0,Bt.of)(null),W=this._paginator?(0,xi.T)(this._paginator.page,this._internalPageChanges,this._paginator.initialized):(0,Bt.of)(null),_e=(0,Hn.a)([this._data,this._filter]).pipe((0,Wi.U)(([qt])=>this._filterData(qt))),ze=(0,Hn.a)([_e,_t]).pipe((0,Wi.U)(([qt])=>this._orderData(qt))),Ie=(0,Hn.a)([ze,W]).pipe((0,Wi.U)(([qt])=>this._pageData(qt)));this._renderChangesSubscription?.unsubscribe(),this._renderChangesSubscription=Ie.subscribe(qt=>this._renderData.next(qt))}_filterData(_t){return this.filteredData=null==this.filter||""===this.filter?_t:_t.filter(W=>this.filterPredicate(W,this.filter)),this.paginator&&this._updatePaginator(this.filteredData.length),this.filteredData}_orderData(_t){return this.sort?this.sortData(_t.slice(),this.sort):_t}_pageData(_t){if(!this.paginator)return _t;const W=this.paginator.pageIndex*this.paginator.pageSize;return _t.slice(W,W+this.paginator.pageSize)}_updatePaginator(_t){Promise.resolve().then(()=>{const W=this.paginator;if(W&&(W.length=_t,W.pageIndex>0)){const ie=Math.ceil(W.length/W.pageSize)-1||0,_e=Math.min(W.pageIndex,ie);_e!==W.pageIndex&&(W.pageIndex=_e,this._internalPageChanges.next())}})}connect(){return this._renderChangesSubscription||this._updateChangeSubscription(),this._renderData}disconnect(){this._renderChangesSubscription?.unsubscribe(),this._renderChangesSubscription=null}}class ta extends ea{}}}]);